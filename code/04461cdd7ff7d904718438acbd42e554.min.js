var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},_thisGlobal=this,egret;!function(t){function e(t){i.push(t)}var r=t,n=r.Capabilities,o=r.MainContext,i=[],a=function(){function e(){}return Object.defineProperty(e.prototype,"NATIVE",{get:function(){return n?t.RuntimeType.NATIVE:t.MainContext.RUNTIME_NATIVE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"WEB",{get:function(){return n?t.RuntimeType.WEB:t.MainContext.RUNTIME_HTML5},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"runtimeType",{get:function(){return n?n.runtimeType:o.runtimeType},enumerable:!0,configurable:!0}),e}();t.Difference=a,__reflect(a.prototype,"egret.Difference"),t.DIFF=new a,t.isNative=t.DIFF.runtimeType==t.RuntimeType.NATIVE;var s=t.registerClass;t.__classId=1,t.registerClass=function(e,r){var n=e.prototype,o=r.split(".");e.__className=n.__className=o[o.length-1],n.__class=e,e.__classId=t.__classId++,s&&s.apply(t,arguments);for(var a=0,u=i.length;u>a;a++){var l=i[a];l(e,r)}},t.mo_onRegisterClass=e;var u=t.web||{},l=u.WebVideo;if(l){var c=l.prototype.load;c&&(l.prototype.load=function(){var t=this;c.apply(t,arguments),t.video&&(t.video.crossOrigin="Anonymous")})}}(egret||(egret={})),this.__reflect=function(t,e,r){egret.registerClass(t.constructor,e,r)};var mo;!function(t){var e;!function(e){function r(t,e){n(t,e,3)}function n(e,r,n){i[r]=e;var o=function(){};egret.isNative?(e.log=n>1?o:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];console.log(r+".log: "+t.STR.format.apply(t.STR,e))},e.debug=n>1?o:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];console.debug(r+".debug: "+t.STR.format.apply(t.STR,e))},e.info=n>2?o:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];console.debug(r+".info: "+t.STR.format.apply(t.STR,e))},e.warn=n>3?o:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];console.warn(r+".warn: "+t.STR.format.apply(t.STR,e))},e.error=n>4?o:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];console.error(r+".error: "+t.STR.format.apply(t.STR,e))}):(e.log=n>1?o:console.log.bind(console),e.debug=n>1?o:console.debug.bind(console),e.info=n>2?o:console.info.bind(console),e.warn=n>3?o:console.warn.bind(console),e.error=n>4?o:console.error.bind(console))}function o(t,e){if("default"==t){for(var r in i)if("default"!=r){var o=i[r];o&&n(o,r,e)}}else{var o=i[t];if(!o)return;n(o,t,e)}}var i={};e.initLogger=r,e.setLvl=o,r(t.LOG,"mo.LOG")}(e=t.LOG||(t.LOG={}))}(mo||(mo={}));var mo;!function(t){function e(t,e){egret.callLater(function(){t.call(e)},null)}function r(t,e){egret.startTick(t,e)}function n(t,e){egret.stopTick(t,e)}t.nextTick=e,t.tick=r,t.clearTick=n}(mo||(mo={}));var mo;!function(t){var e;!function(t){function e(t,e){o[t]=e}function r(){return JSON.stringify(o)}function n(){console.info(r())}var o={};t.set=e,t.getInfo=r,t.print=n}(e=t.VERSION||(t.VERSION={}))}(mo||(mo={})),function(t){function e(t,e,r,n){var o={};o.configurable=!0,o.enumerable=!0,r&&(o.get=r),n&&(o.set=n),Object.defineProperty(t,e,o)}function r(t,e,r){if(t instanceof Array)for(var n=0,o=t.length;o>n;n++)e.call(r,t[n],n);else for(var i in t)e.call(r,t[i],i)}function n(t,e,r){var n=t.extData=t.extData||{};if("string"==typeof e||"number"==typeof e)n[e]=r;else for(var o in e)n[e]=e[o]}function o(t,e){var r=t.extData;return r?r[e]:null}function i(t){delete t.extData}function a(t,e,r,i){var a=o(i,"emitterOrClassList")||[];n(i,"emitterOrClassList",a);for(var s=!1,u=0,l=a.length;l>u;u++){var c=a[u];if(c[0]==t&&c[1]==e){s=!0,c[2]=r;break}}s||a.push([t,e,r]),t.on(e,r,i)}function s(t){for(var e=o(t,"emitterOrClassList")||[],r=0,n=e.length;n>r;r++){var i=e[r];i[0].un(i[1],i[2],t)}e.length=0}t.LOG.initLogger(t,"mo"),t.__define=e,t.each=r,t.setExt=n,t.getExt=o,t.clearExt=i,t.onEmitter=a,t.unEmitter=s}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},mo;!function(t){var e=function(){function e(t,e,r,n,o){this._srcObj=null,this._limit=0,this._pool=[],this._iterator=null,this._iteratorCtx=null,this._onEnd=null,this._onEndCtx=null,this._results=null,this._isErr=!1,this.size=0,this.finishedSize=0,this._workingSize=0;var i=this;i._srcObj=t,i._iterator=r,i._iteratorCtx=o,i._onEnd=n,i._onEndCtx=o,i._results=t instanceof Array?[]:{},i._each(t,function(t,e){i._pool.push({index:e,value:t})}),i.size=i._pool.length,i._limit=e||i.size}return e.prototype._each=function(t,e,r){if(t)if(t instanceof Array){for(var n=0,o=t.length;o>n;n++)if(e.call(r,t[n],n)===!1)return}else for(var i in t)if(e.call(r,t[i],i)===!1)return},e.prototype.onIterator=function(t,e){this._iterator=t,this._iteratorCtx=e},e.prototype.onEnd=function(t,e){this._onEnd=t,this._onEndCtx=e},e.prototype._handleItem=function(){var e=this;if(0!=e._pool.length&&!(e._workingSize>=e._limit)){var r=e._pool.shift(),n=r.value,o=r.index;e._workingSize++,e._iterator.call(e._iteratorCtx,n,o,function(r){if(!e._isErr){if(e.finishedSize++,e._workingSize--,r)return e._isErr=!0,void(e._onEnd&&e._onEnd.call(e._onEndCtx,r));var n=Array.prototype.slice.call(arguments);return n.splice(0,1),e._results[this.index]=n[0],e.finishedSize==e.size?void(e._onEnd&&e._onEnd.call(e._onEndCtx,null,e._results)):void t.nextTick(function(){e._handleItem()})}}.bind(r),e)}},e.prototype.flow=function(){var e=this,r=function(){if(0==e._pool.length)e._onEnd&&e._onEnd.call(e._onEndCtx,null,[]);else for(var t=0;t<e._limit;t++)e._handleItem()};t.nextTick(r)},e}();t.AsyncPool=e,__reflect(e.prototype,"mo.AsyncPool")}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},mo;!function(t){var e=function(){function t(){this.pool={},this.tempPool={},this.pool4Single={},this.tempArgsMap={},this.valuePool={}}return t.prototype.register=function(t,e,r,n,o){var i=this.pool;if(i){var a=i[t];a||(i[t]=a={});var s=a[e];s||(s=a[e]=[]);for(var u=0,l=s.length;l>u;u++){var c=s[u];if(c&&c.listener==r&&c.ctx==n)return}var p={listener:r,ctx:n,priority:o};if(null==o)s.push(p);else{for(var f=0,u=0,l=s.length;l>u;u++){var c=s[u];if(null==c.priority||c.priority<=o)f=u+1;else if(c.priority>o){f=u;break}}s.splice(f,0,p)}}},t.prototype.unRegister=function(t,e,r,n){var o=this.pool;if(o){var i=o[t];if(i){var a=i[e];if(a)for(var s=0,u=a.length;u>s;s++){var l=a[s];if(l.listener==r&&l.ctx==n)return void a.splice(s,1)}}}},t.prototype.clear=function(t,e){var r=this.pool;if(r){var n=r[t];if(n){var o=n[e];o&&(o.length=0)}}},t.prototype.registerSingle=function(t,e,r,n){var o=this,i=o.pool4Single;if(i){var a=i[t];a||(a=i[t]={}),a[e]={listener:r,ctx:n}}},t.prototype.unRegisterSingle=function(t,e){var r=this,n=r.pool4Single;if(n){var o=n[t];o&&delete o[e]}},t.prototype.unCtx=function(t){if(t){var e=this,r=e.pool,n=e.pool4Single;if(r&&n){for(var o in r){var i=r[o];if(i)for(var a in i){var s=i[a];if(s)for(var u=0;u<s.length;){var l=s[u];l.ctx==t?s.splice(u,1):u++}}}for(var o in n){var i=n[o];if(i)for(var a in i){var c=i[a];c.ctx==t&&delete i[a]}}}}},t.prototype.unRegisterAll=function(t,e){var r=this.pool,n=this.pool4Single;if(r&&n){var o=r[t],i=n[t];if(1==arguments.length){if(o)for(var a in o)delete o[a];if(i)for(var a in i)delete i[a]}else{if(o){var s=o[e];s&&(s.length=0)}i&&delete i[e]}}},t.prototype.getTempArr=function(t,e){var r=this.pool,n=this.tempPool;if(!r||!n)return null;var o=r[t];if(!o)return null;var i=o[e];if(!i)return null;var a=n[t];a||(a=n[t]={});var s=a[e];s||(s=a[e]=[]),s.length=0;for(var u=0,l=i.length;l>u;u++)s.push(i[u]);return s},t.prototype.getSingle=function(t,e){var r=this,n=r.pool4Single;if(n){var o=n[t];return o?o[e]:null}},t.prototype.getTempArgs=function(t,e,r){var n=this.tempArgsMap;if(!n)return null;var o=n[t];o||(o=n[t]={});var i=o[e];i||(i=o[e]=[]),i.length>0&&(i=[]);for(var a=0,s=r.length;s>a;a++)i.push(r[a]);return i},t.prototype.setValue=function(t,e,r){var n=this.valuePool;if(n){var o=n[t];o||(o=n[t]={}),o[e]=r}},t.prototype.removeValue=function(t,e){var r=this.valuePool;if(!r)return null;var n=r[t];return n?n[e]:null},t.prototype.doDtor=function(){var t=this;t._hasDtored||(t._hasDtored=!0,t.dtor())},t.prototype.dtor=function(){var t=this;delete t.pool,delete t.tempPool,delete t.pool4Single,delete t.tempArgsMap,delete t.valuePool},t}();t.Store=e,__reflect(e.prototype,"mo.Store")}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},mo;!function(t){function e(e){if(!e||!e.__classId)return null;var r=e.__classId,n=o[r]=o[r]||new t.Store;return n}function r(){y||(y=!0,t.tick(function(){if(_.length=0,f.length>0){for(var t=0,r=f.length;r>t;t++){var n=f[t],o=n._store,i=o.valuePool,s=i[a];for(var l in s)h.push(n),g.push(l),d.push(s[l]),delete s[l]}f.length=0;for(var t=0,r=h.length;r>t;t++){var c,p,n=h[t],y=g[t],v=d[t];c=o.getSingle(a,y),n._emitByListenerInfoArr(a,y,c,v),p=o.getTempArr(u,y),o.clear(u,y),n._emitByListenerInfoArr(u,y,p,v),p=o.getTempArr(a,y),n._emitByListenerInfoArr(a,y,p,v),o=e(n.__class),c=o.getSingle(a,y),n._emitByListenerInfoArr(a,y,c,v),p=o.getTempArr(u,y),o.clear(u,y),n._emitByListenerInfoArr(u,y,p,v),p=o.getTempArr(a,y),n._emitByListenerInfoArr(a,y,p,v)}h.length=0,g.length=0,d.length=0}}))}function n(t){for(var e=p.prototype,r=t.prototype,n=0,o=v.length;o>n;n++){var i=v[n];r[i]=e[i]}}var o={};t._getClassStore=e;var i="on",a="onNextTick",s="once",u="onceNextTick",l="onAsync",c="onceAsync",p=function(){function n(){var t=this;t._initProp(),t._init()}return n.genGS=function(e,r){var n=this,o=n.prototype;t.__define(o,e,function(){var t=this,r="_get"+e.substring(0,1).toUpperCase()+e.substring(1),n=t[r];return n?n.call(t):t.$$data[e]},function(n){var o=this,i=o.$$data[e],a="_set"+e.substring(0,1).toUpperCase()+e.substring(1),s=o[a];s?(s.call(o,n),n=o.$$data[e]):o.$$data[e]=n,r&&!t.ASSERT.equals(i,n)&&o.emit(e,n,i)})},n.genGsList=function(t,e){for(var r=0,n=t.length;n>r;r++){var o=t[r];this.genGS(o,e)}},n.prototype._initProp=function(){var e=this;e._store=new t.Store,e.$$data={}},n.prototype._init=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},n.prototype.init=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},n.prototype.setData=function(e){var r=this;if(e){var n=r.$$data,o={};for(var i in e){var a=n[i],s=e[i];n[i]=s,t.ASSERT.equals(a,s)||(o[i]=[s,a])}for(var i in o)r.emit(i,o[i][0],o[i][1])}},n.prototype.clearData=function(){var e=this;t.OBJ.empty(e.$$data),e.emit(e.__class.ON_CLEAR_DATA)},n.prototype.doDtor=function(){var t=this;t._hasDtored||(t._hasDtored=!0,t.dtor())},n.prototype.dtor=function(){this.unEmitter(),this._store.doDtor()},n.prototype.on=function(t,r,n){var o=this;if(!o._hasDtored){var a=o.__classId?e(o):o._store;return a.register(i,t,r,n,null),o}},n.prototype.onPriority=function(t,r,n,o){var a=this;if(!a._hasDtored){var s=a.__classId?e(a):a._store;return s.register(i,t,n,o,r),a}},n.prototype.onAsync=function(t,r,n){var o=this;if(!o._hasDtored){var i=o.__classId?e(o):o._store;return i.register(l,t,r,n,null),o}},n.prototype.onAsyncPriority=function(t,r,n,o){var i=this;if(!i._hasDtored){var a=i.__classId?e(i):i._store;return a.register(l,t,n,o,r),i}},n.prototype.onNextTick=function(t,r,n){var o=this;if(!o._hasDtored){var i=o.__classId?e(o):o._store;return i.register(a,t,r,n,null),o}},n.prototype.onPriorityNextTick=function(t,r,n,o){var i=this;if(!i._hasDtored){var s=i.__classId?e(i):i._store;return s.register(a,t,n,o,r),i}},n.prototype.once=function(t,r,n){var o=this;if(!o._hasDtored){var i=o.__classId?e(o):o._store;return i.register(s,t,r,n,null),o}},n.prototype.oncePriority=function(t,r,n,o){var i=this;if(!i._hasDtored){var a=i.__classId?e(i):i._store;return a.register(s,t,n,o,r),i}},n.prototype.onceAsync=function(t,r,n){var o=this;if(!o._hasDtored){var i=o.__classId?e(o):o._store;return i.register(c,t,r,n,null),o}},n.prototype.onceAsyncPriority=function(t,r,n,o){var i=this;if(!i._hasDtored){var a=i.__classId?e(i):i._store;return a.register(c,t,n,o,r),i}},n.prototype.onceNextTick=function(t,r,n){var o=this;if(!o._hasDtored){var i=o.__classId?e(o):o._store;return i.register(u,t,r,n,null),o}},n.prototype.oncePriorityNextTick=function(t,r,n,o){var i=this;if(!i._hasDtored){var a=i.__classId?e(i):i._store;return a.register(s,t,n,o,r),i}},n.prototype.single=function(t,r,n){var o=this;if(!o._hasDtored){var a=o.__classId?e(o):o._store;return a.registerSingle(i,t,r,n),o}},n.prototype.singleAsync=function(t,r,n){var o=this;if(!o._hasDtored){var i=o.__classId?e(o):o._store;return i.registerSingle(l,t,r,n),o}},n.prototype.singleNextTick=function(t,r,n){var o=this;if(!o._hasDtored){var i=o.__classId?e(o):o._store;return i.registerSingle(a,t,r,n),o}},n.prototype.un=function(t,r,n){var o=this,a=o.__classId?e(o):o._store;return a.unRegister(i,t,r,n),o},n.prototype.unNextTick=function(t,r,n){var o=this,i=o.__classId?e(o):o._store;return i.unRegister(a,t,r,n),o},n.prototype.unOnce=function(t,r,n){var o=this,i=o.__classId?e(o):o._store;return i.unRegister(s,t,r,n),o},n.prototype.unOnceNextTick=function(t,r,n){var o=this,i=o.__classId?e(o):o._store;return i.unRegister(u,t,r,n),o},n.prototype.unSingle=function(t){var r=this,n=r.__classId?e(r):r._store;return n.unRegisterSingle(i,t),r},n.prototype.unSingleNextTick=function(t){var r=this,n=r.__classId?e(r):r._store;return n.unRegisterSingle(a,t),r},n.prototype.unAll=function(t){for(var r=this,n=arguments.length,o=[i,s],a=r.__classId?e(r):r._store,u=0,l=o.length;l>u;u++){var c=o[u];0==n?a.unRegisterAll(c):a.unRegisterAll(c,t)}return r},n.prototype.unAllNextTick=function(t){for(var r=this,n=[a,u],o=arguments.length,i=r.__classId?e(r):r._store,s=0,l=n.length;l>s;s++){var c=n[s];0==o?i.unRegisterAll(c):i.unRegisterAll(c,t)}return r},n.prototype.unCtx=function(t){var r=this,n=r.__classId?e(r):r._store;n.unCtx(t)},n.prototype._emitByListenerInfoArr=function(t,e,r,n){if(r){var o=this;if(r=r instanceof Array?r:[r],0==r.length)return;var n=o._store.getTempArgs(t,e,n);if(null==n)return;n.push(e),n.push(o);for(var i=0,a=r.length;a>i;i++){var s=r[i];if(s){var u=s.listener;u&&u.apply(s.ctx,n)}}r.length=0,n.length=0}},n.prototype.emit=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o,a,u=this,l=u._store;return u._hasDtored?void 0:(o=l.getSingle(i,t),u._emitByListenerInfoArr(i,t,o,r),a=l.getTempArr(s,t),l.clear(s,t),u._emitByListenerInfoArr(s,t,a,r),a=l.getTempArr(i,t),u._emitByListenerInfoArr(i,t,a,r),l=e(u.__class),o=l.getSingle(i,t),u._emitByListenerInfoArr(i,t,o,r),a=l.getTempArr(s,t),l.clear(s,t),u._emitByListenerInfoArr(s,t,a,r),a=l.getTempArr(i,t),u._emitByListenerInfoArr(i,t,a,r),u)},n.prototype.emitAsync=function(r,n,o){for(var i=[],a=3;a<arguments.length;a++)i[a-3]=arguments[a];var s,u,p=this,f=p._store;if(!p._hasDtored){var _=[];if(s=f.getSingle(l,r),s&&_.push(_),u=f.getTempArr(c,r))for(var h=0,g=u.length;g>h;h++)_.push(u[h]);if(f.clear(c,r),u=f.getTempArr(l,r))for(var h=0,g=u.length;g>h;h++)_.push(u[h]);if(f=e(p.__class),s=f.getSingle(l,r),s&&_.push(_),u=f.getTempArr(c,r))for(var h=0,g=u.length;g>h;h++)_.push(u[h]);if(f.clear(c,r),u=f.getTempArr(l,r))for(var h=0,g=u.length;g>h;h++)_.push(u[h]);var d=[null].concat(i);d.push(r),d.push(p);var y=new t.AsyncPool(_,0,function(t,e,r){d[0]=r,t.listener.apply(t.ctx,d)},n,o);return y.flow(),p}},n.prototype.emitNextTick=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var o=this;return o._hasDtored?void 0:(o._store.setValue(a,t,e),f.indexOf(o)<0&&(f.push(o),r()),o)},n.prototype.emitBoth=function(){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];var r=this;return r._hasDtored?void 0:(r.emit.apply(r,arguments),r.emitNextTick.apply(r,arguments),r)},n.prototype.emitPhase=function(){for(var t=[],e=3;e<arguments.length;e++)t[e-3]=arguments[e];var r=this;return r},n.prototype.emitPhaseNextTick=function(){for(var t=[],e=3;e<arguments.length;e++)t[e-3]=arguments[e];var r=this;return r},n.prototype.onEmitter=function(e,r,n){this._hasDtored||t.onEmitter(e,r,n,this)},n.prototype.unEmitter=function(){t.unEmitter(this)},n.on=function(){return this.prototype.on.apply(this,arguments)},n.onPriority=function(){return this.prototype.onPriority.apply(this,arguments)},n.onAsync=function(){return this.prototype.onAsync.apply(this,arguments)},n.onAsyncPriority=function(){return this.prototype.onAsyncPriority.apply(this,arguments)},n.onNextTick=function(){return this.prototype.onNextTick.apply(this,arguments)},n.onPriorityNextTick=function(){return this.prototype.onPriorityNextTick.apply(this,arguments)},n.once=function(){return this.prototype.once.apply(this,arguments)},n.oncePriority=function(){return this.prototype.oncePriority.apply(this,arguments)},n.onceAsync=function(){return this.prototype.onceAsync.apply(this,arguments)},n.onceAsyncPriority=function(){return this.prototype.onceAsyncPriority.apply(this,arguments)},n.onceNextTick=function(){return this.prototype.onceNextTick.apply(this,arguments)},n.oncePriorityNextTick=function(){return this.prototype.oncePriorityNextTick.apply(this,arguments)},n.single=function(){return this.prototype.single.apply(this,arguments)},n.singleAsync=function(){return this.prototype.singleAsync.apply(this,arguments)},n.singleNextTick=function(){return this.prototype.singleNextTick.apply(this,arguments)},n.un=function(){return this.prototype.un.apply(this,arguments)},n.unNextTick=function(){return this.prototype.unNextTick.apply(this,arguments)},n.unOnce=function(){return this.prototype.unOnce.apply(this,arguments)},n.unOnceNextTick=function(){return this.prototype.unOnceNextTick.apply(this,arguments)},n.unSingle=function(){return this.prototype.unSingle.apply(this,arguments)},n.unSingleNextTick=function(){return this.prototype.unSingleNextTick.apply(this,arguments)},n.unAll=function(){return this.prototype.unAll.apply(this,arguments)},n.unAllNextTick=function(){return this.prototype.unAllNextTick.apply(this,arguments)},n.unCtx=function(){return this.prototype.unCtx.apply(this,arguments)},n.formatBeforeEvent=function(t){return t+".before"},n.formatAfterEvent=function(t){return t+".after"},n.create=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=this,n=new r;return n.init&&n.init.apply(n,arguments),n},n.getInstance=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=this;if(!r._instance){var n=r._instance=r.create.apply(r,arguments);n._isInstance=!0}return r._instance},n.purgeInstance=function(){var t=this,e=t._instance;e&&(e.doDtor&&e.doDtor(),t._instance=null)},n}();p.ON_CLEAR_DATA="ON_CLEAR_DATA",t.Emitter=p,__reflect(p.prototype,"mo.Emitter",["mo.IEmitter"]);var f=[],_=[],h=[],g=[],d=[],y=!1;t._loop4Emitter=r,t.emitter=new p;var v=["on","onPriority","onAsync","onAsyncPriority","onNextTick","onPriorityNextTick","once","oncePriority","onceAsync","onceAsyncPriority","onceNextTick","oncePriorityNextTick","single","singleAsync","singleNextTick","un","unNextTick","unOnce","unOnceNextTick","unSingle","unSingleNextTick","unAll","unAllNextTick","unCtx","_emitByListenerInfoArr","emit","emitAsync","emitNextTick","emitBoth","emitPhase","emitPhaseNextTick"];t.bindEmitterPrototype=n}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e=function(e){function r(){return e.apply(this,arguments)||this}return __extends(r,e),r.prototype._initProp=function(){e.prototype._initProp.call(this);var t=this;t.maxLimit=10,t._curNum=0,t._finishedNum=0},r.prototype._runEnd=function(t){var e=this;if(!e._finished){e._finished=!0;var r=e._endListener,n=e._endCtx,o=e._result;e.listenerInfoList.length=0,delete e._endListener,delete e._endCtx,delete e._result,t?r.call(n,t):r.call(n,t,o)}},r.prototype._runListener=function(t,e,r,n){var o=this;r.call(n,t,e,function(t,r){return t?o._runEnd(t):o._finished?void 0:(o._curNum--,o._finishedNum++,o._result[e]=r,o._finishedNum>=o._totalNum?o._runEnd(null):void o._do())})},r.prototype._do=function(){var t=this;if(!t._finished){var e=t.listenerInfoList,r=Math.min(t.limit||t.maxLimit,t.maxLimit);if(!(t._finished||t._curNum>=r)){var n=Math.min(r-t._curNum,e.length),o=e.splice(0,n);t._curNum+=n;for(var i=0,a=o.length;a>i;i++)t._runListener.apply(t,o[i])}}},r.prototype._register=function(t,e){var r=this;return r.listenerInfoList=t,r._totalNum=t.length,r._curNum=0,r._finished=!1,r._finishedNum=0,r._result=e?{}:[],r},r.prototype.setLimit=function(t){return this.limit=t,this},r.prototype.each=function(e,r,n){var o=this,i=[];return t.each(e,function(t,e){i.push([t,e,r,n])}),o._register(i,!(e instanceof Array)),o},r.prototype.end=function(e,r){var n=this;return n._endListener=e,n._endCtx=r,0==n._totalNum?n._runEnd(null):void(n._isAtOnce?n._do():t.nextTick(function(){n._do()}))},r}(t.Emitter);t.Spawn=e,__reflect(e.prototype,"mo.Spawn")}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e=function(e){function r(){return e.apply(this,arguments)||this}return __extends(r,e),r.prototype._initProp=function(){e.prototype._initProp.call(this);var t=this;t.arr=[]},r.prototype.begin=function(t){var e=this;return e._lastResult=t,e},r.prototype.then=function(t,e){var r=this;return r.arr.push(["then",t,e]),r},r.prototype.repeat=function(t,e,r){for(var n=this,o=0;t>o;++o)n.then(e,r);return n},r.prototype.spawn=function(t,e){var r=this,n=r.arr,o=n[n.length-1];return o&&"spawn"==o[0]||(o=["spawn",[]],n.push(o)),o[1].push([t,e]),r},r.prototype.each=function(t,e){var r=this;return r.arr.push(["each",t,e]),r},r.prototype.limit=function(t,e,r){var n=this;return n.arr.push(["limit",t,e,r]),n},r.prototype._runEnd=function(t,e){var r=this,n=(r.arr,r._endListener),o=r._endCtx;r._finished||(r._finished=!0,delete r._endListener,delete r._endCtx,delete r._lastResult,n.call(o,t,e))},r.prototype._do=function(){var e=this,r=e.arr,n=r.shift(),o=e._lastResult,i=n[0];if(!e._finished)if("then"==i)n[1].call(n[2],o,function(t,n){return delete e._lastResult,t||0==r.length?e._runEnd(t,n):(e._lastResult=n,void e._do())});else if("spawn"==i){for(var a=n[1],s=[],u=0,l=a.length;l>u;u++){var c=a[u];s.push([e._lastResult,u].concat(function(t,e,r){this[0].call(this[1],t,r)}.bind(c)))}(new t.Spawn)._register(s,!1).end(e._doSpawnEnd,e)}else"each"==i?(new t.Spawn).each(e._lastResult||{},n[1],n[2]).end(e._doSpawnEnd,e):"limit"==i&&(new t.Spawn).setLimit(n[1]).each(e._lastResult||{},n[2],n[3]).end(e._doSpawnEnd,e)},r.prototype._doSpawnEnd=function(t,e){var r=this,n=r.arr;delete r._lastResult,!t&&n.length>0?(r._lastResult=e,r._do()):r._runEnd(t,e)},r.prototype.end=function(e,r){var n=this;t.nextTick(function(){var t=n.arr;return n._endListener=e,n._endCtx=r,0==t.length?n._runEnd(null,null):void n._do()})},r}(t.Emitter);t.Chain=e,__reflect(e.prototype,"mo.Chain")}(mo||(mo={})),function(t){var e;!function(e){function r(e){var r=new t.Chain;return r.begin(e),r}function n(e,r){var n=new t.Chain;return n.then(e,r),n}function o(e,r){var n=new t.Chain;return n.spawn(e,r),n}e.begin=r,e.then=n,e.spawn=o}(e=t.CHAIN||(t.CHAIN={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e=function(e){function r(){return e.apply(this,arguments)||this}return __extends(r,e),r.registerClass=function(t){this._classMap=this._classMap||{},t.__n&&(this._classMap[t.__n]=t)},r.getClass=function(t){return this._classMap=this._classMap||{},this._classMap[t]},r.prototype._initProp=function(){e.prototype._initProp.call(this);var t=this;t._map={},t.limit=2,t._batchId=0},r.prototype.onCreate=function(t){this._createFunc=t},r.prototype.onReset=function(t){this._resetFunc=t},r.prototype.onRecycle=function(t){this._saveFunc=t},r.prototype.onRelease=function(t){this._releaseFunc=t},r.prototype.prepare=function(e,r,n){n=n||"$";for(var o=this,i=o._batchId,a=o._map[n]=o._map[n]||[],s=0;r>s;++s){var u=o._createFunc.call(null,e,n);t.setExt(u,"batchId",i),a.push(u)}},r.prototype.getByKey=function(e,r){var n,o=this,i=o._batchId,a=o._map,s=a[e]=a[e]||[];s.length>0&&(n=s.pop()),n||(n=o._createFunc.call(null,r),t.setExt(n,"batchId",i)),n.$$resetOrRecycle&&n.$$resetOrRecycle(),n.$$reset&&n.$$reset(r,e);var u=o._resetFunc;return u&&u.call(null,n,r,e),t.setExt(n,"pool",o),t.setExt(n,"poolKey",e),n},r.prototype.get=function(t){return this.getByKey("$",t)},r.prototype.rm=function(e){var r=this,n=t.getExt(e,"poolKey");if(n&&!e._hasDtored&&!e.released){t.setExt(e,"poolKey",null);var o=t.getExt(e,"pool");if(!o||r!=o)return void(e.doDtor?e.doDtor():e.release&&e.release());t.setExt(e,"pool",null);var i=t.getExt(e,"batchId");if(!e.released){e.$$resetOrRecycle&&e.$$resetOrRecycle(),e.$$recycle&&e.$$recycle();var a=r._saveFunc;a&&a(e)}if(i!=r._batchId||r.closed||r.released){if(e.released)return;return void(r._releaseFunc?r._releaseFunc.call(null,e):e.doDtor?e.doDtor():e.release&&e.release())}var s=r.limit,u=r._map,l=u[n]=u[n]||[];l.length>=s?e.doDtor?e.doDtor():e.release&&e.release():l.push(e)}},r.prototype.dtor=function(){e.prototype.dtor.call(this);var t=this;t.clear(),t._createFunc=null,t._resetFunc=null,t._saveFunc=null,t._releaseFunc=null,t.released=!0},r.prototype.clear=function(){var t=this,e=t._map;t._batchId++;for(var r in e){for(var n=e[r];n.length;){var o=n.pop();o&&o.doDtor&&o.doDtor()}delete e[r]}},r}(t.Emitter);t.Pool=e,__reflect(e.prototype,"mo.Pool")}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},mo;!function(t){var e=function(){function t(t){this.content=[],this.scoreFunction=t}return t.prototype.push=function(t){this.content.push(t),this.sinkDown(this.content.length-1)},t.prototype.pop=function(){var t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.bubbleUp(0)),t},t.prototype.remove=function(t){for(var e=this.content.length,r=0;e>r;r++)if(this.content[r]==t){var n=this.content.pop();return void(r!=e-1&&(this.content[r]=n,this.scoreFunction(n)<this.scoreFunction(t)?this.sinkDown(r):this.bubbleUp(r)))}throw new Error("Node not found.")},t.prototype.size=function(){return this.content.length},t.prototype.rescoreElement=function(t){this.sinkDown(this.content.indexOf(t))},t.prototype.sinkDown=function(t){for(var e=this.content[t];t>0;){var r=Math.floor((t+1)/2)-1,n=this.content[r];if(!(this.scoreFunction(e)<this.scoreFunction(n)))break;this.content[r]=e,this.content[t]=n,t=r}},t.prototype.bubbleUp=function(t){for(var e=this.content.length,r=this.content[t],n=this.scoreFunction(r);;){var o=2*(t+1),i=o-1,a=null,s=0;if(e>i){var u=this.content[i];s=this.scoreFunction(u),n>s&&(a=i)}if(e>o){var l=this.content[o],c=this.scoreFunction(l);(null==a?n:s)>c&&(a=o)}if(null==a)break;this.content[t]=this.content[a],this.content[a]=r,t=a}},t}();t.BinaryHeap=e,__reflect(e.prototype,"mo.BinaryHeap")}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e=0,r=function(r){function n(){return r.apply(this,arguments)||this}return __extends(n,r),Object.defineProperty(n.prototype,"timer",{get:function(){return this._timer},set:function(e){var r=this;e!=r._timer&&(r._timer?r._timer.clearTick(r._onLoop4Timer,r):t.clearTick(r._onTick,r),r._timer=e)},enumerable:!0,configurable:!0}),n.prototype._initProp=function(){r.prototype._initProp.call(this);var t=this;t._loopList=[],t._passTimeInfoList=[],t.status=0,t._lastTime=0},Object.defineProperty(n.prototype,"paused",{get:function(){return this._paused},set:function(t){var e=this;e._paused=t,e._setPaused(t)},enumerable:!0,configurable:!0}),n.prototype._setPaused=function(){},n.prototype.start=function(){var e=this;e.status=1,e._paused=!1,e.timer?e.timer.tick(e._onLoop4Timer,e):t.tick(e._onTick,e)},n.prototype.end=function(){t.warn("%s的【end】接口已经分废弃,请使用【stop】接口代替!",this.__className),this.stop()},n.prototype.stop=function(){var e=this;e.status=0,e._lastTime=0,t.clearTick(e._onTick,e),e.timer&&e.timer.clearTick(e._onLoop4Timer,e)},n.prototype._onTick=function(t){var e=this;if(!e._lastTime)return void(e._lastTime=t);var r=t-e._lastTime;e._lastTime=t,e._paused||e.loop(r)},n.prototype._onLoop4Timer=function(t){var e=this;e._paused||e.loop(t)},n.prototype.setTimeout=function(t,r){var n=this,o=arguments.length>=3?r:null,i=arguments[arguments.length-1];return e++,(!i||1>i)&&(i=1),i?n._passTimeInfoList.push({id:e,cb:t,ctx:o,time:i}):t.call(o),e},n.prototype.setInterval=function(t,r){var n=this,o=arguments.length>=3?r:null,i=arguments[arguments.length-1];if(e++,(!i||1>i)&&(i=1),!i)throw"setInterval不能设置定时为0";return n._passTimeInfoList.push({id:e,cb:t,ctx:o,time:i,isInterval:!0}),e},n.prototype.clearTimeout=function(t){var e=this;if(null!=t)for(var r=e._passTimeInfoList,n=0,o=r.length;o>n;n++){var i=r[n];if(i&&i.id==t){r[n]=null;break}}},n.prototype.clearCtx=function(t){if(t)for(var e=this,r=e._passTimeInfoList,n=0,o=r.length;o>n;n++){var i=r[n];if(i&&i.ctx==t){r[n]=null;break}}},n.prototype.clearAll=function(){for(var t=this,e=t._passTimeInfoList,r=0,n=e.length;n>r;r++){var o=e[r];if(!o)return;e[r]=null}},n.prototype.clearInterval=function(t){this.clearTimeout(t)},n.prototype.loop=function(t){for(var e=this,r=[].concat(e._passTimeInfoList),n=[],o=0,i=r.length;i>o&&!e._paused;o++){var a=r[o];if(a){var s=a.time||0,u=a.pass||0;if(a.pass=u+t,a.isInterval){var l=Math.floor(a.pass/s);a.pass-=s*l;for(var c=0;l>c&&!(r.indexOf(a)<0)&&a.cb;++c){a.cb.call(a.ctx,l);break}}else s<=a.pass&&(r[o]=null,n.push(a.id),a.cb&&a.cb.call(a.ctx,a.pass-s))}}r=e._passTimeInfoList;for(var o=0;o<r.length;){var a=r[o];!a||n.indexOf(a.id)>=0?r.splice(o,1):o++}for(var p=e._loopList,o=0,i=p.length;i>o;o++){var f=p[o];if(f){var _=f[0];_&&_.call(f[1],t)}}for(var o=p.length-1;o>=0;o--){var f=p[o];f||p.splice(o,1)}},n.prototype.tick=function(t,e){for(var r=this._loopList,n=0,o=r.length;o>n;n++){var i=r[n];if(i&&i[0]==t&&i[1]==e)return}r.push([t,e])},n.prototype.clearTick=function(t,e){for(var r=this._loopList,n=0,o=r.length;o>n;n++){var i=r[n];i&&i[0]==t&&i[1]==e&&(r[n]=null)}},n.prototype.clearAllTick=function(){for(var t=this._loopList,e=0,r=t.length;r>e;e++)t[e]=null},n}(t.Emitter);t.CustTimer=r,__reflect(r.prototype,"mo.CustTimer"),t.custTimer=new r,t.custTimer.start()}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e=function(e){function r(){return e.apply(this,arguments)||this}return __extends(r,e),r.prototype._initProp=function(){e.prototype._initProp.call(this);var t=this;t._passed=0,t.stopped=!0},r.prototype.countdown=function(e,r){var n=this;return e?(n._timer&&n._timer.clearTick(n._onTick,n),r=n._timer=r||t.custTimer,n.stopped=!1,r.tick(n._onTick,n),n.endTime=e,void n._invoke()):t.error("必须传入endTime参数!")
},r.prototype._invoke=function(e){var r=this;if(null==e){var n=t.DATE.date(),o=r.endTime;e=o.getTime()-n.getTime()}var i=r.__class.ON_SECOND,a=r.__class.ON_END;if(0>=e)return r.emit(i,0,0,0),r.emit(a,0,0,0),void r.stop();if(!(1e3>e)){var s=t.DATE.toHMS(e);r.emit(i,s[0],s[1],s[2])}},r.prototype._onTick=function(e){var r=this;if(r.endTime){r._passed+=e;var n=Math.floor(r._passed/1e3);r._passed-=1e3*n;var o=t.DATE.date(),i=r.endTime,a=i.getTime()-o.getTime();(0>=a||n)&&r._invoke(a)}},r.prototype.stop=function(){var t=this;t._timer&&t._timer.clearTick(t._onTick,t),t._passed=0,t.endTime=null,t.stopped=!0},r.prototype.clear=function(){var t=this;t.stop(),t.unAll()},r.prototype.onSecond=function(t,e){this.on(this.__class.ON_SECOND,t,e)},r.prototype.unSecond=function(t,e){this.un(this.__class.ON_SECOND,t,e)},r.prototype.onEnd=function(t,e){this.on(this.__class.ON_END,t,e)},r.prototype.unEnd=function(t,e){this.un(this.__class.ON_END,t,e)},r}(t.Emitter);e.ON_SECOND="ON_SECOND",e.ON_END="ON_END",t.CustTrigger=e,__reflect(e.prototype,"mo.CustTrigger")}(mo||(mo={}));var mo;!function(t){var e;!function(t){t.obj=/^([\d\w\-+]+:[\d\w\-+]+)+(,([\d\w\-+]+:[\d\w\-+]+)+)*$/i,t.obj_arr=/^([\d\w\-+]+,[\d\w\-+]+)+(;([\d\w\-+]+,[\d\w\-+]+)+)*$/i}(e=t.REG||(t.REG={}))}(mo||(mo={})),function(t){var e;!function(e){function r(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=t.length;if(1>r)return"";var n=t[0],o=!0;if("object"==typeof n){try{n=JSON.stringify(n)}catch(i){n+=""}o=!1}null==n&&(n="null"),n+="";var a=1;o&&(n=n.replace(/(%d)|(%i)|(%s)|(%f)|(%o)/g,function(e){if(t.length<=a)return e;var r=t[a++];if("%d"==e||"%i"==e)return parseInt(r);if("object"==typeof r)try{return JSON.stringify(r)}catch(n){return r+""}return r}));for(var s=a;r>s;++s){var u=t[s];if("object"==typeof u)try{u=JSON.stringify(u)}catch(i){u+=""}n+="    "+u}return n}function n(r,n){function o(e){var r=e.substring(2,e.length-1),o=r.split(":"),i=o[1],a=n[r];if(null==a)for(var s=r.split("||"),u=!1,l=0,c=s.length;c>l&&!u;l++){var p=s[l],f=p.substring(0,1),_=p.length,h=p.substring(_-1,_);if(f==h&&"`"==f){a=t.STR.parseNumOrStr(p.substring(1,_-1)),u=!0;break}var g=p.split(".");a=n;for(var d=0,y=g.length;y>d;d++){var v=g[d];if(a=a[v],null==a)break}u=null!=a}return null==a?null==i?e:i:"string"==typeof a?a.replace(/\\/g,"\\\\"):a}return t.OBJ.isEmpty(n)?r:r.replace(e.PLACEHOLDER_EXP,o)}function o(t,e,r){void 0===r&&(r=!0),t+="";var n=t.length,o=e.length;return n>=o?t:r?e.substring(0,o-n)+t:t+e.substring(n)}function i(t){for(var e=t.split(""),r=0,n=0;n<e.length;n++){var o=e[n];r+=a(o)?2:1}return r}function a(t){var e=/^[u4E00-u9FA5]+$/;return e.test(t)?!1:!0}function s(e){var r={};if(!e)return r;if(e=(e+"").replace(/，/g,",").replace(/：/g,":").replace(/；/g,":").trim(),t.REG.obj_arr.test(e)){for(var n=e.split(";"),o=0,i=n.length;i>o;o++){var a=n[o].split(",");r[a[0].trim()]=v(a[1].trim())}return r}for(var s=e.split(","),o=0;o<s.length;o++){var u=s[o];if(u){var l=u.split(":");r[l[0].trim()]=v(l[1].trim())}}return r}function u(t,e){if(void 0===e&&(e=","),"number"==typeof t)return[t];var r=[];if(t)for(var n=t.split(e),o=0,i=n.length;i>o;o++)r.push(parseFloat(n[o]));return r}function l(){x.length=0}function c(t){for(var e=0,r=t.length;r>e;e++){var n=t[e];n&&(n=n.trim().toLowerCase(),""!=n&&x.indexOf(n)<0&&x.push(n))}}function p(t){for(var e=t.toLowerCase(),r=0;r<x.length;r++){var n=x[r];if(-1!==e.indexOf(n))return!0}return!1}function f(t){for(var e=0;e<x.length;e++){for(var r=x[e],n=r.length,o="",i=0;n>i;++i)o+="*";var a=S[r];a||(r=r.replace(/\\/gi,"\\\\"),r=r.replace(/\(/gi,"\\("),r=r.replace(/\)/gi,"\\)"),r=r.replace(/\[/gi,"\\["),r=r.replace(/\]/gi,"\\]"),r=r.replace(/\{/gi,"\\{"),r=r.replace(/\}/gi,"\\}"),r=r.replace(/\*/gi,"\\*"),r=r.replace(/\./gi,"\\."),a=S[r]=new RegExp(r,"gi")),t=t.replace(a,o)}return t}function _(){C.length=0}function h(t){for(var e=0,r=t.length;r>e;e++){var n=t[e];n&&(n=n.trim().toLowerCase(),""!=n&&C.indexOf(n)<0&&C.push(n))}}function g(t){for(var e=t.toLowerCase(),r=0;r<C.length;r++){var n=C[r];if(-1!==e.indexOf(n))return!0}return!1}function d(){return C}function y(t){return 0==(t+"").search(e.NUM_EXP)}function v(t,e){if(!t)return t;if(t+="",y(t)){if(t.indexOf(".")>0){if(null!=e){var r=Math.pow(10,e);return Math.round(parseFloat(t)*r)/r}return parseFloat(t)}return parseInt(t)}return t}function m(t,r){return t?t.replace(e.EMOJI_EXP,r||""):t}function E(t){if(!t)return!1;t+="";var e=/^0?1[3|4|5|8][0-9]\d{8}$/;return e.test(t)}function T(t){if(!t)return-1;var e=t.split("."),r=parseInt(e[0]),n=parseInt(e[1]),o=parseInt(e[2]),i=parseInt(e[3]);return 256*r*256*256+256*n*256+256*o+i}function O(t){var e=Math.floor(t/16777216);t-=256*e*256*256;var r=Math.floor(t/65536);t-=256*r*256;var n=Math.floor(t/256),o=t-256*n;return e+"."+r+"."+n+"."+o}e.NUM_EXP=/(^([\-+]?[\d]+)$)|(^([\-+]?[\d]+\.[\d]+)$)/,e.EMOJI_EXP=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,e.PLACEHOLDER_EXP=/\$\{[^\s\{\}]*\}/g;var x=[],S={},C=[];e.format=r,e.placeholder=n,e.fill=o,e.getLength=i,e.hasChinese=a,e.toObj=s,e.toNums=u,e.clearSensitiveInfo=l,e.registerSensitive=c,e.hasSensitive=p,e.replaceSensitive=f,e.clearForbiddenWordsInfo=_,e.registerForbiddenWords=h,e.hasForbiddenWords=g,e.getForbiddenWords=d,e.isNum=y,e.parseNumOrStr=v,e.filterEmoji=m,e.isPhone=E,e.ip2Num=T,e.num2Ip=O}(e=t.STR||(t.STR={}))}(mo||(mo={}));var mo;!function(t){var e;!function(e){function r(t,e){for(var r="",n=0;e>n;++n)r+=t;return r}function n(t,n){e.debug(r(u,c)+t+r(l,c)),n(),e.debug(r(l,c)+t+r(u,c)+"\n")}function o(t,n){e.debug(r(u,c)+t+r(l,c)),n(function(n){if(n)e.error(n);else{var o=Array.prototype.slice.apply(arguments);o.shift();for(var i=0,a=o.length;a>i;i++){var s=o[i];e.log(s)}}e.debug(r(l,c)+t+r(u,c)+"\n")})}function i(t,r){var n="object"==typeof r?JSON.stringify(r):r,o="The result should be 【"+n+"】, ";if("function"==typeof t)t(function(t){var n="object"==typeof t?JSON.stringify(t):t;s(t,r)?e.log(o+"and it is successful!"):e.error(o+"but it is 【"+n+"】!")});else{var i="object"==typeof t?JSON.stringify(t):t;s(t,r)?e.log(o+"and it is successful!"):e.error(o+"but it is 【"+i+"】!")}}function a(t,r){for(var n=!1,o=[],i=0,a=r.length;a>i;i++){var u=r[i];if(!n)if(t==u)n=!0;else if(null!=u){n=!0;for(var l in u)if(!s(u[l],t[l])){n=!1;break}}o.push(JSON.stringify(u))}var c=n?"and it is successful":"but it is failed";e.log("The result should has 【"+o.join("】or【")+"】, "+c+"! The result is 【"+JSON.stringify(t)+"】")}function s(t,e){if(t===e)return!0;if(null==t)return t==e;if(void 0==t)return t==e;if(t instanceof Array){if(!(e instanceof Array)||null==e)return!1;if(t.length!=e.length)return!1;for(var r=0,n=t.length;n>r;r++)if(!s(t[r],e[r]))return!1;return!0}if(t instanceof Date)return e instanceof Date&&null!=e?t.getTime()==e.getTime():!1;if("object"==typeof t){if("object"!=typeof e||null==e)return!1;var o=Object.keys(t),i=Object.keys(e);if(o.length!=i.length)return!1;for(var a in t)if(!s(t[a],e[a]))return!1;return!0}return t===e}t.LOG.initLogger(t.ASSERT,"mo.ASSERT");var u="/",l="\\",c=20;e.desc=n,e.descAsync=o,e.should=i,e.shouldHas=a,e.equals=s}(e=t.ASSERT||(t.ASSERT={}))}(mo||(mo={}));var mo;!function(t){var e;!function(e){function r(){return I}function n(){return M}function o(){return w}function i(){return P}function a(){return A}function s(){return N}function u(t){I&&(I.c_language=t)}function l(t,e){if(I&&-1==N.indexOf(e)){N.push(e);try{if(I.c_language)for(var r in t){var n=t[r];I.c_language[r]||(I.c_language[r]={$$:1,code:r}),I.c_language[r][e]=n}else{I.c_language={};for(var r in t){var n=t[r];I.c_language[r]={$$:1,code:r},I.c_language[r][e]=n}}}catch(o){console.error("Push new lang fail : "+o)}}}function c(e,r){if(arguments.length>1)I[e]=t.OBJ.merge(I[e]||{},r);else if(arguments.length=1)for(var n in e)I[n]=t.OBJ.merge(I[n]||{},e[n])}function p(e){I.c_language||(I.c_language=e);for(var r in e)I.c_language[r]=t.OBJ.merge({},I.c_language[r],e[r])}function f(e,r){if(arguments.length>1){var n=I[e]=I[e]||{},o=r;if(!o)return;for(var i in o){var a=o[i];a&&(n[i]=t.OBJ.merge({$$:1},a))}}else if(arguments.length=1)for(var s in e){var o=e[s];if(o){var n=I[s]=I[s]||{};for(var i in o){var a=o[i];a&&(n[i]=t.OBJ.merge({$$:1},a))}}}}function _(t,e){if(arguments.length>1)M[t]=e;else if(arguments.length=1)for(var r in t)M[r]=t[r]}function h(t,e){if(arguments.length>1)w[t]=e;else if(arguments.length=1)for(var r in t)w[r]=t[r]}function g(t,e){var r=w[t];return r?r[e]:null}function d(t,e){if(arguments.length>1){var r=P[t]=P[t]||[];r.push(e)}else if(arguments.length=1)for(var n in t){var r=P[n]=P[n]||[];r.push(t[n])}}function y(e,r){var n=I[e];if(!n)return null;var o=n[r];if(!o)return null;if("string"==typeof o||"number"==typeof o)return y(e,o);if(o.$$)return o;r=t.STR.parseNumOrStr(r+"");var i=M[e];if(i){var a={$$:1};for(var s in i)if(o[s])a[s]=o[s];else{var u=o[i[s]];u=null==u?g(e,s):u,a[s]=u}o=n[r]=a;var l=g(e,"_id_");l&&(a[l]=r)}var c=P[e];if(!c)return o;for(var p=0,f=c.length;f>p;p++){var _=c[p];_&&(o=_(e,r,o))}return o}function v(e,r,n){var o=I[e];if(o){var i=A[e];i||(i=A[e]=Object.keys(o),i.sort(function(e,r){return t.STR.parseNumOrStr(e)>t.STR.parseNumOrStr(r)?1:-1}));for(var a=0,s=i.length;s>a;a++){var u=t.STR.parseNumOrStr(i[a]);if(-1!=u&&1==r.call(n,y(e,u),u))break}}}function m(t){var e=I[t];return e?Object.keys(e).length:0}function E(t){e.langCodeTranser=t}function T(t){return null==t?null:t.match(e.LANGCODE_EXP)}function O(r){t.PROJ.isDebugShowMsgCode&&0==r.indexOf("[")&&(r=r.slice(r.indexOf("]")+1));var n=""+r,o=e.getLangCode(r);if(o)for(var i=0;i<o.length;i++){var a=o[i];n=n.replace(a,S(a))}return n}function x(t){return"string"==typeof t?0==t.indexOf("${{")&&t.indexOf("}}")==t.length-2:!1}function S(r,n){if(!r)return r;t.PROJ.lang||t.error("未开启国际化！"),x(r)||(r="${{"+r+"}}");var o=r.replace("${{","").replace("}}",""),i="["+o+"]",a=t.PROJ.lang&&e.langCodeTranser?e.langCodeTranser(r):r;if(a.match(e.LANGCODE_EXP)){var s=t.PROJ.lang;t.PROJ.lang="en_us",a=t.PROJ.lang&&e.langCodeTranser?e.langCodeTranser(r):r,t.PROJ.lang=s}return t.PROJ.isDebugShowMsgCode?i+b(a,n):b(a,n)}function C(e){var r=[],n=t.D.get_data(),o=n.c_language;if(o){for(var i in o)if(-1!=i.indexOf(e)){var a=t.D.langCodeToTxt(i);r.push(a)}return r}}function b(e,r){return null==r?e:r instanceof Array?0==r.length?e:t.STR.format.apply(t.STR,[e].concat(r)):"object"==typeof r?t.STR.placeholder(e,r):e}function R(){return t.PROJ.lang.indexOf("zh")<0?",":"，"}var I={},M={},w={},P={},A={},N=[];e.get_data=r,e.get_colInfo=n,e.get_defaultMap=o,e.get_transMap=i,e.get_keysMap=a,e.get_langArr=s,e.setLanguageTable=u,e.addNewLangData=l,e.register=c,e.appendLangData=p,e.registerFinal=f,e.setColInfo=_,e.setDefault=h,e.getDefaultValue=g,e.registerTranser=d,e.get=y,e.each=v,e.length=m,e.registerLangCodeTranser=E,e.LANGCODE_EXP=/\$\{\{[^\s\{\}]*\}\}/g,e.getLangCode=T,e.fillLangCodeStr=O,e.isLangCode=x,e.langCodeToTxt=S,e.getTxtByMatch=C,e.getTextWithArglistOrMap=b,e.getCommaByLangCode=R,t.D.registerLangCodeTranser(function(e){var r=e.replace("${{","").replace("}}","");if(!t.PROJ.lang)return r;var n=t.D.get("c_language",r);return n?n[t.PROJ.lang]||e:r})}(e=t.D||(t.D={}))}(mo||(mo={}));var mo;!function(t){var e;!function(e){function r(t,e){if(t&&t.length>0)for(var r=0;r<t.length;r++)if(!(t[r]instanceof e))return!1;return!0}function n(e,r){if(!e||0==e.length)return!1;for(var n=e.length-1;n>=0;--n)if(t.ASSERT.equals(e[n],r))return!0;return!1}function o(t,e){return t&&0!=t.length?t.indexOf(e)>=0:!1}function i(e,r){if(!e||0==e.length)return!1;if(!r||0==r.length)return!1;for(var n=0,o=r.length;o>n;n++)for(var i=r[n],a=0,s=e.length;s>a;a++)if(t.ASSERT.equals(e[a],i))return!0;return!1}function a(t,e){if(!t||0==t.length)return!1;if(!e||0==e.length)return!1;for(var r=0,n=e.length;n>r;r++){var o=e[r];if(t.indexOf(o)>=0)return!0}return!1}function s(e,r){if(!e||0==e.length)return!1;if(!r||0==r.length)return!1;for(var n=0,o=r.length;o>n;n++){for(var i=r[n],a=!1,s=0,u=e.length;u>s;s++)if(t.ASSERT.equals(e[s],i)){a=!0;break}if(!a)return!1}return!0}function u(t,e){if(!t||0==t.length)return!1;if(!e||0==e.length)return!1;for(var r=0,n=e.length;n>r;r++){var o=e[r];if(t.indexOf(o)<0)return!1}return!0}function l(e,r){for(var n=e.length-1;n>=0;--n)t.ASSERT.equals(e[n],r)&&e.splice(n,1);return e}function c(t,e){for(var r=0,n=e.length;n>r;r++)l(t,e[r]);return t}function p(e){for(var r=e.length-1;r>=0;r--)for(var n=e[r],o=r-1;o>=0;--o)if(t.ASSERT.equals(n,e[o])){e.splice(r,1);break}return e}function f(t,e,r){if(r>=t.length)return t;if(e==r)return t;if(r>=t.length)for(var n=r-t.length;n--+1;)t.push(void 0);return t.splice(r,0,t.splice(e,1)[0]),t}function _(t,e,r){return t[e]=t.splice(r,1,t[e])[0],t}function h(e,r){t.warn("警告：mo.ARR.sortOption方法将被废弃，请改成mo.ARR.sort接口！");for(var n=this.list,o=0,i=n.length;i>o;++o){var a=n[o],s=-1;"object"==typeof a&&(s=a.type,a=a.name);var u=e[a],l=r[a];if("function"==typeof u&&(u=u.call(e)),"function"==typeof l&&(l=l.call(r)),l>u)return 0>=s?1:-1;if(u>l)return 0>=s?-1:1}return 0}function g(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return t.sort(function(t,r){if(null==t)return-1;if(null==r)return 1;for(var n=0,o=e.length;o>n;n++){var i=e[n],a=1;if("object"==typeof i){var s=i.type;"number"==typeof s?a=s:s&&"desc"==s.toLowerCase()&&(a=-1),i=i.name}else{if("function"==typeof i){var u=i(t,r);if(0==u)continue;return u}if("string"==typeof i){var l=i.split(":"),s=l[1];i=l[0],s&&"desc"==s.toLowerCase()&&(a=-1)}}if("object"==typeof t&&"object"==typeof r){for(var c=i.split("."),p=t,f=r,_=0,h=c.length;h>_;_++){var g=c[_];p&&(p=p[g]),f&&(f=f[g])}if(f>p)return 0>=a?1:-1;if(p>f)return 0>=a?-1:1}else{if(r>t)return 0>=a?1:-1;if(t>r)return 0>=a?-1:1}}return 0}),t}function d(e){t.warn("警告：mo.ARR.filterOption方法将被废弃，请改成mo.ARR.filter接口！");var r=this.list;if(!r||0==r.length)return!0;for(var n=0,o=r.length;o>n;n++){var i=r[n];if(0!=i.length){var a=i[0],s=i.slice(1,i.length),u=e[a];if("function"==typeof u&&(u=u.call(e)),s.length>0&&s.indexOf(u)<0)return!1}}return!0}function y(t,e,r,o){var i=t.filter(function(t){var i;return i=o?n(e,null==t?t:t[o]):n(e,t),r?i:!i});return i}function v(t){if(t)for(var e=t.length-1;e>=0;--e)null==t[e]&&t.splice(e,1);return t}function m(e,r){r=null==r?1:r,r=Math.min(e.length,r),T.length=0,O.length=0;for(var n=e.length,o=[],i=0;n>i;++i)T.push(i);for(;O.length<r;){var a=t.NUM.rand(T.length-1);O.push(T[a]),T.splice(a,1)}for(var i=0,s=O.length;s>i;i++){var u=O[i];o.push(e[u])}return o}function E(t){for(var e={},r=0,n=t.length;n>r;r++){var o=t[r];e[o[0]]=o[1]}return e}e.verifyType=r,e.has=n,e.hasStrict=o,e.hasOr=i,e.hasOrStrict=a,e.hasAnd=s,e.hasAndStrict=u,e.rm=l,e.rmInArr=c,e.rmSame=p,e.mvTo=f,e.swap=_,e.sortOption=h,e.sort=g,e.filterOption=d,e.filter=y,e.reset=v;var T=[],O=[];e.rand=m,e.toObj=E}(e=t.ARR||(t.ARR={}))}(mo||(mo={}));var mo;!function(t){var e;!function(e){function r(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(0==t.length)return{};for(var r,n=t.shift(),o=0,i=t.length;i>o;o++){var a=t[o];for(r in a)n[r]=a[r]}return n}function n(t){return t?0==Object.keys(t).length:null==t}function o(t){if(t)if(t instanceof Array)t.length=0;else for(var e in t)delete t[e]}function i(t){if(!t||Array.isArray(t)||"object"!=typeof t)return t;var e=Object.keys(t);e.sort();for(var r=[],n=0;n<e.length;n++){var o=e[n];r.push([o,i(t[o])])}return r}function a(t){if(!t)return null;var e={};if(t instanceof Array){for(var r=0,n=t.length;n>r;r++){var o=t[r];o instanceof Array&&o.length>=2&&"number"==typeof o[1]&&(e[o[0]]=o[1])}return e}if("object"==typeof t){for(var i in t){var a=t[i];"number"==typeof a&&(e[i]=a)}return e}return null}function s(t,e){if(t)if(t instanceof Array)for(var r=0,n=t.length;n>r;r++){var o=t[r];if(o instanceof Array&&o.length>=2&&"number"==typeof o[1]&&1==e(o[0]+"",o[1]))return}else if("object"==typeof t)for(var i in t){var a=t[i];if("number"==typeof a&&1==e(i,a))return}}function u(e,r){if(e==r)return null;if(!e)return r;if(!r)return null;var n={};for(var o in r){var i=r[o];t.ASSERT.equals(i,e[o])||(n[o]=i)}return n}function l(t){return null==t?t:JSON.parse(JSON.stringify(t))}e.merge=r,e.isEmpty=n,e.empty=o,e.sort=i,e.getItems=a,e.eachItems=s,e.has=u,e.clone=l}(e=t.OBJ||(t.OBJ={}))}(mo||(mo={}));var mo;!function(t){var e;!function(t){function e(t,e){var r=Math.random();1==arguments.length&&(e=t,t=0);var n=e-t+1;return t-1+Math.ceil(r*n)}function r(t,e,r){var n=t.toString(16),o=e.toString(16),i=r.toString(16);return parseInt((16>t?"0"+n:n)+(16>e?"0"+o:o)+(16>r?"0"+i:i),16)}function n(t,e,r){var n=t.toString(16),o=e.toString(16),i=r.toString(16);return"#"+(16>t?"0"+n:n)+(16>e?"0"+o:o)+(16>r?"0"+i:i)}function o(t){return t=t.replace(/^#?/,"0x"),parseInt(t)}function i(t){if(!t||0==t.length)return-1;for(var e=0,r=[],n=0,o=t.length;o>n;n++){var i=t[n];0>=i?r.push(-1):(e+=i,r.push(e))}if(!e)return-1;for(var a=Math.random(),n=0,o=r.length;o>n;n++){var s=r[n];if(!(0>=s)&&s/e>=a)return n}return-1}t.rand=e,t.c3b=r,t.c3bStr=n,t.hexToInt=o,t.calWeight=i}(e=t.NUM||(t.NUM={}))}(mo||(mo={}));var mo;!function(t){var e;!function(e){function r(e){if(e&&t.PROJ.needIndependenceLocalDate&&(N||N||(A=new Date(e),N=t.TM.setInterval(function(){A&&A.setSeconds(A.getSeconds()+1)},1e3))),b&&null!=b&&0!=b.getTime()){var r=(new Date).getTime(),n=new Date(b.getTime()+r-R.getTime()),o=e?new Date(e):new Date,i=new Date,a=new Date(o.getTime()+r-i.getTime());a.getTime()>n.getTime()&&(b=e?new Date(e):new Date,R=new Date)}else b=e?new Date(e):new Date,R=new Date}function n(){return A}function o(t){if(t)return"string"==typeof t&&(t.match(/^\d\d\d\d-\d\d-\d\d$/)||t.match(/^\d\d\d\d-\d\d-\d\d /))&&(t=t.replace(/\-/gi,"/")),new Date(t);if(b){var e=(new Date).getTime(),r=b.getTime()+e-R.getTime();return new Date(r)}return new Date}function i(){var t=o();return t.getTime()}function a(t,e){return t.setSeconds(t.getSeconds()+e),t}function s(t,e){return t.setMinutes(t.getMinutes()+e),t}function u(t,e){return t.setHours(t.getHours()+e),t}function l(t,e){return t.setDate(t.getDate()+e),t}function c(t,e){return t.setMonth(t.getMonth()+e),t}function p(t,e){return t.getTime()<e.getTime()}function f(t,e){return t.getTime()>e.getTime()}function _(e,r){r=r||"-";var n="%s"+r+"%s"+r+"%s";return t.STR.format(n,e.getFullYear(),t.STR.fill(e.getMonth()+1,"00"),t.STR.fill(e.getDate(),"00"))}function h(t,e){return _(t)===_(e)}function g(t){return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t}function d(){return g(new Date)}function y(r,n){var o=t.DATE.clear(t.DATE.date(r)),i=n.split(":"),a=i[0]?parseInt(i[0]):0,s=i[1]?parseInt(i[1]):0,u=i[2]?parseInt(i[2]):0;return e.addHours(o,a),e.addMinutes(o,s),e.addSeconds(o,u),o}function v(t,e){return void 0===e&&(e="YYYY/MM/DD HH24:MI:SS"),L(e,m(t))}function m(e){var r=e.getHours()%12?e.getHours()%12:12,n="00";return{YYYY:e.getFullYear(),YY:String(e.getFullYear()).slice(-2),MMMM:M[e.getMonth()],MMM:I[e.getMonth()],MM:t.STR.fill(e.getMonth()+1,n),MI:t.STR.fill(e.getMinutes(),n),M:e.getMonth()+1,DDDD:P[e.getDay()],DDD:w[e.getDay()],DD:t.STR.fill(e.getDate(),n),D:e.getDate(),HH24:t.STR.fill(e.getHours(),n),HH:t.STR.fill(r,n),H:r,SS:t.STR.fill(e.getSeconds(),n),PP:e.getHours()>=12?"PM":"AM",P:e.getHours()>=12?"pm":"am",LL:t.STR.fill(e.getMilliseconds(),"000")}}function E(t){var e=Math.floor(t/36e5);t-=1e3*e*60*60;var r=Math.floor(t/6e4);t-=1e3*r*60;var n=Math.floor(t/1e3);return[e,r,n]}function T(t,e){return(t.getTime()-e.getTime())/864e5|0}function O(t,e){return(t.getTime()-e.getTime())/36e5|0}function x(t,e){return(t.getTime()-e.getTime())/6e4|0}function S(t,e){return(t.getTime()-e.getTime())/1e3|0}function C(t,e){return t.getTime()-e.getTime()|0}var b,R,I=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],M=["January","February","March","April","May","June","July","August","September","October","November","December"],w=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],P=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],A=(M.concat(I),null),N=null;e.setStandard=r,e.getIndependenceLocalDate=n,e.date=o,e.now=i,e.addSeconds=a,e.addMinutes=s,e.addHours=u,e.addDays=l,e.addMonths=c,e.isBefore=p,e.isAfter=f,e.toYMD=_,e.equalsDay=h,e.clear=g,e.today=d,e.getDstTime=y;var L=function(t,e){var r,n,o,i=[t],a=function(t,e){for(var r,n,o,a=0,s=i.length,u=[];s>a;a++)if("string"==typeof i[a]){for(o=i[a].split(t),r=0,n=o.length-1;n>r;r++)u.push(o[r]),u.push([e]);u.push(o[n])}else u.push(i[a]);i=u};for(r in e)a(r,e[r]);for(o="",r=0,n=i.length;n>r;r++)o+="string"==typeof i[r]?i[r]:i[r][0];return i.join("")};e.format=v,e.getReplaceMap=m,e.toHMS=E,e.getDaysBetween=T,e.getHoursBetween=O,e.getMinutesBetween=x,e.getSecondsBetween=S,e.getMillisecondsBetween=C}(e=t.DATE||(t.DATE={}))}(mo||(mo={}));var mo;!function(t){var e;!function(t){function e(t){var e="",r=t.lastIndexOf("://"),n=t.lastIndexOf(":\\");return r>=0?(e=t.substring(0,r+3),t=t.substring(r+3)):n>=0&&(e=t.substring(0,n+2),t=t.substring(n+2)),[e,t]}function r(t){var r=e(t);t=r[1],t=t.replace(/\\\\/g,"/"),t=t.replace(/\\/g,"/"),t=t.replace(/[\/]+/g,"/");for(var n=t.split("../"),o=[],i=0,a=n.length;a>i;i++){var s=n[i];if(s=n[i]=s.replace(/(\.\/)/g,""),0!=i&&(o.length&&".."!=o[o.length-1]?o.pop():o.push("..")),i==a-1)o.push(s);else for(var u=s.split("/"),l=0,c=u.length;c-1>l;l++)o.push(u[l])}return t=o.join("/"),r[0]+t}function n(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var o=t.length,i="",a=0;o>a;a++){var s=t[a];if(s){s=r(s);for(var u=null;0==s.indexOf("../");){u||(u=e(i),i=u[1]);var l=i.lastIndexOf("/");if(0>=l)break;if(l==i.length-1&&(i=i.substring(0,l),l=i.lastIndexOf("/")),0>=l)break;i=i.substring(0,l),s=s.substring(3)}u&&(i=u[0]+i),i=i+(""==i?"":"/"==i[i.length-1]?"":"/")+s}}return i}function o(t){var e=/(\.[^\.\/\?\\]*)(\?.*)?$/.exec(t);return e?e[1]:null}function i(t,e){var n=t.indexOf("?");n>0&&(t=t.substring(0,n)),t=r(t);var o=t.split("/"),i=o[o.length-1];return""==i&&o.length>1&&(i=o[o.length-2]),e&&t.substring(t.length-e.length).toLowerCase()==e.toLowerCase()?i.substring(0,i.length-e.length):i}function a(t){var e=t.indexOf("?");e>=0&&(t=t.substring(0,e)),t=r(t);var n=t.split("/"),o=n[n.length-1];return""==o&&n.pop(),n.pop(),n.join("/")}function s(t,e){return t=t.replace(/\\/g,"/"),t=t.replace(/[\/]+/g,"/"),e=e.replace(/\\/g,"/"),e=e.replace(/[\/]+/g,"/"),t.lastIndexOf("/")!=t.length-1&&(t+="/"),t==e||t.substring(0,t.length-1)==e?"./":0!=e.indexOf(t)?(console.error("路径【%s】无法到【%s】进行相对路径处理，请检查！",e,t),null):e.substring(t.length)}function u(t,e){e=e||"";var r=t.indexOf("?"),n="";return r>0&&(n=t.substring(r),t=t.substring(0,r)),r=t.lastIndexOf("."),0>r?t+e+n:t.substring(0,r)+e+n}function l(t,e,r){if(0==e.indexOf("."))return this.changeExtname(t,e);var n=t.indexOf("?"),o="",i=r?this.extname(t):"";return n>0&&(o=t.substring(n),t=t.substring(0,n)),n=t.lastIndexOf("/"),n=0>=n?0:n+1,t.substring(0,n)+e+i+o}t._formatPathStr=r,t.join=n,t.extname=o,t.basename=i,t.dirname=a,t.relative=s,t.changeExtname=u,t.changeBasename=l}(e=t.PATH||(t.PATH={}))}(mo||(mo={}));var mo;!function(t){var e;!function(e){function r(t){for(var r in t)e._keyMap[r]=t[r]}function n(t){var r=e._finalKeyMap[t];if(r)return r;var o=e._keyMap[t]||{},i=t.lastIndexOf("."),a=i>0?t.substring(0,i):null;r={};for(var u in o){var l=o[u],c=l+"",p=c.split(":"),f=p[0],_=p[1];r[u]={fullDsName:s(_,a),ns:a,srcMiniKey:f,miniKey:f,defKey:_,depth:0}}var h=e._extendsFullNameMap[t],g=e._extendsMap[t];if(!h&&g){for(var d=a;d;){var y=d+"."+g;if(e._keyMap[y]){g=y;break}var v=d.lastIndexOf(".");if(0>v)break;d=d.substring(0,v)}h=e._extendsFullNameMap[t]=g}if(h){var m=n(h);for(var u in m)if(!r[u]){var l=m[u];r[u]={fullDsName:l.fullDsName,ns:l.ns,srcMiniKey:l.srcMiniKey,defKey:l.defKey,depth:l.depth+1,miniKey:l.depth+1+":"+l.srcMiniKey}}}return e._finalKeyMap[t]=r,r}function o(t){var e=n(t);return Object.keys(e)}function i(t){for(var r in e._keyMap)t(r,n(r))}function a(r,n,o){e._keyMap[r]=t.OBJ.merge(e._keyMap[r]||{},n),e._finalKeyMap[r]=null,o&&(e._extendsMap[r]=o)}function s(t,r){if(!t)return t;if(t=t.replace(/\[\]/g,""),p.indexOf(t)>=0)return t;for(;;){var n=r+"."+t;if(e._keyMap[n]){t=n;break}var o=r.lastIndexOf(".");if(0>o)break;r=r.substring(0,o)}return t}function u(r,n){e._ignoreMap[r]=t.OBJ.merge(e._ignoreMap[r]||{},n)}function l(r,o){if(!o)return r;if(!r)return r;if(r instanceof Array){for(var i=[],a=0,s=r.length;s>a;a++)i[a]=l(r[a],o);return i}if("object"==typeof r){if("Date"==o)return t.DATE.date(r).getTime();var u=n(o),c={},p=e._ignoreMap[o];for(var f in u)if(!p||!p[f]){var _=u[f],h=_.miniKey,g=_.fullDsName,d=r[f];void 0!==d&&(c[h]=null==d?d:g?l(d,g):d)}return c}return"Date"==o?t.DATE.date(r).getTime():r}function c(r,o){if(!o)return r;if(!r)return r;if(r instanceof Array){for(var i=[],a=0,s=r.length;s>a;a++)i[a]=c(r[a],o);return i}if("object"==typeof r){var u=n(o),l={},p=e._ignoreMap[o];for(var f in u)if(!p||!p[f]){var _=u[f],h=_.miniKey,g=_.fullDsName,d=r[h];void 0!==d&&(l[f]=null==d?d:g?c(d,g):d)}return l}return"Date"==o?t.DATE.date(r):r}var p=["any","number","boolean","string","Date"];e._keyMap={},e._ignoreMap={},e._extendsMap={},e._extendsFullNameMap={},e._name2FullName={},e._fullKeyMap={},e._finalKeyMap={},e.setKeyMap=r,e.getKeyInfo=n,e.getKeys=o,e.each=i,e.setSingle=a,e.getFullDsName=s,e.setIgnore=u,e.enCode=l,e.deCode=c}(e=t.DS||(t.DS={}))}(mo||(mo={}));var mo;!function(t){var e;!function(t){function e(t,e){e=e||"i";var r="<"+t+"[^>]*>((?:(?!</"+t+">)[\\s\\S])*)</"+t+">";return new RegExp(r,e)}function r(t){return new RegExp("<"+t+"(([\\s]+[^>]*>)|([\\s]*>))","i")}function n(t){return new RegExp("</"+t+">","i")}function o(t){return new RegExp("<"+t+"[^>]*/>","i")}t.attrStr_gi=/[a-zA-Z0-9_:.-]+="[^"]+"/gi,t.tagPre_gi=/<[a-zA-Z0-9_]+[\s]*([a-zA-Z0-9_.]+="[^"]+)*>/gi,t.getTag=e,t.getTagPre=r,t.getTagPost=n,t.getTagClose=o}(e=t.REG||(t.REG={}))}(mo||(mo={}));var mo;!function(t){var e;!function(e){function r(e,r){var n={},o=e.match(t.REG.getTagPre(r));if(!o)return{};for(var i=o[0].match(t.REG.attrStr_gi)||[],a=0,s=i.length;s>a;a++){var u=i[a],l=u.split("="),c=l[0].trim();if(c){var p=t.STR.parseNumOrStr(l[1].replace(/"/gi,"").trim());"string"==typeof p&&("true"==p.toLowerCase()?p=!0:"false"==p.toLowerCase()&&(p=!1)),n[c]=p}}return n}function n(e,r){return e.replace(t.REG.getTagPre(r),"").replace(t.REG.getTagPost(r),"").trim()}function o(e){var n=[];if(!e)return[];if(e=e.replace(/<\?[^>]*\?>/gi,""),""==e.trim())return[];for(;;){var a=/<[a-zA-Z][^>]+[\/]?>/i,s=a.exec(e);if(!s)break;var u=s[0],l=/<[a-zA-Z0-9:_]+/gi,c=l.exec(u);if(!c)break;var p=c[0].substring(1),f=i(e,p,0);if(!f)break;e=e.substring(f.length);var _={};if(_.tagName=p,_.attr=r(f,p),n.push(_),u.indexOf("/>")==u.length-2);else{var h=t.REG.getTagPre(p),g=f.match(h);if(!g)break;var d=f.substring(g[0].length+g.index),y="</"+p+">";d=d.substring(0,d.length-y.length),_.inner=d,_.children=o(d)}}return n}function i(e,r,n){if(!e||""==e.trim())return null;var o=t.REG.getTagPre(r),a=t.REG.getTagPost(r),s=t.REG.getTagClose(r),u=e.match(o),l=e.match(a),c=e.match(s),p=u?u.index:-1,f=l?l.index:-1,_=c?c.index:-1,h=[];p>=0&&h.push(p),f>=0&&h.push(f),_>=0&&h.push(_);var g=Math.min.apply(Math,h);if(g==_){var d=c[0],y=_+d.length,v=e.substring(0,y);if(0==n)return v;var m=i(e.substring(y),r,n);return m?v+m:null}if(g==f){var E=l[0],T=f+E.length,v=e.substring(0,T);if(n-1==0)return v;var m=i(e.substring(T),r,n-1);return m?v+m:null}if(g==p){var O=u[0],x=p+O.length,v=e.substring(0,x),m=i(e.substring(x),r,n+1);return m?v+m:null}return null}function a(e,r,n){if(!e)return null;r=r||"",n=n||0;var o="${blank1}<${tagName}${attr}>${inner}${blank2}</${tagName}>",i=[],s=[],u=e.attr,l=e.children;if(u)for(var c in u)i.push(t.STR.format(' %s="%s"',c,u[c]));if(l)for(var p=0,f=l.length;f>p;p++){var _=n+1,h=a(l[p],r,_);if(h)if(""!=r){for(var g="",d=0;_>d;++d)g+=r;s.push(h+"\n")}else s.push(h)}var y=s.join("");""!=y&&""!=r&&(y="\n"+y);var v="",m="";if(""!=r&&n)for(var p=0;n>p;++p)v+=r,m+=r;return 0==s.length&&(m=""),t.STR.placeholder(o,{tagName:e.tagName,attr:i.join(""),inner:y,blank1:v,blank2:m})}e.getAttr=r,e.getInnerTxt=n,e.parse=o,e.toStr=a}(e=t.TAG||(t.TAG={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e;!function(e){t.LOG.initLogger(t.UNIT,"mo.UNIT");var r=function(r){function n(){return r.apply(this,arguments)||this}return __extends(n,r),n.prototype.getDesc=function(){return null},n.prototype.prepare=function(t){t()},n.prototype.handle=function(t){t()},n.prototype.getJudgeOpt=function(){return null},n.prototype.onJudgeResult=function(t){this._onJudgeResult=t},n.prototype.handleResult=function(e,r,n){var o=this,i={};i.should=n;var a=n.result;return n.shouldBeErr?e&&(a?t.ASSERT.equals(e,a)?(i.then=e,i.isPassed=!0):(i.but=e,i.isPassed=!1):(i.then=e,i.isPassed=!0)):o._onJudgeResult?o._onJudgeResult(i):1==n.compareType?t.OBJ.has(r,a)?(i.isPassed=!0,i.then=r):(i.isPassed=!1,i.but=r):t.ASSERT.equals(a,r)?(i.isPassed=!0,i.then=r):(i.isPassed=!1,i.but=r),i},n.prototype.handleUnitResult=function(t){var r=t.should,n=this.__className,o=1==r.compareType?"包含":"为";t.isPassed?(e.log("Unit【%s】测试通过!",n),r.shouldBeErr&&e.error("本单元测试为错误校验测试"),r.result&&e.log("    测试结果应该%s:",o,r.result),e.log("    最终测试结果为:",t.then),1==r.compareType&&e.log("    比较类型为:has")):(e.error("Unit【%s】测试不通过!",n),r.shouldBeErr&&e.error("本单元测试为错误校验测试"),e.error("    测试结果应该%s:",o,r.result),e.error("    但却为:",t.but),1==r.compareType&&e.error("    比较类型为:has")),e.log("")},n.prototype.exec=function(t){var r=this;e.log("-----test【%s】-----",r.__className);var n=r.getDesc();n&&""!=n.trim()&&e.log(n),r.prepare(function(n){return n?e.error("数据准备失败!"):void r.handle(function(e,n){var o=r.getJudgeOpt(),i=r.handleResult(e,n,o);r.handleUnitResult(i),t()})})},n}(t.Emitter);e.Unit=r,__reflect(r.prototype,"mo.UNIT.Unit");var n=function(r){function n(){var t=r.apply(this,arguments)||this;return t._map={},t}return __extends(n,r),n.prototype._initProp=function(){r.prototype._initProp.call(this);var t=this;t._map={}},n.prototype.register=function(t){this._map[t.__className]=t},n.prototype.prepare=function(t){t()},n.prototype.testAll=function(r){var n=this;n.logFileEnabled=!0,n.prepare(function(o){return o?(e.error("【%s】准备出错!",n.__className),r()):void t.CHAIN.begin(n._map).limit(1,function(t,r,o){if(!t)return e.error("请先注册单元测试【%s】",r),o();var i=new t;i.mgr=n,i.exec(o)}).end(r)})},n.prototype.testSingle=function(t,r){var n=this;n.prepare(function(o){if(o)return e.error("【%s】准备出错!",n.__className),r();var i=n._map[t];if(!i)return e.error("请先注册单元测试【%s】",t),r();var a=new i;a.mgr=n,a.exec(r)})},n}(t.Emitter);e.UnitMgr=n,__reflect(n.prototype,"mo.UNIT.UnitMgr")}(e=t.UNIT||(t.UNIT={}))}(mo||(mo={}));var mo;!function(t){var e;!function(t){function e(t,e){var r=(65535&t)+(65535&e),n=(t>>16)+(e>>16)+(r>>16);return n<<16|65535&r}function r(t,e){return t<<e|t>>>32-e}function n(t,n,o,i,a,s){return e(r(e(e(n,t),e(i,s)),a),o)}function o(t,e,r,o,i,a,s){return n(e&r|~e&o,t,e,i,a,s)}function i(t,e,r,o,i,a,s){return n(e&o|r&~o,t,e,i,a,s)}function a(t,e,r,o,i,a,s){return n(e^r^o,t,e,i,a,s)}function s(t,e,r,o,i,a,s){return n(r^(e|~o),t,e,i,a,s)}function u(t,r){t[r>>5]|=128<<r%32,t[(r+64>>>9<<4)+14]=r;var n,u,l,c,p,f=1732584193,_=-271733879,h=-1732584194,g=271733878;for(n=0;n<t.length;n+=16)u=f,l=_,c=h,p=g,f=o(f,_,h,g,t[n],7,-680876936),g=o(g,f,_,h,t[n+1],12,-389564586),h=o(h,g,f,_,t[n+2],17,606105819),_=o(_,h,g,f,t[n+3],22,-1044525330),f=o(f,_,h,g,t[n+4],7,-176418897),g=o(g,f,_,h,t[n+5],12,1200080426),h=o(h,g,f,_,t[n+6],17,-1473231341),_=o(_,h,g,f,t[n+7],22,-45705983),f=o(f,_,h,g,t[n+8],7,1770035416),g=o(g,f,_,h,t[n+9],12,-1958414417),h=o(h,g,f,_,t[n+10],17,-42063),_=o(_,h,g,f,t[n+11],22,-1990404162),f=o(f,_,h,g,t[n+12],7,1804603682),g=o(g,f,_,h,t[n+13],12,-40341101),h=o(h,g,f,_,t[n+14],17,-1502002290),_=o(_,h,g,f,t[n+15],22,1236535329),f=i(f,_,h,g,t[n+1],5,-165796510),g=i(g,f,_,h,t[n+6],9,-1069501632),h=i(h,g,f,_,t[n+11],14,643717713),_=i(_,h,g,f,t[n],20,-373897302),f=i(f,_,h,g,t[n+5],5,-701558691),g=i(g,f,_,h,t[n+10],9,38016083),h=i(h,g,f,_,t[n+15],14,-660478335),_=i(_,h,g,f,t[n+4],20,-405537848),f=i(f,_,h,g,t[n+9],5,568446438),g=i(g,f,_,h,t[n+14],9,-1019803690),h=i(h,g,f,_,t[n+3],14,-187363961),_=i(_,h,g,f,t[n+8],20,1163531501),f=i(f,_,h,g,t[n+13],5,-1444681467),g=i(g,f,_,h,t[n+2],9,-51403784),h=i(h,g,f,_,t[n+7],14,1735328473),_=i(_,h,g,f,t[n+12],20,-1926607734),f=a(f,_,h,g,t[n+5],4,-378558),g=a(g,f,_,h,t[n+8],11,-2022574463),h=a(h,g,f,_,t[n+11],16,1839030562),_=a(_,h,g,f,t[n+14],23,-35309556),f=a(f,_,h,g,t[n+1],4,-1530992060),g=a(g,f,_,h,t[n+4],11,1272893353),h=a(h,g,f,_,t[n+7],16,-155497632),_=a(_,h,g,f,t[n+10],23,-1094730640),f=a(f,_,h,g,t[n+13],4,681279174),g=a(g,f,_,h,t[n],11,-358537222),h=a(h,g,f,_,t[n+3],16,-722521979),_=a(_,h,g,f,t[n+6],23,76029189),f=a(f,_,h,g,t[n+9],4,-640364487),g=a(g,f,_,h,t[n+12],11,-421815835),h=a(h,g,f,_,t[n+15],16,530742520),_=a(_,h,g,f,t[n+2],23,-995338651),f=s(f,_,h,g,t[n],6,-198630844),g=s(g,f,_,h,t[n+7],10,1126891415),h=s(h,g,f,_,t[n+14],15,-1416354905),_=s(_,h,g,f,t[n+5],21,-57434055),f=s(f,_,h,g,t[n+12],6,1700485571),g=s(g,f,_,h,t[n+3],10,-1894986606),h=s(h,g,f,_,t[n+10],15,-1051523),_=s(_,h,g,f,t[n+1],21,-2054922799),f=s(f,_,h,g,t[n+8],6,1873313359),g=s(g,f,_,h,t[n+15],10,-30611744),h=s(h,g,f,_,t[n+6],15,-1560198380),_=s(_,h,g,f,t[n+13],21,1309151649),f=s(f,_,h,g,t[n+4],6,-145523070),g=s(g,f,_,h,t[n+11],10,-1120210379),h=s(h,g,f,_,t[n+2],15,718787259),_=s(_,h,g,f,t[n+9],21,-343485551),f=e(f,u),_=e(_,l),h=e(h,c),g=e(g,p);
return[f,_,h,g]}function l(t){var e,r="",n=32*t.length;for(e=0;n>e;e+=8)r+=String.fromCharCode(t[e>>5]>>>e%32&255);return r}function c(t){var e,r=[];for(r[(t.length>>2)-1]=void 0,e=0;e<r.length;e+=1)r[e]=0;var n=8*t.length;for(e=0;n>e;e+=8)r[e>>5]|=(255&t.charCodeAt(e/8))<<e%32;return r}function p(t){return l(u(c(t),8*t.length))}function f(t,e){var r,n,o=c(t),i=[],a=[];for(i[15]=a[15]=void 0,o.length>16&&(o=u(o,8*t.length)),r=0;16>r;r+=1)i[r]=909522486^o[r],a[r]=1549556828^o[r];return n=u(i.concat(c(e)),512+8*e.length),l(u(a.concat(n),640))}function _(t){var e,r,n="0123456789abcdef",o="";for(r=0;r<t.length;r+=1)e=t.charCodeAt(r),o+=n.charAt(e>>>4&15)+n.charAt(15&e);return o}function h(t){return unescape(encodeURIComponent(t))}function g(t){return p(h(t))}function d(t){return _(g(t))}function y(t,e){return f(h(t),h(e))}function v(t,e){return _(y(t,e))}function m(t,e,r){return e?r?y(e,t):v(e,t):r?g(t):d(t)}function E(t,e){if(e=e||"abc","string"==typeof t)return m(t+e);var r=Object.keys(t);r.sort();for(var n=[],o=0,i=r.length;i>o;o++){var a=r[o];n.push(a+"="+t[a])}return m(n.join("&")+e)}t.encode=m,t.sign=E}(e=t.MD5||(t.MD5={}))}(mo||(mo={}));var mo;!function(t){var e;!function(e){function r(t,e){e=s(e||"abc");for(var r="",n=0;n<t.length;n++){var o=t.charCodeAt(n),i=String.fromCharCode(u(o,e));r+=i}return c(r)}function n(t,e){e=s(e||"abc");var r="";t=p(t);for(var n=0;n<t.length;n++){var o=t.charCodeAt(n),i=String.fromCharCode(l(o,e));r+=i}return r}function o(e,r,n){t.CRYPTO._clientKey=i(e,r,n),t.CRYPTO._clientKey||console.log("createClientKey fail")}function i(t,e,r){for(var n=[],o=0;o<e.length;++o)n.push(e.charCodeAt(o)^o);var i=n.toString(),a=CryptoJS.MD5(t),s=CryptoJS.enc.Hex.stringify(a),u=CryptoJS.AES.decrypt(r,s,{mode:CryptoJS.mode.CBC,iv:i}),l=CryptoJS.enc.Utf8.stringify(u);return l}function a(e,r){if(!t.CRYPTO._clientKey)return void console.log("decryptoDataFromClientKey no clientKey");var n=i(t.CRYPTO._clientKey,e,r);return JSON.parse(n)}function s(t){for(var e=[],r="",n=0;n<t.length;++n)e.push(t.charCodeAt(n));e.sort();for(var n=0;n<e.length;++n)r+=String.fromCharCode(e[n]%127);return r}function u(t,e){for(var r=0;r<e.length;r++){var n=e.charCodeAt(r);t^=n}return t}function l(t,e){for(var r=e.length-1;r>=0;r--){var n=e.charCodeAt(r);t^=n}return t}function c(t){for(var e=[],r=0;r<t.length;r++){var n=t.charCodeAt(r);e.push(n)}return JSON.stringify(e)}function p(t){for(var e="",r=JSON.parse(t),n=0;n<r.length;n++){var o=String.fromCharCode(r[n]);e+=o}return e}e.enCharCode=r,e.deCharCode=n,e.createClientKey=o,e.decipherGTS=i,e.decryptoDataFromClientKey=a}(e=t.CRYPTO||(t.CRYPTO={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e=function(e){function r(){return e.apply(this,arguments)||this}return __extends(r,e),r._gs=function(e,r){var n=e.prototype;t.__define(n,r,function(){return this.$$data[r]},function(e){var n=this,o=n.$$data[r];n.$$data[r]=e,t.ASSERT.equals(o,e)||n.emit(r,e,o)})},r._initCtrl=function(t){var e=t.KEY||{};for(var r in e)this._gs(t,r)},r.prototype._initProp=function(){e.prototype._initProp.call(this);var t=this;t.$$data={},t.__class._initCtrl(t.__class)},r.prototype.onEmitter=function(e,r,n){t.onEmitter(e,r,n,this)},r.prototype.dtor=function(){var e=this;t.unEmitter(e)},r.prototype.setData=function(e){var r=this;if(e){var n=r.$$data,o={};for(var i in e){var a=n[i],s=e[i];n[i]=s,t.ASSERT.equals(a,s)||(o[i]=[s,a])}for(var i in o)r.emit(i,o[i][0],o[i][1])}},r.prototype.clearData=function(){t.OBJ.empty(this.$$data)},r.prototype._onLogout=function(){var t=this;t.clearData()},r}(t.Emitter);e.ON_RESET="onReset",e.KEY={},t.DataCtrl=e,__reflect(e.prototype,"mo.DataCtrl")}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e;!function(e){var r=function(e){function r(){return e.apply(this,arguments)||this}return __extends(r,e),r.prototype._initProp=function(){e.prototype._initProp.call(this);var t=this;t._tile={},t._limitX=0,t._limitY=0,t.defaultWayList=[0,2]},r.prototype.initTile=function(e,r,n){var o=this;o._originTileCfg=e,o._cellWidth=r,o._cellHeight=n,o._limitX=e.limitX||0,o._limitY=e.limitY||0;var i=e.tile||{},a=o._tile;t.OBJ.empty(a);for(var s in i)for(var u=i[s]||0,l=s.split(","),c=l[0].split("-"),p=l[1].split("-"),f=parseInt(c[0]),_=parseInt(c[1]||c[0]),h=parseInt(p[0]),g=parseInt(p[1]||p[0]),d=f;_>=d;++d)for(var y=h;g>=y;++y)a[d+","+y]=u},r.prototype.genNode=function(t,e,r){var n=this;if(e>=0&&e<=n._limitX&&r>=0&&r<=n._limitY){var o=e+","+r;if(t[o])return t[o];var i=n._tile[e+","+r]||0,a={};return a.f=0,a.g=0,a.h=0,a.type=i,a.x=e,a.y=r,t[o]=a,a}return null},r.prototype._estimate=function(t,e,r,n,o,i){var a=this,s=a._tile,u=[],l=n-e,c=o-r,p=Math.min(Math.abs(l),Math.abs(c)),f=0,_=0;l>0?f=1:0>l&&(f=-1),c>0?_=1:0>c&&(_=-1);for(var h=p*f,g=p*_,d=a._limitX,y=a._limitY,v=!0,m=1;p>=m;++m){var E=m*f+e,T=m*_+r;if(0>E||E>d||0>T||T>y){v=!1;break}var O=s[E+","+T]||0;if(i.indexOf(O)<0){v=!1;break}u.push(a.genNode(t,E,T))}if(v){for(var x=Math.abs(l-h),S=l>h?1:-1,m=1;x>=m;++m){var E=h+e+m*S,T=g+r;if(0>E||E>d||0>T||T>y){v=!1;break}var O=s[E+","+T]||0;if(i.indexOf(O)<0){v=!1;break}u.push(a.genNode(t,E,T))}if(v){for(var C=Math.abs(c-g),b=c>g?1:-1,m=1;C>=m;++m){var E=h+e,T=g+r+m*b;if(0>E||E>d||0>T||T>y){v=!1;break}var O=s[E+","+T]||0;if(i.indexOf(O)<0){v=!1;break}u.push(a.genNode(t,E,T))}v||(u.length=0)}else u.length=0}else u.length=0;return u},r.prototype.search=function(e,r,n,o,i){var a=this,s=a._tile;if(1==s[n+","+o])return[];i=i||a.defaultWayList;var u={},l=a._estimate(u,e,r,n,o,i);if(l&&l.length>0)return l;if(l=a._estimate(u,n,o,e,r,i),l&&l.length>0)return l.pop(),l.reverse(),l.push(a.genNode(u,n,o)),l;var c={},p={},f=[],_=a.genNode(u,e,r);f.push(_);var h=new t.BinaryHeap(function(t){return t.f});for(h.push(_);h.size()>0;){var g=h.pop();if(g.x==n&&g.y==o){for(var d=g,y=[];d.parent;)y.push(d),d=d.parent;return y.reverse()}c[g.x+","+g.y]=!0;for(var v=0;2>v;++v)for(var m=a.neighbors(u,g,i,v),E=0;E<m.length;E++){var T=m[E],O=T.x+","+T.y;if(!(c[O]||i.indexOf(T.type)<0)){var x=g.g+(0==v?10:14),S=p[O];(!S||x<T.g)&&(p[O]=!0,T.parent=g,T.h=T.h||a.manhattan(T.x,T.y,n,o),T.g=x,T.f=T.g+T.h,S?h.rescoreElement(T):h.push(T))}}}return[]},r.prototype.manhattan=function(t,e,r,n){var o=Math.abs(r-t),i=Math.abs(n-e);return o+i},r.prototype.neighbors=function(t,e,r,n){var o=this,i=[],a=e.x,s=e.y,u=o._tile;if(0==n)for(var l=[[a-1,s],[a+1,s],[a,s-1],[a,s+1]],c=0,p=l.length;p>c;c++){var f=l[c],_=f[0],h=f[1],g=u[_+","+h]||0;if(!(r.indexOf(g)<0)){var d=o.genNode(t,_,h);d&&i.push(d)}}else if(1==n)for(var l=[[a-1,s-1],[a-1,s+1],[a+1,s-1],[a+1,s+1]],y=[[[a-1,s],[a,s-1]],[[a-1,s],[a,s+1]],[[a+1,s],[a,s-1]],[[a+1,s],[a,s+1]]],c=0,p=l.length;p>c;c++){var f=l[c],_=f[0],h=f[1],g=u[_+","+h]||0;if(!(r.indexOf(g)<0)){var v=y[c],m=v[0],E=v[1],T=u[m[0]+","+m[1]]||0,O=u[E[0]+","+E[1]]||0;if(!(r.indexOf(T)<0||r.indexOf(O)<0)){var x=o.genNode(t,_,h);x&&i.push(x)}}}return i},r.prototype.toRealPos=function(t,e){var r=this,n=[];return t=Math.max(Math.min(r._limitX,t),0),e=Math.max(Math.min(r._limitY,e),0),n[0]=t*r._cellWidth+Math.round(r._cellWidth/2),n[1]=e*r._cellHeight+Math.round(r._cellHeight/2),n},r.prototype.toCellPos=function(t,e){var r=this,n=Math.min(Math.max(Math.ceil(t/r._cellWidth)-1,0),r._limitX),o=Math.min(Math.max(Math.ceil(e/r._cellHeight)-1,0),r._limitY);return[n,o]},r}(t.Emitter);e.AStar=r,__reflect(r.prototype,"mo.FT.AStar")}(e=t.FT||(t.FT={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e;!function(e){function r(t,e,r){var n=c.get({});n.send(t,e,function(){c.rm(n),r.apply(null,arguments)})}function n(t,n,o,i){o=o||{},t=t.trim();var a=t.indexOf("http://"),s=t.indexOf("https://"),u=null;0==a?u="http://":0==s&&(u="https://"),t=u?t.substring(u.length):t;var l=t.indexOf("?"),c=l>0?t.substring(0,l):t,p=l>0?t.substring(l)+"&":"?",f=c.indexOf("/"),_=c,h="";f>0&&(_=c.substring(0,f),h=c.substring(f));var g=_.split(":"),d="";n=n||"GET";var y=[];for(var v in o){var m=o[v];"object"==typeof m&&(m=JSON.stringify(m)),y.push(v+"="+m)}"POST"==n.toUpperCase()?d+=y.join("&"):p+=y.join("&"),g[0]=(u||"http://")+g[0],e.debug(g[0]+(g[1]?":"+g[1]:"")+h+p);var E={host:g[0],port:g[1],path:h+p,method:n};"POST"==n.toUpperCase()&&(E.headers={"Content-Type":"application/x-www-form-urlencoded"}),r(E,d,i)}function o(t,e,r){n(t,"GET",e,r)}function i(t,e,r){n(t,"POST",e,r)}function a(t,r,n){if(r)return t(r);var o;try{n&&""!=n.trim()&&(o=JSON.parse(n))}catch(i){return e.error("mo.NET.getJson error:"),e.error("responseStr-->",n),e.error(i),t(i)}t(null,o)}function s(t,e,r){o(t,e,function(t,e){a(r,t,e)})}function u(t,e,r){i(t,e,function(t,e){a(r,t,e)})}var l=(egret.HttpRequest,function(e){function r(){return e.apply(this,arguments)||this}return __extends(r,e),r.prototype._initProp=function(){e.prototype._initProp.call(this);var t=this,r=t._egretRequest=new egret.HttpRequest;r.responseType=egret.HttpResponseType.TEXT,r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.addEventListener(egret.Event.COMPLETE,t._onComplete,t),r.addEventListener(egret.IOErrorEvent.IO_ERROR,t._onIOError,t)},r.prototype._onComplete=function(){var t=this,e=t._egretRequest;t.onEnd&&t.onEnd.call(t.ctx,null,e.response)},r.prototype._onIOError=function(t){var e=this;e.onEnd&&e.onEnd.call(e.ctx,t.type)},r.prototype.send=function(e,r,n,o){var i=this,a=t.STR.format("%s:%s%s",e.host,e.port||80,e.path),s=i._egretRequest,u=e.method||"GET";i.onEnd=n,i.ctx=o,s.open(a,e.method),s.send("POST"==u.toUpperCase()?r:null)},r.prototype.$$reset=function(t){var e=this;e.onEnd=t.onEnd,e.ctx=t.ctx},r.prototype.$$recycle=function(){var t=this;t.onEnd=t.ctx=null},r}(t.Emitter));e.HttpRequest=l,__reflect(l.prototype,"mo.NET.HttpRequest");var c=new t.Pool;c.onCreate(function(){return new l}),e.requestHttp=r,e.request=n,e.get=o,e.post=i,e.getJson=s,e.postJson=u}(e=t.NET||(t.NET={}))}(mo||(mo={}));var mo;!function(t){function e(e,r){if(r){var n=t._dc[e]=t._dc[e]||{};for(var o in r){var i=r[o];i&&(n[o]=i)}}}function r(e,r){var n=t._dc[e]||{},o=n[r];if(!o)return o;var i;if(o instanceof Array)i=o[0];else{if("object"!=typeof o)return o;i=o["@parseType"]}if("string"==typeof i&&0==i.indexOf("@")){var a=_[i];return a?(n[r]=a[0].call(a[1],o,r),n[r]):(t.error("未注册类型为【】的dcParser，请检查！",i),o)}return o}function n(e,n,o){for(var i=t._dc[e]||{},a=Object.keys(i),s=0,u=a.length;u>s;s++){var l=a[s];n.call(o,r(e,l),l)}}function o(t,e,r){_[t]=[e,r]}function i(){var e=t.PROJ.appInfo.deviceId;if(e)return e;var r=t.mainStorage.get("deviceId");return r||(r="device"+(new Date).getTime(),t.mainStorage.set("deviceId",r)),r}function a(t){h=t||h}function s(t){return t?h.show(t):h.show(),h}function u(){h.close()}function l(){h.forceClose()}function c(t){for(var e in t)g[e]=t[e]}function p(t){return g[t]}function f(){if(!location)return!1;var t=location.protocol;return t&&t.indexOf("https")>-1}t._dc={};var _={};t.addDc=e,t.getData=r,t.eachData=n,t.registerDcParser=o,t.getDeviceId=i;var h={show:function(){},close:function(){},forceClose:function(){}};t.setWaitingView=a,t.playWaiting=s,t.stopWaiting=u,t.stopWaitingForce=l;var g={};t.registerFontStyle=c,t.getFontStyleOpt=p,t.isHttps=f,t.manifest={}}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e=function(e){function r(){return e.apply(this,arguments)||this}return __extends(r,e),r.prototype.set=function(e,r){var n=this.pre?this.pre+"_"+e:e;n=t.MD5.encode(n),null!=r&&"object"==typeof r&&(r=JSON.stringify(r)),null!=r&&(r=t.CRYPTO.enCharCode(r+"")),egret.localStorage.setItem(n,r)},r.prototype.get=function(e){var r=this.pre?this.pre+"_"+e:e;r=t.MD5.encode(r);var n=egret.localStorage.getItem(r);if(null==n||"null"==n)return null;try{null!=n&&(n=t.CRYPTO.deCharCode(n+""))}catch(o){}try{return JSON.parse(n)}catch(o){return n}},r.prototype.rm=function(e){var r=this.pre?this.pre+"_"+e:e;r=t.MD5.encode(r),egret.localStorage.removeItem(r)},r}(t.Emitter);t.Storage=e,__reflect(e.prototype,"mo.Storage"),t.gwStorage=new e,t.gsStorage=new e,t.mainStorage=t.gwStorage,t.serverStorage=t.gsStorage}(mo||(mo={}));var mo;!function(t){var e;!function(e){function r(t){f.push(t)}function n(t,r,n){var o=e[r],i=t[r];null==i?e[r]=o:(i=n?!!i:i,e[r]=i)}function o(t){for(var e=0,r=f.length;r>e;e++){var n=f[e];n(t)}}function i(t,e){_[t]=e;var r=new egret.URLLoader;r.addEventListener(egret.Event.COMPLETE,h,r),r.addEventListener(egret.IOErrorEvent.IO_ERROR,h,r),r.dataFormat=egret.URLLoaderDataFormat.TEXT,r.load(new egret.URLRequest(t))}function a(){var r=e.channelId,n=e.appInfo.packageName||"",o=e.appInfo.versionName,i=e.channelCfg,a=e["package"]+"."+e.projName;if(n){t.LOG.debug("packageName--->",n);var s=n;0==n.indexOf(a+".")&&(s=n.substring(a.length+1));for(var u in i){var l=i[u].channels||[];if(i[u].channelName==s){e.channelId=r=parseInt(u);break}if(l.indexOf(s)>=0){e.channelId=r=parseInt(u);break}}}var c=i[r]||{},p=(c.versionJumper||{})[o];if(p){var f=(e.refCfg||{})[p]||{};for(var _ in f)e[_]=f[_]}else if(c.refCfg){var h=(e.refCfg||{})[c.refCfg]||{};for(var _ in h)e[_]=h[_]}for(var g in c)e[g]=c[g]}function s(r){var n=egret.getOption("appInfoRequired");if(n=n&&"0"!=n,egret.isNative){var o=egret.Capabilities.os.toLowerCase();n&&"android"==o?t.RT.call("getAppInfo",{},function(t,n){for(var o in n)e.appInfo[o]=n[o];r()}):"ios"==o?(egret.ExternalInterface.call("getCfgUrl",""),egret.ExternalInterface.addCallback("getCfgUrlBack",function(t){e.cfgUrl=t,egret.ExternalInterface.call("getAppInfo","")}),egret.ExternalInterface.addCallback("getAppInfoBack",function(t){var n=JSON.parse(t);console.log("getAppInfoBack appInfoObj = "+t);for(var o in n)e.appInfo[o]=n[o];r()})):r()}else r()}function u(r,n){s(function(){e.emitter.emit(e.HANDLE_APP_INFO,e.appInfo),p(function(){var o=e.logLvl;if("number"==typeof o)t.LOG.setLvl("default",o);else{var i=o["default"];null!=i&&t.LOG.setLvl("default",i);for(var a in o)"default"!=a&&t.LOG.setLvl(a,o[a])}e.emitter.emit(e.AFTER_CFG),r.call(n)})})}function l(){return e._appCfg}e.HANDLE_APP_INFO="HANDLE_APP_INFO",e.AFTER_CFG="AFTER_CFG",e.emitter=new t.Emitter,e.appInfo={},e.srcUrlParam={};var c=function(){if(!egret.isNative){var t={},r=mo.PROJ.search,n=r.indexOf("?");if(n>0)for(var i=r.substring(n+1),a=i.split("&"),s=0,u=a.length;u>s;s++){var l=a[s],c=l.split("="),p=c[0],f=c[1],_=f.search(/[a-z]/i);null==f||isNaN(f)||-1!=_||(f.match(/(^\d+$)/)?f=parseInt(f):f.match(/(^\d+.\d+$)/)&&(f=parseFloat(f))),t[p]=f}e.srcUrlParam=t,o(t)}},p=function(r){var n=e.cfgUrl||egret.getOption("cfgUrl")||e.appInfo.cfgUrl||"resource/project.json",a=e.appInfo.channelId||e.channelId,s=e.appInfo.version||e.appVersion,u=e.version;n+=t.STR.format("?channelId=%s&appVersion=%s&version=%s&timestamp=%s",a,s,u,t.DATE.now()),i(n,function(t,n){return t?(console.error("缺失project.json文件，请检查！"),c(),r()):(o(n),e.my?void i(e.my,function(t,e){t||null==e?(c(),r()):(o(e),c(),r())}):(c(),r()))})},f=[];e.registerValueHandler=r,e.setValue=n,e._parse=o;var _={},h=function(t){var e=this,r=t.target,n=r._request.url;e.removeEventListener(egret.Event.COMPLETE,h,egret),e.removeEventListener(egret.IOErrorEvent.IO_ERROR,h,egret);var o=_[n];if(delete _[n],t._type==egret.IOErrorEvent.IO_ERROR)o&&o("配置文件读取失败");else{var i=JSON.parse(e.data);o&&o(null,i)}};e.version="0.0.1",e["package"]="com.modo7game",e.projName="mo",e.appName="摩多游戏",e.logLvl={},e.langs=[],e.channelId=99999,e.channelName="dev",e.channelEnabled=!0,e.channelCfg={},e.refCfg={},e.portraitMode=!1,e.handleChannelCfg=a,r(function(t){n(t,"version"),n(t,"lang"),n(t,"langs"),n(t,"package"),n(t,"projName"),n(t,"appName"),n(t,"productName"),n(t,"logLvl"),n(t,"channelId"),n(t,"channelName"),n(t,"channelEnabled",!0),n(t,"channelDisabledMsg"),n(t,"channelCfg"),n(t,"refCfg"),n(t,"my"),n(t,"cdn"),n(t,"appVersion"),n(t,"dataEyeAppId"),n(t,"portraitMode")}),e.load=u,e._appCfg={},e.getAppCfg=l}(e=t.PROJ||(t.PROJ={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){function e(t,e){var n,o=0,i=0;return 1==arguments.length?(o=t.x,i=t.y):2==arguments.length?"number"==typeof e?(o=t,i=e):(n=arguments[1],o=t.x,i=t.y):(o=t,i=e),n||(n=new r),n._setX(o),n._setY(i),n}var r=function(e){function r(){return e.apply(this,arguments)||this}return __extends(r,e),r.prototype._setXDirty=function(t){t&&(this._dirty=t),this._xDirty=t},Object.defineProperty(r.prototype,"xDirty",{get:function(){return this._xDirty},set:function(t){this._setXDirty(t)},enumerable:!0,configurable:!0}),r.prototype._setYDirty=function(t){t&&(this._dirty=t),this._yDirty=t},Object.defineProperty(r.prototype,"yDirty",{get:function(){return this._yDirty},set:function(t){this._setYDirty(t)},enumerable:!0,configurable:!0}),r.prototype._setDirty=function(t){this._xDirty=t,this._yDirty=t,this._dirty=t},Object.defineProperty(r.prototype,"dirty",{get:function(){return this._dirty},set:function(t){this._setDirty(t)},enumerable:!0,configurable:!0}),r.prototype._setX=function(t){var e=this;e._x!=t&&(e._setXDirty(!0),e._x=t)},Object.defineProperty(r.prototype,"x",{get:function(){return this._x},set:function(t){this._setX(t)},enumerable:!0,configurable:!0}),r.prototype._setY=function(t){var e=this;e._y!=t&&(e._setYDirty(!0),e._y=t)},Object.defineProperty(r.prototype,"y",{get:function(){return this._y},set:function(t){this._setY(t)},enumerable:!0,configurable:!0}),r.prototype.clone=function(t){t||(t=new r);var e=this;return t._x=e._x,t._y=e._y,t._xDirty=e._xDirty,t._yDirty=e._yDirty,t._dirty=e._dirty,t},r.prototype.neg=function(){return t.p(-this.x,-this.y)},r.prototype.add=function(e){return t.p(this.x+e.x,this.y+e.y)},r.prototype.sub=function(e){return t.p(this.x-e.x,this.y-e.y)},r.prototype.mult=function(e){return t.p(this.x*e,this.y*e)},r.prototype.midPoint=function(t){return this.add(t).mult(.5)},r.prototype.dot=function(t){return this.x*t.x+this.y*t.y},r.prototype.cross=function(t){return this.x*t.y-this.y*t.x},r.prototype.perp=function(){return t.p(this.y,-this.x)},r.prototype.rPerp=function(){return t.p(-this.y,this.x)},r.prototype.project=function(t){return t.mult(this.dot(t)/t.dot(t))},r.prototype.rotate=function(e){return t.p(this.x*e.x-this.y*e.y,this.x*e.y+this.y*e.x)},r.prototype.unrotate=function(e){return t.p(this.x*e.x+this.y*e.y,this.y*e.x-this.x*e.y)},Object.defineProperty(r.prototype,"lengthSQ",{get:function(){return this.dot(this)},enumerable:!0,configurable:!0}),r.prototype.distanceSQTo=function(t){return this.sub(t).lengthSQ},r.prototype.distanceSQ=function(e){return t.warn("Point#distanceSQ已经废弃，请使用Point#distanceSQTo"),this.sub(e).lengthSQ},Object.defineProperty(r.prototype,"length",{get:function(){return Math.sqrt(this.lengthSQ)},enumerable:!0,configurable:!0}),r.prototype.distanceTo=function(t){return Math.sqrt(this.distanceSQTo(t))},r.prototype.distance=function(e){return t.warn("Point#distance已经废弃，请使用Point#distanceTo"),Math.sqrt(this.distanceSQTo(e))},r.prototype.normalize=function(){return this.length?this.mult(1/this.length):t.p(0,0)},r.prototype.toAngle=function(){return Math.atan2(this.y,this.x)},r}(egret.Point);t.Point=r,__reflect(r.prototype,"mo.Point"),t.p=e}(mo||(mo={}));var mo;!function(t){function e(t){return t*Math.PI/180}function r(t){return t*(180/Math.PI)}function n(e){return t.p(-e.x,-e.y)}function o(e,r){return t.p(e.x+r.x,e.y+r.y)}function i(e,r){return t.p(e.x-r.x,e.y-r.y)}function a(e,r){return t.p(e.x*r,e.y*r)}function s(t,e){return a(o(t,e),.5)}function u(t,e){return t.x*e.x+t.y*e.y}function l(t){return a(t,1/c(t))}function c(t){return Math.sqrt(p(t))}function p(t){return u(t,t)}t.degreesToRadians=e,t.radiansToDegrees=r,t.pNeg=n,t.pAdd=o,t.pSub=i,t.pMult=a,t.pMidpoint=s,t.pDot=u,t.pNormalize=l,t.pLength=c,t.pLengthSQ=p}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){function e(t,e,n,o,i){return i?(i.x=t,i.y=e,i.width=n,i.height=o,i):new r(t,e,n,o)}var r=function(e){function r(){return e.apply(this,arguments)||this}return __extends(r,e),r.prototype.containsRect=function(t){if(!t)return!1;var e=this;return!(e.x>=t.x||e.y>=t.y||e.x+e.width<=t.x+t.width||e.y+e.height<=t.y+t.height)},Object.defineProperty(r.prototype,"maxX",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"midX",{get:function(){return this.x+this.width/2},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxY",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"midY",{get:function(){return this.y+this.height/2},enumerable:!0,configurable:!0}),r.prototype.overlaps=function(t){var e=this;return!(e.x+e.width<t.x||t.x+t.width<e.x||e.y+e.height<t.y||t.y+t.height<e.y)},r.prototype.union=function(e){var r=this,n=t.rect(0,0,0,0);return n.x=Math.min(r.x,e.x),n.y=Math.min(r.y,e.y),n.width=Math.max(r.x+r.width,e.x+e.width)-n.x,n.height=Math.max(r.y+r.height,e.y+e.height)-n.y,n},r.prototype.getIntersection=function(e){var r=this,n=t.rect(Math.max(r.x,e.x),Math.max(r.y,e.y),0,0);return n.width=Math.min(r.maxX,e.maxX)-n.x,n.height=Math.min(r.maxY,e.maxY)-n.y,n},r.prototype.clone=function(t){var e=this;return t||(t=new r),t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,t},r}(egret.Rectangle);t.Rect=r,__reflect(r.prototype,"mo.Rect"),t.rect=e}(mo||(mo={}));var mo;!function(t){t.touchEmitter=new t.Emitter}(mo||(mo={})),function(t){var e;!function(e){var r=egret.Event;e.COMPLETE=r.COMPLETE,e.LOOP_COMPLETE=r.LOOP_COMPLETE,e.FRAME_LABEL=egret.MovieClipEvent.FRAME_LABEL,e.END="end";var n=egret.TouchEvent;e.TOUCH_BEGIN_0=n.TOUCH_BEGIN+"_0",e.TOUCH_BEGIN_1=n.TOUCH_BEGIN+"_1",e.TOUCH_END_0=n.TOUCH_END+"_0",e.TOUCH_END_1=n.TOUCH_END+"_1",e.TOUCH_MOVE_0=n.TOUCH_MOVE+"_0",e.TOUCH_MOVE_1=n.TOUCH_MOVE+"_1",e.TOUCH_TAP_0=n.TOUCH_TAP+"_0",e.TOUCH_TAP_1=n.TOUCH_TAP+"_1",e.ON_INIT="onInit",e.MODULE_CHANGED="onModuleChanged",e.MODULE_DTOR="onModuleDTOR",t.PROJ.emitter.once(t.PROJ.AFTER_CFG,function(){for(var e=egret.MainContext.instance.stage,r=egret.TouchEvent,n=99999999,o=function(e){t.touchEmitter.emit(this.event,e)},i=[r.TOUCH_BEGIN,r.TOUCH_END,r.TOUCH_MOVE,r.TOUCH_TAP],a=0,s=i.length;s>a;a++){var u=i[a];e.addEventListener(u,o,{event:u+"_0"},!0,n),e.addEventListener(u,o,{event:u+"_1"},!1,n)}})}(e=t.EVT||(t.EVT={}))}(mo||(mo={}));var LD;!function(t){t._=""}(LD||(LD={}));var mo;!function(t){var e;!function(e){function r(e,r,i){t.CHAIN.begin(e).limit(1,function(e,i,a){return t.log("正在加载js:【%s】",e),o[e]?a(null):void n(e,function(n){return n?a(n):(r&&r(e,i),t.log("js【%s】加载完毕！",e),void a())})}).end(i)}function n(t,e){var r=document,n=document.createElement("script");n.hasOwnProperty("async")&&(n.async=!1),o[t]=!0,n.src=t,n.addEventListener("load",function(){this.removeEventListener("load",arguments.callee,!1),e()},!1),n.addEventListener("error",function(){e("Load "+t+" failed!")},!1),r.body.appendChild(n)}var o={};e.loadList=r,e.createScript=n}(e=t.JS||(t.JS={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e=function(e){function r(){var t=e.call(this)||this;return t._initProp(),t}return __extends(r,e),r.prototype._initProp=function(){var e=this;e._store=new t.Store,e.$$data={},e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){e.isEnter=!0,e.onEnter()},e),e.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){e.isEnter=!1,e.onExit()},e)},r.prototype.doDtor=function(){var t=this;t._hasDtored||(t._hasDtored=!0,t.dtor())},r.prototype.dtor=function(){this._store.doDtor()},r.prototype.onEnter=function(){},r.prototype.onExit=function(){},r.prototype.onEmitter=function(e,r,n){t.onEmitter(e,r,n,this)},r.prototype.unEmitter=function(){t.unEmitter(this)},r.prototype.on=function(){return this},r.prototype.onPriority=function(){return this},r.prototype.onAsync=function(){return this},r.prototype.onAsyncPriority=function(){return this},r.prototype.onNextTick=function(){return this},r.prototype.onPriorityNextTick=function(){return this},r.prototype.once=function(){return this},r.prototype.oncePriority=function(){return this},r.prototype.onceAsync=function(){return this},r.prototype.onceAsyncPriority=function(){return this},r.prototype.onceNextTick=function(){return this},r.prototype.oncePriorityNextTick=function(){return this},r.prototype.single=function(){return this},r.prototype.singleAsync=function(){return this},r.prototype.singleNextTick=function(){return this},r.prototype.un=function(){return this},r.prototype.unNextTick=function(){return this},r.prototype.unOnce=function(){return this},r.prototype.unOnceNextTick=function(){return this},r.prototype.unSingle=function(){return this},r.prototype.unSingleNextTick=function(){return this},r.prototype.unAll=function(){return this},r.prototype.unAllNextTick=function(){return this},r.prototype.unCtx=function(){},r.prototype._emitByListenerInfoArr=function(){},r.prototype.emit=function(){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return this},r.prototype.emitAsync=function(){for(var t=[],e=3;e<arguments.length;e++)t[e-3]=arguments[e];return this},r.prototype.emitNextTick=function(){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return this},r.prototype.emitBoth=function(){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return this},r.prototype.emitPhase=function(){for(var t=[],e=3;e<arguments.length;e++)t[e-3]=arguments[e];return this},r.prototype.emitPhaseNextTick=function(){for(var t=[],e=3;e<arguments.length;e++)t[e-3]=arguments[e];return this},r}(egret.DisplayObjectContainer);e._store=new t.Store,t.Container=e,__reflect(e.prototype,"mo.Container",["mo.IEmitter"]),t.bindEmitterPrototype(e)}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},mo;!function(t){var e;!function(e){var r=function(){function e(t){this.__class=e;var r=this;r._initProp(),r._init(),r.endTime=t}return e.prototype._initProp=function(){var t=this;t._isInstance=!1,t._hasDtored=!1,t._listenerMap={},t._ctxMap={},t._moreMap={},t._tempArrMap={},t._typeCounter={},t.msPassed=0},e.prototype._init=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.doDtor=function(){var t=this;t._hasDtored||(t._hasDtored=!0,t.dtor())},e.prototype.dtor=function(){},e.prototype.on=function(t,e,r){e?(this._listenerMap[t]=e,this._ctxMap[t]=r):(delete this._listenerMap[t],delete this._ctxMap[t])},e.prototype.un=function(t){this.on(t,null)},e.prototype.onMore=function(t,e,r){var n=this._moreMap,o=n[t];o||(o=n[t]=[]);for(var i=0,a=o.length;a>i;i++){var s=o[i];if(s.listener==e&&s.ctx==r)return}o.push({listener:e,ctx:r})},e.prototype.unMore=function(t,e,r){var n=this._moreMap,o=n[t];if(o)if(1==arguments.length)delete n[t];else{for(var i=0,a=o.length;a>i;){var s=o[i];s.listener==e&&s.ctx==r?(o.splice(i,1),a--):i++}0==o.length&&delete n[t]}},e.prototype._switchToTemp=function(t,e){var r=this._tempArrMap[t];r||(r=this._tempArrMap[t]=[]),r.length=0;for(var n=0,o=e.length;o>n;n++)r[n]=e[n];return r},e.prototype._invoke=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=this,o=n._listenerMap[t],i=n._ctxMap[t];o&&o.apply(i,arguments);var a=n._moreMap[t];if(a){for(var s=n._switchToTemp(t,a),u=0,l=s.length;l>u;u++){var c=s[u];c.listener&&c.listener.apply(c.ctx,arguments)}s.length=0}},e.prototype._update=function(e,r){var n=this,o=n.__class,i=n.beginTime,a=n.endTime;if(!a)return!1;var s=a.getTime();if(r>=s&&!i)return!0;var u=!i;i||(i=n.beginTime=t.DATE.date()),u&&n._invoke(o.ON_FIRST,i,a);for(var l=Math.min(s-r,e),c=n.msPassed,p=c%1e3,f=Math.floor((p+l)/1e3),_=0;f>_;_++)n._invoke(o.ON_SECOND,i,a);return n.msPassed+=l,c=n.msPassed,r>=s?(p=c%1e3,f=Math.round((p+l)/1e3),f&&n._invoke(o.ON_SECOND,i,a),n._invoke(o.ON_END,i,a),!0):!1},e}();r.ON_FIRST="onFirst",r.ON_SECOND="onSecond",r.ON_END="onEnd",e.Trigger=r,__reflect(r.prototype,"mo.TM.Trigger")}(e=t.TM||(t.TM={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},mo;!function(t){var e;!function(e){function r(){var t=new n;return o.push(t),t}var n=function(){function e(){this.__class=e;var t=this;t._initProp(),t._init()}return e.prototype._initProp=function(){var t=this;t._isInstance=!1,t._hasDtored=!1,t.deltaMs=0,t._triggers=[],t._tempTriggers=[]},e.prototype._init=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.doDtor=function(){var t=this;t._hasDtored||(t._hasDtored=!0,t.dtor())},e.prototype.dtor=function(){var t=this;t.clear()},e.prototype.clear=function(){var t=this;t._triggers.length=0,egret.Ticker.getInstance().unregister(t._update,t),t._tickBegan=!1,t.deltaMs=0},e.prototype.setDeltaMs=function(t){if(t){var e=this;e.deltaMs+=t,e._tickBegan||(e._tickBegan=!0,egret.Ticker.getInstance().register(e._update,e))}},e.prototype._judgeUpdate=function(){var t=this;0==t._triggers.length?(egret.Ticker.getInstance().unregister(t._update,t),t._tickBegan=!1):t._tickBegan||(egret.Ticker.getInstance().register(t._update,t),t._tickBegan=!0)},e.prototype._update=function(e){var r=this,n=r._triggers,o=n.length;if(o>0){for(var i=r.deltaMs,a=t.DATE.now(),s=r._tempTriggers,u=0;o>u;++u)n[u]&&s.push(n[u]);o=s.length;for(var u=0;o>u;++u)s[u]._update(e+i,a)&&r.remove(s[u]);s.length=0}r.deltaMs=0,r._judgeUpdate()},e.prototype.add=function(t){var e=this._triggers;e.indexOf(t)<0&&e.push(t),this._judgeUpdate()},e.prototype.remove=function(){this.rm.apply(this,arguments)},e.prototype.rm=function(t){var e=this._triggers,r=e.indexOf(t);r>=0&&e.splice(r,1),this._judgeUpdate()},e}();e.Timer=n,__reflect(n.prototype,"mo.TM.Timer");var o=[],i=function(){for(var t=egret.getTimer(),e=0,r=o.length;r>e;e++){var n=o[e];n.setDeltaMs(t)}},a=function(){var t=egret.MainContext.instance.stage;t.removeEventListener(egret.Event.ACTIVATE,i,e),t.addEventListener(egret.Event.ACTIVATE,i,e)};e.newTimer=r,e.timer=r(),t.PROJ.emitter.once(t.PROJ.AFTER_CFG,a)}(e=t.TM||(t.TM={}))}(mo||(mo={}));var mo;!function(t){var e;!function(e){function r(t){for(var e=[],r=3;r<arguments.length;r++)e[r-3]=arguments[r];
var n=u++,o=_.apply(null,arguments),i=o[1],a=o[2],s=o[3];return 0==a?t.apply(i,s):(o.push(0,!0),c[n]=o),n}function n(t){for(var e=[],r=3;r<arguments.length;r++)e[r-3]=arguments[r];var n=u++,o=_.apply(null,arguments),i=o[1],a=o[2],s=o[3];return 0==a?t.apply(i,s):(o.push(0,!1),c[n]=o),n}function o(t){delete c[t]}function i(t){for(var e=[],r=3;r<arguments.length;r++)e[r-3]=arguments[r];var n=l++,o=_.apply(null,arguments),i=o[1],a=o[2],s=o[3];return 0==a&&t.apply(i,s),o.push(0,!0),p[n]=o,n}function a(t){for(var e=[],r=3;r<arguments.length;r++)e[r-3]=arguments[r];var n=l++,o=_.apply(null,arguments),i=o[1],a=o[2],s=o[3];return 0==a&&t.apply(i,s),o.push(0,!1),p[n]=o,n}function s(t){delete p[t]}t.LOG.initLogger(e,"mo.TM");var u=1,l=1,c={},p={},f=!1,_=function(t,e,r){for(var n=[],o=3;o<arguments.length;o++)n[o-3]=arguments[o];var i=e,a=r,s=n,u=arguments.length;if("number"==typeof e)i=null,a=e,u>2&&s.splice(0,0,r);else if(2==u&&"number"!=typeof e||u>2&&"number"!=typeof r)throw"参数有误";return[t,i,a,s]};e.setTimeout=r,e.setTimeout4Tick=n,e.clearTimeout=o,e.setInterval=i,e.setInterval4Tick=a,e.clearInterval=s;var h=function(){if(!f){f=!0,egret.Ticker.getInstance().register(function(t){var e=c;for(var r in e){var n=e[r],o=n[0],i=n[1],a=n[2],s=n[3],u=n[4]+t;u>=a?(o.apply(i,s),delete e[r]):n[4]=u}var l=p;for(var f in l){var n=l[f],o=n[0],i=n[1],_=n[2]||1,s=n[3],u=n[4]+t,h=u-_;if(h>=0){for(;h>=0;)o.apply(i,s),h-=_;n[4]=h+_}else n[4]=u}},e);var t=egret.MainContext.instance.stage,r={deactivateTime:0};t.addEventListener(egret.Event.DEACTIVATE,function(){this.deactivateTime=egret.getTimer()},r),t.addEventListener(egret.Event.ACTIVATE,function(){var t=egret.getTimer()-this.deactivateTime;e.debug("休眠了 %d 毫秒",t);var r=c,n=[];for(var o in r){var i=r[o],a=i[0],s=i[1],u=i[2],l=i[3],f=i[4]+t,_=i[5];_&&(f>=u?n.push([a,s,u,l,u-i[4],1,o]):i[4]=f)}var h=p;for(var g in h){var i=h[g],a=i[0],s=i[1],d=i[2]||1,l=i[3],_=i[5];if(_){var y=d-i[4];if(t>=y){for(;t>=y;)n.push([a,s,u,l,y,2,g]),y+=d;i[4]=y-d}else i[4]+=t}}n.sort(function(t,e){var r=t[4],n=e[4];return r>n?1:r==n?0:-1});for(var v=0,m=n.length;m>v;v++){var i=n[v],a=i[0],s=i[1],u=i[2],l=i[3],E=i[5],T=i[6];if(1==E){if(!c[T])continue;delete c[T]}else if(!p[T])continue;a.apply(s,l)}},r)}};t.PROJ.emitter.once(t.PROJ.AFTER_CFG,h)}(e=t.TM||(t.TM={}))}(mo||(mo={}));var mo;!function(t){var e;!function(e){function r(){egret.ExternalInterface.addCallback("$rt",function(t){e.log("message form native【%s】 : %s","$rt",t);var r=t;try{r=JSON.parse(r);var n=r.$error,o=r.$key,a=i[r.$iface]||{},s=a[o];if(delete a[o],n)return void(s?s(n):e.error(n));s&&s(null,r.$data)}catch(u){e.error(u)}}),egret.ExternalInterface.addCallback("$error",function(t){e.error("rt error--->"+t)}),egret.ExternalInterface.addCallback("$notify",function(t){try{var r=JSON.parse(t),n=r.$event;n&&e.receiver.emit(n,r.$data)}catch(o){e.error(o)}}),o=!0}function n(n,a,s){if(!egret.isNative){var u="当前不是native环境，接口调用失败！";return void(s?s(u):e.error(u))}if(o||r(),!n){var u="iface不能为空！";return void(s?s(u):e.error(u))}if(null==a&&(a={}),"object"!=typeof a||a instanceof Array){var u="param必须是null或者是一个对象，不支持数字、字符串、数组这些。";return void(s?s(u):e.error(u))}var l=t.MD5.encode(t.STR.format("%s-%s",n,t.DATE.now()));if(s){var c=i[n]=i[n]||{};c[l]=s}var p=JSON.stringify({$iface:n,$key:l,$data:a});e.log("send to native【%s】 : %s",n,p),egret.ExternalInterface.call("$rt",p)}t.LOG.initLogger(t.RT,"mo.RT"),t.LOG.setLvl("mo.RT",3);var o,i={};e.receiver=new t.Emitter,e.call=n}(e=t.RT||(t.RT={}))}(mo||(mo={}));var mo;!function(t){var e;!function(e){function r(e){var r=t.touchEmitter,o=t.EVT,i=n;return e.stopImmediatePropagation(),r.on(o.TOUCH_BEGIN_1,i),r.on(o.TOUCH_END_0,i),r.on(o.TOUCH_END_1,i),r.on(o.TOUCH_MOVE_0,i),r.on(o.TOUCH_MOVE_1,i),r.on(o.TOUCH_TAP_0,i),r.on(o.TOUCH_TAP_1,i),!0}function n(t){return t.stopImmediatePropagation(),!0}function o(){f=f||0,f++,!p&&f>0&&(p=!0,t.touchEmitter.onPriority(t.EVT.TOUCH_BEGIN_0,-9999999,r))}function i(){if(f--,p&&0>=f){p=!1,f=0;var e=t.touchEmitter,o=t.EVT,i=n;e.un(o.TOUCH_BEGIN_0,r),e.un(o.TOUCH_BEGIN_1,i),e.un(o.TOUCH_END_0,i),e.un(o.TOUCH_END_1,i),e.un(o.TOUCH_MOVE_0,i),e.un(o.TOUCH_MOVE_1,i),e.un(o.TOUCH_TAP_0,i),e.un(o.TOUCH_TAP_1,i)}}function a(e,r){var n=t.getFontStyleOpt(r);if(n)for(var o in n){var i=n[o];null!=i&&(e[o]=i)}else t.warn("请配置名为【%s】的StyleOpt",r)}function s(e,r,n){if(void 0===r&&(r=1),void 0===n&&(n=!1),e)if(egret.isNative){var o=egret.Capabilities.os.toLowerCase();if("android"==o)t.RT.call("openUrl",{url:e,closeType:r.toString()});else{var i=JSON.stringify({url:e,closeType:r.toString(),forcePortrait:n});egret.ExternalInterface.call("openWebview",i)}}else window.open(e)}function u(e,r,n){if(void 0===r&&(r=1),e&&egret.isNative){var o=egret.Capabilities.os.toLowerCase();if("android"==o)t.RT.call("openRule",{url:e,closeType:r.toString(),changeString:JSON.stringify(n)});else{var i=JSON.stringify({url:e,closeType:r.toString(),changeString:n});egret.ExternalInterface.call("openRuleWebview",i)}}}function l(t){return t._children||t.$children||[]}function c(){if(egret.isNative)return"landscape";var t=this;if(0!=t.orientationForDevelop.length)return t.orientationForDevelop;var e=window.orientation;return void 0==e?"landscape":90==e||-90==e?"landscape":"portrait"}var p,f=0;e.stopTouch=o,e.resumeTouch=i,e.setFontStyle=a,e.openUrl=s,e.openRule=u,e.getChildren=l,e.orientationForDevelop="",t.PROJ.emitter.on(t.PROJ.AFTER_CFG,function(){if(!egret.isNative){var e=egret.MainContext.instance.stage;e.addEventListener(egret.StageOrientationEvent.ORIENTATION_CHANGE,function(){t.emitter.emit("changePLMode")},this)}}),e.orientation=c}(e=t.UTIL||(t.UTIL={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},eui;!function(){}(eui||(eui={}));var mo;!function(t){var e=function(e){function r(){return e.apply(this,arguments)||this}return __extends(r,e),r.prototype._initProp=function(){e.prototype._initProp.call(this);var t=this;t.preJsList=[],t.jsList=[],t.zipList=[],t.preResInfoMap={},t.resInfoMap={},t.progress=0,t.uiType=2,t.status=0,t._zipManifest={}},Object.defineProperty(r.prototype,"total",{get:function(){var t=this;return t.jsList.length+t.zipList.length+Object.keys(t.resInfoMap).length},enumerable:!0,configurable:!0}),r.prototype.setPreResInfo=function(t,e){this.preResInfoMap[t]=(this.preResInfoMap[t]||[]).concat(e)},r.prototype.setResInfo=function(t,e){this.resInfoMap[t]=(this.resInfoMap[t]||[]).concat(e)},r.prototype.loadPre=function(e){var r=this,n=null;egret.isNative?n=new t.VersionCtrl_Native:(n=new t.VersionCtrl,n.initVersionInfo(t.manifest)),n&&RES.registerVersionController(n),t.CHAIN.then(function(e,n){t.JS.loadList(r.preJsList||[],null,n)}).then(function(e,r){t.PROJ.load(function(){r()})}).then(function(t,e){return egret.isNative?(RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,function(){e()},this),void RES.loadConfig(r.resJsonPath||"resource/default.res.json","resource/")):e()}).then(function(e,n){if(r.uiType==r.__class.UI_TYPE_GUI){var o=egret.gui,i=t.gui;o.mapClass("egret.gui.IAssetAdapter",i.AssetAdapter),o.mapClass("egret.gui.IThemeAdapter",i.ThemeAdapter),o.Theme.load("resource/default.thm.json"),n()}else if(r.uiType==r.__class.UI_TYPE_EUI){var a=egret.MainContext.instance.stage,s=t.EUI;a.registerImplementation("eui.IAssetAdapter",new s.AssetAdapter),a.registerImplementation("eui.IThemeAdapter",new s.ThemeAdapter);var u=eui,l=new u.Theme("resource/theme.json",a),c=function(){l.removeEventListener(u.UIEvent.COMPLETE,c,r),n()};l.addEventListener(u.UIEvent.COMPLETE,c,r)}else n()}).then(function(t,e){r._loadPreRes(e)}).end(e)},r.prototype.registerZipManifest=function(t,e){this._zipManifest[t]=e},r.prototype.waitModuleRes=function(e){var r=this;r._intervalId4ModuleRes&&t.TM.clearInterval(r._intervalId4ModuleRes);var n=null;r._intervalId4ModuleRes=t.TM.setInterval(function(){if(null==n){n=[];var o=t.R.moduleInfoMap[t.R.moduleName];for(var i in o)n.push(i)}for(var a=n.length-1;a>=0;a--){var i=n[a];t.R.get(i)&&n.splice(a,1)}0==n.length&&(t.TM.clearInterval(r._intervalId4ModuleRes),e())},100)},r.prototype.clearLoading=function(){if(LD.stop&&LD.stop(),!egret.isNative)for(var t=document.getElementsByTagName("canvas"),e=0,r=t.length;r>e;e++){var n=t[e];n.style.backgroundColor="black"}},r.prototype.onZipHandler=function(t,e){this._zipHandler=t,this._zipHandlerCtx=e},r.prototype.loadZip=function(e,r){var n=this,o=new egret.URLLoader,i=new egret.URLRequest;i.url=RES.$getVirtualUrl(e),o.dataFormat=egret.URLLoaderDataFormat.BINARY,o.addEventListener(egret.IOErrorEvent.IO_ERROR,function(){t.MSG.show("E:"+egret.IOErrorEvent.IO_ERROR),r(t.STR.format("zip【%s】加载失败!",e))},n),o.addEventListener(egret.Event.COMPLETE,function(){if(null==t.JSZip)return r("请先加载mo-jszip模块!");var e=new t.JSZip(o.data),i=e.file(/.*/);t.CHAIN.begin(i).limit(1,function(e,r,o){t.TM.setTimeout4Tick(function(){n._zipHandler&&n._zipHandler.call(n._zipHandlerCtx,e),o()},30)}).end(r)},n),o.load(i)},r.prototype._loadPreRes=function(e){var r=this,n=r.preResInfoMap,o=r.__class,i=o.ON_PROGRESS_PRE,a=0,s=Object.keys(n);t.CHAIN.begin(n).limit(5,function(e,n,o){return e?void("global"==n?(t.R.setGlobal.apply(t.R,e),t.R.load(e,function(){a++,r.emit(i,a,s),o()})):t.R.loadTo(n,e,function(){a++,r.emit(i,a,s),o()})):o()}).end(e)},r.prototype.load=function(){var e=this;if(e._intervalId4ModuleRes&&t.TM.clearInterval(e._intervalId4ModuleRes),!e.status){e.status=1;var r=e.jsList,n=e.zipList,o=e.resInfoMap,i=e.__class,a=i.ON_PROGRESS;t.CHAIN.spawn(function(n,o){return 0==r.length?o():void t.JS.loadList(r||[],function(){e.progress++,e.emit(a,e.progress,e.total)},o)}).spawn(function(r,o){return 0==n.length?o():void t.CHAIN.begin(n).limit(5,function(t,r,n){e.loadZip(t,function(t){return t?n(t):(e.progress++,e.emit(a,e.progress,e.total),void n())})}).end(o)}).spawn(function(r,n){return 0==Object.keys(o).length?n():void t.CHAIN.begin(o).limit(5,function(r,n,o){"global"==n?(t.R.setGlobal.apply(t.R,r),t.R.load(r,function(){e.progress++,e.emit(a,e.progress,e.total),o()})):t.R.loadTo(n,r,function(){e.progress++,e.emit(a,e.progress,e.total),o()})}).end(n)}).end(function(r){r?(e.status=-1,e.emit(i.ON_ERROR,r)):(e.status=2,e._intervalId4ModuleRes&&t.TM.clearInterval(e._intervalId4ModuleRes),t.PROJ.emitter.emit(t.PROJ.AFTER_CFG),e.emit(i.ON_END))})}},r.prototype._onInterval4Bar=function(e,r){var n=this;if(r){var o=t.NUM.rand(5,10);r.value=r.value>=100?o:Math.min(100,r.value+o)}if(e){var o=t.NUM.rand(5,10);if(e.value>=90)return;e.value=Math.min(100*(n.progress+1)/n.total,e.value+o)}},r.prototype.bindUi=function(e){var r=this,n=e.bar_small,o=e.bar_loading,i=r.__class;r._intervalId4Bar||(r._intervalId4Bar=t.TM.setInterval(function(){r._onInterval4Bar(o,n)},100)),r.on(i.ON_PROGRESS,function(t,e){o&&(o.value=100*t/e)},e),r.on(i.ON_ERROR,function(n){r.unCtx(e),t.MSG.show(n)},e),r.on(i.ON_END,function(){r.unCtx(e),t.TM.clearInterval(r._intervalId4Bar),r._intervalId4Bar=null},e)},r}(t.Emitter);e.ON_PROGRESS="ON_PROGRESS",e.ON_PROGRESS_PRE="ON_PROGRESS_PRE",e.ON_END="ON_END",e.ON_ERROR="ON_ERROR",e.UI_TYPE_GUI=1,e.UI_TYPE_EUI=2,e.STATUS_FAIL=-1,e.STATUS_WAIT=0,e.STATUS_LOADING=1,e.STATUS_SUCCESS=2,t.LazyLoader=e,__reflect(e.prototype,"mo.LazyLoader"),t.lazyLoader=new e}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},mo;!function(t){var e=function(){function e(){var t=this;t._list=[]}return e.prototype.get=function(e){return t.ARR.hasStrict(this._list,e)||this._list.push(e),egret.Tween.get.apply(egret.Tween,arguments)},e.prototype.rm=function(t){var e=this._list.indexOf(t);e>=0&&this._list.splice(e,1),egret.Tween.removeTweens(t)},e.prototype.rmAll=function(){for(var t=this._list,e=t.length-1;e>=0;e--){var r=t[e];t.splice(e),egret.Tween.removeTweens(r)}},e}();t.TweenHelper=e,__reflect(e.prototype,"mo.TweenHelper")}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e;!function(e){function r(t){p=t}function n(t,e,r){f[t]=[e,r]}function o(t,e,r){_[t]=[e,r]}function i(t,e){l=t,c=e}function a(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];for(var o,i,a,s,g=[];r.length>0&&"function"!=typeof r[0];)g.push(r.shift());if(r.length>0&&"function"==typeof r[0]&&(i=r.shift()),r.length>0&&"function"==typeof r[0]&&(a=r.shift()),r.length>0&&(s=r.shift()),e instanceof u)o=e;else if("object"==typeof e)o=new u,t.OBJ.merge(o,e);else{if(!l)return t.warn("msg--->",e,g),t.error("请先注册消息转换器！"),null;e instanceof u?o=e:"object"==typeof e?e.type?(o=new u,o.code=e.code,o.type=e.type,o.msg=e.msg,o.args=e.args||[]):e.code?(o=l.call(c,e.code),o.args=e.args||[]):o=l.call(c,"未知错误！"):o=l.call(c,e)}g.length>0&&(o.args=g),i&&o.on(u.ON_OK,i,s),a&&o.on(u.ON_CANCEL,a,s);var d=o.type||p,y=null;if(null==o.code&&(o.code=o.msg),o.code&&(y=_[o.code]),!y&&(y=f[d],!y)){if(t.warn(o.getDisplayMsg()),t.warn("未注册type为【%s】的消息创建器！",d),d==p)return null;if(y=f[p],!y)return null}var v=y[0].call(y[1],o);if(!v)return null;v.msg=o;var m=h[o.code];return m&&m(v),v.show(),v}function s(t,e){h[t]=e}var u=function(e){function r(){return e.apply(this,arguments)||this}return __extends(r,e),r.prototype._initProp=function(){e.prototype._initProp.call(this);var t=this;t.args=[]},r.prototype.getDisplayMsg=function(){return t.STR.format.apply(t.STR,[this.msg].concat(this.args||[]))},r}(t.Emitter);u.ON_OK="ON_OK",u.ON_CANCEL="ON_CANCEL",u.ON_CLOSE="ON_CLOSE",e.Msg=u,__reflect(u.prototype,"mo.MSG.Msg");var l,c,p=0,f={},_={};e.setDefaultType=r,e.register=n,e.registerByCode=o,e.onTranslate=i,e.show=a;var h={};e.onDisplay=s,t.MSG.onTranslate(function(e){var r=t.D.get("c_msgCode",e),n=new t.MSG.Msg;return r?(n.msg=t.PROJ.lang?t.D.langCodeToTxt(r.langCode):r.text,n.code=e,n.type=r.type):n.msg=e,n})}(e=t.MSG||(t.MSG={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e=function(){function e(){}return e.prototype.fetchVersion=function(t){t.onSuccess(null)},e.prototype.getChangeList=function(){return[]},e.prototype.getVirtualUrl=function(e){if(!e)return null;var r=t.PATH.join(e).toLowerCase(),n=this._versionInfo||{},o=n[r],i=t.PROJ.cdn||"";if(i=this.checkHttps(i),o){var a=o.v,s=o.s;return i+"resource/"+a.substring(0,2)+"/"+a+"_"+s+"."+r.substring(r.lastIndexOf(".")+1)}return e},e.prototype.checkHttps=function(t){if(t.length>0&&window.location&&window.location.href){var e=window.location.href,r=e.indexOf("https://");t=-1!=t.indexOf("https://")||-1!=t.indexOf("http://")?-1!=r?t.replace("http://","https://"):t.replace("https://","http://"):-1!=r?"https://"+t:"http://"+t}return t},e.prototype.initVersionInfo=function(t){if(t){var e=this._versionInfo=this._versionInfo||{};for(var r in t){var n=t[r]||{};for(var o in n){var i=n[o];o.indexOf(".")<0&&(o+=".png"),e[(r+"/"+o).toLowerCase()]={v:i[0],s:i[1]}}}}},e}();t.VersionCtrl=e,__reflect(e.prototype,"mo.VersionCtrl",["RES.VersionController","RES.IVersionController"]);var r=function(e){function r(){return e.apply(this,arguments)||this}return __extends(r,e),r.prototype.getVirtualUrl=function(e){if(!e)return null;var r=t.PATH.join(e).toLowerCase(),n=this._versionInfo||{},o=n[r],i=t.PROJ.cdn||"";if(i=this.checkHttps_native(i),o){var a=o.v,s=o.s;return i+"resource/"+a.substring(0,2)+"/"+a+"_"+s+"."+r.substring(r.lastIndexOf(".")+1)}return e},r.prototype.getList1=function(t,e,r){void 0===r&&(r="");var n=egret.PromiseObject.create();n.onSuccessFunc=function(e){t(e)},n.onErrorFunc=function(){console.error("list files error")},"assets"==e?egret_native.Game.listResource(r,n):egret_native.Game.listUpdate(r,n)},r.prototype.getLocalData1=function(t){if(egret_native.readUpdateFileSync&&egret_native.readResourceFileSync)try{var e=egret_native.readUpdateFileSync(t);if(null!=e)return JSON.parse(e);if(e=egret_native.readResourceFileSync(t),null!=e)return JSON.parse(e)}catch(r){return null}return null},r.prototype.fetchVersion=function(t){var e=this;if(e._versionPath="all.manifest",e._versionInfo=e.getLocalData1(e._versionPath),null==e._versionInfo)return void egret.callLater(function(){t.onFail(1,null)},e);var r=0,n=function(n){if(n)for(var o=0;o<n.length;o++)n[o]&&""!=n[o]&&e._localFileArr.push("resource/"+n[o]);r++,2==r&&t.onSuccess(null)};e.getList1(n,"assets","resource"),e.getList1(n,"update","resource")},r.prototype.checkHttps_native=function(t){return t.length>0&&(t=-1!=t.indexOf("https://")||-1!=t.indexOf("http://")?t.replace("https://","http://"):"http://"+t),t},r}(RES["native"].NativeVersionController);t.VersionCtrl_Native=r,__reflect(r.prototype,"mo.VersionCtrl_Native")}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e;!function(e){t.LOG.initLogger(t.NET,"mo.NET");var r=function(t){function e(){return t.apply(this,arguments)||this}return __extends(e,t),e.prototype.send=function(){},e.prototype.$$reset=function(t){var e=this;e.iface=t.iface,e.args=t.args,e.onSuccess=t.onSuccess,e.onError=t.onError,e.ctx=t.ctx},e.prototype.$$recycle=function(){var t=this;t.url=t.iface=t.args=t.onSuccess=t.onError=t.ctx=t.net=null},e}(t.Emitter);e.BaseReqHandler=r,__reflect(r.prototype,"mo.NET.BaseReqHandler")}(e=t.NET||(t.NET={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e;!function(e){var r=function(r){function n(){return r.apply(this,arguments)||this}return __extends(n,r),n.prototype._initProp=function(){r.prototype._initProp.call(this);var t=this;t.method="POST"},n.prototype._getParams=function(){var e=this,r={},n=e.iface,o=n.indexOf("."),i=n.substring(o+1),a=e.net?e.net.token:null,s=e.args||{},u=s.$fileMap;if(!t.OBJ.isEmpty(u)){var l={};for(var c in s)"$fileMap"!=c&&(l[c]=s[c]);s=l}var p=JSON.stringify([i,s,a]),f=e.net,_=f?f.cryptoKey:null;_=_||t.PROJ.cryptoKey,f&&f.cryptoEnabled&&(p=t.CRYPTO.enCharCode(p,_));var h=t.MD5.sign(p,_);return r.a=p,r.sign=h,t.OBJ.isEmpty(u)||(r.$fileMap=u),r},n.prototype.send=function(){var t=this,r=t.net,n=t._getParams(),o=t.iface,i=o.indexOf("."),a=o.substring(0,i),s=t.url?t.url.trim():"";""==s?s+="/"+a:0==s.indexOf("/")?s+=a:0!=s.indexOf("http://")&&0!=s.indexOf("https://")?(s="http://"+s,s+="/"+a):s+="/"+a,e.request(s,t.method,n,function(n,o){if(n){var i=r?r.handleRspErr(n):n;e.log("rsp error--->",i),t.onError&&t.onError.call(t.ctx,i,t)}else{var a=r?r.handleRspStr(o):o;e.log("rsp success--->",a),t.onSuccess&&t.onSuccess.call(t.ctx,a,t)}})},n}(e.BaseReqHandler);e.HttpReqHandler=r,__reflect(r.prototype,"mo.NET.HttpReqHandler")}(e=t.NET||(t.NET={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e;!function(e){var r=function(e){function r(){return e.apply(this,arguments)||this}return __extends(r,e),r.prototype._initProp=function(){e.prototype._initProp.call(this);var r=this;r.cryptoEnabled=!0;var n=r._handlerPool=new t.Pool;n.onCreate(function(){return new r._handlerClass}),n.onReset(function(t){t.net=r,t.url=r.url})},r.prototype.handleRspStr=function(t){return t},r.prototype.handleRspErr=function(t){return t},r.prototype._handleRsp=function(e,r,n,o,i,a){var s=n.m,u=n.v,l=n.e;l&&(u=t.CRYPTO.decryptoDataFromClientKey(t.PROJ.strIV,l));var c,p=n.d;if(null!=u&&p&&(c=t.CRYPTO.deCharCode(p),u=t.DS.deCode(u,c)),c&&this.mgr.emit(c,e,r,u,!!s),s){var f={};f.route=e,f.args=r,f.rsp=n,t.emitter.emit("eLogSendExceptionLog",f),(t.OBJ.isEmpty(r)||!r.$noShowErr)&&(console.error("mo net error:",s),s instanceof Array?t.MSG.show.apply(t.MSG,s):t.MSG.show(s)),i&&i.call(a,s)}else o&&o.call(a,u,c),u&&u.$msg$&&(console.error("mo net error:",u),t.MSG.show(u.$msg$))},r.prototype._request=function(t,e,r){var n=this,o=function(t,e){n._handlerPool.rm(e),r(t)};n._handlerPool.get({iface:t,args:e,onSuccess:o,onError:o}).send()},r.prototype.request=function(t,e,r,n){this.requestWithErr(t,e,r,null,n)},r.prototype.requestWithErr=function(t,e,r,n,o){var i=this;i._request(t,e,function(a){i._handleRsp(t,e,a,r,n,o)})},r}(t.Emitter);e.BaseNet=r,__reflect(r.prototype,"mo.NET.BaseNet")}(e=t.NET||(t.NET={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e;!function(e){var r=function(r){function n(){return r.apply(this,arguments)||this}return __extends(n,r),n.prototype._initProp=function(){r.prototype._initProp.call(this);var t=this;t._handlerClass=e.HttpReqHandler},n.prototype.handleRspStr=function(t){try{return JSON.parse(t)}catch(r){return e.error(r),{m:"返回数据结构有误！"}}},n.prototype.handleRspErr=function(){return{m:t.D.langCodeToTxt("internet_unstable")}},n}(e.BaseNet);e.HttpNet=r,__reflect(r.prototype,"mo.NET.HttpNet")}(e=t.NET||(t.NET={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e;!function(t){t.cryptoKey="百家樂-龍虎-骰寶-輪盤-xjslpfbhlalbl",t.clientBaseKey="749afa94c30e081ddd5cc61220e736ad",t.strIV="eBetBaccaratGame",t.registerValueHandler(function(e){t.setValue(e,"cryptoKey"),t.setValue(e,"clientBaseKey")})}(e=t.PROJ||(t.PROJ={}))}(mo||(mo={})),function(t){var e;!function(e){var r=function(e){function r(){return e.apply(this,arguments)||this}return __extends(r,e),Object.defineProperty(r.prototype,"net",{get:function(){return this._net},set:function(t){this._net=t,t.mgr=this},enumerable:!0,configurable:!0}),r.prototype.pause=function(){this._paused=!0},r.prototype.resume=function(){this._paused=!1},r.prototype.onArgs=function(t){this._argsHandler=t},r.prototype.request=function(t,e,r,n){var o=this;o._paused||(o._argsHandler&&o._argsHandler(t,e),o.requestWithErr(t,e,r,null,n))},r.prototype.requestWithErr=function(t,e,r,n,o){var i=this;i._paused||(i._argsHandler&&i._argsHandler(t,e),i.net.requestWithErr(t,e,r,n,o))},r.prototype.wait=function(t,e,r,n,o){var i=this;i._paused||i.waitWithErr(t,e,r,function(){},n,o)},r.prototype.waitWithErr=function(e,r,n,o,i,a){var s=this;s._paused||("gts.behavior.clientBehavior"==e?a?t.playWaiting(a):t.playWaiting():"gts.table.getMultiRangeList"==e||"gts.table.enterMultiBaccarat"==e||"gts.moneyHist.getHistList"==e||"gts.betStrategy.getRoulette"==e||"gts.table.enterTableList"==e||"gts.table.enterTable"==e||"gts.table.exitTableList"==e||"gts.table.exitTable"==e||"gts.table.getLastTable"==e||"gts.slot.getCasinoGames"==e||"gw.index.getChannelByCode"==e||"gw.index.login"==e||"common.index.loginByToken"==e||"gts.table.getMatchRankList"==e?t.playWaiting(1):"gts.table.giveFee"==e||"gts.betStrategy.modifyRoulette"==e||"gts.user.changeNick"==e?t.playWaiting(2):"gts.table.bet"==e||"gts.bet.getHistListWithPage"==e?t.playWaiting(4):t.playWaiting(),s.requestWithErr(e,r,function(){t.stopWaiting(),n&&n.apply(i,arguments)},function(){t.stopWaiting(),o&&o.apply(i,arguments)}))},r.prototype.onNotify=function(t,e,r){this.on("notify:"+t,e,r)},r.prototype.unNotify=function(t,e,r){this.un("notify:"+t,e,r)},r.prototype.notify=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=["notify:"+t].concat(e);this.emit.apply(this,n)},r}(t.Emitter);e.NetMgr=r,__reflect(r.prototype,"mo.NET.NetMgr"),e.mgr=new r,e.mainMgr=new r,e.serverMgr=new r,e.gwMgr=e.mainMgr,e.gsMgr=e.serverMgr}(e=t.NET||(t.NET={}))}(mo||(mo={}));var mo;!function(t){var e;!function(t){t.resLimit=100,t.resReleaseEnabled=!0,t.registerValueHandler(function(e){t.setValue(e,"resLimit"),t.setValue(e,"resReleaseEnabled",!0)})}(e=t.PROJ||(t.PROJ={}))}(mo||(mo={})),function(t){var e;!function(e){var r;!function(){t.LOG.initLogger(t.LOG.R,"mo.LOG.R"),t.LOG.setLvl("mo.LOG.R",3)}(r=e.R||(e.R={}))}(e=t.LOG||(t.LOG={}))}(mo||(mo={})),function(t){function e(e){if(e)for(var r=0,o=e.length;o>r;r++){var i=e[r];i&&(".sht"!=t.PATH.extname(i)&&(i+=".sht"),n.indexOf(i)<0&&n.push(i))}}function r(){return n}var n=[];t.addShtList=e,t.getShtList=r,t.PROJ.emitter.on(t.PROJ.AFTER_CFG,function(){RES.setMaxLoadingThread(t.PROJ.resLimit)})}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e=function(e){function r(){return e.apply(this,arguments)||this}return __extends(r,e),r.prototype.registerLoader=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];for(var n=this,o=n._loaderMap,i=0,a=e.length;a>i;i++){var s=e[i];o[s]=new t,o[s].type=s}},r.prototype.getLoader=function(t){return t="."==t[0]?t.substring(1):t,this._loaderMap[t]},r.prototype.registerType=function(t,e){var r=this;r._itemTypeMap[t]=e},r.prototype._initProp=function(){e.prototype._initProp.call(this);var t=this,r=RES.ResourceItem,n=RES.ResourceEvent,o=t._grpCbMap={};t.map={},t._handlerMap={},t._unloadHandlerMap={},t._cfgHandlerMap={},t._globalMap={},t.typeMap={".json":r.TYPE_JSON,".png":r.TYPE_IMAGE,".jpg":r.TYPE_IMAGE,".mp3":r.TYPE_SOUND,".ogg":r.TYPE_SOUND,".fnt":r.TYPE_FONT},t.scatteredList=[],t._ignores=[],t._keyMap={},t.moduleInfoMap={},t._resCounter={},t._waitingMap={},t._loadedMap={},t._subResCfgMap={},t._urlHandlerMap={},t.canReturn=!0,t._loaderMap={},t._itemTypeMap={},t._uiCfgMap={},t._keyUiMap={},t._s9gMap={},t._langInfoMap={},t._uiPath="ui",t._useOgg=!1,RES.addEventListener(n.GROUP_COMPLETE,function(t){var e=t.groupName,r=o[e];delete o[e],r&&r()},null),RES.addEventListener(n.GROUP_LOAD_ERROR,function(t){var e=t.groupName,r=o[e];delete o[e],r&&r("error")},null)},r.prototype.registerHandler=function(t,e,r){this._handlerMap[t.toLowerCase()]=e,this._unloadHandlerMap[t.toLowerCase()]=r},r.prototype.registerCfgHandler=function(t,e){this._cfgHandlerMap[t]=e},r.prototype.registerUrlHandler=function(t,e){this._urlHandlerMap[t]=e},r.prototype.setIgnores=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=this._ignores,n=0,o=t.length;o>n;n++){var i=t[n];r.indexOf(i)<0&&r.push(i)}},r.prototype.rmIgnores=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=this._ignores,n=0,o=t.length;o>n;n++){var i=t[n],a=r.indexOf(i);a>=0&&r.splice(a,1)}},r.prototype.addSubResCfg=function(t,e){this._subResCfgMap[t]=e},r.prototype.get=function(e){var r,n=this,o=n._itemTypeMap,i=n._loaderMap;e&&(e=e.toLowerCase());var a;if(o[e]&&(a=i[o[e]]),!a){var s=t.PATH.extname(e);s&&(a=i[s.substring(1)])}if(a)return a.get(e);var u=n.toFinalUrl(e);try{if(r=RES.getRes(u))return r}catch(l){}var c=this._subResCfgMap[e];if(c){var p=n.toFinalUrl(c),f=RES.getRes(p);if(f&&f.get)return f.get(e)}return null},r.prototype.addToCfg=function(e){var r=e.url,n=e.res;t.LOG.R.debug("addToCfg--->",n,r);var o=this,i=o.typeMap,a=o._keyMap;if(a[r])return a[r];var s=t.PATH.extname(r);if(!s)return null;s=s.toLowerCase();var u=i[s]||s.substring(1),l={name:r,url:r,type:u},c=o._s9gMap[e.res];if(c&&(l.scale9grid=c),u){var p=o._cfgHandlerMap[u];p&&p(l,e)}return RES.parseConfig({resources:[l]},"resource/"),a[r]=l,l},r.prototype.addS9gCfg=function(e){t.OBJ.merge(this._s9gMap,e)},r.prototype.getS9g=function(t){return this._s9gMap[t]},r.prototype.setGlobal=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=this,n=r._globalMap,o=0,i=t.length;i>o;++o){var a=t[o];void 0===n[a]&&(n[a]=!1)}},r.prototype.getStatusRes=function(t,e,r){var n=this,o=n.get(t);return o?e.call(r,o):void n.load(t,function(){o=n.get(t),e.call(r,o)})},r.prototype.washResources=function(t,e){for(var r=this,n=t instanceof Array?t:[t],o=[],i=(r._ignores,r._loadedMap),a={},s=0,u=n.length;u>s;++s){var l=n[s];if(!a[l]){if("string"==typeof l){var c=r.getResItemCfg(l,e);if(i[c.url]){r.countWithItemCfg(c);continue}r.addToCfg(c),o.push(c)}a[l]=1}}return o},r.prototype.load=function(t,e,r){return this.loadTo(this.moduleName,t,e,r)},r.prototype.loadTo=function(e,r,n,o){var i=this,a=i.washResources(r,e),s=i._handlerMap,u=i._globalMap,l=i._waitingMap,c=i._loadedMap;try{t.CHAIN.begin(a).each(function(e,r,n){var o=e.res,a=e.url;if(void 0===u[o]&&i.countWithItemCfg(e),i.once(o,function(){i.emit("singleRes",arguments[arguments.length-2]),n()},e),i._itemTypeMap[o])return void i.emit(o);if(c[a])return void i.emit(o);if(!l[a]){t.LOG.R.debug("加载资源--->",a),l[a]=!0;var p=i.get(o);if(p)return void i._onResLoaded(null,e);var f=t.PATH.extname(o);if(f){f=f.toLowerCase();var _=i.getLoader(f);if(_)return void _.loadByResItemCfg(e,function(){i._onResLoaded(null,e)});var h=s[f];if(h)return h(o,function(t){i._onResLoaded(t,e)});if(i._loaderMap[f.substring(1)])return void i._onResLoaded(null,e)}RES.getResAsync(a,function(t,r){i._onResLoaded(t?null:"资源加载失败："+r,e)},null)}}).end(function(){i.canReturn&&n&&n.call(o)})}catch(p){}return a.length},r.prototype._onResLoaded=function(e,r){var n=this,o=n._globalMap,i=n._resCounter,a=n._loadedMap,s=r.res,u=r.url,l=i[u]||0;if(delete n._waitingMap[u],!e)if(void 0!==o[s])o[s]=!0,a[u]=!0;else if(0>=l){delete a[u];var c=t.PATH.extname(s),p=!0;if(c){var f=n._unloadHandlerMap[c];if(f)f(s),p=!1;else{var _=n.getLoader(c);_&&(_.destroyRes(s),p=!1)}}p&&RES.destroyRes(u)}else a[s]=!0;n.emit(s,e)},r.prototype.countWithItemCfg=function(e,r){if(e){var n=this,o=e.res,i=e.url,a=e.moduleName,s=n._globalMap,u=n._resCounter;if(void 0===s[o]){a=a||n.moduleName,a=a||"default";var l=n.moduleInfoMap,c=l[a];c||(c=l[a]={}),r=null==r?1:r;var p=c[o]=c[o]||{};p[i]=(p[i]||0)+r,u[i]=(u[i]||0)+r,u[i]>0&&t.LOG.R.debug("countRes--->",i,u[i])}}},r.prototype.unload=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];1==r.length&&r[0]instanceof Array&&(r=r[0]);var o=this;e=e||o.moduleName||"default";var i=o.moduleInfoMap,a=i[e],s=o._globalMap,u=o._resCounter,l=[];if(a){t.LOG.R.debug("正在释放模块--->",e);for(var c=0,p=r.length;p>c;++c){var f=r[c],_=a[f];if(delete a[f],o._validRelease(f)&&void 0===s[f])for(var h in _){var g=_[h];g&&u[h]&&(u[h]-=g,u[h]<=0&&(delete u[h],l.push(h)))}}for(var c=0,p=l.length;p>c;++c)o._destroyRes(l[c])}},r.prototype._destroyRes=function(e){var r=this,n=typeof e;
if("string"!=n||!r._judgeStoreFunc||!r._judgeStoreFunc(e)){t.LOG.R.debug("开始释放资源---->",e);var o=r._unloadHandlerMap,i=r._loadedMap;delete i[e];var a,s="string"==n?t.PATH.extname(e):null;if(s){var u=o[s];if(u)return void u(e);if(a=r.getLoader(s))return a.destroyRes(e)}return(a=r._loaderMap[r._itemTypeMap[e]])?a.destroyRes(e):void RES.destroyRes(e)}},r.prototype.onJudgeStore=function(t){this._judgeStoreFunc=t},r.prototype.unloadModule=function(e){var r=this;e=e||r.moduleName||"default";var n=r.moduleInfoMap,o=n[e],i=r._globalMap,a=r._resCounter,s=[];if(o){t.LOG.R.debug("正在释放模块--->",e);for(var u in o){var l=o[u];if(delete o[u],r._validRelease(u)&&void 0===i[u])for(var c in l){var p=l[c];p&&a[c]&&(a[c]-=p,a[c]<=0&&(delete a[c],s.push(c)))}}for(var f=0,_=s.length;_>f;++f)r._destroyRes(s[f])}},r.prototype.getRemoteImg=function(e,r,n){var o=this,i=o._remoteCache=o._remoteCache||{},a=o._gettingRemoteMap=o._gettingRemoteMap||{},s=o._remoteImgEmitter=o._remoteImgEmitter||new t.Emitter;if(!e)return r.call(n,null,e);t.LOG.R.debug("getRemoteImg--->",e);var u=i[e]||o.get(e);if(u)r.call(n,u,e);else if(s.once(e,r,n),!a[e]){var l=0==e.indexOf("http://")||0==e.indexOf("https://");l?RES.getResByUrl(e,function(r){i[e]=r,delete a[e],t.LOG.R.debug("remoteMode",e,r),s.emit(e,r,e)},null,RES.ResourceItem.TYPE_IMAGE):o.load([e],function(){u=o.get(e),delete a[e],t.LOG.R.debug("not remoteMode",e,u),s.emit(e,u,e)})}},r.prototype.onValidRelease=function(t,e){this._onValidRelease=t,this._onValidReleaseCtx=e},r.prototype._validRelease=function(e){var r=this;return t.PROJ.resReleaseEnabled?r._onValidRelease&&r._onValidRelease.call(r._onValidReleaseCtx,e)===!1?!1:!0:!1},r.prototype.loadUiCfg=function(e,r){var n=this;t.OBJ.merge(n._uiCfgMap,e),r&&(n._uiPath=r)},r.prototype.registerLangInfo=function(e,r){if(r){var n=this,o=n._langInfoMap,i=o[e]=o[e]||{};t.OBJ.merge(i,r)}},r.prototype.isLangRes=function(e){if(!e)return!1;var r=this,n=t.PROJ.lang;if(n){var o=r._langInfoMap;return o[n]&&o[n][e.toLowerCase()]}return!1},r.prototype.toFinalUrl=function(e){var r=this;if(!e)return null;if("string"!=typeof e)return null;e=e.toLowerCase();var n=t.PATH.extname(e),o=r.isLangRes(e),i=t.PROJ.lang,a=e;if(!n){a=r._uiPath+"/"+a;var s=r._uiCfgMap;n=".png";for(var u in s)if(!r._useOgg||"mp3"!=u){var l=s[u];if(l&&l.indexOf(e)>=0){n="."+u;break}}a+=n}var c=t.PATH.extname(a).substring(1),p=r._urlHandlerMap[c];return p&&(a=p({url:a})),o&&(a=i+"/"+a),a},r.prototype.getResItemCfg=function(e,r){var n=this,o={};return o.res=e,o.url=n.toFinalUrl(e),o.moduleName=r||n.moduleName||"default",t.PROJ.lang&&(o.lang=t.PROJ.lang),o},r.prototype.loadCfg4Loader=function(e,r,n){var o=this._loaderMap[e];return o?void o.loadCfg(r,n):void t.warn("不存在【%s】类型的loader",e)},r.prototype.useOgg=function(){var t=this;t._useOgg=!0},r}(t.Emitter);t.Res_lang=e,__reflect(e.prototype,"mo.Res_lang"),t.R=new e}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e=function(e){function r(t){var r=e.call(this)||this,n=r;return t&&n.setFrames(t),r}return __extends(r,e),r.prototype._initProp=function(){e.prototype._initProp.call(this);var t=this;t._textureMap={},t.$texture=new egret.Texture,t._usingList=[]},r.prototype.setFrames=function(t){var e=this;e._frames=t},r.prototype.loadTexture=function(t){if(t){var e=this,r=e._textureMap,n=e._frames,o=e.$texture,i=(e._usingList,t.bitmapData);o._bitmapData=i,o.$initData(0,0,t._bitmapWidth,t._bitmapHeight,0,0,t.textureWidth,t.textureHeight,t._sourceWidth,t._sourceHeight);for(var a=0,s=n.length;s>a;a++){var u=n[a],l=u[0],c=r[l];c&&e._doSingle(l,u,!0)}}},r.prototype._doSingle=function(e,r,n){if(!r)return null;var o=this,i=o._textureMap,a=o.$texture,s=o._usingList,u=i[e];u||(u=i[e]=new egret.Texture);var l=r[1],c=r[2],p=r[3],f=r[4],_=r[5]||p,h=r[6]||f,g=0,d=0;a._bitmapData&&(g=a._sourceWidth,d=a._sourceHeight,u._bitmapData=a._bitmapData),u.$initData(l,c,p,f,0,0,_,h,g,d);var y=t.R.getS9g(e);if(y){var v=y.split(",");u.scale9Grid=new egret.Rectangle(parseInt(v[0]),parseInt(v[1]),parseInt(v[2]),parseInt(v[3]))}return u.fromSht=1,s.indexOf(e)<0&&s.push(e),n&&(t.R.emit("freshTexture_"+e,e),u.fromSht=0),u},r.prototype.getTexture=function(t){for(var e=this,r=e._frames,n=null,o=0,i=r.length;i>o;o++){var a=r[o];if(t==a[0]){n=a;break}}return e._doSingle(t,n)},r.prototype.dispose=function(){var e=this,r=e._textureMap;if(void 0===t.R._globalMap[e.name]){e.$texture.dispose();for(var n in r){var o=r[n];o.dispose()}}},r.prototype.disposeTexture=function(e){var r=this,n=r._usingList;t.LOG.R.debug("disposeTexture---->",r.name,e);var o=n.indexOf(e);o>=0&&n.splice(o,1),0==n.length&&r.dispose()},r}(t.Emitter);t.Sht=e,__reflect(e.prototype,"mo.Sht")}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){egret.Bitmap.prototype.$setBitmapData=function(t){var e=this,r=e.$Bitmap,n=r[0];if(!(t!=n||n&&n.fromSht))return!1;if(r[0]=t,!t)return n&&egret.BitmapData.$removeDisplayObject(e,n),e.setImageData(null,0,0,0,0,0,0,0,0,0,0),e.$invalidateContentBounds(),!0;if(e.$refreshImageData(),e.$stage){if(n){var o=void 0;o=n._bitmapData&&n._bitmapData.hashCode?n._bitmapData.hashCode:n.hashCode;var i=void 0;if(i=t._bitmapData&&t._bitmapData.hashCode?t._bitmapData.hashCode:t.hashCode,o==i)return e.$invalidateContentBounds(),!0;egret.BitmapData.$removeDisplayObject(e,n)}egret.BitmapData.$addDisplayObject(e,t)}return e.$invalidateContentBounds(),!0},egret.ImageLoader.crossOrigin="Anonymous";var e=function(e){function r(){return e.apply(this,arguments)||this}return __extends(r,e),r.prototype._initProp=function(){e.prototype._initProp.call(this);var t=this;t._subMap={}},r.prototype._initSubCfg=function(){},r.prototype.initSubMap=function(){var e=this;t.eachData(e.type,e._initSubCfg,e)},r.prototype.get=function(){return null},r.prototype.destroyRes=function(){},r.prototype.loadCfg=function(t,e){var r=this;if(t)for(var n in t)r._initSubCfg(t[n],n,e)},r}(t.Emitter);t.ResLoader=e,__reflect(e.prototype,"mo.ResLoader");var r=function(e){function r(){return e.apply(this,arguments)||this}return __extends(r,e),r.prototype._initProp=function(){e.prototype._initProp.call(this);var t=this;t._statusMap={},t.fileDic={},t.fileDic["default"]={},t._loadingMap={}},r.prototype._getContentInDic=function(t,e){var r=this.fileDic,n=e||"default",o=r[n];return o&&o[t]?o[t]:(o=r["default"],o?o[t]:null)},r.prototype._initSubCfg=function(e,r,n){var o=this,i=o.type,a=n||"default";r+="."+i;var s=o.fileDic[a]=o.fileDic[a]||{},u=o._subMap[a]=o._subMap[a]||{};s[r]=new t.Sht(e),s[r].name=r;for(var l=0,c=e.length;c>l;l++){var p=e[l],f=p[0];u[f]=r,t.R.registerType(f,i)}},r.prototype._loadShtImg=function(e,r){var n=this,o=n._loadingMap;if(!o[r]){var i={name:r,url:r,type:"image"},a=t.R._urlHandlerMap[n.type];a&&(i.url=a(i)),RES.parseConfig({resources:[i]},"resource/"),o[r]=1,RES.getResAsync(r,function(t){delete o[r],t&&e.loadTexture(t),n.emit(r)},null)}},r.prototype._loadShtImg2=function(t,e,r){var n=this,o=n._loadingMap,i=e;if("default"!=r&&(i=r+"/"+e),!o[i]){var a={name:i,url:i,type:"image"};RES.parseConfig({resources:[a]},"resource/"),o[i]=1,RES.getResAsync(i,function(r){delete o[i],r&&t.loadTexture(r),n.emit(e)},null)}},r.prototype.load=function(t,e,r){var n=this,o=(n._loadingMap,n.fileDic["default"][t]);if(!o)throw"sht cnt be null["+t+"]";o&&o.$texture._bitmapData?e&&e.call(r):(n.once(t,function(){e&&e.call(r)}),n._loadShtImg(o,t))},r.prototype.loadByResItemCfg=function(t,e,r){var n=this,o=(n._loadingMap,t.url),i=t.res,a=t.lang,s=n.fileDic[a]||{},u=s[i];if(u||(a="default",s=n.fileDic[a]||{},u=s[i]),!u)throw"sht cnt be null["+i+"]";u.$texture._bitmapData?e&&e.call(r):(n.once(o,function(){e&&e.call(r)}),n._loadShtImg2(u,o,a))},r.prototype.get=function(e){var r=this,n=t.PROJ.lang||"default",o=r._subMap[n],i=null;if(o&&(i=o[e]),i||(o=r._subMap["default"],o&&(i=o[e])),!i)return null;var a=r._getContentInDic(i,t.PROJ.lang);return a?a.getTexture(e):null},r.prototype.destroyRes=function(e){var r=this,n=r._getContentInDic(e,t.PROJ.lang);n&&n.dispose()},r}(e);t.ShtLoader=r,__reflect(r.prototype,"mo.ShtLoader"),t.R.registerLoader(r,"sht"),t.R.registerUrlHandler("sht",function(e){return t.PATH.changeExtname(e.url,".png")})}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e=function(t){function e(){return t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"paused",{get:function(){return!!this._paused},set:function(t){this._paused=t},enumerable:!0,configurable:!0}),e.prototype._initProp=function(){t.prototype._initProp.call(this);var e=this;e._passedTime=0,e.curIndex=-1,e.cost=e.__class.DEFAULT_COST,e.totalFrameCount=1,e._frameListenerInfoList=[],e._resetListenerInfoList=[],e.curLoopIndex=0,e.loopCount=0},e.prototype.onFrameEvent=function(t,e){this._onFrameListener=t,this._onFrameCtx=e},e.prototype.loop=function(t,e){var r=this;if(!(r.loopCount>0&&r.loopCount<=r.curLoopIndex||r._paused)){r._passedTime+=t;var n=r.cost;if(e=e||Math.floor(r._passedTime/n),e>0){var o=r.totalFrameCount-1,i=r.curIndex;i>=o&&(i=-1);var a=r.curIndex+e;a=0>=o?0:a%(o+1),r._passedTime-=e*n,r.curIndex=a;for(var s=r._frameListenerInfoList,u=0,l=s.length;l>u;u++){var c=s[u];c&&c[0]&&c[0].call(c[1],a,e)}for(var p=r.owner,f=r.__class.ON_END,u=0;e>u;++u){i++;var _=r._onFrameListener,h=r._onFrameCtx;if(i>=o){i=-1;var g=i;_&&_.call(h,g,r.curLoopIndex,!0),r.emit(g+"",r.curLoopIndex,p),r.emit(f,r.curLoopIndex,p),r.curLoopIndex++}else _&&_.call(h,i,r.curLoopIndex,!1),r.emit(i+"",r.curLoopIndex,p)}}}},e.prototype.onFrame=function(t,e){for(var r=this,n=r._frameListenerInfoList,o=0,i=n.length;i>o;o++){var a=n[o];if(a&&a[0]==t&&a[1]==e)return}n.push([t,e])},e.prototype.registerTicker=function(t){this.registerTimer(t)},e.prototype.unRegisterTicker=function(){this.unRegisterTimer()},e.prototype.registerTimer=function(t){var e=this;t&&t!=e._timer&&(e._timer&&e._timer.clearTick(e.loop,e),t.tick(e.loop,e),e._timer=t)},e.prototype.unRegisterTimer=function(){var t=this;t._timer&&t._timer.clearTick(t.loop,t),t._timer=null},e.prototype.reset=function(){var t=this,e=t._resetListenerInfoList;t._passedTime=0,t.curIndex=-1,t.curLoopIndex=0;for(var r=0,n=e.length;n>r;r++){var o=e[r];o&&o[0]&&o[0].call(o[1])}},e.prototype.onReset=function(t,e){for(var r=this,n=r._resetListenerInfoList,o=0,i=n.length;i>o;o++){var a=n[o];if(a&&a[0]==t&&a[1]==e)return}n.push([t,e])},e}(t.Emitter);e.DEFAULT_COST=100,e.ON_END="ON_END",t.FrameLoop=e,__reflect(e.prototype,"mo.FrameLoop")}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e=function(e){function r(){var t=e.call(this)||this;return t._initProp(),t}return __extends(r,e),r.prototype._initProp=function(){var e=this;e.width=0,e.height=0,e._partMap={},e._partOffsetMap={};var r=e.frameLoop=new t.FrameLoop;r.owner=e,r.onFrame(e._onFrame,e),r.onReset(e._onReset,e)},r.prototype.onEnter=function(){},r.prototype.onExit=function(){},r.prototype.onEmitter=function(e,r,n){t.onEmitter(e,r,n,this)},r.prototype.unEmitter=function(){t.unEmitter(this)},r.prototype._onFrame=function(t,e){var r=this,n=r._partMap;for(var o in n){var i=n[o];i&&(i.increaseIndex(e),r._setPartOffset(o,i,t))}},r.prototype._onReset=function(){var t=this,e=t._partMap;for(var r in e){var n=e[r];n&&(n.playIndex(0),t._setPartOffset(r,n,0))}},r.prototype._setPartOffset=function(t,e,r){var n=this,o=n._partOffsetMap[t]||[],i=o[r]||[0,0];e.x=i[0],e.y=i[1]},r.prototype.addPart=function(e){var r=this,n=r._partMap;if(!n[e]){var o=n[e]=new t.Sprite;o.name=e,r.addChild(o)}return n[e]},r.prototype.setMovieData=function(t,e){var r=this,n=r.frameLoop;r.movieData=t,n.cost=t.cost||n.cost,r.mainPartName=t.main||r.mainPartName;var o=t.partMap||{},i=t.zMap||{};for(var a in o){var s=o[a],u=i[a],l=r.addPart(a);null!=u&&(l.zOrder=u),null==s?l.setCfg({}):(l.setCfg(s),a==r.mainPartName&&(n.totalFrameCount=s.frames.length))}r.refreshZOrder(),r.refreshBoneInfo(),e&&n.reset()},r.prototype.refreshBoneInfo=function(){var e=this,r=e._partOffsetMap,n=e.movieData.partMap;t.OBJ.empty(r);for(var o in n){var i=n[o];if(i){var a=i.bone;if(a)for(var s in a)r[s]=a[s]}}},r.prototype.refreshZOrder=function(){t.UTIL.getChildren(this).sort(function(t,e){return(t.zOrder||0)>(e.zOrder||0)?1:(t.zOrder||0)<(e.zOrder||0)?-1:0})},r.prototype.play=function(e,r,n,o){var i=this,a=i.frameLoop;o&&a.registerTicker(o),r&&i.setMovieData(r,!0);var s=t.FrameLoop.ON_END;i._onEndFunc&&a.un(s,i._onEndFunc,i),n>0&&(i._onEndFunc=function(t){t+1>=n&&i.autoRmWhenComplete&&(i.frameLoop.unRegisterTicker(),i.parent&&i.parent.removeChild(i))},a.once(s,i._onEndFunc,i)),e&&e!=i.parent&&(i.parent&&i.parent.removeChild(i),e.addChild(i)),a.loopCount=n},r.prototype.playOnce=function(t,e,r){this.play(t,e,1,r)},r}(t.Container);t.Movie=e,__reflect(e.prototype,"mo.Movie")}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e=function(e){function r(){var t=e.call(this)||this;return t._initProp(),t}return __extends(r,e),r.genGS=function(e,r){var n=this,o=n.prototype;t.__define(o,e,function(){return this.$$data[e]},function(n){var o=this,i=o.$$data[e],a="_set"+e.substring(0,1).toUpperCase()+e.substring(1),s=o[a];s?(s(n),n=o.$$data[e]):o.$$data[e]=n,r&&!t.ASSERT.equals(i,n)&&o.emit(e,n,i)})},r.genGsList=function(t,e){for(var r=0,n=t.length;n>r;r++){var o=t[r];this.genGS(o,e)}},r.prototype._initProp=function(){var e=this;e._store=new t.Store,e.$$data={},e.addEventListener(egret.Event.ADDED_TO_STAGE,function(){e.isEnter=!0,e.onEnter()},e),e.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){e.isEnter=!1,e.onExit()},e)},r.prototype.doDtor=function(){var t=this;t._hasDtored||(t._hasDtored=!0,t.dtor())},r.prototype.dtor=function(){this._store.doDtor()},r.prototype.rmSelf=function(){this.parent&&this.parent.removeChild(this)},r.prototype.onEnter=function(){},r.prototype.onExit=function(){},r.prototype.onEmitter=function(e,r,n){t.onEmitter(e,r,n,this)},r.prototype.unEmitter=function(){t.unEmitter(this)},r.prototype.on=function(){return this},r.prototype.onPriority=function(){return this},r.prototype.onAsync=function(){return this},r.prototype.onAsyncPriority=function(){return this},r.prototype.onNextTick=function(){return this},r.prototype.onPriorityNextTick=function(){return this},r.prototype.once=function(){return this},r.prototype.oncePriority=function(){return this},r.prototype.onceAsync=function(){return this},r.prototype.onceAsyncPriority=function(){return this},r.prototype.onceNextTick=function(){return this},r.prototype.oncePriorityNextTick=function(){return this},r.prototype.single=function(){return this},r.prototype.singleAsync=function(){return this},r.prototype.singleNextTick=function(){return this},r.prototype.un=function(){return this},r.prototype.unNextTick=function(){return this},r.prototype.unOnce=function(){return this},r.prototype.unOnceNextTick=function(){return this},r.prototype.unSingle=function(){return this},r.prototype.unSingleNextTick=function(){return this},r.prototype.unAll=function(){return this},r.prototype.unAllNextTick=function(){return this},r.prototype.unCtx=function(){},r.prototype._emitByListenerInfoArr=function(){},r.prototype.emit=function(){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return this},r.prototype.emitAsync=function(){for(var t=[],e=3;e<arguments.length;e++)t[e-3]=arguments[e];return this},r.prototype.emitNextTick=function(){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return this},r.prototype.emitBoth=function(){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return this},r.prototype.emitPhase=function(){for(var t=[],e=3;e<arguments.length;e++)t[e-3]=arguments[e];return this},r.prototype.emitPhaseNextTick=function(){for(var t=[],e=3;e<arguments.length;e++)t[e-3]=arguments[e];return this},r}(egret.Bitmap);e._store=new t.Store,t.BaseSprite=e,__reflect(e.prototype,"mo.BaseSprite",["mo.IEmitter"]),t.bindEmitterPrototype(e)}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e=function(e){function r(){return e.apply(this,arguments)||this}return __extends(r,e),r.prototype._initProp=function(){var r=this;e.prototype._initProp.call(this),r.shtCfgList=[],r.curIndex=0,r.zOrder=0,r._spriteCfg={},r._frameToEvents={},r.autoRes=!0,r._resArrToLoad=[];var n=r.frameLoop=new t.FrameLoop;n.owner=r,n.onFrame(r._onFrame,r),n.onReset(r._onReset,r),n.onFrameEvent(r._onFrameEvent,r),r.playCount=0},r.prototype._onFrameEvent=function(t,e,r){var n=this;n.emit(t+"",e),r&&n.emit(n.__class.ON_END,e)},r.prototype.reset=function(){var t=this;t.texture=null,t.shtCfgList.length=0,t._spriteCfg={},t._frameToEvents={},t.autoRes=!0,t.curIndex=0,t.isPlaying=!1,t._isTicking=!1,t.frameLoop.unRegisterTimer(),t._timer=null},r.prototype._onFrame=function(t){this.playIndex(t)},r.prototype._onReset=function(){this.playIndex(0)},r.prototype.setCfg=function(e){var r=this;r._spriteCfg=e;var n=e.frames||[],o=e.resName,i=r._resArrToLoad;if(i.length=0,o&&r.autoRes)if(o.indexOf("%s")>=0)for(var a=0,s=n.length;s>a;a++){var u=n[a],l=t.STR.format(o,null==u.resIndex?a:u.resIndex);i.push(l)}else i.push(o);t.R.load(i),t.OBJ.empty(r._frameToEvents);var c=r._frameToEvents,p=e.eventMap||{};for(var f in p){var _=p[f];if(null!=_){var h=c[_]=c[_]||[];h.push(f)}}},r.prototype._loadScatteredRes=function(e,r,n,o,i,a){i=i||{};var s=t.STR.format(n,i.n||o),u=t.R.get(s);return u?a(u):void 0},r.prototype._loadPackedRes=function(e,r,n,o,i,a){var s=this,u=t.R.get(n);if(u){var l=s._subTexture,c=u.textureWidth,p=u.textureHeight;l||(l=s._subTexture=new egret.Texture),l.__resName__!=n&&(l._bitmapData=u._bitmapData,l.$initData(0,0,c,p,0,0,c,p,u._sourceWidth,u._sourceHeight),l.__resName__=n),i=i||{},l._bitmapX=i.x||0,l._bitmapY=i.y||0,l._bitmapWidth=i.w||u.textureWidth,l._bitmapHeight=i.h||u.textureHeight,a(l)}},r.prototype.playIndex=function(t){var e=this;e.curIndex=t,e.isPlaying=!0;var r=e._spriteCfg,n=r.frames||[],o=n[t];if(!e.isEnter)return o;var i=r.resName,a=r.res||[];if(!o)return e.texture=null,e.width=0,e.height=0,e.anchorOffsetX=0,e.anchorOffsetY=0,null;var s=null==o.resIndex?t:o.resIndex,u=a[s];return e.toRemoveTextureWhenChanged&&(e.texture=null,null!=o.w&&(e.width=o.w),null!=o.h&&(e.height=o.h),null!=o.ax&&(e.anchorOffsetX=o.ax),null!=o.ay&&(e.anchorOffsetY=o.ay),null!=o.sx&&(e.scaleX=o.sx),null!=o.sy&&(e.scaleY=o.sy),null!=o.a&&(e.alpha=o.a),null!=o.r&&(e.rotation=o.r)),i.indexOf("%s")>=0?e._loadScatteredRes(t,o,i,s,u,function(t){e.texture=t,e.width=u.w||t.textureWidth,e.height=u.h||t.textureHeight,null!=o.ax&&(e.anchorOffsetX=o.ax),null!=o.ay&&(e.anchorOffsetY=o.ay),null!=o.sx&&(e.scaleX=o.sx),null!=o.sy&&(e.scaleY=o.sy),null!=o.a&&(e.alpha=o.a),null!=o.r&&(e.rotation=o.r)}):e._loadPackedRes(t,o,i,s,u,function(t){e.fillMode="clip",e.texture=t,e.width=u.w||t.textureWidth,e.height=u.h||t.textureHeight,null!=o.ax&&(e.anchorOffsetX=o.ax),null!=o.ay&&(e.anchorOffsetY=o.ay),null!=o.sx&&(e.scaleX=o.sx),null!=o.sy&&(e.scaleY=o.sy),null!=o.a&&(e.alpha=o.a),null!=o.r&&(e.rotation=o.r),e.$refreshImageData(),e.$invalidateContentBounds()}),o},r.prototype.increaseIndex=function(t){var e=this,r=e._spriteCfg.frames;!r||r.length<=0||e.playIndex((e.curIndex+t)%r.length)},r.prototype.onEnter=function(){e.prototype.onEnter.call(this);var r=this,n=r._resArrToLoad;t.R.load(n),r.playIndex(r.curIndex)},r.prototype.onExit=function(){e.prototype.onExit.call(this);var t=this;t.texture=null,t._subTexture=null},r.prototype.play=function(e,r){var n=this,o=t.PATH.basename(e,t.PATH.extname(e)),i=t.D.get("@sp",e)||t.D.get("@sp",o);if(i){i.resName=e,n.setCfg(i);var a=t.FrameLoop.ON_END,s=n.frameLoop;r=r||0,n._onEndFunc&&n.un(a,n._onEndFunc,n),n._onEndFunc=null,r>0&&(n._onEndFunc=function(t){t+1>=r&&(n._isTicking=!1,n._timer&&s.unRegisterTicker(),n.autoRmWhenComplete&&n.parent&&n.parent.removeChild(n))},n.once(a,n._onEndFunc,n));var u=n._spriteCfg?n._spriteCfg.frames||[]:[];s.reset(),s.totalFrameCount=u.length||1,s.loopCount=r;var l=n._timer;l?s.registerTicker(l):s._timer||s.registerTicker(t.custTimer),n._isTicking=!0,s.loop(0,1)}},r.prototype.registerTimer=function(t){var e=this;e._timer!=t&&(e._timer=t,e.frameLoop._timer&&e.frameLoop.registerTicker(t))},r}(t.BaseSprite);e.ON_END="ON_END",t.Sprite=e,__reflect(e.prototype,"mo.Sprite")}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e=function(e){function r(){return e.apply(this,arguments)||this}return __extends(r,e),r.prototype._initProp=function(){e.prototype._initProp.call(this);var r=this;r.width=0,r.height=0,r.boneData={},r._partMap={};var n=r._pool=new t.Pool;n.limit=10,n.onCreate(function(){return new t.Sprite}),n.onReset(function(t){t.reset()}),n.onRecycle(function(){})},r.prototype.setBoneData=function(t){var e=this;e.boneData=t},r.prototype._addPart=function(t){var e=this,r=e._partMap[t];return r||(r=e._partMap[t]=e._pool.get({})),e.addChild(r),r},r.prototype.clearPart=function(){var t=this,e=t._partMap;for(var r in e){var n=e[r];delete e[r],n&&(n.parent&&n.parent.removeChild(n),t._pool.rm(n))}},r.prototype.play=function(t){var e=this,r=e.boneData.slotMap||{};for(var n in t){var o=t[n],i=r[n];if(i){var a=e._addPart(n);if(a.setCfg(i.sprite),null!=o){var s=a.playIndex(o);a.x=s.x||0,a.y=s.y||0}else a.texture=null}}},r}(t.Container);t.Bone=e,__reflect(e.prototype,"mo.Bone");var r=function(r){function n(){return r.apply(this,arguments)||this}return __extends(n,r),n.prototype._initProp=function(){r.prototype._initProp.call(this);var e=this;e.width=0,e.height=0,e.movieData={},e._partMap={};var n=e.frameLoop=new t.FrameLoop;n.owner=e,n.onFrame(e._onFrame,e),n.onReset(e._onReset,e),n.onFrameEvent(e._onFrameEvent,e),e.playCount=0},n.prototype._onFrameEvent=function(t,e,r){var n=this,o=n.aniName;n.emit(t+"",e,o),r&&n.emit(n.__class.ON_END,e,o)},n.prototype.setData=function(t,r){var n=this;if(t){var o=n.movieData,i=o.boneMap=o.boneMap||{},a=t.boneMap||{},s=n._partMap;o.aniMap=JSON.parse(JSON.stringify(t.aniMap));for(var u in a){var l=a[u];if(null!=l){l=JSON.parse(JSON.stringify(l)),i[u]=l;var c=s[u];c||(c=s[u]=new e),c.setBoneData(l)}}for(var u in a){var l=a[u];if(null!=l){var c=s[u],p=l.parent,f=null;f=p?s[p]:n,!f&&c.parent?(c.parent.removeChild(c),delete s[u]):f&&(c.parent&&c.parent!=f&&c.parent.removeChild(c),f.addChild(c))}}r&&n.frameLoop.reset()}},n.prototype._onFrame=function(e){var r=this,n=r.aniName;if(n){var o=r.movieData.aniMap||{},i=o[n],a=r._partMap;if(i){var s=i.frames||[],u=s[e],l=r._partMap;if(u){var c=[];for(var p in u){var f=u[p],_=l[p];if(_&&null!=!f){null!=f.x&&(_.x=f.x+(_.boneData.x||0)),null!=f.y&&(_.y=f.y+(_.boneData.y||0)),null!=f.sx&&(_.scaleX=f.sx),null!=f.sy&&(_.scaleY=f.sy),null!=f.r&&(_.rotation=f.r),null!=f.a&&(_.alpha=f.a),null!=f.z&&(c.indexOf(_.parent)<0&&c.push(_.parent),_.zOrder=f.z);var h=f.slotMap;h&&_.play(h)}}for(var g=0,d=c.length;d>g;g++){var y=c[g];t.UTIL.getChildren(y).sort(function(t,e){return(t.zOrder||0)>(e.zOrder||0)?1:(t.zOrder||0)<(e.zOrder||0)?-1:0})}}}else for(var v in a){var m=a[v];m&&m.clearPart()}}},n.prototype._onReset=function(){var t=this,e=t._partMap;for(var r in e)e[r]},n.prototype.play=function(e,r){var n=this,o=t.FrameLoop.ON_END,i=n.frameLoop;r=r||0,n.aniName=e,n._onEndFunc&&n.un(o,n._onEndFunc,n),n._onEndFunc=null,r>0&&(n._onEndFunc=function(t){t+1>=r&&n.autoRmWhenComplete&&n.parent&&n.parent.removeChild(n)},n.once(o,n._onEndFunc,n)),i.reset();var a=n._partMap;for(var s in a){var u=a[s];u&&(u.rotation=0,u.clearPart())}var l=n.movieData.aniMap[e];l&&(i.totalFrameCount=l.frames.length,i.loopCount=r,i.loop(0,1))},n.prototype.getFrameCount=function(t){var e=this,r=e.movieData.aniMap[t];return r?r.frames.length||0:0},n}(t.Container);r.ON_END="ON_END",t.BoneMovie=r,__reflect(r.prototype,"mo.BoneMovie")}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},mo;!function(t){var e;!function(e){function r(){return e.parser.parse.apply(e.parser,arguments)}var n=function(){function t(t,e,r,n){var o=this;o.text=t,o.style={textColor:n,size:r,fontFamily:e}}return t}();e.UbbTextElement=n,__reflect(n.prototype,"mo.UBB.UbbTextElement",["egret.ITextElement"]);var o=function(){function e(){var t=this;t._attrNames=["style","color","font","size","bold","italic","stroke","strokeColor"],t._convertMap={color:t._convertColorFromStr,size:t._converNumberFromStr,bold:t._converBoolFromStr,italic:t._converBoolFromStr,stroke:t._converNumberFromStr,strokeColor:t._convertColorFromStr},t._keyMap={font:"fontFamily",size:"size",color:"textColor",bold:"bold",italic:"italic",stroke:"stroke",strokeColor:"strokeColor"},t._attrSetterMap={style:t._setStyle}}return e.prototype.setAttrs=function(t,e){for(var r=this,n={},o=0,i=e.length;i>o;o++){var a=e[o],s=a.split("=");n[s[0]]=s[1]}for(var u=r._attrNames,o=0,i=u.length;i>o;o++){var l=u[o],c=n[l];if(c){var p=r._convertMap[l];p&&(c=p.call(r,t,c));var f=r._keyMap[l]||l,_=r._attrSetterMap[f];_?_.call(r,t,c):t.style[f]=c}}},e.prototype._convertColorFromStr=function(e,r){r=r.trim().toLowerCase();var n=this.__class.colorMap[r];return n?n:0==r.indexOf("#")?t.NUM.hexToInt(r):0==r.indexOf("0x")?t.NUM.hexToInt("#"+r.substring(2)):parseInt(r)},e.prototype._converNumberFromStr=function(t,e){return parseInt(e)},e.prototype._converBoolFromStr=function(t,e){var r=parseInt(e);return isNaN(r)?"true"==e?!0:!1:r>0?!0:!1},e.prototype._setStyle=function(t,e){var r=egret.getImplementation("eui.Theme");if(r){var n=r.$getStyleConfig(e);if(n)for(var o in n)t.style[o]=n[o]}},e.prototype._parseTextFromStr=function(t){var e=/\](.*)\[\/ubb\]/g,r=e.exec(t);return r?r[1]:t},e.prototype.isUBB=function(t){return t&&(-1!==t.indexOf(e.UBB_TAG)||-1!==t.indexOf(e.LINE_BREAK_TAG))},e.prototype.parse=function(t,r,o,i){var a=this;if(a.isUBB(t)){for(var s=this,u=/^[^\[]+|\[ubb[^\]]*?\].*?\[\/ubb\]|[^\]]+$|[^\[\]]+/g,l=t.split(e.LINE_BREAK_TAG),c=void 0,p=[],f=0;f<l.length;f++){var _=l[f];if(null!=_)if(f>0&&p.push(new n("\n",r,o,i)),""!=_){c=_.match(u);for(var h=0;h<c.length;h++){var g=c[h],d=new n("",r,o,i);if(s.isUBB(g)){var y=s._parseTextFromStr(g),v="]"+y+"[/ubb]";g=g.replace(v,"");var m=g.match(/[^\s]+=[^\s\]]+/gi);m&&s.setAttrs(d,m),d.text=s.trans2Normal(y)}else d.text=g==s.__class.LINE_BREAK_TAG?"\n":g;p.push(d)}}else p.push(new n(" ",r,o,i))}return p}return t},e.prototype.trans2Normal=function(t){var e=t+"";return e.indexOf("&brkl;")>=0&&(e=e.replace(/&brkl;/g,"[")),e.indexOf("&brkr;")>=0&&(e=e.replace(/&brkr;/g,"]")),e.indexOf("&amp;")>=0&&(e=e.replace(/&amp;/g,"&")),e},e}();o.LINE_BREAK_TAG="[/br]",o.UBB_TAG="/ubb]",o.colorMap={white:16777215,yellow:16776960,blue:255,green:65280,red:16711680,magenta:16711935,black:0,orange:16744192,gray:3355443},e.UBBParser=o,__reflect(o.prototype,"mo.UBB.UBBParser"),e.parser=new o,e.parse=r}(e=t.UBB||(t.UBB={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){function e(e){return t.moduleConfig[e]}function r(e){e&&(t._validModuleFunc=e)}function n(e){t._moduleNotFoundFunc=e}t.moduleConfig={};var o=function(){function t(t){var e=this;e.name=t,e.subModules=[],e.resMap={},e.fullScrSBM=!1;var r=t.indexOf("Scene");e.isSubModule=!(r>=0&&r==t.length-5)}return t}();t.ModuleInfo=o,__reflect(o.prototype,"mo.ModuleInfo");var i=function(r){function n(){return r.apply(this,arguments)||this}return __extends(n,r),n.prototype._initProp=function(){r.prototype._initProp.call(this);var t=this;t._moduleStack=[],t._LoadingClassMap={},t._moduleSwiftTime=1e3,t._sceneShowWithoutAnimation={IndexScene:"IndexScene",VideoScene:"VideoScene",GsIndexScene:"GsIndexScene",GsTableScene:"GsTableScene"}},n.prototype.registerLoadingClass=function(t,e){this._LoadingClassMap[t]=e},n.prototype.isSubModule=function(t){return t.indexOf("Scene")!=t.length-5},n.prototype.runModule=function(){return this.run.apply(this,arguments)},n.prototype.pushModule=function(){return this.push.apply(this,arguments)},n.prototype.popModule=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.pop.apply(this,arguments)},n.prototype.run=function(){var t=Array.prototype.slice.call(arguments,0);t.splice(0,0,!0),this._runModule.apply(this,t)},n.prototype.push=function(){var t=Array.prototype.slice.call(arguments,0);t.splice(0,0,!1),this._runModule.apply(this,t)},n.prototype.rePush=function(){var t=Array.prototype.slice.call(arguments,0);this._reRunModule.apply(this,t)},n.prototype._runModule=function(r,n,i,a){var s=this,u=e(n);if(i=i||{},!u)return t.log("没有这个模块：%s",n),void(t._moduleNotFoundFunc&&t._moduleNotFoundFunc(n));var l,c=null,p=null,f=null,_=!1;if(l=s.curModule,l&&(c=l.target),!(t._validModuleFunc&&!t._validModuleFunc(u,i)||u._valid&&u._valid(i)===!1)){var h=u.targetClass,g=h.__className;p=new o(g),_=p.isSubModule,l&&(i.fromWhere=l.name),_?(p.parentModule=l,l.subModules.push(p),l.curSubModule=p):s.curModule=p;var d=s._LoadingClassMap[u.loadingType],y=d?d.create():null,v=u._preAsync||function(t,e){e()},m=y&&y.toHideUnder,E=function(){t.R.moduleName=p.name;var e=function(e){if(e)return s.curModule=l,c&&!c.parent&&c.reshow(),void(y?y.close():t.stopWaiting());for(var n=s._moduleStack,o=0;o<n.length;++o){var h=n[o];if(h.name==p.name)break}if(o<n.length){var g=l.target;for(g&&(g.isAutoDtor=!0,g.close());o<n.length-1;){var d=n.pop(),v=d.target;v&&(v.isAutoDtor=!0,v.close())}var E=n.pop();return s.curModule=E,t.R.moduleName=E.name,E&&E.target&&(E.target.moduleParam=i,E.target.reshow()),y?y.close():t.stopWaiting(),void t.emitter.emit(t.EVT.MODULE_CHANGED,E.name,l?l.name:null)}t.stopWaiting(),f=p.target=u.createView();var T=f.emitter;if(T&&T.once("dtor",function(){var e=this.moduleInfo,r=e.parentModule;if(s.curModule&&s.curModule.name==e.name||(t.debug("释放模块--->",e.name),t.R.unloadModule(e.name)),r){for(var n=r.curSubModule,o=r.subModules||[],i=0;i<o.length;){var a=o[i];
if(a==e){if(o.splice(i,1),o.length>0){var u=n.target;if(!u)continue;n=r.curSubModule=o[o.length-1],u.visible=!0,t.R.moduleName=n.name}break}i++}n==e&&(n=r.curSubModule=o.pop(),n&&(t.R.moduleName=n.name)),0==o.length&&(t.R.moduleName=r.name)}var l=e.subModules,c=e.curSubModule;for(c&&(t.debug("释放当前子模块--->",c.name),t.R.unloadModule(c.name));l.length>0;)c=l.pop(),t.debug("释放模块--->",c.name),t.R.unloadModule(c.name);t.emitter.emit(t.EVT.MODULE_DTOR,e.name)},{moduleInfo:p}),f.moduleParam=i,f.init&&f.init(),s._sceneShowWithoutAnimation[p.name]||t.PROJ.isPc)f.show();else{t.stopWaiting(),t.playWaiting();var O=egret.Tween.get(f);f.show(),f.x=f.layoutBoundsWidth,O.to({x:0},s._moduleSwiftTime,egret.Ease.quartOut).call(function(){y&&y.close(),t.stopWaiting()})}if(!_&&l&&c&&(c.isAutoDtor=r,r||n.push(l)),a&&a(),t.emitter.emit(t.EVT.MODULE_CHANGED,p.name,l?l.name:null),!m&&!_&&c)if(t.PROJ.isPc||s._sceneShowWithoutAnimation[p.name])c.close(),c=null,l=null;else{egret.Tween.removeTweens(c);var O=egret.Tween.get(c);O.to({x:-c.layoutBoundsWidth},s._moduleSwiftTime,egret.Ease.quartOut).call(function(){c.close(),c.x=0,c=null,l=null})}s._sceneShowWithoutAnimation[p.name]&&t.nextTick(function(){y?y.close():t.stopWaiting()})};v(i,e,i,n)};y?(s._curLoadingView=y,y.emitter.once("onReady",function(){m&&!_&&c&&c.close(),r&&!_&&c&&c.doDtor&&c.doDtor(),E()}),y.show()):(s._curLoadingView=null,t.playWaiting(1),E())}},n.prototype._reRunModule=function(t,r){var n=this;e(t),r=r||{};var o=n.curModule.target;o&&(o.close(),o.moduleParam=r,o.init&&o.init(),o.reshow())},n.prototype._recordTrayInfo=function(t){for(var e={},r=t._trayNames,n=0,o=r.length;o>n;n++){var i=r[n],a=t.getTray(i),s=a.numChildren;s&&(e[i]=s)}return e},n.prototype._hideTrayChildren=function(t,e){for(var r in e)for(var n=e[r],o=t.getTray(r),i=o.numChildren,a=Math.min(i,n),s=0,u=a;u>s;s++)o.getChildAt(s).visible=!1},n.prototype._showTrayChildren=function(t,e){for(var r in e)for(var n=e[r],o=t.getTray(r),i=o.numChildren,a=Math.min(i,n),s=0,u=a;u>s;s++)o.getChildAt(s).visible=!0},n.prototype.pop=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=this,o=n.curModule,i=n._moduleStack.pop();n.curModule=i,t.R.moduleName=i.name;var a=o.target;if(t.PROJ.isPc)a&&(a.isAutoDtor=!0,a.close()),i&&i.target&&i.target.reshow();else{var s=0;if(a){t.playWaiting(1),egret.Tween.removeTweens(a),s=a.getTableOffset?a.getTableOffset():0,a.cleanVideoManager&&a.cleanVideoManager();var u=egret.Tween.get(a);u.to({x:a.layoutBoundsWidth+s},n._moduleSwiftTime,egret.Ease.quartOut).call(function(){a.isAutoDtor=!0,a.close(),t.stopWaiting()})}if(i&&i.target){i.target.reshow(),i.target.x=-(i.target.layoutBoundsWidth+s);var u=egret.Tween.get(i.target);u.to({x:0},n._moduleSwiftTime,egret.Ease.quartOut)}}t.emitter.emit(t.EVT.MODULE_CHANGED,i.name,o?o.name:null)},n.prototype.popAll=function(){var e=this,r=e._moduleStack,n=e.curModule,o=e._curLoadingView;o&&o.close&&o.close();var i=n.target;for(i&&(i.isAutoDtor=!0,i.close());r.length;)n=r.pop(),i=n.target,i&&(i.isAutoDtor=!0,i.close());e.curModule=null,t.R.moduleName=null},n.prototype.getModuleCfgItem=function(e){return t.moduleConfig[e]},n.prototype.registerModule=function(e){var r=e.id;r=r||e.targetClass.__className,e.id=r,t.moduleConfig[r]=e},n.prototype.registerValidModuleFunc=function(e){e&&(t._validModuleFunc=e)},n.prototype.registerModuleNotFoundFunc=function(e){t._moduleNotFoundFunc=e},n.prototype.getModuleSwiftTime=function(){return this._moduleSwiftTime},n}(t.Emitter);t.ModuleMgr=i,__reflect(i.prototype,"mo.ModuleMgr",["mo.IModuleMgr"]);var a=function(){function t(){this.loadingType=0,this.fullScr=!1,this._netErrRouteList=[]}return t.prototype.onValid=function(t){var e=this;return e._valid=t,e},t.prototype.onPreAsync=function(t){var e=this;return e._preAsync=t,e},t.prototype.registerCreator=function(t,e){this._creator=t,this._creatorCtx=e},t.prototype.createView=function(){var t=this,e=t.targetClass;return t._creator?t._creator.call(t._creatorCtx,e):new e},t.prototype.registerNetErrRoute=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=this,n=r._netErrRouteList,o=0,i=t.length;i>o;o++){var a=t[o];n.indexOf(a)<0&&n.push(a)}},t}();a.LOADING_TYPE_NONE=-1,a.LOADING_TYPE_CIRCLE=0,a.LOADING_TYPE_ARMATURE=1,t.ModuleCfgItem=a,__reflect(a.prototype,"mo.ModuleCfgItem"),t.getModuleCfgItem=e,t.registerValidModuleFunc=r,t.registerModuleNotFoundFunc=n,i.genGsList(["scaleX","scaleY"],!0),t.moduleMgr=new i}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e=function(e){function r(t){var r=e.call(this,t)||this,n=r;return n.addEventListener(egret.Event.ADDED_TO_STAGE,function(){n.onEnter()},n),n.addEventListener(egret.Event.REMOVED_FROM_STAGE,n.onExit,n),r}return __extends(r,e),r.prototype.onEnter=function(){var t=this;t._hasEnter=!0,t.autoLoop&&t._mcName&&t.loadRes(function(){t._hasEnter&&t.frameEvents&&t.gotoAndPlay(1,-1)})},r.prototype.onExit=function(){var t=this;t._hasEnter=!1,t.frameEvents&&t.gotoAndStop(1)},r.prototype._setD=function(){var e=this,r=t.R.get(e.getUrl()),n=t.getData("mc",e._mcName);if(!n)return t.error("未注册mc数据【%s】",e._mcName),-1;if(r){var o=e._factory=new egret.MovieClipDataFactory(n,r);return e.movieClipData=o.generateMovieClipData(""),1}return 0},r.prototype.loadRes=function(e,r){var n=this,o=n.getUrl();n._factory=null;var i=n._setD();1==i&&(t.R.load(o),e.call(r)),0==i&&t.R.load(o,function(){i=n._setD(),e.call(r)})},r.prototype.getUrl=function(){return this.mcName?t.STR.format(this.urlTemp||r.urlTemp,this.mcName):null},Object.defineProperty(r.prototype,"mcName",{get:function(){return this._mcName},set:function(t){var e=this;t&&t!=e._mcName&&(e._mcName=t,e._hasEnter&&e._autoLoop&&e.loadRes(function(){e.frameEvents&&e.gotoAndPlay(1,-1)}))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"autoLoop",{get:function(){return this._autoLoop},set:function(t){var e=this;"false"==t?t=!1:"true"==t&&(t=!0),e._autoLoop!=t&&(e._autoLoop=t,e._hasEnter&&(!t&&e._factory&&e.frameEvents?e.gotoAndStop(1):e.loadRes(function(){e.frameEvents&&e.gotoAndPlay(1,-1)})))},enumerable:!0,configurable:!0}),r.prototype.playOnce=function(){var t=this;t.loadRes(function(){t.frameEvents&&t.gotoAndPlay(1,1)})},r}(egret.MovieClip);e.urlTemp="dynamic/%s.png",t.MovieClip=e,__reflect(e.prototype,"mo.MovieClip")}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e;!function(e){e.gsNetMgr=null,e.URL_SEND_GOODS="server.recharge.sendGoods",e.ON_SEND_GOODS="ON_SEND_GOODS";var r=function(r){function n(){return r.apply(this,arguments)||this}return __extends(n,r),n.prototype._initProp=function(){r.prototype._initProp.call(this);var t=this;t.orderNoList4Waiting=[]},n.prototype.initSdk=function(e){var r=this;t.playWaiting(),r._initSdk(function(){t.stopWaiting(),e.apply(null,arguments)})},n.prototype._initSdk=function(t){t(null,{})},n.prototype.login=function(e,r){var n=this;n.token=null,t.playWaiting(),n._login(function(o){t.stopWaiting(),t.OBJ.isEmpty(o)||(t.SA.login(o.account.id),n.token=o.token,n.emit(n.__class.ON_LOGIN_SUCCESS,o),e.apply(r,arguments))})},n.prototype._login=function(){},n.prototype.checkLogin=function(t,e){this._checkLogin(t,e)},n.prototype._checkLogin=function(){},n.prototype.logout=function(){},n.prototype.getAccountName=function(){return null},n.prototype.roleLogin=function(){},n.prototype.pay=function(e,r,n){var o=this,i=t.D.get("c_recharge",r),a=o._getExtStr(e,i);t.playWaiting();var s=!1;t.TM.setTimeout(function(){s||t.stopWaiting(),s=!0},5e3),o._pay(e,i,a,function(r){if(s||t.stopWaiting(),s=!0,r)return t.MSG.show(r);var i=o.orderNoList4Waiting;return i.indexOf(e)<0&&i.push(e),o.startPolling(),n?n():void 0})},n.prototype._getExtStr=function(e,r){return t.CRYPTO.enCharCode(JSON.stringify({orderNo:e,rechargeId:r.id}))},n.prototype._pay=function(){},n.prototype.startPolling=function(r){var n=this;n._pollingIndex=0;var o=[2,2,2,2,2,4,4,4,4,4,5,10,20,30,60,600,1800,3610];t.TM.clearInterval(n._pollingInvId),n._pollingInvId=null;var i=function(){return t.TM.clearInterval(n._pollingInvId),n._pollingInvId=null,o[n._pollingIndex]?void(n._pollingInvId=t.TM.setInterval(function(){var o=e.gsNetMgr||t.NET.gsMgr;o.request(e.URL_SEND_GOODS,{},function(o){o=o||{};var i=o.rechargeList,a=!!r;if(i){for(var s=n.orderNoList4Waiting,u=0,l=i.length;l>u;u++){var c=i[u],p=c.orderNo,f=s.indexOf(p);f>=0&&s.splice(f,1)}0==s.length&&(a=!0),t.emitter.emit(e.ON_SEND_GOODS,o)}a&&(t.TM.clearInterval(n._pollingInvId),n._pollingInvId=null)}),n._pollingIndex++,r||i()},1e3*o[n._pollingIndex])):(n._pollingIndex=0,void e.log("stop interval"))};i()},n}(t.Emitter);r.ON_LOGIN_SUCCESS="ON_LOGIN_SUCCESS",e.Channel=r,__reflect(r.prototype,"mo.SDK.Channel")}(e=t.SDK||(t.SDK={}))}(mo||(mo={}));var modosdk;!function(){}(modosdk||(modosdk={}));var mo;!function(t){var e;!function(e){function r(t){if(e.enabled)try{modosdk.sa&&modosdk.sa.tag&&modosdk.sa.tag(t)}catch(r){e.error(r)}}function n(t){if(e.enabled)try{modosdk.sa&&modosdk.sa.login&&modosdk.sa.login(t+"")}catch(r){e.error(r)}}function o(t,r,n,o,i){if(e.enabled)try{modosdk.sa&&modosdk.sa.enterServer&&modosdk.sa.enterServer(t+"",r,n,o,i)}catch(a){e.error(a)}}function i(t,r,n,o){if(e.enabled)try{modosdk.sa&&modosdk.sa.recordItems&&modosdk.sa.recordItems(t,r,n,o)}catch(i){e.error(i)}}function a(t){if(e.enabled)try{if(null==t)return;modosdk.sa&&modosdk.sa.setRoleLevel&&modosdk.sa.setRoleLevel(t)}catch(r){e.error(r)}}function s(t){if(e.enabled)try{if(null==t)return;modosdk.sa&&modosdk.sa.setVIPLevel&&modosdk.sa.setVIPLevel(t)}catch(r){e.error(r)}}t.LOG.initLogger(t.SA,"mo.SA"),e.enabled=!0,e.tag=r,e.login=n,e.enterServer=o,e.recordItems=i,e.setLvl=a,e.setVip=s;try{modosdk.sa&&modosdk.sa.onGetTimestamp&&modosdk.sa.onGetTimestamp(function(){return t.DATE.now()})}catch(u){e.error(u)}}(e=t.SA||(t.SA={}))}(mo||(mo={}));var mo;!function(t){var e;!function(e){function r(t,e){o[t]=e}function n(){var e=t.PROJ.channelId,r=i[e];if(!r){var n=o[e];if(!n)throw t.STR.format("请先注册渠道%s!",e);r=i[e]=new n,r.channelId=e}return r}t.LOG.initLogger(t.SDK,"mo.SDK");var o={},i={};e.register=r,e.getChannel=n}(e=t.SDK||(t.SDK={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},mo;!function(t){var e;!function(e){eui.Image.prototype.$setBitmapData=function(t){var e=this,r=e.$Bitmap[0];if(!(t!=r||r&&r.fromSht))return!1;var n=egret.Bitmap.prototype.$setBitmapData.call(e,t);return e.sourceChanged=!1,this.invalidateSize(),this.invalidateDisplayList(),n};var r=function(){function e(){}return e.prototype.getAsset=function(e,r,n){function o(t){if("string"==typeof e)if(a){if(u){var o=i._resCounter[u.url]||0;0>=o&&void 0==i._globalMap[e]&&i._destroyRes(u.url)}}else{var o=i._resCounter[e]||0;0>=o&&void 0==i._globalMap[e]&&i._destroyRes(e)}r.call(n,t,e)}var i=t.R,a=i instanceof t.Res_lang,s=i.moduleName,u=null,l=e;if(e.prototype&&(l=new e),l instanceof egret.DisplayObject||l instanceof egret.Texture)o(l);else if("string"==typeof e){if(0==e.indexOf("preview_")||0==e.indexOf("pre_"))return o(null);if(a){var c=t.PATH.extname(e);c&&(c=c.toLowerCase(),".arm"!=c&&i.addToCfg(e,c)),u=i.getResItemCfg(e,s),i.addToCfg(u),i.countWithItemCfg(u)}else{var c=t.PATH.extname(e);c&&(c=c.toLowerCase(),".arm"!=c&&i.addToCfg(e,c)),i.countRes(e,s)}try{var p=i.get(e);p?(p instanceof egret.Texture&&p.fromSht&&!p._bitmapData&&i.once("freshTexture_"+e,function(){r.call(n,p,e)}),o(p)):i.load([e],function(){p=i.get(e),p?o(p):(t.error("没有加载到：",e),o(null))})}catch(f){t.error("资源加载出错--->",f),o(null)}}else o(l)},e}();e.AssetAdapter=r,__reflect(r.prototype,"mo.EUI.AssetAdapter",["eui.IAssetAdapter"])}(e=t.EUI||(t.EUI={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},mo;!function(t){var e;!function(e){var r=function(){function e(){}return e.prototype.getTheme=function(e,r,n,o){function i(t){r.call(o,t)}function a(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),n.call(o))}r=function(e){var r,n=this;if(e)try{r=JSON.parse(e)}catch(o){egret.$error(3e3)}else egret.$error(3e3,n.$configURL);if(r&&r.skins)for(var i=n.skinMap,a=r.skins,s=Object.keys(a),u=s.length,l=0;u>l;l++){var c=s[l];i[c]||n.mapSkin(c,a[c])}r.styles&&(n.$styles=r.styles),r.exmls&&0!=r.exmls.length?r.exmls[0].gjs?t.CHAIN.begin(r.exmls).limit(10,function(e,r,n){EXML.$parseURLContentAsJs(e.path,e.gjs,e.className),t.nextTick(function(){n()})}).end(function(){n.onLoaded()}):r.exmls[0].content?t.CHAIN.begin(r.exmls).limit(10,function(e,r,n){EXML.$parseURLContent(e.path,e.content),t.nextTick(function(){n()})}).end(function(){n.onLoaded()}):EXML.$loadAll(r.exmls,n.onLoaded,n,!0):n.onLoaded()},RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),RES.getResByUrl(e,i,this,RES.ResourceItem.TYPE_TEXT)},e}();e.ThemeAdapter=r,__reflect(r.prototype,"mo.EUI.ThemeAdapter",["eui.IThemeAdapter"])}(e=t.EUI||(t.EUI={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e;!function(e){e.tapBEmitter=new t.Emitter,e.tapAEmitter=new t.Emitter;var r=function(r){function n(){var t=null!==r&&r.apply(this,arguments)||this;return t._audioPlayCb=function(){},t}return __extends(n,r),n.prototype._initProp=function(){r.prototype._initProp.call(this);var t=this;t.skinTemp="%sSkin.exml",t._ignoreClassListToSetSkin=[]},n.prototype.setSkinName=function(r,n){r.skinName=t.STR.format(e.helper.skinTemp,n||r.__className)},n.prototype.addIgnoreClassToSetSkin=function(t){this._ignoreClassListToSetSkin.indexOf(t)<0&&this._ignoreClassListToSetSkin.push(t)},n.prototype.isIgnoreClazzToSetSkin=function(t){return this._ignoreClassListToSetSkin.indexOf(t)>=0},n.prototype.rm=function(t){if(t){var e=t.parent;e&&e.removeChild(t)}},n.prototype.getChild=function(e,r){var n=t.UTIL.getChildren(e);if(0==n.length)return null;for(var o=r.split("."),i=o[0],a=r.substring(i.length+1),s=0,u=n.length;u>s;s++){var l=n[s];if(l.name==i)return a&&""!=a?this.getChild(l,a):l}for(var s=0,u=n.length;u>s;s++){var c=this.getChild(n[s],r);if(c)return c}return null},n.prototype.isIn=function(t,e,r){var n=t.globalToLocal(e,r);return e=n.x,r=n.y,e>1&&e<t.width-1&&r>1&&r<t.height-1},n.prototype.posTo=function(e,r){var n=t.p(0,0);return e.localToGlobal(0,0,n),r.globalToLocal(n.x,n.y,n),n},n.prototype.sortZOrder=function(e){t.UTIL.getChildren(e).sort(function(t,e){return(t.zOrder||0)>(e.zOrder||0)?1:(t.zOrder||0)<(e.zOrder||0)?-1:0})},n.prototype.registerSound=function(e,r,n){var o=this;e.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){var i=null==n?n:t.getExt(e,"audio");0==i||null!=i||!r||0!=r.indexOf("btn_")&&0!=r.indexOf("ico_")||(i=o.defaultAudio)},e)},n.prototype.registerAudioPlayCb_IOS=function(t){this._audioPlayCb=t},n.prototype._getLayer=function(e,r){var n=t.UTIL.getChildren(r);if(0==n.length)return null;for(var o=0,i=n.length;i>o;o++){var a=n[o];if(a.__className==e)return a}for(var o=0,i=n.length;i>o;o++){var s=this._getLayer(e,n[o]);if(s)return s}return null},n.prototype.getLayer=function(e){return this._getLayer(e,t.EUI.uiScene)||this._getLayer(e,t.EUI.infoScene)},n.prototype._handlePartAdded=function(e,r,n){var o=this;if(0==r.toLocaleLowerCase().indexOf("preview")||0==r.toLocaleLowerCase().indexOf("pre_"))return this.rm(n),void delete e[r];if(n.ctrl||n.ctrl_key){var i=e._parts4Ctrl=e._parts4Ctrl||[];i.indexOf(n)<0&&i.push(n)}var a=e._parts=e._parts||[];a.push(r),n.name=r;var s=e.get(r);if(n instanceof egret.tween.TweenGroup){var u=e._tweenGrpList=e._tweenGrpList||[];u.push(n)}else if(null!=s&&n.setData)n.setData(s);else if(0==r.indexOf("label_"))s=e.get(r.substring(6)),null!=s&&(n.text=s);else if(0==r.indexOf("bar_"))s=e.get(r.substring(4)),null!=s&&(n.value=s);else if(0==r.indexOf("img_"))s=e.get(r.substring(4)),null!=s&&(n.source=s+"");else if(n instanceof eui.DataGroup){var l=e["_Item_"+r];l&&(n.itemRenderer=l),n.createOneRenderer=function(){var t=this,r=eui.DataGroup.prototype.createOneRenderer.apply(t,arguments);return r.delegate=e,r};var c=e["_data_"+r];c&&e._compOpt.delay("_data_"+r,function(){c="function"==typeof c?c.call(e):c,n.dataProvider=new eui.ArrayCollection(c),t.emitter.emit("_data_"+r)});var p=e["_click_"+r];p&&n instanceof eui.ListBase&&n.addEventListener(eui.ItemTapEvent.ITEM_TAP,p,e)}var f=e["_tap_"+r];f&&(o.registerSound(n,r),o._registerTap(e,n,r,f));var _=e["_chg_"+r];_&&n.addEventListener(egret.Event.CHANGE,_,e)},n.prototype._registerTap=function(t,r,n,o,i){r.addEventListener(egret.TouchEvent.TOUCH_TAP,function(a){var s=t.__className+"#"+n;e.tapBEmitter.emit(s,t,r),e.tapBEmitter.emit(n,t,r),e.tapBEmitter.emit("*",t,r),o.call(i?i:t,a),e.tapAEmitter.emit(s,t,r),e.tapAEmitter.emit(n,t,r),e.tapAEmitter.emit("*",t,r)})},n.prototype._handleSetter=function(t,e,r,n){var o=this,i=t._compOpt,a=i.data,s=a[e],u=typeof r,l=!("string"==u||"number"==u||"boolean"==u)||a[e]!=r;if(l){a[e]=r;var c=i.oldMap;void 0===c[e]&&(c[e]=s),o._doDataChanged(t,n)}},n.prototype._handleSetData=function(t,e){var r=t._compOpt,n=r.data=r.data||{},o=r.chgMap=r.chgMap||{},i=!1;for(var a in e){var s=e[a],u=n[a],l=typeof s;n[a]=s;var c=!("string"==l||"number"==l||"boolean"==l)||u!=s;if(c){o[a]=!0,i||(i=!0);var p=t[a];p&&p.setData&&"object"==l?p.setData(s):t["label_"+a]?t["label_"+a].text=s:t["bar_"+a]?t["bar_"+a].value=s:t["img_"+a]&&(t["img_"+a].source=null==s?s:s+"");var f=t["_chg_"+a];f&&"function"==typeof f&&f.call(t,s,u),r.emitter.emit(a,s,u)}}i&&(t.dataChanged(),r.chgMap={})},n.prototype._doDataChanged=function(t,e){if(!t._hasDtored){var r=t._compOpt,n=r.data,o=r.oldMap,i=r.chgMap;for(var a in i)delete i[a];var s=!1;for(var a in o){var u=o[a],l=n[a];delete o[a];var c=typeof u,p=!("string"==c||"number"==c||"boolean"==c)||u!=l;if(p){s=!0,i[a]=!0;var f=t[a];if(f&&f.setData?f.setData(l):t["label_"+a]?t["label_"+a].text=l:t["bar_"+a]?t["bar_"+a].value=l:t["img_"+a]&&(t["img_"+a].source=null==l?l:l+""),e)continue;var _=t["_chg_"+a];_&&"function"==typeof _&&_.call(t,l,u),r.emitter.emit(a,l,u)}}!e&&s&&t.dataChanged()}},n.prototype._handleInitProp=function(r){var n=this;r.addEventListener(egret.Event.ADDED_TO_STAGE,function(){r.onEnter()},r),r.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){n._handleOnExit(r),r.onExit()},r),r.isAutoDtor=!0,r.isDtorByParent=!0,r._compOpt=new e.CompOpt,r.emitter=new t.Emitter},n.prototype._handleDoDtor=function(e){e._hasDtored||(e._hasDtored=!0,e.dataChanged=function(){},this._doDtorChildren(t.UTIL.getChildren(e)),e.dtor&&t.nextTick(function(){e.dtor();var t=e._parts;t&&delete e._parts}))},n.prototype._handleDtor=function(e){var r=egret.MainContext.instance.stage,n=egret.Event.ACTIVATE;r.removeEventListener(n,e._onResume,e),delete e.delegate;var o=e.delegateFactorys;if(o)for(;o.length>0;){var i=o.pop();delete i.delegate}this.rm(e),e.unEmitter&&e.unEmitter();var a=e.emitter;a&&a.emit("dtor",e),t.clearExt(e)},n.prototype._doDtorChildren=function(e){if(e)for(var r=this,n=0,o=e.length;o>n;++n){var i=e[n];if(i&&(i.isDtorByParent||i.isAutoDtor)&&!i._isInstance){var a=t.getExt(i,"pool");a?a.rm(i):i.doDtor?i.doDtor():r._doDtorChildren(t.UTIL.getChildren(i))}else!i||i.isDtorByParent||i.isAutoDtor||i._isInstance||r._doDtorChildren(t.UTIL.getChildren(i))}},n.prototype._handleSetParent=function(e,r,n){var o=r.prototype,i=!0;if(o._parentChanged?o._parentChanged.call(e,n):o.$setParent&&(i=o.$setParent.call(e,n)),!n){var a=t.getExt(e,"pool");a?a.rm(e):!e._isInstance&&e.isAutoDtor&&e.doDtor()}return i},n.prototype._handleOnEnter=function(t){if(t.isEnter=!0,t.resumeEnabled){var e=egret.MainContext.instance.stage,r=egret.Event.ACTIVATE;e.removeEventListener(r,t._onResume,t),e.addEventListener(r,t._onResume,t)}},n.prototype._handleOnExit=function(t){t.isEnter=!1;var e=egret.MainContext.instance.stage,r=egret.Event.ACTIVATE;e.removeEventListener(r,t._onResume,t),t.unEmitter&&t.unEmitter(),t.tweenHelper&&t.tweenHelper.rmAll();var n=t._tweenGrpList;if(n){for(var o=0,i=n.length;i>o;o++){var a=n[o];a&&a.stop()}n.length=0}var s=t._triggerMap;if(s)for(var u in s){var l=s[u];l&&l.clear(),delete s[u]}},n}(t.Emitter);e.Helper=r,__reflect(r.prototype,"mo.EUI.Helper"),e.helper=new r}(e=t.EUI||(t.EUI={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.hitTestPoint=function(){if(!this.touchEnabled)return!1;var t=eui.Rect.prototype;return t.hitTestPoint.apply(this,arguments)},e.prototype.hitTest=function(){if(!this.touchEnabled)return null;var t=eui.Rect.prototype;return t.hitTest.apply(this,arguments)},e}(eui.Rect);t.Rect=e,__reflect(e.prototype,"mo.EUI.Rect")}(e=t.EUI||(t.EUI={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e;!function(e){var r=function(e){function r(){var r=e.call(this)||this;r._hasChangeSize=!1,r._hasChangeHeight=!1,r.doCut=!0;var n=r;return n.touchEnabled=!1,n.style="txt_default",egret.isNative&&t.PROJ.lang&&null!=t.PROJ.lang&&(n.fontFamily=t.PROJ.lang),n.addEventListener(egret.Event.ADDED_TO_STAGE,function(){n.wantWidth?n.scaleText4X&&"function"==typeof n.scaleText4X&&n.scaleText4X():n.maxSize&&n.refreshText4AutoSize&&"function"==typeof n.refreshText4AutoSize&&n.refreshText4AutoSize(),n.onEnter()},n),n.addEventListener(egret.Event.REMOVED_FROM_STAGE,n.onExit,n),n.copyTextOpen=!1,n.copyTextContent="",r}return __extends(r,e),Object.defineProperty(r.prototype,"maxSize",{get:function(){return this._maxSize||0},set:function(t){this._maxSize!=t&&(this._maxSize=t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"minSize",{get:function(){return this._minSize||10},set:function(t){this._minSize!=t&&(this._minSize=t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"wantWidth",{get:function(){return this._wantWidth},set:function(t){this._wantWidth!=t&&(this._wantWidth=t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"cutWidth",{get:function(){return this._cutWidth},set:function(t){this._cutWidth!=t&&(this._cutWidth=t)},enumerable:!0,configurable:!0}),r.prototype.enableCopyText=function(){var t=this;t.copyTextOpen||(t.copyTextOpen=!0,t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_TAP,t._tap_self.bind(t),t))},Object.defineProperty(r.prototype,"copyText",{set:function(t){var e=this;e.enableCopyText(),e.copyTextContent=t},enumerable:!0,configurable:!0}),r.prototype.onEnter=function(){var e=this;t.PROJ.isPc?e.changeSizeForCircleWord():e._hasChangeHeight&&(e.y=e.y-.15*e.height),"my_mm"==t.PROJ.lang?e.lineSpacing=Math.ceil(e.size/10*7):"th_th"==t.PROJ.lang||"km_kh"==t.PROJ.lang?e.lineSpacing=Math.ceil(e.size/10*4):("hi_in"==t.PROJ.lang||"ta_in"==t.PROJ.lang)&&(e.lineSpacing=Math.ceil(e.size/10*3.5))},r.prototype.changeSizeForCircleWord=function(){var e=this;if(("my_mm"==t.PROJ.lang||"th_th"==t.PROJ.lang||"km_kh"==t.PROJ.lang||"hi_in"==t.PROJ.lang||"ta_in"==t.PROJ.lang)&&!e._hasChangeSize)if(e.verticalAlign="middle",e._lastGenText){e.size=Math.floor(.7*e.size);var r=e.height;e.height=Math.ceil(1.35*e.height),e.y=e.y-.2*(e.height-r),e._hasChangeSize=!0}else if(e.height>0){e.size=Math.floor(.7*e.size);var r=e.height;e.height=Math.ceil(1.35*e.height),e.y=e.y-.175*(e.height-r),e._hasChangeSize=!0}},r.prototype.onExit=function(){var t=this;t.copyTextOpen&&t.removeEventListener(egret.TouchEvent.TOUCH_TAP,t._tap_self.bind(t),t)},r.prototype._isValidPlaceHolderStr=function(e){return"string"==typeof e&&(e.match(t.STR.PLACEHOLDER_EXP)||e.indexOf("%s")>=0)},r.prototype._fillTemplate=function(e,r){var n=this,o=r;return r instanceof Array?o=t.STR.format.apply(t.STR,[e].concat(r)):"object"==typeof r?o=t.STR.placeholder(e,r):n._isValidPlaceHolderStr(r)?o=t.STR.format(e,r):(r&&null!=n.floatNum&&(o=t.STR.parseNumOrStr(r+"",n.floatNum)+""),o=t.STR.format(e,o)),o},r.prototype._genText=function(e){var r=this,n="";if(null==e)return n;var o=r.tempTxt;if(e instanceof Array){for(var i=[],a=0;a<e.length;a++){var s=e[a];i.push(t.D.isLangCode(s)?t.D.langCodeToTxt(s):s)}n=o?r._fillTemplate(o,i):t.STR.format.apply(t.STR,i)}else if("object"==typeof e){var u={};for(var l in e){var s=e[l];u[l]=t.D.isLangCode(s)?t.D.langCodeToTxt(s):s}n=o?r._fillTemplate(o,u):JSON.stringify(u)}else if("string"==typeof e){var c=t.D.fillLangCodeStr(e);o?n=r._fillTemplate(o,c):(r._isValidPlaceHolderStr(c)&&(r.tempTxt=c),n=c)}else n=e+"",null!=r.floatNum&&(n=t.STR.parseNumOrStr(n,r.floatNum)+""),o&&(n=r._fillTemplate(o,n));return n},Object.defineProperty(r.prototype,"floatNum",{get:function(){return this._floatNum},set:function(t){var e=this;e._floatNum=t},enumerable:!0,configurable:!0}),r.prototype.$setText=function(e){var r=this,n=r._genText(e),o=new t.EUI.TextWrapNew,i=t.EUI.Label.verifyEmoji(n);if(r._lastGenText=i,r.cutWidth&&(i=0==r.width?o.getCuttingByIndex(i,r.cutWidth,r.size):o.getCuttingByIndex(i,r.cutWidth,r.size*r.scaleY),r._lastGenText=i),"my_mm"==t.PROJ.lang||"th_th"==t.PROJ.lang||"km_kh"==t.PROJ.lang||"hi_in"==t.PROJ.lang||"ta_in"==t.PROJ.lang){var a=n.match(/\d|[A-Za-z]|[0-9]|[.]|[,]|[:]|[-]|[(]|[)]|[%]\s/g),s=n.match(/.|\s/g);if(null!=s)if(null!=a){if(s.length>a.length&&1!=r._hasChangeHeight){var u=r._lastGenText.match(/\n/g)?r._lastGenText.match(/\n/g).length+1:1;r.verticalAlign="middle";var l=Math.ceil(u*r.size*1.45);if(l>r.height){var c=r.height;r.height=l,r.y=r.y-.5*(r.height-c)}r._hasChangeHeight=!0}}else if(1!=r._hasChangeHeight){var u=r._lastGenText.match(/\n/g)?r._lastGenText.match(/\n/g).length+1:1;r.verticalAlign="middle";var l=Math.ceil(u*r.size*1.45);if(l>r.height){var c=r.height;r.height=l,r.y=r.y-.5*(r.height-c)}r._hasChangeHeight=!0}}return r.copyTextOpen&&(r.copyText=r._lastGenText),r._handleUbb(i)},r.prototype._handleUbb=function(r){var n=this;if(!t.PROJ.isPc&&r&&(r.match(/\d\.|\-|\,|\K+/g),"my_mm"==t.PROJ.lang||"th_th"==t.PROJ.lang||"km_kh"==t.PROJ.lang||"hi_in"==t.PROJ.lang||"ta_in"==t.PROJ.lang)){var o=r.match(/\d|[A-Za-z]|[0-9]|[.]|[,]|[:]|[-]|[(]|[)]|[%]\s/g),i=r.match(/.|\s/g);null!=i&&(null!=o?i.length>o.length&&1!=n._hasChangeSize&&(n.size=Math.floor("th_th"==t.PROJ.lang?.79*n.size:.7*n.size),n._hasChangeSize=!0):1!=n._hasChangeSize&&(n.size=Math.floor("th_th"==t.PROJ.lang?.79*n.size:.7*n.size),n._hasChangeSize=!0))}var a=t.UBB.parse(r,n.fontFamily,n.size,n.textColor);if("string"==typeof a){if(n.textFlow=[],n.wantWidth){var s=n.checkText=n.checkText||new egret.TextField;s.fontFamily=n.fontFamily,s.multiline=n.multiline,s.wordWrap=n.wordWrap,s.textAlign=n.textAlign,s.verticalAlign=n.verticalAlign,s.maxChars=n.maxChars,s.italic=n.italic,s.bold=n.bold,s.scaleX=s.scaleY=n.scaleY,s.text=a,n.scaleX!=n.scaleY&&(n.scaleX=n.scaleY),n.wantWidth<s.width&&(n.scaleX=n.scaleY*(n.wantWidth/s.width));var u=e.prototype.$setText.call(this,r);return u}return n.maxSize?n._autoSizeText(r):e.prototype.$setText.call(this,r)}return n.textFlow=a,!0},r.prototype._getCheckSize=function(t,e,r,n,o){for(var i=this,a=null,s=null,u=null,l=i.maxSize||0;null==a&&(a=i.checkSize(e-r,t,n,o)),null==s&&(s=i.checkSize(e,t,n,o)),null==u&&(u=i.checkSize(e+r,t,n,o)),!u||s||a;){if(u&&s?(e-=r,u=s,s=a,a=null):u||(e+=r,a=s,s=u,u=null),e-r<i.minSize){e=i.minSize;break}if(e+r>l){e=l;break}}return e},r.prototype._autoSizeText=function(t){var r=this,n=r.$TextField,o=n[0],i=n[3],a=n[4];i&&a&&(r._lastCheckText!=t||r._lastCheckSize!=o)&&(r.initCheckText(),o=r._getCheckSize(t,o,2,i,a),o!=r.maxSize&&o!=r.minSize&&(o=r._getCheckSize(t,o,1,i,a)),r._lastCheckSize=r.size=o,r._lastCheckText=t);var s=e.prototype.$setText.call(this,t);return s},r.prototype.initCheckText=function(){var t=this,e=t.checkText=t.checkText||new egret.TextField;e.fontFamily=t.fontFamily,e.multiline=!0,e.wordWrap=t.wordWrap,e.textAlign=t.textAlign,e.verticalAlign=t.verticalAlign,e.maxChars=t.maxChars,e.italic=t.italic,e.bold=t.bold},r.prototype.checkSize=function(t,e,r,n){var o=this.checkText;return o.size=t,o.text=e,o.textWidth>r||o.textHeight>n},r.prototype.refreshText4AutoSize=function(){var t=this,e=t._lastGenText;if(e&&""!=e){var r=t.$TextField,n=r[0];t._lastCheckSize!=n&&t._handleUbb(e)}},r.prototype.scaleText4X=function(){var t=this,e=t._lastGenText;e&&""!=e&&t.wantWidth<t.width&&(t.scaleX=t.scaleY*(t.wantWidth/t.width))},r.verifyEmoji=function(e){var r="";if(void 0!=e&&null!=e)for(var n=(t.EUI.Label.reg_emoji_one,t.EUI.Label.reg_emoji_two),o=String(e),i=0;i<o.length;i++){var a=o.charAt(i);if(n.test(a));else{var s=o.charAt(i);0!=s.length&&(r+=s)}}return r},r.prototype.doCopyTxt=function(e){if(e=e.replace(/\r?\n|\r/g,""),egret.isNative){var r=egret.Capabilities.os.toLowerCase();if("android"==r)t.RT.call("copyText",{copyText:e});else{var n=JSON.stringify({copyText:e});egret.ExternalInterface.call("copyText",n)}}else{var o=document.createElement("textarea");o.value=e,o.setAttribute("readonly",""),o.style.position="absolute",o.style.left="-9999px",document.body.appendChild(o),o.select(),o.setSelectionRange(0,o.value.length),document.execCommand("Copy"),document.body.removeChild(o)}},r.prototype._tap_self=function(){var e=this;e.doCopyTxt(e.copyTextContent),t.MSG.show(t.D.langCodeToTxt("copy_first"))},r}(eui.Label);r.default_fontFamily=egret.TextField.default_fontFamily,r.reg_emoji_one=new RegExp("(?:[✀-➿]|️|︎|‍|(?:�[�-�]){2}|[�-�][�-�]|[#-9]️|[#-9]︎|[#-9]‍?⃣|㊙|㊗|〽|〰|Ⓜ|�[�-�]|�[�-�]|🆎|�[�-�]|�[�-�]|[�[�-�]|🈚|🈯|[�[�-�]|[�[�-�]|‼|⁉|[▪-▫]|▶|◀|[◻-◾]|©|®|™|ℹ|🀄|[☀-⛿]|⬅|⬆|⬇|⬛|⬜|⭐|⭕|⌚|⌛|⌨|⏏|[⏩-⏳]|[⏸-⏺]|🃏|⤴|⤵|[←-⇿])"),r.reg_emoji_two=new RegExp("​|‍|️"),e.Label=r,__reflect(r.prototype,"mo.EUI.Label")}(e=t.EUI||(t.EUI={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e;!function(t){t.isPack=!0,t.strokeEnabled=!0,t.labelVerticalAlign="middle",t.layerPoolLimit=5,t.registerValueHandler(function(e){t.setValue(e,"isPack",!0),t.setValue(e,"strokeEnabled",!0),t.setValue(e,"labelVerticalAlign"),t.setValue(e,"layerPoolLimit"),t.setValue(e,"defaultStyle")})}(e=t.PROJ||(t.PROJ={}))}(mo||(mo={})),function(t){var e;!function(e){e.ON_SHOW="onShow",e.ON_CLOSE="onClose",e.actionEmitter=new t.Emitter,e.activatedEmitter=new t.Emitter,e.inactivatedEmitter=new t.Emitter,e.showEmitter=new t.Emitter,e.closeEmitter=new t.Emitter}(e=t.EUI||(t.EUI={}))}(mo||(mo={})),function(mo){var EUI;!function(EUI){var CompOpt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;
return e.data={},e}return __extends(e,t),e.prototype._initProp=function(){t.prototype._initProp.call(this);var e=this;e.emitter=new mo.Emitter,e.delayArr=[],e.delayKeyMap={},e.oldMap={},e.chgMap={}},e.prototype.delay=function(t,e,r,n){var o=this,i=o.delayArr,a=o.delayKeyMap;a[t]||(a[t]=!0,i.push([e,r,n||[]]))},e.prototype.doDelay=function(){for(var t=this,e=t.delayArr;e.length;){var r=e.shift(),n=r.shift(),o=r.shift();n.apply(o,r)}t.delayKeyMap={}},e}(mo.Emitter);EUI.CompOpt=CompOpt,__reflect(CompOpt.prototype,"mo.EUI.CompOpt");var Comp=function(_super){function Comp(){var t=_super.call(this)||this,e=t;e._initProp();var r=e.__class;return EUI.helper.isIgnoreClazzToSetSkin(r)||(e._skinName?e.skinName=e._skinName:EUI.helper.setSkinName(e)),t}return __extends(Comp,_super),Object.defineProperty(Comp.prototype,"data",{get:function(){return this._compOpt.data},enumerable:!0,configurable:!0}),Comp.prototype._isValueChanged=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=0,n=t.length;n>r;r++)if(this._compOpt.chgMap[t[r]])return!0;return!1},Comp.prototype._initProp=function(){var t=this;t._triggerMap={},t._parts4Ctrl=[],t.emitter=new mo.Emitter,t.tweenHelper=new mo.TweenHelper,EUI.helper._handleInitProp(t)},Comp.prototype.init=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},Comp.prototype.doDtor=function(){EUI.helper._handleDoDtor(this)},Comp.prototype.dtor=function(){EUI.helper._handleDtor(this)},Comp.prototype._parentChanged=function(t){return EUI.helper._handleSetParent(this,eui.Component,t)},Comp.prototype.$setParent=function(t){return EUI.helper._handleSetParent(this,eui.Component,t)},Comp.prototype.registerClassByKey=function(){},Comp.prototype._onResume=function(){},Comp.prototype.onEnter=function(){var self=this;EUI.helper._handleOnEnter(self);for(var parts4Ctrl=self._parts4Ctrl,i=0,l_i=parts4Ctrl.length;l_i>i;i++){var part=parts4Ctrl[i],ctrlStr=part.ctrl,ctrlData=ctrlStr?eval("("+ctrlStr+")"):self.data,ctrl=ctrlStr?ctrlData:null;ctrl=ctrl?ctrl:self}},Comp.prototype.getTween=function(){var t=this;return t._hasDtored?null:t.tweenHelper.get.apply(t.tweenHelper,arguments)},Comp.prototype.rmTweens=function(t){this.tweenHelper.rm(t)},Comp.prototype.onExit=function(){},Comp.prototype.partAdded=function(t,e){_super.prototype.partAdded.call(this,t,e),EUI.helper._handlePartAdded(this,t,e)},Comp.prototype.childrenCreated=function(){_super.prototype.childrenCreated.call(this);var t=this,e=t._compOpt;t._hasDtored||e.doDelay()},Comp.prototype._childrenCreated=function(){},Comp.prototype.$parseSkinName=function(){_super.prototype.$parseSkinName.call(this);var t=this;t.skin&&t.skin.states.length&&t.invalidateState(),t._childrenCreated()},Comp.prototype.setOnly=function(t,e){return EUI.helper._handleSetter(this,t,e,!0),this},Comp.prototype.set=function(t,e){return EUI.helper._handleSetter(this,t,e),this},Comp.prototype.get=function(t){return this._compOpt.data[t]},Comp.prototype.setData=function(t){var e=this;return EUI.helper._handleSetData(e,t||{}),e},Comp.prototype.setDataOnly=function(t){var e=this;for(var r in t)e.setOnly(r,t[r]);return e},Comp.prototype.dataChanged=function(){},Comp.prototype.refreshList=function(t){var e=this,r=e[t],n=e["_data_"+t];n&&(n="function"==typeof n?n.call(e):n,r.dataProvider=new eui.ArrayCollection(n))},Comp.prototype.onEmitter=function(t,e,r){mo.onEmitter(t,e,r,this)},Comp.prototype.unEmitter=function(){mo.unEmitter(this)},Comp.prototype.getTrigger=function(t){var e=this,r=e._triggerMap,n=r[t]=r[t]||new mo.CustTrigger;return n},Comp}(eui.Component);EUI.Comp=Comp,__reflect(Comp.prototype,"mo.EUI.Comp"),EUI.helper.addIgnoreClassToSetSkin(Comp)}(EUI=mo.EUI||(mo.EUI={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e;!function(e){function r(e){var r=e.__className;l[r]=e;var n=e.SYS_ID;if(n){var o=c[n];o&&t.warn("Layer#SYS_ID【%s】被重复注册，请检查：old:【%s】- new：【%s】",n,o,r),c[n]=r}}function n(t){return l[t]}function o(t,e){p=t,f=e}function i(t,e){if(!t)return null;var r=n(t);return r?r.show(e):null}function a(t,e){return i(c[t],e)}var s=function(){function t(){this.trayEmitterEnabled=!0}return t.prototype.dtor=function(){var t=this;delete t.scene,delete t.onClose,delete t.onCloseCtx},t}();e.LayerOpt=s,__reflect(s.prototype,"mo.EUI.LayerOpt");var u=function(r){function n(){return null!==r&&r.apply(this,arguments)||this}return __extends(n,r),Object.defineProperty(n.prototype,"trayName",{get:function(){return this._trayName},enumerable:!0,configurable:!0}),n.prototype.dtor=function(){r.prototype.dtor.call(this);var e=this,n=e._layerOpt;n.isTouchStoped&&(t.UTIL.resumeTouch(),n.isTouchStoped=!1),n.dtor(),delete e._layerOpt},n.prototype._setModuleParam=function(t){this._moduleParam=t},Object.defineProperty(n.prototype,"moduleParam",{get:function(){var t=this,e=t._layerOpt,r=e.scene;return t._moduleParam?t._moduleParam:r?r.moduleParam||{}:{}},set:function(t){this._setModuleParam(t)},enumerable:!0,configurable:!0}),n.prototype._setPenetrable=function(t){this._penetrable=t;var e=this._layerOpt.rect;e&&(e.visible=t)},Object.defineProperty(n.prototype,"penetrable",{get:function(){return this._penetrable},set:function(t){this._setPenetrable(t)},enumerable:!0,configurable:!0}),n.prototype._setActivated=function(r){var n=this,o=n._layerOpt;if(!n._hasDtored){var i=o.scene;if(r&&i&&i.canBeActivated&&!i.canBeActivated(n)&&(r=!1),o.activated!=r){void 0===o.activatedOld&&(o.activatedOld=!!o.activated),o.activated=r,t.log("_setActivated--->",n.__className,n.hashCode,r);var a=o.activateUnderDisabled;n.activated?!a&&!n.penetrable&&i&&i.inactivateUnder&&i.inactivateUnder(n):!a&&i&&i.activateUnder&&i.activateUnder(n),n._hasDtored||t.nextTick(function(){if(!n._hasDtored){var t=o.activatedOld;delete o.activatedOld;var r=o.activated;if(t!=r){r?n._onActivated():n._onInactivated();var i=r?e.activatedEmitter:e.inactivatedEmitter;i.emit(n.__className,n)}}})}}},Object.defineProperty(n.prototype,"activated",{get:function(){return this.parent&&this.visible&&this._layerOpt.activated},set:function(t){this._setActivated(t)},enumerable:!0,configurable:!0}),n.prototype._onActivated=function(){},n.prototype._onInactivated=function(){},n.prototype._initProp=function(){r.prototype._initProp.call(this);var e=this,n=e._layerOpt=new s;e._trayName="display",e.penetrable=!0,e._layerOpt.isAutoSize=!0,e.alpha=0,e.addEventListener(egret.Event.ADDED_TO_STAGE,e._onAddToStage,e),e.addEventListener(egret.Event.REMOVED_FROM_STAGE,e._onRmFromStage,e);var o=n.rect=new t.EUI.Rect;o.name="__rect",o.alpha=0,e.alpha=1,e._hasChangeOrientation=!1},n.prototype._childrenCreated=function(){r.prototype._childrenCreated.call(this);var t=this,e=t._layerOpt,n=e.rect;t.addChildAt(n,0),n.visible=!t.penetrable,t.width>=t.height?(t._width_landscape=t.width,t._height_landscape=t.height):(t._width_landscape=t.height,t._height_landscape=t.width)},n.prototype._onAddToStage=function(){},n.prototype._onRmFromStage=function(){},n.prototype._onLayerMoveEnd=function(){},n.prototype.init=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},n.prototype.partAdded=function(t,n){r.prototype.partAdded.call(this,t,n);var o,i=this;if("btn_close"==t)o=n;else if("container"==t){var a=n.btn_close;a&&(o=a)}o&&e.helper._registerTap(i,o,t,i.close)},n.prototype.getTrayInfo=function(){var t=this,r=t.get("tray");return r?{tray:r}:e.getTrayInfo(t.trayName)},n.prototype._onShowReady=function(){var e=this,r=e._layerOpt;r.rect,r.isTouchStoped&&(t.UTIL.resumeTouch(),r.isTouchStoped=!1),r.showingWithAction=!1,e.visible=!0,e.activated=!0,e.emitter.emitBoth("onReady")},n.prototype.isInTray=function(){var t=this.getTrayInfo().tray;return!!t.name&&0==t.name.indexOf("tray_")},n.prototype._resetRectSize=function(t){var e=this,r=e._layerOpt,n=r.rect;n.width=e.width*t,n.height=e.height*t,n.anchorOffsetX=n.width/2,n.anchorOffsetY=n.height/2,n.x=e.width/2,n.y=e.height/2},n.prototype.show=function(){var r=this;if(!r._hasDtored){var n=r._layerOpt,o=r.getTrayInfo(),i=o.tray,a=o.scene;if(!i)return r;n.isTouchStoped||(t.UTIL.stopTouch(),n.isTouchStoped=!0),n.scene=a,a?a.addLayerToTray(r,r.trayName):i.add?i.add(r):i.addChild(r),n.isAutoSize&&(r.width=i.width,r.height=i.height,r.anchorOffsetX=r.width/2,r.anchorOffsetY=r.height/2,r.x=i.width/2,r.y=i.height/2),r._resetRectSize(1);var s=r.isInTray();return!s&&n.rect&&(n.rect.visible=!1),s&&(n.showingWithAction=!0,r.scaleX=r.scaleY=1),n.shownWithAction?(r._resetRectSize(1.6),r._doShowTween(function(){r._hasDtored||(r._resetRectSize(1),r._onShowReady())})):(r._resetRectSize(1),r._onShowReady()),r.emitter.emit(t.EUI.ON_SHOW,r),e.showEmitter.emit(r.__className,r),r}},n.prototype.onClose=function(t,e){var r=this._layerOpt;return r.onClose=t,r.onCloseCtx=e,this},n.prototype._onClose=function(){},n.prototype._doShowTween=function(t){var e=this;e.scaleX=e.scaleY=.8,e.alpha=1,egret.Tween.get(e,{loop:!1}).to({scaleX:1,scaleY:1},400,egret.Ease.backOut).call(t,e)},n.prototype._doCloseTween=function(t){var e=this;egret.Tween.get(e,{loop:!1}).to({alpha:0},300).call(t,e)},n.prototype._doClose=function(){var r=this;if(!r._hasDtored){var n=r._layerOpt;n.closingWithAction=!1,r.activated=!1;var o=n.onClose,i=n.onCloseCtx;n.isTouchStoped&&(t.UTIL.resumeTouch(),n.isTouchStoped=!1),e.helper.rm(r);var a=n.scene;"display"==r.trayName&&a&&a.pop&&a.pop(),r._onClose(),o&&o.call(i,r),r.emitter.emit(t.EUI.ON_CLOSE,r),e.closeEmitter.emit(r.__className,r)}},n.prototype.close=function(){var t=this,e=t._layerOpt;return t._hasDtored?t:e.closingWithAction?t:(t._doClose(),t)},n.prototype._restore=function(){var r=this,n=r._layerOpt;if(!r._hasDtored){r.activated=!1,r.activated=!1;var o=n.onClose,i=n.onCloseCtx;e.helper.rm(r),r._onClose(),o&&o.call(i,r),r.emitter.emit(t.EUI.ON_CLOSE,r),e.closeEmitter.emit(r.__className,r)}},n.prototype.onEnter=function(){r.prototype.onEnter.call(this);var e=this,n=e._layerOpt;n.needToRefresh&&(e._onRefresh(),n.needToRefresh=!1),t.emitter.emit("enter:"+e.__className,e),t.PROJ.portraitMode&&(t.emitter.on("changePLMode",e.readyToChangeOrientation.bind(e)),e.readyToChangeOrientation())},n.prototype.onEnter_portrait=function(){},n.prototype.onExit=function(){r.prototype.onExit.call(this);var e=this;e._layerOpt.needToRefresh=!0,t.emitter.emit("exit:"+e.__className,e),t.PROJ.portraitMode&&t.emitter.un("changePLMode",e.readyToChangeOrientation.bind(e))},n.prototype._onRefresh=function(){},n.prototype.readyToChangeOrientation=function(){var e=this;if(t.PROJ.portraitMode){var r=t.UTIL.orientation();e.currentState=r,e.invalidateState(),"portrait"==r?(e.width=e._height_landscape,e.height=e._width_landscape):(e.width=e._width_landscape,e.height=e._height_landscape)}},n.prototype.commitProperties=function(){r.prototype.commitProperties.call(this);var e=this;t.PROJ.portraitMode&&e.onOrientationChange()},n.prototype.onOrientationChange=function(){var e=this;t.PROJ.portraitMode&&e.isNowPortrait()&&(e._hasChangeOrientation||(e._hasChangeOrientation=!0,e.onEnter_portrait()))},n.prototype.isNowPortrait=function(){return"portrait"==t.UTIL.orientation()?!0:!1},n.show=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this;return e=e||{},e.__chg=t.DATE.now(),o.SYS_ID?!p||p.call(f,o.SYS_ID,o)?(new o).setData(e).show():null:(new o).setData(e).show()},n}(e.Comp);u.__isLayer=!0,e.Layer=u,__reflect(u.prototype,"mo.EUI.Layer");var l={},c={};e.register=r,e.getLayerClass=n,egret.mo_onRegisterClass(function(t){t.__isLayer&&r(t)});var p,f;e.onJudgeSysId=o,e.showByLayerName=i,e.showBySysId=a}(e=t.EUI||(t.EUI={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._initProp=function(){t.prototype._initProp.call(this);var e=this;e._trayName="menu",e.touchEnabled=!1,e._layerOpt.activateUnderDisabled=!0},e}(t.Layer);t.MenuLayer=e,__reflect(e.prototype,"mo.EUI.MenuLayer")}(e=t.EUI||(t.EUI={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e;!function(e){var r=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.outsideCloseCb=null,t}return __extends(r,e),r.prototype._initProp=function(){e.prototype._initProp.call(this);var r=this;r._trayName="dlg",r._layerOpt.shownWithAction=!0,r.penetrable=!1;var n=r._layerOpt.rect;n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){r.outsideClosable&&(r.outsideCloseCb&&r.outsideCloseCb(),r.close())},r),n.fillColor=0,n.alpha=t.PROJ.isPc?.65:.8},r.prototype.onEnter=function(){e.prototype.onEnter.call(this),t.emitter.emit("event_dlgShow")},r.prototype.onExit=function(){e.prototype.onExit.call(this),t.emitter.emit("event_dlgClose")},r}(e.Layer);e.Dlg=r,__reflect(r.prototype,"mo.EUI.Dlg")}(e=t.EUI||(t.EUI={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e;!function(e){var r=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return __extends(r,e),Object.defineProperty(r.prototype,"msg",{get:function(){return this._msg},set:function(t){this._msg=t,this.setDataOnly({msg:t.getDisplayMsg()})},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"trayName",{get:function(){return this._isOnTop?"top":this._trayName},enumerable:!0,configurable:!0}),r.prototype._initProp=function(){e.prototype._initProp.call(this);var t=this;t._layerOpt.activateUnderDisabled=!0,t._trayName="msg",t.toPauseGuide=!0;var r=t.data;r.btn_ok="确定",r.btn_cancel="取消"},r.prototype.onEnter=function(){e.prototype.onEnter.call(this);var r=this;t.nextTick(function(){r.parent&&r.toPauseGuide&&(r._pausingGuide=!0,t.emitter.emit("pauseGuide"))})},r.prototype.onExit=function(){e.prototype.onExit.call(this);var r=this;r._pausingGuide&&r.toPauseGuide&&t.emitter.emit("resumeGuide")},r.prototype._tap_btn_ok=function(){this.msg.emit(t.MSG.Msg.ON_OK,this),this.close()},r.prototype._tap_btn_cancel=function(){this.msg.emit(t.MSG.Msg.ON_CANCEL,this),this.close()},r.prototype._tap_btn_no=function(){this.msg.emit(t.MSG.Msg.ON_CANCEL,this),this.close()},r.prototype._tap_btn_close=function(){this.msg.emit(t.MSG.Msg.ON_CLOSE,this),this.close()},r}(e.Dlg);e.MsgDlg=r,__reflect(r.prototype,"mo.EUI.MsgDlg"),e.helper.addIgnoreClassToSetSkin(r)}(e=t.EUI||(t.EUI={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e;!function(e){var r=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return __extends(r,e),r.prototype._initProp=function(){e.prototype._initProp.call(this);var t=this;t._trayName="top",t.penetrable=!1,t._layerOpt.activateUnderDisabled=!0,t.toPauseGuide=!0},r.prototype.onEnter=function(){e.prototype.onEnter.call(this);var r=this;t.nextTick(function(){r.parent&&r.toPauseGuide&&(r._pausingGuide=!0,t.emitter.emit("pauseGuide"))})},r.prototype.onExit=function(){e.prototype.onExit.call(this);var r=this;r._pausingGuide&&r.toPauseGuide&&t.emitter.emit("resumeGuide")},r}(e.Layer);e.TopLayer=r,__reflect(r.prototype,"mo.EUI.TopLayer")}(e=t.EUI||(t.EUI={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e;!function(e){var r=function(r){function n(){var t=r.call(this)||this,n=t;n._initProp();var o=n.__class;return e.helper.isIgnoreClazzToSetSkin(o)||(n._skinName?n.skinName=n._skinName:e.helper.setSkinName(n)),t}return __extends(n,r),n.prototype._initProp=function(){var r=this;r._triggerMap={},r.tweenHelper=new t.TweenHelper,e.helper._handleInitProp(r),r.isAutoDtor=!1},n.prototype.init=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},n.prototype.doDtor=function(){e.helper._handleDoDtor(this)},n.prototype.dtor=function(){e.helper._handleDtor(this),delete this._afterChildrenCreated},n.prototype._parentChanged=function(t){return e.helper._handleSetParent(this,eui.Component,t)},n.prototype.$setParent=function(t){return e.helper._handleSetParent(this,eui.Component,t)},n.prototype.registerClassByKey=function(){},n.prototype._onResume=function(){},n.prototype.getTween=function(){var t=this;return t._hasDtored?null:t.tweenHelper.get.apply(t.tweenHelper,arguments)},n.prototype.rmTweens=function(t){this.tweenHelper.rm(t)},n.prototype.onEnter=function(){e.helper._handleOnEnter(this)},n.prototype.onExit=function(){},n.prototype.partAdded=function(t,n){r.prototype.partAdded.call(this,t,n),e.helper._handlePartAdded(this,t,n)},n.prototype._childrenCreated=function(){},n.prototype._onAfterChildrenCreated=function(t){this._afterChildrenCreated=t},n.prototype.$parseSkinName=function(){r.prototype.$parseSkinName.call(this);var t=this;t.skin&&t.skin.states.length&&t.invalidateState(),t._childrenCreated()},n.prototype.setOnly=function(t,r){return e.helper._handleSetter(this,t,r,!0),this},n.prototype.set=function(t,r){return e.helper._handleSetter(this,t,r),this},n.prototype.get=function(t){return this._compOpt.data[t]},n.prototype.setData=function(t){var e=this;t=t||{};for(var r in t)e.set(r,t[r]);return e},n.prototype.setDataOnly=function(t){var e=this;for(var r in t)e.setOnly(r,t[r]);return e},n.prototype.dataChanged=function(){r.prototype.dataChanged.call(this);var t=this;t._compOpt,t._hasDtored||t.setDataOnly(t.data)},n.prototype.onLongClick=function(t,e,r){var n=this;n._longItor=t,n._longEnd=e,n._longCtx=r},n.prototype.refreshList=function(t){var e=this,r=e[t],n=e["_data_"+t];n&&(n="function"==typeof n?n.call(e):n,r.dataProvider=new eui.ArrayCollection(n))},n.prototype.onEmitter=function(e,r,n){t.onEmitter(e,r,n,this)},n.prototype.unEmitter=function(){t.unEmitter(this)},n}(eui.ItemRenderer);e.ItemRenderer=r,__reflect(r.prototype,"mo.EUI.ItemRenderer"),e.helper.addIgnoreClassToSetSkin(r)}(e=t.EUI||(t.EUI={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e;!function(e){var r=function(e){function r(){var t=e.call(this)||this,r=t;return r.addEventListener(egret.Event.ADDED_TO_STAGE,r._setFontFamily,r),t}return __extends(r,e),r.prototype._setFontFamily=function(){var e=this;egret.isNative&&t.PROJ.lang&&null!=t.PROJ.lang&&(e.promptDisplay.fontFamily=t.PROJ.lang)},r}(eui.TextInput);e.TextInput=r,__reflect(r.prototype,"mo.EUI.TextInput")}(e=t.EUI||(t.EUI={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._initProp(),e}return __extends(e,t),e.prototype._initProp=function(){var t=this;t.singleModule=!0},e.prototype.add=function(t){var e=this;e.singleModule&&(e._curLayer&&e._curLayer.close(),e._curLayer=null),e.addChild(t)},e}(eui.Group);t.Tray=e,__reflect(e.prototype,"mo.EUI.Tray")}(e=t.EUI||(t.EUI={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e;!function(e){function r(t){var r;return e.uiScene&&(r=e.uiScene.getTray(t))?{tray:r,scene:e.uiScene}:e.infoScene&&(r=e.infoScene.getTray(t))?{tray:r,scene:e.infoScene}:{tray:egret.MainContext.instance.stage}}e.sceneScaleX=1,e.sceneScaleY=1;var n=function(r){function n(){var t=r.call(this)||this,e=t;return e._initProp(),e._initTrays(),t}return __extends(n,r),n.prototype._initProp=function(){var r=this;r.emitter=new t.Emitter,r._trayNames=[],r._trays=[],r._index=0,r.touchEnabled=!1,r.addEventListener(egret.Event.ADDED_TO_STAGE,r.onEnter,r);var n=egret.MainContext.instance.stage;r.width=0|n.stageWidth/e.sceneScaleX,r.height=0|n.stageHeight/e.sceneScaleX,r.scaleX=e.sceneScaleX,r.scaleY=e.sceneScaleY},n.prototype._initBg=function(){var t=this,e=t._bg=new eui.Image;e.horizontalCenter=e.verticalCenter=0},n.prototype.setBg=function(t){this._bg.source=t},n.prototype._initTray=function(t,e){var r=this,n=new eui.Group;return t="tray_"+t,n.touchEnabled=!1,n.width=r.width,n.height=r.height,n.name=t,r[t]=n,null==e?(r._trays.push(n),r.addChild(n)):(r._trays.splice(e,1,n),r.addChildAt(n,e)),n},n.prototype._initTrays=function(){for(var t=this,e=t._trayNames,r=0,n=e.length;n>r;r++){var o=e[r];t._initTray(o)}},n.prototype.getTray=function(t){return this["tray_"+t]},n.prototype.addLayerToTray=function(e,r){var n=this,o=n.getTray(r);return o?(o.addChild(e),void t.emitter.emit(n.__class.ON_ADD_LAYER_TO_TRAY,n,r,e.__className)):void t.error("%s未找到tray【%s】",n.__className,r)},n.prototype.doDtor=function(){e.helper._handleDoDtor(this)},n.prototype.dtor=function(){var t=this;e.helper._handleDtor(t),t.removeEventListener(egret.Event.ADDED_TO_STAGE,t.onEnter,t)},n.prototype._show=function(){var t=this,e=egret.MainContext.instance.stage;e.addChildAt(t,t._index)},n.prototype.show=function(){this._show()},n.prototype.reshow=function(){this._show(),this._recover()},n.prototype.close=function(){var r=this;if(r.parent){e.helper.rm(r);var n=r._recoverMap=r._recoverMap||{},o=r.hashCode,i=n[o];if(!i){i=[],n[o]=i;for(var a=r._trays,s=0,u=a.length;u>s;s++)for(var l=a[s],c=t.UTIL.getChildren(l),p=0,f=c.length;f>p;p++){var _=c[p];_.activated&&i.push(_)}for(var s=0,u=i.length;u>s;s++)i[s].activated=!1}}},n.prototype.onEnter=function(){var e=this;e.addEventListener(egret.Event.REMOVED_FROM_STAGE,e.onExit,e),e.visible=!0,t.PROJ.isPc||t.emitter.on("refreshTrayWH",e.refreshTrayWH.bind(e))},n.prototype.onExit=function(){var e=this;e.removeEventListener(egret.Event.REMOVED_FROM_STAGE,e.onExit,e),t.PROJ.isPc||t.emitter.un("refreshTrayWH",e.refreshTrayWH.bind(e))},n.prototype.$setParent=function(t){return e.helper._handleSetParent(this,eui.Group,t)},n.prototype.refreshTrayWH=function(){if(!t.PROJ.isPc){var r=this,n=egret.MainContext.instance.stage;if(r.width=0|n.stageWidth/e.sceneScaleX,r.height=0|n.stageHeight/e.sceneScaleX,r._trayNames)for(var o=0;o<r._trayNames.length;o++){var i=r._trayNames[o],a=r.getTray(i);a&&(a.width=r.width,a.height=r.height)}}},n.prototype.inactivateUnder=function(e){var r=this;if(r.parent){var n=r._trays,o=[],i=!1,a=r._recoverMap=r._recoverMap||{},s=e.hashCode;if(e.parent&&!a[s]){for(var u=0;u<n.length;u++){var l=n[u],c=t.UTIL.getChildren(l);if(c){if(i)break;for(var p=0,f=c.length;f>p;p++){var _=c[p];if(_==e){i=!0;break}_.activated&&o.push(_)}}}if(i){a[s]=o;for(var u=0,h=o.length;h>u;u++){var g=o[u];g.activated=!1}}}}},n.prototype.activateUnder=function(t){var e=this;if(e.parent){var r=e._recoverMap=e._recoverMap||{},n=t.hashCode;for(var o in r)if(parseInt(o)!=n)for(var i=r[o]||[],a=0,s=i.length;s>a;a++)if(i[a],n==i[a].hashCode)return;var u=r[n];if(delete r[n],u&&u.length){var l=!0;if(!t.parent)for(var o in r){for(var c=r[o],a=0,s=c.length;s>a;a++){if(t==c[a]){c.splice(a,1);for(var p=0,f=u.length;f>p;p++){c.splice(a+p-1,0,u[p]),l=!1;break}}if(!l)break}if(!l)break}if(l)for(var a=0,s=u.length;s>a;a++)u[a].activated=!0}}},n.prototype.canBeActivated=function(e){var r=this,n=r._trays,o=!1,i=[],a=r._recoverMap;if(!a)return!0;for(var s=0,u=n.length;u>s;s++)for(var l=n[s],c=t.UTIL.getChildren(l),p=0,f=c.length;f>p;p++){var _=c[p];if(o){if(_.visible&&!_.penetrable){var h=a[_.hashCode];if(!h)continue;for(var g=0,d=h.length-1;d>=0;--d){var y=h[d];if(i.indexOf(y.hashCode)){g=d;break}}return h.splice(g,1,e),!1}}else _==e?o=!0:i.push(_.hashCode)}return!0},n.prototype._recover=function(){var t=this,e=t._recoverMap=t._recoverMap||{},r=t.hashCode,n=e[r];if(n){delete e[r];for(var o=0,i=n.length;i>o;o++)n[o].activated=!0}},n}(eui.Group);n.ON_ADD_LAYER_TO_TRAY="ON_ADD_LAYER_TO_TRAY",e.Scene=n,__reflect(n.prototype,"mo.EUI.Scene");var o=function(r){function n(){return null!==r&&r.apply(this,arguments)||this}return __extends(n,r),n.prototype._initProp=function(){r.prototype._initProp.call(this);var t=this;t._trayNames=["display","menu","dlg"],t._stack=[],t.singleDisplayEnabled=!0,t._layerIdMap={}},n.prototype.registerLayer=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];this._layerIdMap[t]=e},n.prototype._getLayerData=function(){return this.moduleParam.$layerData||{}},n.prototype._getMainLayerData=function(){return this.moduleParam.$layerData||{}},n.prototype.resetToMain=function(){var t=this,e=t._stack;if(t.singleDisplayEnabled){for(;e.length>1;)e.pop().doDtor();var r=t._curDisplayLayer;r&&(t._mainLayerClass&&r.__className==t._mainLayerClass.__className||t._curDisplayLayer.close())}},n.prototype.show=function(){var t=this;e.uiScene=t,t._show();var r=t.moduleParam,n=r.$sysId,o=r.$layerId,i=r.$layerName,a=!1;if(n)a=!!e.showBySysId(n,t._getLayerData(null)||{});else if(o){var s=t._layerIdMap[o];if(s){for(var u=s.length,l=0,c=s.length;c>l;l++){var p=s[l],f=e.showByLayerName(p,t._getLayerData(p)||{});f&&u--}a=0==u}else console.warn("%s里面未注册layerId【%s】的相关类信息")}else if(i){for(var _=i.split(","),u=_.length,l=0,c=_.length;c>l;l++){var p=_[l],f=e.showByLayerName(p,t._getLayerData(p)||{});f&&u--}a=0==u}!a&&t._mainLayerClass&&t._mainLayerClass.show(t._getMainLayerData()||{})},n.prototype.reshow=function(){e.uiScene=this,this._show(),this._recover()},n.prototype.addLayerToTray=function(t,e){var n=this;if(n.singleDisplayEnabled&&"display"==e){var o=n._curDisplayLayer;o&&(o.isAutoDtor=!1,o._restore(),n._stack.push(o)),n._curDisplayLayer=t}r.prototype.addLayerToTray.call(this,t,e)},n.prototype.pop=function(){var e=this,r=e._stack;if(e.singleDisplayEnabled){e._curDisplayLayer=null;var n=r.pop();n?(n.isAutoDtor=!0,n.show({__chgTime:t.DATE.now()})):e._mainLayerClass&&(n=e._mainLayerClass.show()),e._curDisplayLayer=n}},n.prototype.cleanVideoManager=function(){var t=this;t._gameLayer&&t._gameLayer.cleanVideoManager&&(t._gameLayer.cleanVideoManager(),t._gameLayer=null)},n.prototype.getTableOffset=function(){var t=this;return t._gameLayer&&t._gameLayer.getTableOffset?t.scaleX*t._gameLayer.getTableOffset():0},n}(n);e.UIScene=o,__reflect(o.prototype,"mo.EUI.UIScene");var i=function(n){function o(){return null!==n&&n.apply(this,arguments)||this}return __extends(o,n),o.prototype._initProp=function(){n.prototype._initProp.call(this);var e=this;e._trayNames=["msg","guide","top"],t.moduleMgr.on("scaleX",function(){e.scaleX=t.moduleMgr.scaleX||1}),t.moduleMgr.on("scaleY",function(){e.scaleY=t.moduleMgr.scaleY||1})},o.prototype.onEnter=function(){var e=this;t.emitter.on("activate_delay_v2",e._closeAllDlg,e),t.emitter.on("remove_other_msg_dialog",e._removeOtherMsgDialog,e),t.PROJ.isPc||t.emitter.on("refreshTrayWH",e.refreshTrayWH.bind(e))},o.prototype.onExit=function(){var e=this;t.emitter.un("activate_delay_v2",e._closeAllDlg,e),t.emitter.un("remove_other_msg_dialog",e._removeOtherMsgDialog,e),t.emitter.emit("InfoScene_onExit"),t.PROJ.isPc||t.emitter.un("refreshTrayWH",e.refreshTrayWH.bind(e))},o.prototype._closeAllDlg=function(t){void 0===t&&(t=!1);var e=this;t||(e.tray_msg.removeChildren(),e.tray_guide.removeChildren(),e.tray_top.removeChildren())},o.prototype._removeOtherMsgDialog=function(){var t=r("msg").tray;if(t.$children)for(var e=t.$children.length-1;e>=0;e--){var n=t.$children[e];n.close()}},o.prototype.show=function(){e.infoScene=this,this._show()},o.prototype.reshow=function(){e.infoScene=this,this._show(),this._recover()},o.prototype.dtor=function(){n.prototype.dtor.call(this);var e=this;t.moduleMgr.unCtx(e)},o.prototype.registerClassByKey=function(){},o}(n);e.InfoScene=i,__reflect(i.prototype,"mo.EUI.InfoScene"),e.getTrayInfo=r,t.PROJ.emitter.once(t.PROJ.AFTER_CFG,function(){e.infoScene=new i,e.infoScene.show()})}(e=t.EUI||(t.EUI={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e;!function(e){var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._initProp=function(){t.prototype._initProp.call(this);var e=this;e.toPauseGuide=!1,e.count=0;var r=e.__class.juhuImage||"ico_juhua";e._skinName='\n            <?xml version="1.0" encoding="utf-8"?>\n                <e:Skin width="400" height="300" xmlns:e="http://ns.egret.com/eui" xmlns:w="http://ns.egret.com/wing">\n                    <e:Group id="grp_juhua" width="0" height="0" verticalCenter="0" horizontalCenter="0">\n                        <e:Image source="'+r+'" horizontalCenter="0" verticalCenter="0"/>\n                        <e:Label id="juhua_text" text="connect" horizontalCenter="0" verticalCenter="0" textColor="0x26ff00" size="60" scaleX="0.5" scaleY="0.5" visible="false"/>\n                    </e:Group>\n                </e:Skin>'},e.prototype.onEnter=function(){t.prototype.onEnter.call(this);var r=this;r.grp_container&&(r.grp_container.visible=!1),r.grp_juhua.visible=!1,e.lazzyShow?egret.Tween.get(r.grp_juhua).wait(1e3).call(r._showLoading,r):r._showLoading()},e.prototype._showLoading=function(){var t=this;t.grp_juhua.rotation=0,t.grp_container&&(t.grp_container.visible=!0),t.grp_juhua.visible=!0,egret.Tween.get(t.grp_juhua,{loop:!0}).to({rotation:360},1500)},e.prototype.onExit=function(){t.prototype.onExit.call(this);var e=this;egret.Tween.removeTweens(e.grp_juhua)},e.prototype.show=function(e){var r=this;switch(r.rect_bg&&(r.rect_bg.visible=!0),e){case 1:r.juhua_text.text="Loading";break;case 2:r.juhua_text.text="Processing";break;case 3:r.juhua_text.text="Connect";break;case 4:r.rect_bg&&(r.rect_bg.visible=!1)}return r.count++,r.count>0&&!r.parent&&t.prototype.show.call(this,e),r},e.prototype.close=function(){var e=this;return e.count<=0?void 0:(e.count--,e.count<=0&&e.parent&&(e.count=0,t.prototype.close.call(this)),e)
},e.prototype.forceClose=function(){var e=this;return e.count=0,t.prototype.close.call(this),e},e.show=function(t){var e=this,r=e._instance;return r||(r=e._instance=new e,r.isAutoDtor=!1),r.show(t)},e.close=function(){var t=this,e=t._instance;return e?e.close():void 0},e.forceClose=function(){var t=this,e=t._instance;return e?e.forceClose():void 0},e}(e.TopLayer);r.lazzyShow=!1,e.JuHua=r,__reflect(r.prototype,"mo.EUI.JuHua"),t.setWaitingView(r)}(e=t.EUI||(t.EUI={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e;!function(e){var r=function(e){function r(){var r=e.call(this)||this,n=r,o=n._movieClip=new t.MovieClip;return n.width=n.height=0,n.addChild(o),o.addEventListener(egret.Event.COMPLETE,function(){o.visible=!1},n),r}return __extends(r,e),r.prototype.$hitTest=function(){return null},Object.defineProperty(r.prototype,"mcName",{get:function(){return this._movieClip.mcName},set:function(t){this._movieClip.mcName=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"autoLoop",{get:function(){return this._movieClip.autoLoop},set:function(t){this._movieClip.visible=t,this._movieClip.autoLoop=t},enumerable:!0,configurable:!0}),r.prototype.playOnce=function(){this._movieClip.visible=!0,this._movieClip.playOnce()},r}(eui.Component);e.MovieClip=r,__reflect(r.prototype,"mo.EUI.MovieClip")}(e=t.EUI||(t.EUI={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e;!function(e){var r=function(e){function r(){var r=e.call(this)||this,n=r;return n._sprite=new t.Sprite,n.width=n.height=0,n.addEventListener(egret.Event.ADDED_TO_STAGE,function(){n.isEnter=!0,n.onEnter()},n),n.addEventListener(egret.Event.REMOVED_FROM_STAGE,function(){n.isEnter=!1,n.onExit()},n),r}return __extends(r,e),r.prototype.onEnter=function(){var t=this;t.autoLoop&&t.play()},r.prototype.onExit=function(){var t=this,e=t._sprite;t.autoLoop&&e.frameLoop.unRegisterTicker()},r.prototype.$hitTest=function(){return null},Object.defineProperty(r.prototype,"spName",{get:function(){return this._spName},set:function(t){this._spName=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"autoLoop",{get:function(){return this._autoLoop},set:function(t){this._autoLoop=t},enumerable:!0,configurable:!0}),r.prototype.play=function(t){var e=this;null!=t?e.autoLoop=0>=t?!0:!1:t=this.autoLoop?-1:1;var r=e._sprite;r.parent||e.addChild(r),this._sprite.play(this.getSpUrl(),t||-1)},r.prototype.getSpUrl=function(){return t.STR.format(this.urlTemp||this.__class.DEFAULT_URL_TEMP,this._spName)},r}(eui.Component);r.DEFAULT_URL_TEMP="sp/%s.png",e.UiSprite=r,__reflect(r.prototype,"mo.EUI.UiSprite")}(e=t.EUI||(t.EUI={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},mo;!function(t){var e;!function(e){var r=function(){function e(){this.reg_th_th_all=/[\u0E01-\u0E3A]|[\u0E3F-\u0E5B]/g,this.reg_th_th=/[\u0E01-\u0E23]|\u0E25|[\u0E27-\u0E2E]/g,this.reg_km_kh_all=/[\u1780-\u17CF]|[\u17D0-\u17DD]|[\u17E0-\u17E9]|[\u17F0-\u17F9]|[\u19E0-\u19FF]/g,this.reg_km_kh=/[\u1780-\u17B3]/g,this.reg_my_mm_all=/[\u1000-\u100F]|[\u1010-\u101F]|[\u1020-\u102F]|[\u1030-\u103F]|[\u1040-\u104F]|[\u1050-\u105F]|[\u1060-\u106F]|[\u1070-\u107F]|[\u1080-\u108F]|[\u1090-\u109F]|[\uAA60-\uAA6F]|[\uAA70-\uAA7F]|[\uA9E0-\uA9EF]|[\uA9F0-\uA9FF]/g,this.reg_my_mm=/[\u1000-\u100F]|[\u1010-\u101F]|[\u1020-\u102A]|\u103F|[\u1050-\u1055]|[\u105A-\u105D]|\u1061|[\u1065-\u1066]|[\u106E-\u106F]|\u1070|[\u1075-\u107F]|[\u1080-\u1081]|\u108E|[\uAA60-\uAA6F]|[\uAA70-\uAA76]|\uAA7A|[\uAA7E-\uAA7F]|[\uA9E0-\uA9E4]|[\uA9E6-\uA9EF]|[\uA9FA-\uA9FE]/g,this.reg_hi_in=/[\u0904-\u0939][\u093d][\u0950][\u0958-\u0961][\u0971-\u097f][\ua8f2-\ua8f7][\ua8fb][\ua8fd][\u1ce9-\u1cec][\u1cef-\u1cf1][\u1cf5-\u1cf6]/g,this.reg_ta_in=/[\u0b83][\u0b85-\u0b8a][\u0b8e-\u0b90][\u0b92-\u0b95][\u0b99-\u0b9a][\u0b9c][\u0b9e-\u0b9f][\u0ba3-\u0ba4][\u0ba8-\u0baa][\u0bae-\u0baf][\u0bb0-\u0bb9][\u0bd0]/g,this.reg_independent_collect=/[\u0E01-\u0E23]|\u0E25|[\u0E27-\u0E2E]|[\u1780-\u17B3]|[\u1000-\u100F]|[\u1010-\u101F]|[\u1020-\u102A]|\u103F|[\u1050-\u1055]|[\u105A-\u105D]|\u1061|[\u1065-\u1066]|[\u106E-\u106F]|\u1070|[\u1075-\u107F]|[\u1080-\u1081]|\u108E|[\uAA60-\uAA6F]|[\uAA70-\uAA76]|\uAA7A|[\uAA7E-\uAA7F]|[\uA9E0-\uA9E4]|[\uA9E6-\uA9EF]|[\uA9FA-\uA9FE][\u0904-\u0939][\u093d][\u0950][\u0958-\u0961][\u0971-\u097f][\ua8f2-\ua8f7][\ua8fb][\ua8fd][\u1ce9-\u1cec][\u1cef-\u1cf1][\u1cf5-\u1cf6][\u0b83][\u0b85-\u0b8a][\u0b8e-\u0b90][\u0b92-\u0b95][\u0b99-\u0b9a][\u0b9c][\u0b9e-\u0b9f][\u0ba3-\u0ba4][\u0ba8-\u0baa][\u0bae-\u0baf][\u0bb0-\u0bb9][\u0bd0]/g}return e.prototype.getFstNormalwordIndex=function(t){for(var e=this,r=new RegExp(e.reg_th_th_all),n=new RegExp(e.reg_km_kh_all),o=new RegExp(e.reg_my_mm_all),i=r.source+"|"+n.source+"|"+o.source,a=0;a<t.length;a++){var s=t[a].match(i);if(null==s)return a}return-1},e.prototype.getIndexArrry=function(t){for(var e=this,r=new Array,n=new Array,o=new Array,i=t,a=0,s=0;s<t.length;s++)i[s].match(e.reg_independent_collect)&&(r[a]=s,a+=1);i=t;var u=e.getFstNormalwordIndex(i)+1;for(n[0]=u,a=1;u>0;)i=i.substr(u),e.getFstNormalwordIndex(i)+1>0&&(n[a]=e.getFstNormalwordIndex(i)+1+n[a-1]),a+=1,u=e.getFstNormalwordIndex(i)+1;return o=r.length>n.length?e.setIndexArrryAll(r,n):e.setIndexArrryAll(n,r)},e.prototype.setIndexArrryAll=function(t,e){for(var r=new Array,n=0,o=0;n<t.length||o<e.length;)n<t.length&&o<e.length?t[n]<e[o]?(r.push(t[n]),n++):t[n]==e[o]?(r.push(t[n]),n++,o++):(r.push(e[o]),o++):n<t.length?(r.push(t[n]),n++):o<e.length&&(r.push(e[o]),o++);return r},e.prototype.getCuttingByIndex=function(e,r,n){var o=this,i=o.getIndexArrry(e),a=new Array,s="",u=new t.EUI.Label;if(u.size=n,u.text=e,u.width<=r)s=e;else{for(var l=0,c=0;c<i.length;c++)u.text=e.substring(l,i[c]),u.width<r||c>=1&&(a.push(i[c-1]),l=i[c-1]);if(0==a.length)console.log("Unable to cut");else for(var c=0;c<a.length+1;c++)0==c?s=s+e.substring(c,a[c])+"\n":c<a.length?s=s+e.substring(a[c-1],a[c])+"\n":s+=e.substring(a[c-1])}return"th_th"==t.PROJ.lang||"km_kh"==t.PROJ.lang||"my_mm"==t.PROJ.lang||"hi_in"==t.PROJ.lang||"ta_in"==t.PROJ.lang?0==s.length?e:s:e},e}();e.TextWrapNew=r,__reflect(r.prototype,"mo.EUI.TextWrapNew")}(e=t.EUI||(t.EUI={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e;!function(e){e._socketIdIncrease=1;var r=function(r){function n(n){var o=r.call(this)||this;o.WEBSOCKET_STATE_CONNECTING=0,o.WEBSOCKET_STATE_OPEN=1,o.WEBSOCKET_STATE_CLOSING=2,o.WEBSOCKET_STATE_CLOSED=3;var i=o;return i.splitStr="$#|#$",i.connectStatus=0,i.autoConnectDuration=1e4,n=i.src=n||new egret.WebSocket,n.code=i.code=n.code||t.MD5.encode(t.DATE.now()+"-"+e._socketIdIncrease++),n.addEventListener(egret.ProgressEvent.SOCKET_DATA,i.onReceiveMessage,i),n.addEventListener(egret.Event.CONNECT,i.onSocketOpen,i),n.addEventListener(egret.Event.CLOSE,i.onSocketClose,i),n.addEventListener(egret.IOErrorEvent.IO_ERROR,o.onSocketError,i),o}return __extends(n,r),Object.defineProperty(n.prototype,"writable",{get:function(){var t=this.src;return t?t.writable:!1},enumerable:!0,configurable:!0}),n.prototype.onReceiveMessage=function(){this._on_message(this.src.readUTF())},n.prototype.onSocketOpen=function(){this._on_open()},n.prototype.onSocketClose=function(){this._on_close(0,"close")},n.prototype.onSocketError=function(){this._on_error(new Error("socket error"))},n.prototype._on_close=function(t,e){var r=this;r.connectStatus=0,r.autoReconnectEnabled&&!r._connectIntervalId&&(r._connectIntervalId=setInterval(function(){if(r.connectStatus>=2)r._connectIntervalId&&(clearInterval(r._connectIntervalId),r._connectIntervalId=null);else if(r.connectStatus>=1)return;r.src=null,r.connect(r.url),r.connectStatus=1},r.autoConnectDuration)),r.emit("close",t,e)},n.prototype._on_error=function(t){this.emit("error",t)},n.prototype._on_open=function(){var t=this;t.connectStatus=2,t._connectIntervalId&&(clearInterval(t._connectIntervalId),t._connectIntervalId=null),t.emit("connect")},n.prototype._on_message=function(t){var r=this;try{var n=t.toString(),o=r.splitStr;0==n.indexOf(o)&&(n=n.substring(o.length));for(var i=n.split(o),a=0,s=i.length;s>a;a++){var u=i[a],l=u;try{l=JSON.parse(u)}catch(c){}r.emit("param",l)}}catch(c){e.error(c)}},n.prototype._on_ping=function(t){this.emit("ping",t)},n.prototype._on_pong=function(t){this.emit("pong",t)},n.prototype.send=function(t,e){var r=this,n=null;0!=arguments.length&&(n=1==arguments.length?t:"string"==typeof t?{e:t,d:e}:t,r.src.writeUTF(r.splitStr+JSON.stringify(n)))},n.prototype.getIp=function(){var e=this,r=e.src;if(e._ip)return e._ip;var n=r.handshake,o=r.ip;return o||t.OBJ.isEmpty(n)||(o=n.headers["x-forwarded-for"]||n.address||n.connection.remoteAddress),r.address&&(o=o||r.address().address),o?o.match(/\d+\.\d+\.\d+\.\d+/)[0]:"127.0.0.1"},n.prototype.connect=function(t){var e=this;e.url=t,e.connectStatus=0,e._connectIntervalId&&(clearInterval(e._connectIntervalId),e._connectIntervalId=null),e.src.connectByUrl(t)},n.prototype.close=function(){var t=this;t._connectIntervalId&&(clearInterval(t._connectIntervalId),t._connectIntervalId=null),t.socketState()!=t.WEBSOCKET_STATE_CLOSED&&t.socketState()!=t.WEBSOCKET_STATE_CLOSING&&this.src.close()},n.prototype.socketState=function(){var t=this;return t.src?t.src.socket.socket.readyState:-1},n}(t.Emitter);e.WebSocket=r,__reflect(r.prototype,"mo.NET.WebSocket")}(e=t.NET||(t.NET={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e;!function(e){var r=function(r){function n(){var t=r.apply(this,arguments)||this;return t._testRequestTimeout=!1,t._requestTimer=null,t._timeout=15e3,t}return __extends(n,r),n.prototype._initProp=function(){r.prototype._initProp.call(this);var t=this;t._handlerClass=e.WebSocketReqHandler,t._waitingMap={}},n.prototype._enterTestTimeout=function(){var t=this;t._testRequestTimeout=!0},n.prototype._on_response=function(t){var e=this;if(t){var r=t.k,n=e._waitingMap[r];delete e._waitingMap[r],n&&(e._requestTimer&&clearTimeout(e._requestTimer),n.doResponse(null,t))}},n.prototype._on_error=function(t){var e=this;console.error("Websocket Error:",t),e.emit("error"),e.mgr&&e.mgr.emit("error"),e.socket&&e.socket.socketState()!=e.socket.WEBSOCKET_STATE_CLOSED&&e.socket.socketState()!=e.socket.WEBSOCKET_STATE_CLOSING&&(console.error("Websocket send close by error. socketState:"+e.socket.socketState()),e.socket.close())},n.prototype._on_notify=function(e){var r=this;r.mgr&&r.mgr.emit("notify",e);var n=e.n;if(n){var o=e.v,i=e.e;i&&(o=t.CRYPTO.decryptoDataFromClientKey(t.PROJ.strIV,i)),r.mgr&&r.mgr.emit("notify:"+n,o)}},n.prototype._on_param=function(t){var e=this;if(t&&"object"==typeof t){var r=t.e,n=t.d;"response"==r?e._on_response(n):"notify"==r&&e._on_notify(n)}e.mgr&&e.mgr.emit("param",t)},n.prototype._on_connect=function(){var t=this;t.emit("connect"),t.mgr&&t.mgr.emit("connect")},n.prototype._on_close=function(){var t=this;t.emit("close"),t.mgr&&t.mgr.emit("close"),t.socket&&t.socket.socketState()!=t.socket.WEBSOCKET_STATE_CLOSED&&t.socket.socketState()!=t.socket.WEBSOCKET_STATE_CLOSING&&(console.error("Websocket closed. socketState:"+t.socket.socketState()),t.socket.close())},n.prototype.connect=function(t){var r=this,n=r.socket;n||(n=r.socket=new e.WebSocket,n.on("param",r._on_param,r),n.on("error",r._on_error,r),n.on("connect",r._on_connect,r),n.on("close",r._on_close,r)),n.autoReconnectEnabled=r.autoReconnectEnabled,n.connectStatus<2?(n.once("connect",function(){t&&t(null,n)}),n.connectStatus||n.connect(r.url)):t&&t(null,n)},n.prototype.requestSocket=function(e,r){var n=this,o=t.DATE.now()+"-"+t.NUM.rand(1e5);r.k=o,n._waitingMap[o]=e,n.connect(function(i,a){return i?(console.error("Webscoket Connect Error:"+i),delete n._waitingMap[o],void e.doResponse(null,{m:i})):(n._testRequestTimeout||a.send("request",r),void(t.PROJ.reconnectWhenTimeout&&n.prepareForTimeout()))})},n.prototype.handleRspStr=function(t){if("object"==typeof t)return t;try{return JSON.parse(t)}catch(e){return console.error("Websocket handleRspStr:"+t+" Error:",e),{m:"返回数据结构有误！"}}},n.prototype.handleRspErr=function(t){return console.error("Websocket handleRspErr:"+t),t=""!=t?t:"网络不稳定",{m:t}},n.prototype.prepareForTimeout=function(){var t=this;t._requestTimer&&(clearTimeout(t._requestTimer),t._requestTimer=null),t._requestTimer=setTimeout(function(){if(t.socket){t._on_error("Websocket repquest timeout");try{t.socket.socketState()!=t.socket.WEBSOCKET_STATE_CLOSED&&t.socket.socketState()!=t.socket.WEBSOCKET_STATE_CLOSING&&(console.error("Websocket Error:Request timeout.TimeoutTime:"+t._timeout+" socketState:"+t.socket.socketState()),t.socket.close())}catch(e){console.error("PrepareForTimeout Error:",e)}}},t._timeout)},n}(e.BaseNet);e.WebSocketNet=r,__reflect(r.prototype,"mo.NET.WebSocketNet")}(e=t.NET||(t.NET={}))}(mo||(mo={}));var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mo;!function(t){var e;!function(e){var r=function(r){function n(){return r.apply(this,arguments)||this}return __extends(n,r),n.prototype.doResponse=function(t,r){var n=this,o=n.net;if(t){var i=o?o.handleRspErr(t):t;e.log("rsp error--->",i),n.onError&&n.onError.call(n.ctx,i,n)}else{var a=o?o.handleRspStr(r):r;e.log("rsp success--->",a),n.onSuccess&&n.onSuccess.call(n.ctx,a,n)}},n.prototype._getParams=function(){var e=this,r={},n=e.iface,o=n.indexOf("."),i=n.substring(o+1),a=e.net?e.net.token:null,s=JSON.stringify([i,e.args||{},a]),u=e.net,l=u?u.cryptoKey:null;l=l||t.PROJ.cryptoKey,u&&u.cryptoEnabled&&(s=t.CRYPTO.enCharCode(s,l));var c=t.MD5.sign(s,l);return r.a=s,r.sign=c,r},n.prototype.send=function(){var t=this,e=t.net,r=t._getParams(),n=t.iface,o=n.indexOf("."),i=n.substring(0,o);e.requestSocket(t,{r:i,p:r})},n}(e.BaseReqHandler);e.WebSocketReqHandler=r,__reflect(r.prototype,"mo.NET.WebSocketReqHandler")}(e=t.NET||(t.NET={}))}(mo||(mo={}));