function __extends(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i}var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},egret;!function(t){function e(){return""}function i(t){throw new Error("#"+t)}function r(){}function n(){}function o(){}t.getString=e,t.$error=i,t.$warn=r,t.$markReadOnly=n,t.$markCannotUse=o}(egret||(egret={}));var egret;!function(t){function e(e,i,r){e||t.$error(1003,"classDefinition"),e.prototype||t.$error(1012,"classDefinition"),void 0===i&&t.$error(1003,"className");var n=e.prototype;n.__class__=i;var o=[i];r&&(o=o.concat(r));var a=n.__types__;if(n.__types__)for(var s=a.length,l=0;s>l;l++){var h=a[l];-1==o.indexOf(h)&&o.push(h)}n.__types__=o}t.registerClass=e}(egret||(egret={}));var __define=this.__define||function(t,e,i,r){Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get:i,set:r})},egret;!function(t){t.$hashCount=1;var e=function(){function e(){this.$hashCode=t.$hashCount++}return Object.defineProperty(e.prototype,"hashCode",{get:function(){return this.$hashCode},enumerable:!0,configurable:!0}),e}();t.HashObject=e,__reflect(e.prototype,"egret.HashObject",["egret.IHashObject"]),t.$markReadOnly(e,"hashCode")}(egret||(egret={}));var egret;!function(t){var e=[],i=function(i){function r(t,e,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===n&&(n=0);var o=i.call(this)||this;return o.x=t,o.y=e,o.width=r,o.height=n,o}return __extends(r,i),r.release=function(t){t&&e.push(t)},r.create=function(){var t=e.pop();return t||(t=new r),t},Object.defineProperty(r.prototype,"right",{get:function(){return this.x+this.width},set:function(t){this.width=t-this.x},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bottom",{get:function(){return this.y+this.height},set:function(t){this.height=t-this.y},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"left",{get:function(){return this.x},set:function(t){this.width+=this.x-t,this.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"top",{get:function(){return this.y},set:function(t){this.height+=this.y-t,this.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"topLeft",{get:function(){return new t.Point(this.left,this.top)},set:function(t){this.top=t.y,this.left=t.x},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bottomRight",{get:function(){return new t.Point(this.right,this.bottom)},set:function(t){this.bottom=t.y,this.right=t.x},enumerable:!0,configurable:!0}),r.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},r.prototype.setTo=function(t,e,i,r){return this.x=t,this.y=e,this.width=i,this.height=r,this},r.prototype.contains=function(t,e){return this.x<=t&&this.x+this.width>=t&&this.y<=e&&this.y+this.height>=e},r.prototype.intersection=function(t){return this.clone().$intersectInPlace(t)},r.prototype.inflate=function(t,e){this.x-=t,this.width+=2*t,this.y-=e,this.height+=2*e},r.prototype.$intersectInPlace=function(t){var e=this.x,i=this.y,r=t.x,n=t.y,o=Math.max(e,r),a=Math.min(e+this.width,r+t.width);if(a>=o){var s=Math.max(i,n),l=Math.min(i+this.height,n+t.height);if(l>=s)return this.setTo(o,s,a-o,l-s),this}return this.setEmpty(),this},r.prototype.intersects=function(t){return Math.max(this.x,t.x)<=Math.min(this.right,t.right)&&Math.max(this.y,t.y)<=Math.min(this.bottom,t.bottom)},r.prototype.isEmpty=function(){return this.width<=0||this.height<=0},r.prototype.setEmpty=function(){this.x=0,this.y=0,this.width=0,this.height=0},r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height)},r.prototype.containsPoint=function(t){return this.x<t.x&&this.x+this.width>t.x&&this.y<t.y&&this.y+this.height>t.y?!0:!1},r.prototype.containsRect=function(t){var e=t.x+t.width,i=t.y+t.height,r=this.x+this.width,n=this.y+this.height;return t.x>=this.x&&t.x<r&&t.y>=this.y&&t.y<n&&e>this.x&&r>=e&&i>this.y&&n>=i},r.prototype.equals=function(t){return this===t?!0:this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height},r.prototype.inflatePoint=function(t){this.inflate(t.x,t.y)},r.prototype.offset=function(t,e){this.x+=t,this.y+=e},r.prototype.offsetPoint=function(t){this.offset(t.x,t.y)},r.prototype.toString=function(){return"(x="+this.x+", y="+this.y+", width="+this.width+", height="+this.height+")"},r.prototype.union=function(t){var e=this.clone();if(t.isEmpty())return e;if(e.isEmpty())return e.copyFrom(t),e;var i=Math.min(e.x,t.x),r=Math.min(e.y,t.y);return e.setTo(i,r,Math.max(e.right,t.right)-i,Math.max(e.bottom,t.bottom)-r),e},r.prototype.$getBaseWidth=function(t){var e=Math.abs(Math.cos(t)),i=Math.abs(Math.sin(t));return e*this.width+i*this.height},r.prototype.$getBaseHeight=function(t){var e=Math.abs(Math.cos(t)),i=Math.abs(Math.sin(t));return i*this.width+e*this.height},r}(t.HashObject);t.Rectangle=i,__reflect(i.prototype,"egret.Rectangle"),t.$TempRectangle=new i}(egret||(egret={}));var egret;!function(t){var e=[],i=function(i){function r(t){void 0===t&&(t=null);var e=i.call(this)||this;return e.$EventDispatcher={0:t?t:e,1:{},2:{},3:0},e}return __extends(r,i),r.prototype.$getEventMap=function(t){var e=this.$EventDispatcher,i=t?e[2]:e[1];return i},r.prototype.addEventListener=function(t,e,i,r,n){this.$addListener(t,e,i,r,n)},r.prototype.once=function(t,e,i,r,n){this.$addListener(t,e,i,r,n,!0)},r.prototype.$addListener=function(e,i,r,n,o,a){i||t.$error(1003,"listener");var s=this.$EventDispatcher,l=n?s[2]:s[1],h=l[e];h?0!==s[3]&&(l[e]=h=h.concat()):h=l[e]=[],this.$insertEventBin(h,e,i,r,n,o,a)},r.prototype.$insertEventBin=function(t,e,i,r,n,o,a){o=0|+o;for(var s=-1,l=t.length,h=0;l>h;h++){var u=t[h];if(u.listener==i&&u.thisObject==r&&u.target==this)return!1;-1==s&&u.priority<o&&(s=h)}var c={type:e,listener:i,thisObject:r,priority:o,target:this,useCapture:n,dispatchOnce:!!a};return-1!==s?t.splice(s,0,c):t.push(c),!0},r.prototype.removeEventListener=function(t,e,i,r){var n=this.$EventDispatcher,o=r?n[2]:n[1],a=o[t];a&&(0!==n[3]&&(o[t]=a=a.concat()),this.$removeEventBin(a,e,i),0==a.length&&(o[t]=null))},r.prototype.$removeEventBin=function(t,e,i){for(var r=t.length,n=0;r>n;n++){var o=t[n];if(o.listener==e&&o.thisObject==i&&o.target==this)return t.splice(n,1),!0}return!1},r.prototype.hasEventListener=function(t){var e=this.$EventDispatcher;return!(!e[1][t]&&!e[2][t])},r.prototype.willTrigger=function(t){return this.hasEventListener(t)},r.prototype.dispatchEvent=function(t){return t.$currentTarget=this.$EventDispatcher[0],t.$setTarget(t.$currentTarget),this.$notifyListener(t,!1)},r.prototype.$notifyListener=function(t,i){var r=this.$EventDispatcher,n=i?r[2]:r[1],o=n[t.$type];if(!o)return!0;var a=o.length;if(0==a)return!0;var s=e;r[3]++;for(var l=0;a>l;l++){var h=o[l];if(h.listener.call(h.thisObject,t),h.dispatchOnce&&s.push(h),t.$isPropagationImmediateStopped)break}for(r[3]--;s.length;){var h=s.pop();h.target.removeEventListener(h.type,h.listener,h.thisObject,h.useCapture)}return!t.$isDefaultPrevented},r.prototype.dispatchEventWith=function(e,i,r,n){if(i||this.hasEventListener(e)){var o=t.Event.create(t.Event,e,i,n);o.data=r;var a=this.dispatchEvent(o);return t.Event.release(o),a}return!0},r}(t.HashObject);t.EventDispatcher=i,__reflect(i.prototype,"egret.EventDispatcher",["egret.IEventDispatcher"])}(egret||(egret={}));var egret;!function(t){function e(t){return t%=360,t>180?t-=360:-180>t&&(t+=360),t}var i=function(i){function r(){var e=i.call(this)||this;return e.$children=null,e.$parent=null,e.$stage=null,e.$nestLevel=0,e.$visible=!0,e.$displayList=null,e.$alpha=1,e.$touchEnabled=r.defaultTouchEnabled,e.$scrollRect=null,e.$blendMode=0,e.$maskedObject=null,e.$mask=null,e.$maskRect=null,e.$parentDisplayList=null,e.$renderNode=null,e.$displayFlags=2032,e.$DisplayObject={0:1,1:1,2:0,3:0,4:0,5:"",6:new t.Matrix,7:new t.Matrix,8:new t.Matrix,9:new t.Rectangle,10:new t.Rectangle,11:!1,12:0,13:0,14:0/0,15:0/0,16:0,17:0,18:0,19:null,20:null},e}return __extends(r,i),r.prototype.$setFlags=function(t){this.$displayFlags|=t},r.prototype.$removeFlags=function(t){this.$displayFlags&=~t},r.prototype.$removeFlagsUp=function(t){if(this.$hasAnyFlags(t)){this.$removeFlags(t);var e=this.$parent;e&&e.$removeFlagsUp(t)}},r.prototype.$hasFlags=function(t){return(this.$displayFlags&t)==t},r.prototype.$propagateFlagsUp=function(t){if(!this.$hasFlags(t)){this.$setFlags(t);var e=this.$parent;e&&e.$propagateFlagsUp(t)}},r.prototype.$propagateFlagsDown=function(t,e){void 0===e&&(e=!1),this.$setFlags(t)},r.prototype.$hasAnyFlags=function(t){return!!(this.$displayFlags&t)},r.prototype.$invalidateMatrix=function(){this.$setFlags(8),this.$invalidatePosition()},r.prototype.$invalidatePosition=function(){var t=this;t.$invalidateTransform(),t.$propagateFlagsDown(48),t.$parent&&t.$parent.$propagateFlagsUp(4)},Object.defineProperty(r.prototype,"name",{get:function(){return this.$DisplayObject[5]},set:function(t){this.$DisplayObject[5]=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"parent",{get:function(){return this.$parent},enumerable:!0,configurable:!0}),r.prototype.$setParent=function(t){return this.$parent==t?!1:(this.$parent=t,!0)},r.prototype.$onAddToStage=function(e,i){this.$stage=e,this.$nestLevel=i,this.$hasAddToStage=!0,t.Sprite.$EVENT_ADD_TO_STAGE_LIST.push(this)},r.prototype.$onRemoveFromStage=function(){this.$nestLevel=0,t.Sprite.$EVENT_REMOVE_FROM_STAGE_LIST.push(this)},Object.defineProperty(r.prototype,"stage",{get:function(){return this.$stage},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"matrix",{get:function(){return this.$getMatrix().clone()},set:function(t){this.$setMatrix(t)},enumerable:!0,configurable:!0}),r.prototype.$getMatrix=function(){var t=this.$DisplayObject;return this.$hasFlags(8)&&(t[6].$updateScaleAndRotation(t[0],t[1],t[2],t[3]),this.$removeFlags(8)),t[6]},r.prototype.$setMatrix=function(t,i){void 0===i&&(i=!0);var r=this,n=r.$DisplayObject,o=n[6];return o.equals(t)?!1:(o.copyFrom(t),i&&(n[0]=o.$getScaleX(),n[1]=o.$getScaleY(),n[2]=t.$getSkewX(),n[3]=t.$getSkewY(),n[16]=e(180*n[2]/Math.PI),n[17]=e(180*n[3]/Math.PI),n[4]=e(180*n[3]/Math.PI)),r.$removeFlags(8),r.$invalidatePosition(),!0)},r.prototype.$getConcatenatedMatrix=function(){var e=this.$DisplayObject[7];if(this.$hasFlags(16)){this.$parent?this.$parent.$getConcatenatedMatrix().$preMultiplyInto(this.$getMatrix(),e):e.copyFrom(this.$getMatrix());var i=this.$DisplayObject,r=i[12],n=i[13],o=this.$scrollRect;o?e.$preMultiplyInto(t.$TempMatrix.setTo(1,0,0,1,-o.x-r,-o.y-n),e):(0!=r||0!=n)&&e.$preMultiplyInto(t.$TempMatrix.setTo(1,0,0,1,-r,-n),e),this.$displayList&&(this.$displayList.$renderNode.moved=!0),this.$renderNode&&(this.$renderNode.moved=!0),this.$removeFlags(16)}return e},r.prototype.$getInvertedConcatenatedMatrix=function(){var t=this.$DisplayObject;return this.$hasFlags(32)&&(this.$getConcatenatedMatrix().$invertInto(t[8]),this.$removeFlags(32)),t[8]},Object.defineProperty(r.prototype,"x",{get:function(){return this.$getX()},set:function(t){this.$setX(t)},enumerable:!0,configurable:!0}),r.prototype.$getX=function(){return this.$DisplayObject[6].tx},r.prototype.$setX=function(t){t=+t||0;var e=this.$DisplayObject[6];return t==e.tx?!1:(e.tx=t,this.$invalidatePosition(),!0)},Object.defineProperty(r.prototype,"y",{get:function(){return this.$getY()},set:function(t){this.$setY(t)},enumerable:!0,configurable:!0}),r.prototype.$getY=function(){return this.$DisplayObject[6].ty},r.prototype.$setY=function(t){t=+t||0;var e=this.$DisplayObject[6];return t==e.ty?!1:(e.ty=t,this.$invalidatePosition(),!0)},Object.defineProperty(r.prototype,"scaleX",{get:function(){return this.$getScaleX()},set:function(t){this.$setScaleX(t)},enumerable:!0,configurable:!0}),r.prototype.$getScaleX=function(){return this.$DisplayObject[0]},r.prototype.$setScaleX=function(t){t=+t||0;var e=this.$DisplayObject;return t==e[0]?!1:(e[0]=t,this.$invalidateMatrix(),!0)},Object.defineProperty(r.prototype,"scaleY",{get:function(){return this.$getScaleY()},set:function(t){this.$setScaleY(t)},enumerable:!0,configurable:!0}),r.prototype.$getScaleY=function(){return this.$DisplayObject[1]},r.prototype.$setScaleY=function(t){return t=+t||0,t==this.$DisplayObject[1]?!1:(this.$DisplayObject[1]=t,this.$invalidateMatrix(),!0)},Object.defineProperty(r.prototype,"rotation",{get:function(){return this.$getRotation()},set:function(t){this.$setRotation(t)},enumerable:!0,configurable:!0}),r.prototype.$getRotation=function(){return this.$DisplayObject[4]},r.prototype.$setRotation=function(t){t=+t||0,t=e(t);var i=this.$DisplayObject;if(t==i[4])return!1;var r=t-i[4],n=r/180*Math.PI;return i[2]+=n,i[3]+=n,i[4]=t,this.$invalidateMatrix(),!0},Object.defineProperty(r.prototype,"skewX",{get:function(){return this.$DisplayObject[16]},set:function(t){this.$setSkewX(t)},enumerable:!0,configurable:!0}),r.prototype.$setSkewX=function(t){t=+t||0;var i=this.$DisplayObject;return t==i[16]?!1:(i[16]=t,t=e(t),t=t/180*Math.PI,i[2]=t,this.$invalidateMatrix(),!0)},Object.defineProperty(r.prototype,"skewY",{get:function(){return this.$DisplayObject[17]},set:function(t){this.$setSkewY(t)},enumerable:!0,configurable:!0}),r.prototype.$setSkewY=function(t){t=+t||0;var i=this.$DisplayObject;return t==i[17]?!1:(i[17]=t,t=e(t),t=t/180*Math.PI,i[3]=t,this.$invalidateMatrix(),!0)},Object.defineProperty(r.prototype,"width",{get:function(){return this.$getWidth()},set:function(t){this.$setWidth(t)},enumerable:!0,configurable:!0}),r.prototype.$getWidth=function(){return isNaN(this.$getExplicitWidth())?this.$getOriginalBounds().width:this.$getExplicitWidth()},r.prototype.$getExplicitWidth=function(){return this.$DisplayObject[14]},r.prototype.$setWidth=function(t){return this.$DisplayObject[14]=isNaN(t)?0/0:t,t=+t,0>t?!1:(this.$invalidateMatrix(),!0)},Object.defineProperty(r.prototype,"height",{get:function(){return this.$getHeight()},set:function(t){this.$setHeight(t)},enumerable:!0,configurable:!0}),r.prototype.$getHeight=function(){return isNaN(this.$getExplicitHeight())?this.$getOriginalBounds().height:this.$getExplicitHeight()},r.prototype.$getExplicitHeight=function(){return this.$DisplayObject[15]},r.prototype.$setHeight=function(t){return this.$DisplayObject[15]=isNaN(t)?0/0:t,t=+t,0>t?!1:(this.$invalidateMatrix(),!0)},Object.defineProperty(r.prototype,"measuredWidth",{get:function(){return this.$getOriginalBounds().width},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"measuredHeight",{get:function(){return this.$getOriginalBounds().height},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"anchorOffsetX",{get:function(){return this.$DisplayObject[12]},set:function(t){this.$setAnchorOffsetX(t)},enumerable:!0,configurable:!0}),r.prototype.$getAnchorOffsetX=function(){return this.$DisplayObject[12]},r.prototype.$setAnchorOffsetX=function(t){return t=+t||0,t==this.$DisplayObject[12]?!1:(this.$DisplayObject[12]=t,this.$invalidatePosition(),!0)},Object.defineProperty(r.prototype,"anchorOffsetY",{get:function(){return this.$DisplayObject[13]},set:function(t){this.$setAnchorOffsetY(t)},enumerable:!0,configurable:!0}),r.prototype.$getAnchorOffsetY=function(){return this.$DisplayObject[13]},r.prototype.$setAnchorOffsetY=function(t){return t=+t||0,t==this.$DisplayObject[13]?!1:(this.$DisplayObject[13]=t,this.$invalidatePosition(),!0)},Object.defineProperty(r.prototype,"visible",{get:function(){return this.$visible},set:function(t){this.$setVisible(t)},enumerable:!0,configurable:!0}),r.prototype.$setVisible=function(t){return t=!!t,t==this.$visible?!1:(this.$visible=t,this.$propagateFlagsDown(1024),this.$invalidateTransform(),!0)},r.prototype.$getConcatenatedVisible=function(){var t=this.$DisplayObject;if(this.$hasFlags(1024)){if(this.$parent){var e=this.$parent.$getConcatenatedVisible();t[19]=e&&this.$visible}else t[19]=this.$visible;this.$removeFlags(1024)}return t[19]},Object.defineProperty(r.prototype,"cacheAsBitmap",{get:function(){return this.$DisplayObject[11]},set:function(t){t=!!t,this.$DisplayObject[11]=t,this.$setHasDisplayList(t)},enumerable:!0,configurable:!0}),r.prototype.$setHasDisplayList=function(e){var i=!!this.$displayList;if(i!=e)if(e){var r=t.sys.DisplayList.create(this);r&&(this.$displayList=r,this.$parentDisplayList&&this.$parentDisplayList.markDirty(r),this.$cacheAsBitmapChanged())}else this.$displayList=null,this.$cacheAsBitmapChanged()},r.prototype.$cacheAsBitmapChanged=function(){var t=this.$displayList||this.$parentDisplayList;this.$renderNode&&t&&t.markDirty(this),this.$propagateFlagsDown(48)},Object.defineProperty(r.prototype,"alpha",{get:function(){return this.$alpha},set:function(t){this.$setAlpha(t)},enumerable:!0,configurable:!0}),r.prototype.$setAlpha=function(t){return t=+t||0,t==this.$alpha?!1:(this.$alpha=t,this.$propagateFlagsDown(64),this.$invalidate(),!0)},r.prototype.$getConcatenatedAlpha=function(){var t=this.$DisplayObject;if(this.$hasFlags(64)){if(this.$parent){var e=this.$parent.$getConcatenatedAlpha();t[18]=e*this.$alpha}else t[18]=this.$alpha;this.$removeFlags(64)}return t[18]},Object.defineProperty(r.prototype,"touchEnabled",{get:function(){return this.$getTouchEnabled()},set:function(t){this.$setTouchEnabled(t)},enumerable:!0,configurable:!0}),r.prototype.$getTouchEnabled=function(){return this.$touchEnabled},r.prototype.$setTouchEnabled=function(t){return this.$touchEnabled==t?!1:(this.$touchEnabled=t,!0)},Object.defineProperty(r.prototype,"scrollRect",{get:function(){return this.$scrollRect},set:function(t){this.$setScrollRect(t)},enumerable:!0,configurable:!0}),r.prototype.$setScrollRect=function(e){return e||this.$scrollRect?(e?(this.$scrollRect||(this.$scrollRect=new t.Rectangle),this.$scrollRect.copyFrom(e)):this.$scrollRect=null,this.$invalidatePosition(),!0):!1},Object.defineProperty(r.prototype,"blendMode",{get:function(){return t.sys.numberToBlendMode(this.$blendMode)},set:function(e){var i=t.sys.blendModeToNumber(e);i!=this.$blendMode&&(this.$blendMode=i,this.$invalidateTransform())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"mask",{get:function(){return this.$mask?this.$mask:this.$maskRect},set:function(t){if(t!==this){if(t)if(t instanceof r){if(t==this.$mask)return;t.$maskedObject&&(t.$maskedObject.mask=null),t.$maskedObject=this,t.$invalidateTransform(),this.$mask=t,this.$maskRect=null}else this.$setMaskRect(t),this.$mask&&(this.$mask.$maskedObject=null,this.$mask.$invalidateTransform()),this.$mask=null;else this.$mask&&(this.$mask.$maskedObject=null,this.$mask.$invalidateTransform()),this.$mask=null,this.$maskRect=null;this.$invalidateTransform()}},enumerable:!0,configurable:!0}),r.prototype.$setMaskRect=function(e){return e||this.$maskRect?(e?(this.$maskRect||(this.$maskRect=new t.Rectangle),this.$maskRect.copyFrom(e)):this.$maskRect=null,this.$invalidatePosition(),!0):!1},Object.defineProperty(r.prototype,"filters",{get:function(){return this.$DisplayObject[20]},set:function(t){var e=this.$DisplayObject[20];if(!e&&!t)return void(this.$DisplayObject[20]=t);if(this.$invalidateContentBounds(),this.$invalidate(!0),e&&e.length)for(var i=e.length,r=0;i>r;r++)e[r].$removeTarget(this);if(this.$DisplayObject[20]=t,t&&t.length)for(var n=t.length,r=0;n>r;r++)t[r].$addTarget(this)},enumerable:!0,configurable:!0}),r.prototype.$getFilters=function(){return this.$DisplayObject[20]},r.prototype.getTransformedBounds=function(t,e){return t=t||this,this.$getTransformedBounds(t,e)},r.prototype.getBounds=function(t,e){if(void 0===e&&(e=!0),t=this.$getTransformedBounds(this,t),e){var i=this.$DisplayObject;(0!=i[12]||0!=i[13])&&(t.x-=i[12],t.y-=i[13])}return t},r.prototype.$getTransformedBounds=function(e,i){var r=this.$getOriginalBounds();if(i||(i=new t.Rectangle),i.copyFrom(r),e==this)return i;var n;if(e){n=t.$TempMatrix;var o=e.$getInvertedConcatenatedMatrix();o.$preMultiplyInto(this.$getConcatenatedMatrix(),n)}else n=this.$getConcatenatedMatrix();return n.$transformBounds(i),i},r.prototype.globalToLocal=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0);var r=this.$getInvertedConcatenatedMatrix();return r.transformPoint(t,e,i)},r.prototype.localToGlobal=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0);var r=this.$getConcatenatedMatrix();return r.transformPoint(t,e,i)},r.prototype.$invalidateContentBounds=function(){this.$invalidate(),this.$setFlags(2),this.$propagateFlagsUp(4)},r.prototype.$getOriginalBounds=function(){var t=this.$DisplayObject[9];if(this.$hasFlags(4)){t.copyFrom(this.$getContentBounds()),this.$measureChildBounds(t),this.$removeFlags(4),this.$displayList&&(this.$displayList.$renderNode.moved=!0);var e=this.$measureFiltersOffset();e&&(t.x+=e.minX,t.y+=e.minY,t.width+=e.maxX,t.height+=e.maxY)}return t},r.prototype.$measureChildBounds=function(){},r.prototype.$getContentBounds=function(){var t=this.$DisplayObject[10];return this.$hasFlags(2)&&(this.$measureContentBounds(t),this.$renderNode&&(this.$renderNode.moved=!0),this.$removeFlags(2)),t},r.prototype.$measureContentBounds=function(){},r.prototype.$invalidate=function(){if(this.$renderNode&&!this.$hasFlags(384)){this.$setFlags(384);var t=this.$displayList?this.$displayList:this.$parentDisplayList;t&&t.markDirty(this)}},r.prototype.$invalidateTransform=function(){var t=this;if(!t.$hasFlags(512)){t.$setFlags(512);var e=t.$displayList;(e||t.$renderNode)&&t.$parentDisplayList&&t.$parentDisplayList.markDirty(e||t)}},r.prototype.$getRenderNode=function(){var t=this.$renderNode;return t?(128&this.$displayFlags&&(t.cleanBeforeRender(),this.$render(),this.$removeFlags(128),t=this.$renderNode),t):null},r.prototype.$update=function(e,i){var r=this;r.$removeFlagsUp(768);var n=r.$renderNode;n.renderAlpha=r.$getConcatenatedAlpha();var o=r.$getConcatenatedMatrix();if(e==t.DirtyRegionPolicy.OFF){var a=r.$displayList||r.$parentDisplayList;if(!a)return!1;var s=n.renderMatrix;s.copyFrom(o);var l=a.root;l!==r.$stage&&r.$getConcatenatedMatrixAt(l,s)}else{var h=i||r.$getContentBounds();n.renderVisible=r.$getConcatenatedVisible();var a=r.$displayList||r.$parentDisplayList,u=n.renderRegion;if(!a)return u.setTo(0,0,0,0),n.moved=!1,!1;if(!n.moved)return!1;n.moved=!1;var s=n.renderMatrix;s.copyFrom(o);var l=a.root;l!==r.$stage&&r.$getConcatenatedMatrixAt(l,s),u.updateRegion(h,s);var c=r.$measureFiltersOffset();c&&(u.minX+=c.minX,u.minY+=c.minY,u.maxX+=c.maxX,u.maxY+=c.maxY,u.updateArea())}return!0},r.prototype.$measureFiltersOffset=function(){var e=this.$DisplayObject[20];if(e&&e.length){for(var i=e.length,r=0,n=0,o=0,a=0,s=0;i>s;s++){var l=e[s];if("blur"==l.type){var h=l.blurX,u=l.blurY;r-=h,n-=u,o+=2*h,a+=2*u}else if("glow"==l.type){var h=l.blurX,u=l.blurY;r-=h,n-=u,o+=2*h,a+=2*u;var c=l.distance||0,p=l.angle||0,d=0,f=0;0!=c&&(d=Math.ceil(c*t.NumberUtils.cos(p)),f=Math.ceil(c*t.NumberUtils.sin(p)),d>0?o+=d:0>d&&(r+=d,o-=d),f>0?a+=f:0>f&&(n+=f,a-=f))}}return{minX:r,minY:n,maxX:o,maxY:a}}return null},r.prototype.$getConcatenatedMatrixAt=function(e,i){var r=e.$getInvertedConcatenatedMatrix();if(0===r.a||0===r.d){var n=this,o=e.$nestLevel;for(i.identity();n.$nestLevel>o;){var a=n.$scrollRect;a&&i.concat(t.$TempMatrix.setTo(1,0,0,1,-a.x,-a.y)),i.concat(n.$getMatrix()),n=n.$parent}}else r.$preMultiplyInto(i,i)},r.prototype.$getConcatenatedAlphaAt=function(t,e){var i=t.$getConcatenatedAlpha();if(0===i){e=1;for(var r=this,n=t.$nestLevel;r.$nestLevel>n;)e*=r.$alpha,r=r.$parent}else e/=i;return e},r.prototype.$render=function(){},r.prototype.$hitTest=function(t,e){var i=this.$DisplayObject;if(!this.$renderNode||!this.$visible||0==i[0]||0==i[1])return null;var r=this.$getInvertedConcatenatedMatrix();if(0==r.a&&0==r.b&&0==r.c&&0==r.d)return null;var n=this.$getContentBounds(),o=r.a*t+r.c*e+r.tx,a=r.b*t+r.d*e+r.ty;if(n.contains(o,a)){if(!this.$children){var s=this.$scrollRect?this.$scrollRect:this.$maskRect;if(s&&!s.contains(o,a))return null;if(this.$mask&&!this.$mask.$hitTest(t,e))return null}return this}return null},r.prototype.hitTestPoint=function(e,i,r){if(r){var n=this.$getInvertedConcatenatedMatrix(),o=n.a*e+n.c*i+n.tx,a=n.b*e+n.d*i+n.ty,s=void 0,l=this.$displayList;if(l){var h=l.renderBuffer;try{s=h.getPixels(o-l.offsetX,a-l.offsetY)}catch(u){throw new Error(t.sys.tr(1039))}}else{var h=t.sys.customHitTestBuffer;h.resize(3,3);var c=t.Matrix.create();c.identity(),c.translate(1-o,1-a),t.sys.systemRenderer.render(this,h,c,null,!0),t.Matrix.release(c);try{s=h.getPixels(1,1)}catch(u){throw new Error(t.sys.tr(1039))}}return 0===s[3]?!1:!0}var p=this.$DisplayObject;if(0==p[0]||0==p[1])return!1;var n=this.$getInvertedConcatenatedMatrix(),d=this.getBounds(null,!1),o=n.a*e+n.c*i+n.tx,a=n.b*e+n.d*i+n.ty;if(d.contains(o,a)){var f=this.$scrollRect?this.$scrollRect:this.$maskRect;return f&&!f.contains(o,a)?!1:!0}return!1},r.prototype.$addListener=function(e,n,o,a,s,l){i.prototype.$addListener.call(this,e,n,o,a,s,l);var h=e==t.Event.ENTER_FRAME;if(h||e==t.Event.RENDER){var u=h?r.$enterFrameCallBackList:r.$renderCallBackList;-1==u.indexOf(this)&&u.push(this)}},r.prototype.removeEventListener=function(e,n,o,a){i.prototype.removeEventListener.call(this,e,n,o,a);var s=e==t.Event.ENTER_FRAME;if((s||e==t.Event.RENDER)&&!this.hasEventListener(e)){var l=s?r.$enterFrameCallBackList:r.$renderCallBackList,h=l.indexOf(this);-1!==h&&l.splice(h,1)}},r.prototype.dispatchEvent=function(t){if(!t.$bubbles)return i.prototype.dispatchEvent.call(this,t);var e=this.$getPropagationList(this),r=.5*e.length;return t.$setTarget(this),this.$dispatchPropagationEvent(t,e,r),!t.$isDefaultPrevented},r.prototype.$getPropagationList=function(t){for(var e=[];t;)e.push(t),t=t.$parent;var i=e.concat();return i.reverse(),e=i.concat(e)},r.prototype.$dispatchPropagationEvent=function(t,e,i){for(var r=e.length,n=i-1,o=0;r>o;o++){var a=e[o];if(t.$currentTarget=a,t.$eventPhase=n>o?1:o==i||o==n?2:3,a.$notifyListener(t,i>o),t.$isPropagationStopped||t.$isPropagationImmediateStopped)return}},r.prototype.willTrigger=function(t){for(var e=this;e;){if(e.hasEventListener(t))return!0;e=e.$parent}return!1},r}(t.EventDispatcher);i.defaultTouchEnabled=!1,i.boundsForUpdate=new t.Rectangle,i.$enterFrameCallBackList=[],i.$renderCallBackList=[],t.DisplayObject=i,__reflect(i.prototype,"egret.DisplayObject",["egret.sys.Renderable"]),t.$markReadOnly(i,"parent"),t.$markReadOnly(i,"stage")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.$touchChildren=!0,t.$children=[],t}return __extends(i,e),i.prototype.$propagateFlagsDown=function(t,e){if(void 0===e&&(e=!1),!this.$hasFlags(t)&&(this.$setFlags(t),!e||!this.$displayList))for(var i=this.$children,r=i.length,n=0;r>n;n++)i[n].$propagateFlagsDown(t,e)},Object.defineProperty(i.prototype,"numChildren",{get:function(){return this.$children.length},enumerable:!0,configurable:!0}),i.prototype.addChild=function(t){var e=this.$children.length;return t.$parent==this&&e--,this.$doAddChild(t,e)},i.prototype.addChildAt=function(t,e){return e=0|+e,(0>e||e>=this.$children.length)&&(e=this.$children.length,t.$parent==this&&e--),this.$doAddChild(t,e)},i.prototype.$doAddChild=function(e,r,n){void 0===n&&(n=!0),e==this?t.$error(1005):e instanceof t.DisplayObjectContainer&&e.contains(this)&&t.$error(1004);var o=e.$parent;if(o==this)return this.doSetChildIndex(e,r),e;o&&o.removeChild(e),this.$children.splice(r,0,e),e.$setParent(this);var a=this.$stage;if(a&&e.$onAddToStage(a,this.$nestLevel+1),n&&e.dispatchEventWith(t.Event.ADDED,!0),a)for(var s=i.$EVENT_ADD_TO_STAGE_LIST;s.length;){var l=s.shift();l.$stage&&n&&l.dispatchEventWith(t.Event.ADDED_TO_STAGE)}var h=this.$displayList||this.$parentDisplayList;return this.assignParentDisplayList(e,h,h),e.$propagateFlagsDown(1648,!0),this.$propagateFlagsUp(4),this.$childAdded(e,r),e},i.prototype.contains=function(t){for(;t;){if(t==this)return!0;t=t.$parent}return!1},i.prototype.getChildAt=function(e){return e=0|+e,e>=0&&e<this.$children.length?this.$children[e]:(t.$error(1007),null)},i.prototype.getChildIndex=function(t){return this.$children.indexOf(t)},i.prototype.getChildByName=function(t){for(var e,i=this.$children,r=i.length,n=0;r>n;n++)if(e=i[n],e.name==t)return e;return null},i.prototype.removeChild=function(e){var i=this.$children.indexOf(e);return i>=0?this.$doRemoveChild(i):(t.$error(1006),null)},i.prototype.removeChildAt=function(e){return e=0|+e,e>=0&&e<this.$children.length?this.$doRemoveChild(e):(t.$error(1007),null)},i.prototype.$doRemoveChild=function(e,r){void 0===r&&(r=!0),e=0|+e;var n=this.$children,o=n[e];if(this.$childRemoved(o,e),r&&o.dispatchEventWith(t.Event.REMOVED,!0),this.$stage){o.$onRemoveFromStage();for(var a=i.$EVENT_REMOVE_FROM_STAGE_LIST;a.length>0;){var s=a.shift();r&&s.$hasAddToStage&&(s.$hasAddToStage=!1,s.dispatchEventWith(t.Event.REMOVED_FROM_STAGE)),s.$hasAddToStage=!1,s.$stage=null}}var l=this.$displayList||this.$parentDisplayList;this.assignParentDisplayList(o,l,null),o.$propagateFlagsDown(1648,!0),o.$setParent(null);var h=n.indexOf(o);return-1!=h&&n.splice(h,1),this.$propagateFlagsUp(4),o},i.prototype.setChildIndex=function(t,e){e=0|+e,(0>e||e>=this.$children.length)&&(e=this.$children.length-1),this.doSetChildIndex(t,e)},i.prototype.doSetChildIndex=function(e,i){var r=this.$children.indexOf(e);0>r&&t.$error(1006),r!=i&&(this.$childRemoved(e,r),this.$children.splice(r,1),this.$children.splice(i,0,e),this.$childAdded(e,i),e.$invalidateTransform(),this.$propagateFlagsUp(4))},i.prototype.swapChildrenAt=function(e,i){e=0|+e,i=0|+i,e>=0&&e<this.$children.length&&i>=0&&i<this.$children.length?this.doSwapChildrenAt(e,i):t.$error(1007)},i.prototype.swapChildren=function(e,i){var r=this.$children.indexOf(e),n=this.$children.indexOf(i);-1==r||-1==n?t.$error(1006):this.doSwapChildrenAt(r,n)},i.prototype.doSwapChildrenAt=function(t,e){if(t>e){var i=e;e=t,t=i}else if(t==e)return;var r=this.$children,n=r[t],o=r[e];this.$childRemoved(n,t),this.$childRemoved(o,e),r[t]=o,r[e]=n,this.$childAdded(o,t),this.$childAdded(n,e),n.$invalidateTransform(),o.$invalidateTransform(),this.$propagateFlagsUp(4)},i.prototype.removeChildren=function(){for(var t=this.$children,e=t.length-1;e>=0;e--)this.$doRemoveChild(e)},i.prototype.$childAdded=function(){},i.prototype.$childRemoved=function(){},i.prototype.$onAddToStage=function(t,i){e.prototype.$onAddToStage.call(this,t,i);var r=this.$children,n=r.length;i++;for(var o=0;n>o;o++){var a=this.$children[o];a.$onAddToStage(t,i)}},i.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this);for(var t=this.$children,i=t.length,r=0;i>r;r++){var n=t[r];n.$onRemoveFromStage()}},i.prototype.$measureChildBounds=function(e){var i=this.$children,r=i.length;if(0!=r){for(var n=0,o=0,a=0,s=0,l=!1,h=-1;r>h;h++){var u=-1==h?e:i[h].$getTransformedBounds(this,t.$TempRectangle);u.isEmpty()||(l?(n=Math.min(n,u.x),o=Math.max(o,u.x+u.width),a=Math.min(a,u.y),s=Math.max(s,u.y+u.height)):(l=!0,n=u.x,o=n+u.width,a=u.y,s=a+u.height))}e.setTo(n,a,o-n,s-a)}},Object.defineProperty(i.prototype,"touchChildren",{get:function(){return this.$getTouchChildren()},set:function(t){this.$setTouchChildren(!!t)},enumerable:!0,configurable:!0}),i.prototype.$getTouchChildren=function(){return this.$touchChildren},i.prototype.$setTouchChildren=function(t){return this.$touchChildren==t?!1:(this.$touchChildren=t,!0)},i.prototype.$invalidate=function(t){if(e.prototype.$invalidate.call(this,t),t){var i=this.$displayList||this.$parentDisplayList,r=this.$children;if(r)for(var n=r.length-1;n>=0;n--)this.markChildDirty(r[n],i)}},i.prototype.$invalidateTransform=function(){this.markChildDirty(this,this.$parentDisplayList)},i.prototype.markChildDirty=function(t,e){if(!t.$hasFlags(512)){t.$setFlags(512);var i=t.$displayList;if((i||t.$renderNode)&&e&&e.markDirty(i||t),!i){var r=t.$children;
if(r)for(var n=r.length-1;n>=0;n--)this.markChildDirty(r[n],e)}}},i.prototype.$cacheAsBitmapChanged=function(){e.prototype.$cacheAsBitmapChanged.call(this);for(var t=this.$displayList||this.$parentDisplayList,i=this.$children,r=i.length-1;r>=0;r--)this.assignParentDisplayList(i[r],t,t)},i.prototype.assignParentDisplayList=function(t,e,i){t.$parentDisplayList=i,t.$setFlags(512);var r=t.$displayList;if((t.$renderNode||r)&&e&&e.markDirty(r||t),!r){var n=t.$children;if(n)for(var o=n.length-1;o>=0;o--)this.assignParentDisplayList(n[o],e,i)}},i.prototype.$hitTest=function(t,i){if(!this.$visible)return null;var r=this.$getInvertedConcatenatedMatrix(),n=r.a*t+r.c*i+r.tx,o=r.b*t+r.d*i+r.ty,a=this.$scrollRect?this.$scrollRect:this.$maskRect;if(a&&!a.contains(n,o))return null;if(this.$mask&&!this.$mask.$hitTest(t,i))return null;for(var s=this.$children,l=!1,h=null,u=s.length-1;u>=0;u--){var c=s[u];if(!c.$maskedObject&&(h=c.$hitTest(t,i))){if(l=!0,h.$touchEnabled)break;h=null}}return h?this.$touchChildren?h:this:l?this:e.prototype.$hitTest.call(this,t,i)},i.prototype.$setAlpha=function(t){return t=+t||0,t==this.$alpha?!1:(this.$alpha=t,this.$propagateFlagsDown(64),this.$invalidate(),this.$invalidateAllChildren(),!0)},i.prototype.$invalidateAllChildren=function(){var t=this.$children;if(t)for(var e=t.length-1;e>=0;e--){var i=t[e];i.$invalidate(),i.$children&&i.$invalidateAllChildren()}},i}(t.DisplayObject);e.$EVENT_ADD_TO_STAGE_LIST=[],e.$EVENT_REMOVE_FROM_STAGE_LIST=[],t.DisplayObjectContainer=e,__reflect(e.prototype,"egret.DisplayObjectContainer"),t.$markReadOnly(e,"numChildren")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(){var e=t.apply(this,arguments)||this;return e.type=null,e.$targets=[],e}return __extends(e,t),e.prototype.$addTarget=function(t){for(var e=this.$targets.length,i=0;e>i;i++)if(this.$targets[i].$hashCode==t.$hashCode)return;this.$targets.push(t)},e.prototype.$removeTarget=function(t){for(var e=this.$targets.length,i=0;e>i;i++)if(this.$targets[i].$hashCode==t.$hashCode)return void this.$targets.splice(i,1)},e.prototype.invalidate=function(){for(var t=this.$targets.length,e=0;t>e;e++)this.$targets[e].$invalidateContentBounds()},e.prototype.$toJson=function(){return""},e}(t.HashObject);t.Filter=e,__reflect(e.prototype,"egret.Filter")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(i){var r=e.call(this)||this;return r._bitmapX=0,r._bitmapY=0,r._textureMap=t.createMap(),r.$texture=i,r._bitmapX=i._bitmapX-i._offsetX,r._bitmapY=i._bitmapY-i._offsetY,r}return __extends(i,e),i.prototype.getTexture=function(t){return this._textureMap[t]},i.prototype.createTexture=function(e,i,r,n,o,a,s,l,h){void 0===a&&(a=0),void 0===s&&(s=0),void 0===l&&(l=a+n),void 0===h&&(h=s+o);var u=new t.Texture;return u._bitmapData=this.$texture._bitmapData,u.$initData(this._bitmapX+i,this._bitmapY+r,n,o,a,s,l,h,this.$texture._sourceWidth,this.$texture._sourceHeight),this._textureMap[e]=u,u},i.prototype.dispose=function(){this.$texture&&this.$texture.dispose()},i}(t.HashObject);t.SpriteSheet=e,__reflect(e.prototype,"egret.SpriteSheet")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,i,r,n){var o=t.call(this)||this;return o.$eventPhase=2,o.$currentTarget=null,o.$target=null,o.$isDefaultPrevented=!1,o.$isPropagationStopped=!1,o.$isPropagationImmediateStopped=!1,o.$type=e,o.$bubbles=!!i,o.$cancelable=!!r,o.data=n,o}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this.$type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bubbles",{get:function(){return this.$bubbles},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cancelable",{get:function(){return this.$cancelable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventPhase",{get:function(){return this.$eventPhase},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentTarget",{get:function(){return this.$currentTarget},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this.$target},enumerable:!0,configurable:!0}),e.prototype.$setTarget=function(t){return this.$target=t,!0},e.prototype.isDefaultPrevented=function(){return this.$isDefaultPrevented},e.prototype.preventDefault=function(){this.$cancelable&&(this.$isDefaultPrevented=!0)},e.prototype.stopPropagation=function(){this.$bubbles&&(this.$isPropagationStopped=!0)},e.prototype.stopImmediatePropagation=function(){this.$bubbles&&(this.$isPropagationImmediateStopped=!0)},e.prototype.clean=function(){this.data=this.$currentTarget=null,this.$setTarget(null)},e.dispatchEvent=function(t,i,r,n){void 0===r&&(r=!1);var o=e.create(e,i,r),a=e._getPropertyData(e);void 0!=n&&(a.data=n);var s=t.dispatchEvent(o);return e.release(o),s},e._getPropertyData=function(t){var e=t._props;return e||(e=t._props={}),e},e.create=function(t,e,i,r){var n=t.eventPool;if(n||(n=t.eventPool=[]),n.length){var o=n.pop();return o.$type=e,o.$bubbles=!!i,o.$cancelable=!!r,o.$isDefaultPrevented=!1,o.$isPropagationStopped=!1,o.$isPropagationImmediateStopped=!1,o.$eventPhase=2,o}return new t(e,i,r)},e.release=function(t){t.clean();var e=Object.getPrototypeOf(t).constructor;e.eventPool.push(t)},e}(t.HashObject);e.ADDED_TO_STAGE="addedToStage",e.REMOVED_FROM_STAGE="removedFromStage",e.ADDED="added",e.REMOVED="removed",e.ENTER_FRAME="enterFrame",e.RENDER="render",e.RESIZE="resize",e.CHANGE="change",e.CHANGING="changing",e.COMPLETE="complete",e.LOOP_COMPLETE="loopComplete",e.FOCUS_IN="focusIn",e.FOCUS_OUT="focusOut",e.ENDED="ended",e.ACTIVATE="activate",e.DEACTIVATE="deactivate",e.CLOSE="close",e.CONNECT="connect",e.LEAVE_STAGE="leaveStage",e.SOUND_COMPLETE="soundComplete",t.Event=e,__reflect(e.prototype,"egret.Event"),t.$markReadOnly(e,"type"),t.$markReadOnly(e,"bubbles"),t.$markReadOnly(e,"cancelable"),t.$markReadOnly(e,"eventPhase"),t.$markReadOnly(e,"currentTarget"),t.$markReadOnly(e,"target")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(r){var n=e.call(this)||this;return n.$scale9Grid=null,n.$fillMode="scale",n._pixelHitTest=!1,n.$renderNode=new t.sys.BitmapNode,n.$Bitmap={0:null,1:null,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:i.defaultSmoothing,11:0/0,12:0/0},n.$setBitmapData(r),n}return __extends(i,e),i.prototype.$onAddToStage=function(i,r){e.prototype.$onAddToStage.call(this,i,r);var n=this.$Bitmap[0];n&&t.BitmapData.$addDisplayObject(this,n)},i.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this);var i=this.$Bitmap[0];i&&t.BitmapData.$removeDisplayObject(this,i)},Object.defineProperty(i.prototype,"bitmapData",{get:function(){var e=this.$Bitmap[0];return e instanceof t.Texture?null:e},set:function(t){this.$setBitmapData(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"texture",{get:function(){var e=this.$Bitmap[0];return e instanceof t.Texture?e:null},set:function(t){this.$setBitmapData(t)},enumerable:!0,configurable:!0}),i.prototype.$setBitmapData=function(e){var i=this.$Bitmap,r=i[0];if(e==r)return!1;if(i[0]=e,!e)return r&&t.BitmapData.$removeDisplayObject(this,r),this.setImageData(null,0,0,0,0,0,0,0,0,0,0),this.$invalidateContentBounds(),!0;if(this.$refreshImageData(),this.$stage){if(r){var n=void 0;n=r._bitmapData&&r._bitmapData.hashCode?r._bitmapData.hashCode:r.hashCode;var o=void 0;if(o=e._bitmapData&&e._bitmapData.hashCode?e._bitmapData.hashCode:e.hashCode,n==o)return this.$invalidateContentBounds(),!0;t.BitmapData.$removeDisplayObject(this,r)}t.BitmapData.$addDisplayObject(this,e)}return this.$invalidateContentBounds(),!0},i.prototype.$refreshImageData=function(){var e=this.$Bitmap,i=e[0];if(i)if(i instanceof t.Texture){var r=i;this.setImageData(r._bitmapData,r._bitmapX,r._bitmapY,r._bitmapWidth,r._bitmapHeight,r._offsetX,r._offsetY,r.$getTextureWidth(),r.$getTextureHeight(),r._sourceWidth,r._sourceHeight)}else{var n=i.width,o=i.height;this.setImageData(i,0,0,n,o,0,0,n,o,n,o)}},i.prototype.setImageData=function(t,e,i,r,n,o,a,s,l,h,u){var c=this.$Bitmap;c[1]=t,c[2]=e,c[3]=i,c[4]=r,c[5]=n,c[6]=o,c[7]=a,c[8]=s,c[9]=l,c[13]=h,c[14]=u},Object.defineProperty(i.prototype,"scale9Grid",{get:function(){return this.$scale9Grid},set:function(t){this.$scale9Grid=t,this.$invalidateContentBounds()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fillMode",{get:function(){return this.$fillMode},set:function(t){this.$setFillMode(t)},enumerable:!0,configurable:!0}),i.prototype.$setFillMode=function(t){return t==this.$fillMode?!1:(this.$fillMode=t,!0)},Object.defineProperty(i.prototype,"smoothing",{get:function(){var t=this.$Bitmap;return t[10]},set:function(t){t=!!t;var e=this.$Bitmap;t!=e[10]&&(e[10]=t,this.$invalidate())},enumerable:!0,configurable:!0}),i.prototype.$setWidth=function(t){var e=this.$Bitmap;return 0>t||t==e[11]?!1:(e[11]=t,this.$invalidateContentBounds(),!0)},i.prototype.$setHeight=function(t){var e=this.$Bitmap;return 0>t||t==e[12]?!1:(e[12]=t,this.$invalidateContentBounds(),!0)},i.prototype.$getWidth=function(){var t=this.$Bitmap;return isNaN(t[11])?this.$getContentBounds().width:t[11]},i.prototype.$getHeight=function(){var t=this.$Bitmap;return isNaN(t[12])?this.$getContentBounds().height:t[12]},i.prototype.$measureContentBounds=function(t){var e=this.$Bitmap;if(e[1]){var i=this.$Bitmap,r=isNaN(i[11])?i[8]:i[11],n=isNaN(i[12])?i[9]:i[12];t.setTo(0,0,r,n)}else{var r=isNaN(e[11])?0:e[11],n=isNaN(e[12])?0:e[12];t.setTo(0,0,r,n)}},i.prototype.$render=function(){var e=this.$Bitmap;if(e[1]){var i=isNaN(e[11])?e[8]:e[11],r=isNaN(e[12])?e[9]:e[12];t.sys.BitmapNode.$updateTextureData(this.$renderNode,e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],i,r,e[13],e[14],this.scale9Grid||e[0].scale9Grid,this.fillMode,e[10])}},Object.defineProperty(i.prototype,"pixelHitTest",{get:function(){return this._pixelHitTest},set:function(t){this._pixelHitTest=!!t},enumerable:!0,configurable:!0}),i.prototype.$hitTest=function(t,i){var r=e.prototype.$hitTest.call(this,t,i);return r&&this._pixelHitTest&&(r=this.hitTestPixel(t,i)),r},i.prototype.hitTestPixel=function(e,i){var r,n=this.$getInvertedConcatenatedMatrix(),o=n.a*e+n.c*i+n.tx,a=n.b*e+n.d*i+n.ty,s=this.$displayList;if(s){var l=s.renderBuffer;try{r=l.getPixels(o-s.offsetX,a-s.offsetY)}catch(h){throw console.log(this.$Bitmap[0]),new Error(t.sys.tr(1039))}}else{var l=t.sys.customHitTestBuffer;l.resize(3,3);var u=this.$getRenderNode(),c=t.Matrix.create();c.identity(),c.translate(1-o,1-a),t.sys.systemRenderer.drawNodeToBuffer(u,l,c,!0),t.Matrix.release(c);try{r=l.getPixels(1,1)}catch(h){throw console.log(this.$Bitmap[0]),new Error(t.sys.tr(1039))}}return 0===r[3]?null:this},i.$drawImage=function(e,i,r,n,o,a,s,l,h,u,c,p,d,f,g,y,v){console.warn("deprecated method : Bitmap.$drawImage,use egret.sys.BitmapNode.$drawImage instead of it"),t.sys.BitmapNode.$updateTextureData(e,i,r,n,o,a,s,l,h,u,c,p,d,f,g,y,v)},i}(t.DisplayObject);e.defaultSmoothing=!0,t.Bitmap=e,__reflect(e.prototype,"egret.Bitmap")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.$graphics=new t.Graphics,i.$graphics.$setTarget(i),i}return __extends(i,e),Object.defineProperty(i.prototype,"graphics",{get:function(){return this.$graphics},enumerable:!0,configurable:!0}),i.prototype.$hitTest=function(e,i){if(!this.$visible)return null;var r=this.$getInvertedConcatenatedMatrix(),n=r.a*e+r.c*i+r.tx,o=r.b*e+r.d*i+r.ty,a=this.$scrollRect?this.$scrollRect:this.$maskRect;if(a&&!a.contains(n,o))return null;if(this.$mask&&!this.$mask.$hitTest(e,i))return null;for(var s=this.$children,l=!1,h=null,u=s.length-1;u>=0;u--){var c=s[u];if(!c.$maskedObject&&(h=c.$hitTest(e,i))){if(l=!0,h.$touchEnabled)break;h=null}}return h?this.$touchChildren?h:this:l?this:(h=t.DisplayObject.prototype.$hitTest.call(this,e,i),h&&(h=this.$graphics.$hitTest(e,i)),h)},i.prototype.$measureContentBounds=function(t){this.$graphics.$measureContentBounds(t)},i.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this),this.$graphics&&this.$graphics.$onRemoveFromStage()},i}(t.DisplayObjectContainer);t.Sprite=e,__reflect(e.prototype,"egret.Sprite")}(egret||(egret={}));var egret;!function(t){t.$TextureScaleFactor=1;var e=function(e){function i(){var t=e.call(this)||this;return t._bitmapX=0,t._bitmapY=0,t._bitmapWidth=0,t._bitmapHeight=0,t._offsetX=0,t._offsetY=0,t._textureWidth=0,t._textureHeight=0,t._sourceWidth=0,t._sourceHeight=0,t._bitmapData=null,t}return __extends(i,e),Object.defineProperty(i.prototype,"textureWidth",{get:function(){return this.$getTextureWidth()},enumerable:!0,configurable:!0}),i.prototype.$getTextureWidth=function(){return this._textureWidth},Object.defineProperty(i.prototype,"textureHeight",{get:function(){return this.$getTextureHeight()},enumerable:!0,configurable:!0}),i.prototype.$getTextureHeight=function(){return this._textureHeight},i.prototype.$getScaleBitmapWidth=function(){return this._bitmapWidth*t.$TextureScaleFactor},i.prototype.$getScaleBitmapHeight=function(){return this._bitmapHeight*t.$TextureScaleFactor},Object.defineProperty(i.prototype,"bitmapData",{get:function(){return this._bitmapData},set:function(t){this._setBitmapData(t)},enumerable:!0,configurable:!0}),i.prototype._setBitmapData=function(e){this._bitmapData=e;var i=t.$TextureScaleFactor,r=e.width*i,n=e.height*i;this.$initData(0,0,r,n,0,0,r,n,e.width,e.height)},i.prototype.$initData=function(e,i,r,n,o,a,s,l,h,u){var c=t.$TextureScaleFactor;this._bitmapX=e/c,this._bitmapY=i/c,this._bitmapWidth=r/c,this._bitmapHeight=n/c,this._offsetX=o,this._offsetY=a,this._textureWidth=s,this._textureHeight=l,this._sourceWidth=h,this._sourceHeight=u,t.BitmapData.$invalidate(this)},i.prototype.getPixel32=function(){throw new Error},i.prototype.getPixels=function(t,e,i,r){throw void 0===i&&(i=1),void 0===r&&(r=1),new Error},i.prototype.toDataURL=function(){throw new Error},i.prototype.saveToFile=function(){throw new Error},i.prototype.dispose=function(){this._bitmapData&&(this._bitmapData.$dispose(),this._bitmapData=null)},i}(t.HashObject);t.Texture=e,__reflect(e.prototype,"egret.Texture"),t.$markReadOnly(e,"textureWidth"),t.$markReadOnly(e,"textureHeight")}(egret||(egret={}));var egret;!function(t){t.$locale_strings=t.$locale_strings||{},t.$language="en_US"}(egret||(egret={})),function(t){var e;!function(e){function i(e){for(var i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];var n=t.$locale_strings[t.$language][e];if(!n)return"{"+e+"}";for(var o=i.length,a=0;o>a;a++)n=n.replace("{"+a+"}",i[a]);return n}e.tr=i}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e=[],i=Math.PI/180,r=function(r){function n(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var i=r.call(this)||this;return i.x=t,i.y=e,i}return __extends(n,r),n.release=function(t){t&&e.push(t)},n.create=function(t,i){var r=e.pop();return r||(r=new n),r.setTo(t,i)},Object.defineProperty(n.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},enumerable:!0,configurable:!0}),n.prototype.setTo=function(t,e){return this.x=t,this.y=e,this},n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.equals=function(t){return this.x==t.x&&this.y==t.y},n.distance=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},n.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y},n.prototype.add=function(t){return new n(this.x+t.x,this.y+t.y)},n.interpolate=function(t,e,i){var r=1-i;return new n(t.x*i+e.x*r,t.y*i+e.y*r)},n.prototype.normalize=function(t){if(0!=this.x||0!=this.y){var e=t/this.length;this.x*=e,this.y*=e}},n.prototype.offset=function(t,e){this.x+=t,this.y+=e},n.polar=function(e,r){return new n(e*t.NumberUtils.cos(r/i),e*t.NumberUtils.sin(r/i))},n.prototype.subtract=function(t){return new n(this.x-t.x,this.y-t.y)},n.prototype.toString=function(){return"(x="+this.x+", y="+this.y+")"},n}(t.HashObject);t.Point=r,__reflect(r.prototype,"egret.Point"),t.$markReadOnly(r,"length"),t.$TempPoint=new r}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(){function i(){this.type=0,this.needRedraw=!1,this.renderAlpha=1,this.renderVisible=!0,this.renderMatrix=new t.Matrix,this.renderRegion=new e.Region,this.moved=!1,this.drawData=[],this.renderCount=0}return i.prototype.cleanBeforeRender=function(){this.drawData.length=0,this.renderCount=0},i.prototype.$getRenderCount=function(){return this.renderCount},i}();e.RenderNode=i,__reflect(i.prototype,"egret.sys.RenderNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function t(){this.type=0,this.$commands=[],this.$data=[],this.commandPosition=0,this.dataPosition=0,this.$lastX=0,this.$lastY=0}return t.prototype.moveTo=function(t,e){this.$commands[this.commandPosition++]=1;var i=this.dataPosition;this.$data[i++]=t,this.$data[i++]=e,this.dataPosition=i},t.prototype.lineTo=function(t,e){this.$commands[this.commandPosition++]=2;var i=this.dataPosition;this.$data[i++]=t,this.$data[i++]=e,this.dataPosition=i},t.prototype.curveTo=function(t,e,i,r){this.$commands[this.commandPosition++]=3;var n=this.dataPosition;this.$data[n++]=t,this.$data[n++]=e,this.$data[n++]=i,this.$data[n++]=r,this.dataPosition=n},t.prototype.cubicCurveTo=function(t,e,i,r,n,o){this.$commands[this.commandPosition++]=4;var a=this.dataPosition;this.$data[a++]=t,this.$data[a++]=e,this.$data[a++]=i,this.$data[a++]=r,this.$data[a++]=n,this.$data[a++]=o,this.dataPosition=a},t.prototype.drawRect=function(t,e,i,r){var n=t+i,o=e+r;this.moveTo(t,e),this.lineTo(n,e),this.lineTo(n,o),this.lineTo(t,o),this.lineTo(t,e)},t.prototype.drawRoundRect=function(t,e,i,r,n,o){var a=.5*n|0,s=o?.5*o|0:a;if(!a||!s)return void this.drawRect(t,e,i,r);var l=.5*i,h=.5*r;if(a>l&&(a=l),s>h&&(s=h),l===a&&h===s)return void(a===s?this.drawCircle(t+a,e+s,a):this.drawEllipse(t,e,2*a,2*s));var u=t+i,c=e+r,p=t+a,d=u-a,f=e+s,g=c-s;this.moveTo(u,g),this.curveTo(u,c,d,c),this.lineTo(p,c),this.curveTo(t,c,t,g),this.lineTo(t,f),this.curveTo(t,e,p,e),this.lineTo(d,e),this.curveTo(u,e,u,f),this.lineTo(u,g)},t.prototype.drawCircle=function(t,e,i){this.arcToBezier(t,e,i,i,0,2*Math.PI)},t.prototype.drawEllipse=function(t,e,i,r){var n=.5*i,o=.5*r;t+=n,e+=o,this.arcToBezier(t,e,n,o,0,2*Math.PI)},t.prototype.drawArc=function(t,e,i,r,n,o){o?n>=r&&(n-=2*Math.PI):r>=n&&(n+=2*Math.PI),this.arcToBezier(t,e,i,i,r,n,o)},t.prototype.arcToBezier=function(t,e,i,r,n,o,a){var s=.5*Math.PI,l=n,h=l;a?(h+=-s-l%s,o>h&&(h=o)):(h+=s-l%s,h>o&&(h=o));var u=t+Math.cos(l)*i,c=e+Math.sin(l)*r;(this.$lastX!=u||this.$lastY!=c)&&this.moveTo(u,c);for(var p=Math.cos(l),d=Math.sin(l),f=0;4>f;f++){var g=h-l,y=4*Math.tan(g/4)/3,v=u-d*y*i,m=c+p*y*r;p=Math.cos(h),d=Math.sin(h),u=t+p*i,c=e+d*r;var _=u+d*y*i,b=c-p*y*r;if(this.cubicCurveTo(v,m,_,b,u,c),h===o)break;l=h,a?(h=l-s,o>h&&(h=o)):(h=l+s,h>o&&(h=o))}},t}();t.Path2D=e,__reflect(e.prototype,"egret.sys.Path2D")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){function e(){var t=Object.create(null);return t.__v8__=void 0,delete t.__v8__,t}t.createMap=e}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,i,r,n,o,a,s,l){void 0===e&&(e=16711680),void 0===i&&(i=1),void 0===r&&(r=6),void 0===n&&(n=6),void 0===o&&(o=2),void 0===a&&(a=1),void 0===s&&(s=!1),void 0===l&&(l=!1);var h=t.call(this)||this;return h.type="glow",h.$color=e,h.$blue=255&e,h.$green=(65280&e)>>8,h.$red=e>>16,h.$alpha=i,h.$blurX=r,h.$blurY=n,h.$strength=o,h.$quality=a,h.$inner=s,h.$knockout=l,h}return __extends(e,t),Object.defineProperty(e.prototype,"color",{get:function(){return this.$color},set:function(t){this.$color!=t&&(this.$color=t,this.$blue=255&t,this.$green=(65280&t)>>8,this.$red=t>>16,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.$alpha},set:function(t){this.$alpha!=t&&(this.$alpha=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurX",{get:function(){return this.$blurX},set:function(t){this.$blurX!=t&&(this.$blurX=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this.$blurY},set:function(t){this.$blurY!=t&&(this.$blurY=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strength",{get:function(){return this.$strength},set:function(t){this.$strength!=t&&(this.$strength=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this.$quality},set:function(t){this.$quality!=t&&(this.$quality=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inner",{get:function(){return this.$inner},set:function(t){this.$inner!=t&&(this.$inner=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"knockout",{get:function(){return this.$knockout},set:function(t){this.$knockout!=t&&(this.$knockout=t,this.invalidate())},enumerable:!0,configurable:!0}),e.prototype.$toJson=function(){return'{"color": '+this.$color+', "red": '+this.$red+', "green": '+this.$green+', "blue": '+this.$blue+', "alpha": '+this.$alpha+', "blurX": '+this.$blurX+', "blurY": '+this.blurY+', "strength": '+this.$strength+', "quality": '+this.$quality+', "inner": '+this.$inner+', "knockout": '+this.$knockout+"}"},e}(t.Filter);t.GlowFilter=e,__reflect(e.prototype,"egret.GlowFilter")}(egret||(egret={}));var egret;!function(t){t.CapsStyle={NONE:"none",ROUND:"round",SQUARE:"square"}}(egret||(egret={}));var egret;!function(t){t.DirtyRegionPolicy={OFF:"off",ON:"on"}}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){}return e.compileProgram=function(i,r,n){var o=e.compileFragmentShader(i,n),a=e.compileVertexShader(i,r),s=i.createProgram();return i.attachShader(s,a),i.attachShader(s,o),i.linkProgram(s),i.getProgramParameter(s,i.LINK_STATUS)||t.$warn(1020),s},e.compileFragmentShader=function(t,i){return e._compileShader(t,i,t.FRAGMENT_SHADER)},e.compileVertexShader=function(t,i){return e._compileShader(t,i,t.VERTEX_SHADER)},e._compileShader=function(t,e,i){var r=t.createShader(i);return t.shaderSource(r,e),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)?r:null},e.checkCanUseWebGL=function(){if(void 0==e.canUseWebGL)try{var t=document.createElement("canvas");e.canUseWebGL=!(!window.WebGLRenderingContext||!t.getContext("webgl")&&!t.getContext("experimental-webgl"))}catch(i){e.canUseWebGL=!1}return e.canUseWebGL},e.deleteWebGLTexture=function(t){if(t){var e=t.glContext;e&&e.deleteTexture(t)}},e}();t.WebGLUtils=e,__reflect(e.prototype,"egret.WebGLUtils")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,i,r){return void 0===i&&(i=!1),void 0===r&&(r=!1),t.call(this,e,i,r)||this}return __extends(e,t),e}(t.Event);e.FOCUS_IN="focusIn",e.FOCUS_OUT="focusOut",t.FocusEvent=e,__reflect(e.prototype,"egret.FocusEvent")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(){return t.apply(this,arguments)||this}return __extends(e,t),e}(t.Event);e.PERMISSION_DENIED="permissionDenied",e.UNAVAILABLE="unavailable",t.GeolocationEvent=e,__reflect(e.prototype,"egret.GeolocationEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,r){void 0===i&&(i=!1),void 0===r&&(r=!1);var n=e.call(this,t,i,r)||this;return n._status=0,n}return __extends(i,e),Object.defineProperty(i.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0}),i.dispatchHTTPStatusEvent=function(e,r){var n=t.Event.create(i,i.HTTP_STATUS);n._status=r;var o=e.dispatchEvent(n);return t.Event.release(n),o},i}(t.Event);e.HTTP_STATUS="httpStatus",t.HTTPStatusEvent=e,__reflect(e.prototype,"egret.HTTPStatusEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,r){return void 0===i&&(i=!1),void 0===r&&(r=!1),e.call(this,t,i,r)||this}return __extends(i,e),i.dispatchIOErrorEvent=function(e){var r=t.Event.create(i,i.IO_ERROR),n=e.dispatchEvent(r);return t.Event.release(r),n},i}(t.Event);e.IO_ERROR="ioError",t.IOErrorEvent=e,__reflect(e.prototype,"egret.IOErrorEvent")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(){return t.apply(this,arguments)||this}return __extends(e,t),e}(t.Event);t.MotionEvent=e,__reflect(e.prototype,"egret.MotionEvent")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(){return t.apply(this,arguments)||this}return __extends(e,t),e}(t.Event);t.OrientationEvent=e,__reflect(e.prototype,"egret.OrientationEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,r,n,o){void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===n&&(n=0),void 0===o&&(o=0);var a=e.call(this,t,i,r)||this;return a.bytesLoaded=0,a.bytesTotal=0,a.bytesLoaded=n,a.bytesTotal=o,a}return __extends(i,e),i.dispatchProgressEvent=function(e,r,n,o){void 0===n&&(n=0),void 0===o&&(o=0);var a=t.Event.create(i,r);a.bytesLoaded=n,a.bytesTotal=o;var s=e.dispatchEvent(a);return t.Event.release(a),s},i}(t.Event);e.PROGRESS="progress",e.SOCKET_DATA="socketData",t.ProgressEvent=e,__reflect(e.prototype,"egret.ProgressEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,r){return void 0===i&&(i=!1),void 0===r&&(r=!1),e.call(this,t,i,r)||this}return __extends(i,e),i.dispatchStageOrientationEvent=function(e,r){var n=t.Event.create(i,r),o=e.dispatchEvent(n);return t.Event.release(n),o},i}(t.Event);e.ORIENTATION_CHANGE="orientationChange",t.StageOrientationEvent=e,__reflect(e.prototype,"egret.StageOrientationEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,r,n){void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===n&&(n="");var o=e.call(this,t,i,r)||this;return o.text=n,o}return __extends(i,e),i.dispatchTextEvent=function(e,r,n){var o=t.Event.create(i,r);o.text=n;var a=e.dispatchEvent(o);return t.Event.release(o),a},i}(t.Event);e.LINK="link",t.TextEvent=e,__reflect(e.prototype,"egret.TextEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,r){return e.call(this,t,i,r)||this}return __extends(i,e),i.prototype.updateAfterEvent=function(){t.sys.$requestRenderingFlag=!0},i.dispatchTimerEvent=function(e,r,n,o){var a=t.Event.create(i,r,n,o),s=e.dispatchEvent(a);return t.Event.release(a),s},i}(t.Event);e.TIMER="timer",e.TIMER_COMPLETE="timerComplete",t.TimerEvent=e,__reflect(e.prototype,"egret.TimerEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i.format="image",i.$deleteSource=!0,i.source=t,i.width=t.width,i.height=t.height,i}return __extends(i,e),i.prototype.$dispose=function(){t.Capabilities.runtimeType==t.RuntimeType.WEB&&"webgl"==t.Capabilities.renderMode&&this.webGLTexture&&(t.WebGLUtils.deleteWebGLTexture(this.webGLTexture),this.webGLTexture=null),this.source&&this.source.dispose&&this.source.dispose(),this.source=null,i.$dispose(this)},i.$addDisplayObject=function(t,e){var r;if(r=e._bitmapData&&e._bitmapData.hashCode?e._bitmapData.hashCode:e.hashCode){if(!i._displayList[r])return void(i._displayList[r]=[t]);var n=i._displayList[r];n.indexOf(t)<0&&n.push(t)}},i.$removeDisplayObject=function(t,e){var r;if(r=e._bitmapData&&e._bitmapData.hashCode?e._bitmapData.hashCode:e.hashCode,r&&i._displayList[r]){var n=i._displayList[r],o=n.indexOf(t);o>=0&&n.splice(o)}},i.$invalidate=function(e){var r;if(r=e._bitmapData&&e._bitmapData.hashCode?e._bitmapData.hashCode:e.hashCode,r&&i._displayList[r])for(var n=i._displayList[r],o=0;o<n.length;o++)n[o]instanceof t.Bitmap&&n[o].$refreshImageData(),n[o].$invalidateContentBounds()},i.$dispose=function(e){var r;if(r=e._bitmapData&&e._bitmapData.hashCode?e._bitmapData.hashCode:e.hashCode,r&&i._displayList[r]){for(var n=i._displayList[r],o=0;o<n.length;o++)n[o]instanceof t.Bitmap&&(n[o].$Bitmap[1]=null),n[o].$invalidateContentBounds();delete i._displayList[r]}},i}(t.HashObject);e._displayList=t.createMap(),t.BitmapData=e,__reflect(e.prototype,"egret.BitmapData")}(egret||(egret={}));var egret;!function(t){var e=new t.Point,i=function(i){function r(t,e,r,n,o,a){var s=i.call(this,t,e,r)||this;return s.targetChanged=!0,s.touchDown=!1,s.$initTo(n,o,a),s}return __extends(r,i),r.prototype.$initTo=function(t,e,i){this.touchPointID=+i||0,this.$stageX=+t||0,this.$stageY=+e||0},Object.defineProperty(r.prototype,"stageX",{get:function(){return this.$stageX},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"stageY",{get:function(){return this.$stageY},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"localX",{get:function(){return this.targetChanged&&this.getLocalXY(),this._localX},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"localY",{get:function(){return this.targetChanged&&this.getLocalXY(),this._localY},enumerable:!0,configurable:!0}),r.prototype.getLocalXY=function(){this.targetChanged=!1;var t=this.$target.$getInvertedConcatenatedMatrix();t.transformPoint(this.$stageX,this.$stageY,e),this._localX=e.x,this._localY=e.y},r.prototype.$setTarget=function(t){return this.$target=t,this.targetChanged=!!t,!0},r.prototype.updateAfterEvent=function(){t.sys.$requestRenderingFlag=!0},r.dispatchTouchEvent=function(e,i,n,o,a,s,l,h){if(void 0===h&&(h=!1),!n&&!e.hasEventListener(i))return!0;var u=t.Event.create(r,i,n,o);u.$initTo(a,s,l),u.touchDown=h;var c=e.dispatchEvent(u);return t.Event.release(u),c},r}(t.Event);i.TOUCH_MOVE="touchMove",i.TOUCH_BEGIN="touchBegin",i.TOUCH_END="touchEnd",i.TOUCH_CANCEL="touchcancel",i.TOUCH_TAP="touchTap",i.TOUCH_RELEASE_OUTSIDE="touchReleaseOutside",i.TOUCH_ROLL_OUT="touchRollOut",i.TOUCH_ROLL_OVER="touchRollOver",t.TouchEvent=i,__reflect(i.prototype,"egret.TouchEvent"),t.$markReadOnly(i,"stageX"),t.$markReadOnly(i,"stageY"),t.$markReadOnly(i,"localX"),t.$markReadOnly(i,"localY")}(egret||(egret={}));var egret;!function(){}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,i,r){void 0===e&&(e=4),void 0===i&&(i=4),void 0===r&&(r=1);var n=t.call(this)||this;return n.type="blur",n.$blurX=e,n.$blurY=i,n.$quality=r,n}return __extends(e,t),Object.defineProperty(e.prototype,"blurX",{get:function(){return this.$blurX},set:function(t){this.$blurX!=t&&(this.$blurX=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this.$blurY},set:function(t){this.$blurY!=t&&(this.$blurY=t,this.invalidate())},enumerable:!0,configurable:!0}),e.prototype.$toJson=function(){return'{"blurX": '+this.$blurX+', "blurY": '+this.$blurY+', "quality": 1}'},e}(t.Filter);t.BlurFilter=e,__reflect(e.prototype,"egret.BlurFilter")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return i.$matrix=[],i.matrix2=[],i.type="colorTransform",i.setMatrix(e),i}return __extends(e,t),Object.defineProperty(e.prototype,"matrix",{get:function(){for(var t=0;20>t;t++)this.matrix2[t]=this.$matrix[t];return this.matrix2},set:function(t){this.setMatrix(t),this.invalidate()},enumerable:!0,configurable:!0}),e.prototype.setMatrix=function(t){if(t)for(var e=0;20>e;e++)this.$matrix[e]=t[e];else for(var e=0;20>e;e++)this.$matrix[e]=0==e||6==e||12==e||18==e?1:0},e.prototype.$toJson=function(){return'{"matrix": ['+this.$matrix.toString()+"]}"},e}(t.Filter);t.ColorMatrixFilter=e,__reflect(e.prototype,"egret.ColorMatrixFilter")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,i,r,n,o,a,s,l,h,u,c){void 0===e&&(e=4),void 0===i&&(i=45),void 0===r&&(r=0),void 0===n&&(n=1),void 0===o&&(o=4),void 0===a&&(a=4),void 0===s&&(s=1),void 0===l&&(l=1),void 0===h&&(h=!1),void 0===u&&(u=!1),void 0===c&&(c=!1);var p=t.call(this,r,n,o,a,s,l,h,u)||this;return p.$distance=e,p.$angle=i,p.$hideObject=c,p}return __extends(e,t),Object.defineProperty(e.prototype,"distance",{get:function(){return this.$distance},set:function(t){this.$distance!=t&&(this.$distance=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this.$angle
},set:function(t){this.$angle!=t&&(this.$angle=t,this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hideObject",{get:function(){return this.$hideObject},set:function(t){this.$hideObject!=t&&(this.$hideObject=t,this.invalidate())},enumerable:!0,configurable:!0}),e.prototype.$toJson=function(){return'{"distance": '+this.$distance+', "angle": '+this.$angle+', "color": '+this.$color+', "red": '+this.$red+', "green": '+this.$green+', "blue": '+this.$blue+', "alpha": '+this.$alpha+', "blurX": '+this.$blurX+', "blurY": '+this.blurY+', "strength": '+this.$strength+', "quality": '+this.$quality+', "inner": '+this.$inner+', "knockout": '+this.$knockout+', "hideObject": '+this.$hideObject+"}"},e}(t.GlowFilter);t.DropShadowFilter=e,__reflect(e.prototype,"egret.DropShadowFilter")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t}();e.LINEAR="linear",e.RADIAL="radial",t.GradientType=e,__reflect(e.prototype,"egret.GradientType")}(egret||(egret={}));var egret;!function(t){function e(t){return t%=2*Math.PI,0>t&&(t+=2*Math.PI),t}var i=function(i){function r(){var e=i.call(this)||this;return e.lastX=0,e.lastY=0,e.fillPath=null,e.strokePath=null,e.topLeftStrokeWidth=0,e.bottomRightStrokeWidth=0,e.minX=1/0,e.minY=1/0,e.maxX=-(1/0),e.maxY=-(1/0),e.includeLastPosition=!0,e.$renderNode=new t.sys.GraphicsNode,e}return __extends(r,i),r.prototype.$setTarget=function(t){this.targetDisplay&&(this.targetDisplay.$renderNode=null),t.$renderNode=this.$renderNode,this.targetDisplay=t},r.prototype.setStrokeWidth=function(t){switch(t){case 1:this.topLeftStrokeWidth=0,this.bottomRightStrokeWidth=1;break;case 3:this.topLeftStrokeWidth=1,this.bottomRightStrokeWidth=2;break;default:var e=0|Math.ceil(.5*t);this.topLeftStrokeWidth=e,this.bottomRightStrokeWidth=e}},r.prototype.beginFill=function(t,e){void 0===e&&(e=1),t=+t||0,e=+e||0,this.fillPath=this.$renderNode.beginFill(t,e,this.strokePath),this.$renderNode.drawData.length>1&&this.fillPath.moveTo(this.lastX,this.lastY)},r.prototype.beginGradientFill=function(t,e,i,r,n){void 0===n&&(n=null),this.fillPath=this.$renderNode.beginGradientFill(t,e,i,r,n,this.strokePath),this.$renderNode.drawData.length>1&&this.fillPath.moveTo(this.lastX,this.lastY)},r.prototype.endFill=function(){this.fillPath=null},r.prototype.lineStyle=function(t,e,i,r,n,o,a,s){void 0===t&&(t=0/0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=!1),void 0===n&&(n="normal"),void 0===o&&(o=null),void 0===a&&(a=null),void 0===s&&(s=3),t=+t||0,0>=t?(this.strokePath=null,this.setStrokeWidth(0)):(e=+e||0,i=+i||0,s=+s||0,this.setStrokeWidth(t),this.strokePath=this.$renderNode.lineStyle(t,e,i,o,a,s),this.$renderNode.drawData.length>1&&this.strokePath.moveTo(this.lastX,this.lastY))},r.prototype.drawRect=function(t,e,i,r){t=+t||0,e=+e||0,i=+i||0,r=+r||0;var n=this.fillPath,o=this.strokePath;n&&n.drawRect(t,e,i,r),o&&o.drawRect(t,e,i,r),this.extendBoundsByPoint(t+i,e+r),this.updatePosition(t,e),this.$renderNode.dirtyRender=!0},r.prototype.drawRoundRect=function(t,e,i,r,n,o){t=+t||0,e=+e||0,i=+i||0,r=+r||0,n=+n||0,o=+o||0;var a=this.fillPath,s=this.strokePath;a&&a.drawRoundRect(t,e,i,r,n,o),s&&s.drawRoundRect(t,e,i,r,n,o);var l=.5*n|0,h=o?.5*o|0:l,u=t+i,c=e+r,p=c-h;this.extendBoundsByPoint(t,e),this.extendBoundsByPoint(u,c),this.updatePosition(u,p),this.$renderNode.dirtyRender=!0},r.prototype.drawCircle=function(t,e,i){t=+t||0,e=+e||0,i=+i||0;var r=this.fillPath,n=this.strokePath;r&&r.drawCircle(t,e,i),n&&n.drawCircle(t,e,i),this.extendBoundsByPoint(t-i,e-i),this.extendBoundsByPoint(t+i,e+i),this.updatePosition(t+i,e),this.$renderNode.dirtyRender=!0},r.prototype.drawEllipse=function(t,e,i,r){t=+t||0,e=+e||0,i=+i||0,r=+r||0;var n=this.fillPath,o=this.strokePath;n&&n.drawEllipse(t,e,i,r),o&&o.drawEllipse(t,e,i,r),this.extendBoundsByPoint(t,e),this.extendBoundsByPoint(t+i,e+r),this.updatePosition(t+i,e+.5*r),this.$renderNode.dirtyRender=!0},r.prototype.moveTo=function(t,e){t=+t||0,e=+e||0;var i=this.fillPath,r=this.strokePath;i&&i.moveTo(t,e),r&&r.moveTo(t,e),this.includeLastPosition=!1,this.lastX=t,this.lastY=e,this.$renderNode.dirtyRender=!0},r.prototype.lineTo=function(t,e){t=+t||0,e=+e||0;var i=this.fillPath,r=this.strokePath;i&&i.lineTo(t,e),r&&r.lineTo(t,e),this.updatePosition(t,e),this.$renderNode.dirtyRender=!0},r.prototype.curveTo=function(t,e,i,r){t=+t||0,e=+e||0,i=+i||0,r=+r||0;var n=this.fillPath,o=this.strokePath;n&&n.curveTo(t,e,i,r),o&&o.curveTo(t,e,i,r),this.extendBoundsByPoint(t,e),this.extendBoundsByPoint(i,r),this.updatePosition(i,r),this.$renderNode.dirtyRender=!0},r.prototype.cubicCurveTo=function(t,e,i,r,n,o){t=+t||0,e=+e||0,i=+i||0,r=+r||0,n=+n||0,o=+o||0;var a=this.fillPath,s=this.strokePath;a&&a.cubicCurveTo(t,e,i,r,n,o),s&&s.cubicCurveTo(t,e,i,r,n,o),this.extendBoundsByPoint(t,e),this.extendBoundsByPoint(i,r),this.extendBoundsByPoint(n,o),this.updatePosition(n,o),this.$renderNode.dirtyRender=!0},r.prototype.drawArc=function(t,i,r,n,o,a){if(!(0>r||n===o)){t=+t||0,i=+i||0,r=+r||0,n=+n||0,o=+o||0,a=!!a,n=e(n),o=e(o);var s=this.fillPath,l=this.strokePath;s&&(s.$lastX=this.lastX,s.$lastY=this.lastY,s.drawArc(t,i,r,n,o,a)),l&&(l.$lastX=this.lastX,l.$lastY=this.lastY,l.drawArc(t,i,r,n,o,a)),a?this.arcBounds(t,i,r,o,n):this.arcBounds(t,i,r,n,o);var h=t+Math.cos(o)*r,u=i+Math.sin(o)*r;this.updatePosition(h,u),this.$renderNode.dirtyRender=!0}},r.prototype.arcBounds=function(t,e,i,r,n){var o=Math.PI;if(Math.abs(r-n)<.01)return this.extendBoundsByPoint(t-i,e-i),void this.extendBoundsByPoint(t+i,e+i);r>n&&(n+=2*o);for(var a=Math.cos(r)*i,s=Math.cos(n)*i,l=Math.min(a,s),h=Math.max(a,s),u=Math.sin(r)*i,c=Math.sin(n)*i,p=Math.min(u,c),d=Math.max(u,c),f=r/(.5*o),g=n/(.5*o),y=Math.ceil(f);g>=y;y++)switch(y%4){case 0:h=i;break;case 1:d=i;break;case 2:l=-i;break;case 3:p=-i}l=Math.floor(l),p=Math.floor(p),h=Math.ceil(h),d=Math.ceil(d),this.extendBoundsByPoint(l+t,p+e),this.extendBoundsByPoint(h+t,d+e)},r.prototype.clear=function(){this.$renderNode.clear(),this.updatePosition(0,0),this.minX=1/0,this.minY=1/0,this.maxX=-(1/0),this.maxY=-(1/0)},r.prototype.extendBoundsByPoint=function(t,e){this.extendBoundsByX(t),this.extendBoundsByY(e)},r.prototype.extendBoundsByX=function(t){this.minX=Math.min(this.minX,t-this.topLeftStrokeWidth),this.maxX=Math.max(this.maxX,t+this.bottomRightStrokeWidth),this.updateNodeBounds()},r.prototype.extendBoundsByY=function(t){this.minY=Math.min(this.minY,t-this.topLeftStrokeWidth),this.maxY=Math.max(this.maxY,t+this.bottomRightStrokeWidth),this.updateNodeBounds()},r.prototype.updateNodeBounds=function(){var t=this.$renderNode;t.x=this.minX,t.y=this.minY,t.width=Math.ceil(this.maxX-this.minX),t.height=Math.ceil(this.maxY-this.minY)},r.prototype.updatePosition=function(t,e){this.includeLastPosition||(this.extendBoundsByPoint(this.lastX,this.lastY),this.includeLastPosition=!0),this.lastX=t,this.lastY=e,this.extendBoundsByPoint(t,e),this.targetDisplay.$invalidateContentBounds()},r.prototype.$measureContentBounds=function(t){this.minX===1/0?t.setEmpty():t.setTo(this.minX,this.minY,this.maxX-this.minX,this.maxY-this.minY)},r.prototype.$hitTest=function(e,i){var r=this.targetDisplay,n=r.$getInvertedConcatenatedMatrix(),o=n.a*e+n.c*i+n.tx,a=n.b*e+n.d*i+n.ty,s=t.sys.canvasHitTestBuffer;s.resize(3,3);var l=this.$renderNode,h=t.Matrix.create();h.identity(),h.translate(1-o,1-a),t.sys.canvasRenderer.drawNodeToBuffer(l,s,h,!0),t.Matrix.release(h);try{var u=s.getPixels(1,1);if(0===u[3])return null}catch(c){throw new Error(t.sys.tr(1039))}return r},r.prototype.$onRemoveFromStage=function(){this.$renderNode&&this.$renderNode.clean()},r}(t.HashObject);t.Graphics=i,__reflect(i.prototype,"egret.Graphics")}(egret||(egret={}));var egret;!function(t){var e=Math.PI,i=2*e,r=e/180,n=[],o=function(o){function a(t,e,i,r,n,a){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===a&&(a=0);var s=o.call(this)||this;return s.a=t,s.b=e,s.c=i,s.d=r,s.tx=n,s.ty=a,s}return __extends(a,o),a.release=function(t){t&&n.push(t)},a.create=function(){var t=n.pop();return t||(t=new a),t},a.prototype.clone=function(){return new a(this.a,this.b,this.c,this.d,this.tx,this.ty)},a.prototype.concat=function(t){var e=this.a*t.a,i=0,r=0,n=this.d*t.d,o=this.tx*t.a+t.tx,a=this.ty*t.d+t.ty;(0!==this.b||0!==this.c||0!==t.b||0!==t.c)&&(e+=this.b*t.c,n+=this.c*t.b,i+=this.a*t.b+this.b*t.d,r+=this.c*t.a+this.d*t.c,o+=this.ty*t.c,a+=this.tx*t.b),this.a=e,this.b=i,this.c=r,this.d=n,this.tx=o,this.ty=a},a.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},a.prototype.identity=function(){this.a=this.d=1,this.b=this.c=this.tx=this.ty=0},a.prototype.invert=function(){this.$invertInto(this)},a.prototype.$invertInto=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,o=this.tx,a=this.ty;if(0==i&&0==r)return t.b=t.c=0,void(0==e||0==n?t.a=t.d=t.tx=t.ty=0:(e=t.a=1/e,n=t.d=1/n,t.tx=-e*o,t.ty=-n*a));var s=e*n-i*r;if(0==s)return void t.identity();s=1/s;var l=t.a=n*s;i=t.b=-i*s,r=t.c=-r*s,n=t.d=e*s,t.tx=-(l*o+r*a),t.ty=-(i*o+n*a)},a.prototype.rotate=function(e){if(e=+e,0!==e){e/=r;var i=t.NumberUtils.cos(e),n=t.NumberUtils.sin(e),o=this.a,a=this.b,s=this.c,l=this.d,h=this.tx,u=this.ty;this.a=o*i-a*n,this.b=o*n+a*i,this.c=s*i-l*n,this.d=s*n+l*i,this.tx=h*i-u*n,this.ty=h*n+u*i}},a.prototype.scale=function(t,e){1!==t&&(this.a*=t,this.c*=t,this.tx*=t),1!==e&&(this.b*=e,this.d*=e,this.ty*=e)},a.prototype.setTo=function(t,e,i,r,n,o){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=o,this},a.prototype.transformPoint=function(e,i,r){var n=this.a*e+this.c*i+this.tx,o=this.b*e+this.d*i+this.ty;return r?(r.setTo(n,o),r):new t.Point(n,o)},a.prototype.translate=function(t,e){this.tx+=t,this.ty+=e},a.prototype.equals=function(t){return this.a==t.a&&this.b==t.b&&this.c==t.c&&this.d==t.d&&this.tx==t.tx&&this.ty==t.ty},a.prototype.prepend=function(t,e,i,r,n,o){var a=this.tx;if(1!=t||0!=e||0!=i||1!=r){var s=this.a,l=this.c;this.a=s*t+this.b*i,this.b=s*e+this.b*r,this.c=l*t+this.d*i,this.d=l*e+this.d*r}return this.tx=a*t+this.ty*i+n,this.ty=a*e+this.ty*r+o,this},a.prototype.append=function(t,e,i,r,n,o){var a=this.a,s=this.b,l=this.c,h=this.d;return(1!=t||0!=e||0!=i||1!=r)&&(this.a=t*a+e*l,this.b=t*s+e*h,this.c=i*a+r*l,this.d=i*s+r*h),this.tx=n*a+o*l+this.tx,this.ty=n*s+o*h+this.ty,this},a.prototype.deltaTransformPoint=function(e){var i=this,r=i.a*e.x+i.c*e.y,n=i.b*e.x+i.d*e.y;return new t.Point(r,n)},a.prototype.toString=function(){return"(a="+this.a+", b="+this.b+", c="+this.c+", d="+this.d+", tx="+this.tx+", ty="+this.ty+")"},a.prototype.createBox=function(e,i,n,o,a){void 0===n&&(n=0),void 0===o&&(o=0),void 0===a&&(a=0);var s=this;if(0!==n){n/=r;var l=t.NumberUtils.cos(n),h=t.NumberUtils.sin(n);s.a=l*e,s.b=h*i,s.c=-h*e,s.d=l*i}else s.a=e,s.b=0,s.c=0,s.d=i;s.tx=o,s.ty=a},a.prototype.createGradientBox=function(t,e,i,r,n){void 0===i&&(i=0),void 0===r&&(r=0),void 0===n&&(n=0),this.createBox(t/1638.4,e/1638.4,i,r+t/2,n+e/2)},a.prototype.$transformBounds=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,o=this.tx,a=this.ty,s=t.x,l=t.y,h=s+t.width,u=l+t.height,c=e*s+r*l+o,p=i*s+n*l+a,d=e*h+r*l+o,f=i*h+n*l+a,g=e*h+r*u+o,y=i*h+n*u+a,v=e*s+r*u+o,m=i*s+n*u+a,_=0;c>d&&(_=c,c=d,d=_),g>v&&(_=g,g=v,v=_),t.x=Math.floor(g>c?c:g),t.width=Math.ceil((d>v?d:v)-t.x),p>f&&(_=p,p=f,f=_),y>m&&(_=y,y=m,m=_),t.y=Math.floor(y>p?p:y),t.height=Math.ceil((f>m?f:m)-t.y)},a.prototype.getDeterminant=function(){return this.a*this.d-this.b*this.c},a.prototype.$getScaleX=function(){var t=this;if(1==t.a&&0==t.b)return 1;var e=Math.sqrt(t.a*t.a+t.b*t.b);return this.getDeterminant()<0?-e:e},a.prototype.$getScaleY=function(){var t=this;if(0==t.c&&1==t.d)return 1;var e=Math.sqrt(t.c*t.c+t.d*t.d);return this.getDeterminant()<0?-e:e},a.prototype.$getSkewX=function(){return Math.atan2(this.d,this.c)-e/2},a.prototype.$getSkewY=function(){return Math.atan2(this.b,this.a)},a.prototype.$updateScaleAndRotation=function(e,n,o,a){if(!(0!=o&&o!=i||0!=a&&a!=i))return this.a=e,this.b=this.c=0,void(this.d=n);o/=r,a/=r;var s=t.NumberUtils.cos(o),l=t.NumberUtils.sin(o);o==a?(this.a=s*e,this.b=l*e):(this.a=t.NumberUtils.cos(a)*e,this.b=t.NumberUtils.sin(a)*e),this.c=-l*n,this.d=s*n},a.prototype.$preMultiplyInto=function(t,e){var i=t.a*this.a,r=0,n=0,o=t.d*this.d,a=t.tx*this.a+this.tx,s=t.ty*this.d+this.ty;(0!==t.b||0!==t.c||0!==this.b||0!==this.c)&&(i+=t.b*this.c,o+=t.c*this.b,r+=t.a*this.b+t.b*this.d,n+=t.c*this.a+t.d*this.c,a+=t.ty*this.c,s+=t.tx*this.b),e.a=i,e.b=r,e.c=n,e.d=o,e.tx=a,e.ty=s},a}(t.HashObject);t.Matrix=o,__reflect(o.prototype,"egret.Matrix"),t.$TempMatrix=new o}(egret||(egret={}));var egret;!function(t){t.JointStyle={BEVEL:"bevel",MITER:"miter",ROUND:"round"}}(egret||(egret={}));var egret;!function(t){t.$locale_strings=t.$locale_strings||{},t.$locale_strings.en_US=t.$locale_strings.en_US||{};var e=t.$locale_strings.en_US;e[1001]="Could not find Egret entry class: {0}。",e[1002]="Egret entry class '{0}' must inherit from egret.DisplayObject.",e[1003]="Parameter {0} must be non-null.",e[1004]="An object cannot be added as a child to one of it's children (or children's children, etc.).",e[1005]="An object cannot be added as a child of itself.",e[1006]="The supplied DisplayObject must be a child of the caller.",e[1007]="An index specified for a parameter was out of range.",e[1008]="Instantiate singleton error，singleton class {0} can not create multiple instances.",e[1009]='the Class {0} cannot use the property "{1}"',e[1010]='the property "{1}" of the Class "{0}" is readonly',e[1011]="Stream Error. URL: {0}",e[1012]="The type of parameter {0} must be Class.",e[1013]="Variable assignment is NaN, please see the code!",e[1014]='the constant "{1}" of the Class "{0}" is read-only',e[1015]="xml not found!",e[1016]="{0}has been obsoleted",e[1017]="The format of JSON file is incorrect: {0}\ndata: {1}",e[1018]="the scale9Grid is not correct",e[1019]="Network ab:{0}",e[1020]="Cannot initialize Shader",e[1021]="Current browser does not support webgl",e[1022]="{0} ArgumentError",e[1023]="This method is not available in the ScrollView!",e[1025]="end of the file",e[1026]="! EncodingError The code point {0} could not be encoded.",e[1027]="DecodingError",e[1028]=". called injection is not configured rule: {0}, please specify configuration during its initial years of injection rule, and then call the corresponding single case.",e[1029]="Function.prototype.bind - what is trying to be bound is not callable",e[1033]="Photos can not be used across domains toDataURL to convert base64",e[1034]='Music file decoding failed: "{0}", please use the standard conversion tool reconversion under mp3.',e[1035]="Native does not support this feature!",e[1036]="Sound has stopped, please recall Sound.play () to play the sound!",e[1037]="Non-load the correct blob!",e[1038]="XML format error!",e[1039]="Cross domains pictures can not get pixel information!",e[1040]="hitTestPoint can not detect crossOrigin images! Please check if the display object has crossOrigin elements.",e[1041]="{0} is deprecated, please use {1} replace",e[1042]="The parameters passed in the region needs is an integer in drawToTexture method. Otherwise, some browsers will draw abnormal.",e[1043]="Compile errors in {0}, the attribute name: {1}, the attribute value: {2}.",e[1044]="The current version of the Runtime does not support video playback, please use the latest version",e[1045]="The resource url is not found",e[1046]="BitmapText no corresponding characters: {0}, please check the configuration file",e[1047]="egret.localStorage.setItem save failed,key={0}&value={1}",e[1048]="Video loading failed",e[1049]="In the absence of sound is not allowed to play after loading",e[1050]="ExternalInterface calls the method without js registration: {0}",e[3e3]="Theme configuration file failed to load: {0}",e[3001]="Cannot find the skin name which is configured in Theme: {0}",e[3002]='Index:"{0}" is out of the collection element index range',e[3003]="Cannot be available in this component. If this component is container, please continue to use",e[3004]="addChild(){0}addElement() replace",e[3005]="addChildAt(){0}addElementAt() replace",e[3006]="removeChild(){0}removeElement() replace",e[3007]="removeChildAt(){0}removeElementAt() replace",e[3008]="setChildIndex(){0}setElementIndex() replace",e[3009]="swapChildren(){0}swapElements() replace",e[3010]="swapChildrenAt(){0}swapElementsAt() replace",e[3011]='Index:"{0}" is out of the visual element index range',e[3012]="This method is not available in Scroller component!",e[3013]="UIStage is GUI root container, and only one such instant is in the display list！",e[3014]="set fullscreen error",e[3100]="Current browser does not support WebSocket",e[3101]="Please connect Socket firstly",e[3102]="Please set the type of binary type",e[4e3]="An Bone cannot be added as a child to itself or one of its children (or children's children, etc.)",e[4001]="Abstract class can not be instantiated!",e[4002]="Unnamed data!",e[4003]="Nonsupport version!"}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(i){var r=e.call(this,i)||this;return r._verticesDirty=!0,r._bounds=new t.Rectangle,r.$renderNode=new t.sys.MeshNode,r}return __extends(i,e),i.prototype.$render=function(){var e=this.$Bitmap,i=e[1];if(i){var r=(t.$TextureScaleFactor,this.$renderNode);r.smoothing=e[10],r.image=i,r.imageWidth=e[13],r.imageHeight=e[14];var n=isNaN(e[11])?e[8]:e[11],o=isNaN(e[12])?e[9]:e[12],a=n/e[8],s=o/e[9],l=e[4],h=e[5];r.drawMesh(e[2],e[3],l,h,e[6]*a,e[7]*s,a*l,s*h)}},i.prototype.$updateVertices=function(){this._verticesDirty=!0,this.$invalidateContentBounds()},i.prototype.$measureContentBounds=function(t){if(this._verticesDirty){this._verticesDirty=!1;var e=this.$renderNode,i=e.vertices;if(i.length){this._bounds.setTo(Number.MAX_VALUE,Number.MAX_VALUE,Number.MIN_VALUE,Number.MIN_VALUE);for(var r=0,n=i.length;n>r;r+=2){var o=i[r],a=i[r+1];this._bounds.x>o&&(this._bounds.x=o),this._bounds.width<o&&(this._bounds.width=o),this._bounds.y>a&&(this._bounds.y=a),this._bounds.height<a&&(this._bounds.height=a)}this._bounds.width-=this._bounds.x,this._bounds.height-=this._bounds.y}else this._bounds.setTo(0,0,0,0);e.bounds.copyFrom(this._bounds)}t.copyFrom(this._bounds)},i}(t.Bitmap);t.Mesh=e,__reflect(e.prototype,"egret.Mesh")}(egret||(egret={}));var egret;!function(t){t.$locale_strings=t.$locale_strings||{},t.$locale_strings.zh_CN=t.$locale_strings.zh_CN||{};var e=t.$locale_strings.zh_CN;e[1001]="找不到Egret入口类: {0}。",e[1002]="Egret入口类 {0} 必须继承自egret.DisplayObject。",e[1003]="参数 {0} 不能为 null。",e[1004]="无法将对象添加为它的一个子对象（或子对象的子对象等）的子对象。",e[1005]="不能将对象添加为其自身的子对象。",e[1006]="提供的 DisplayObject 必须是调用者的子级。",e[1007]="为参数指定的索引不在范围内。",e[1008]="实例化单例出错，不允许实例化多个 {0} 对象。",e[1009]="类 {0} 不可以使用属性 {1}",e[1010]="类 {0} 属性 {1} 是只读的",e[1011]="流错误。URL: {0}",e[1012]="参数 {0} 的类型必须为 Class。",e[1013]="变量赋值为NaN，请查看代码！",e[1014]="类 {0} 常量 {1} 是只读的",e[1015]="xml not found!",e[1016]="{0}已经废弃",e[1017]="JSON文件格式不正确: {0}\ndata: {1}",e[1018]="9宫格设置错误",e[1019]="网络异常:{0}",e[1020]="无法初始化着色器",e[1021]="当前浏览器不支持webgl",e[1022]="{0} ArgumentError",e[1023]="此方法在ScrollView内不可用!",e[1025]="遇到文件尾",e[1026]="EncodingError! The code point {0} could not be encoded.",e[1027]="DecodingError",e[1028]="调用了未配置的注入规则:{0}。 请先在项目初始化里配置指定的注入规则，再调用对应单例。",e[1029]="Function.prototype.bind - what is trying to be bound is not callable",e[1033]="跨域图片不可以使用toDataURL来转换成base64",e[1034]='音乐文件解码失败："{0}"，请使用标准的转换工具重新转换下mp3。',e[1035]="Native 下暂未实现此功能！",e[1036]="声音已停止，请重新调用 Sound.play() 来播放声音！",e[1037]="非正确的blob加载！",e[1038]="XML 格式错误!",e[1039]="跨域图片不能获取像素信息!",e[1040]="hitTestPoint 不能对跨域图片进行检测! 请检查该显示对象内是否含有跨域元素",e[1041]="{0} 已废弃,请使用 {1} 代替",e[1042]="drawToTexture方法传入的区域各个参数需要为整数,否则某些浏览器绘制会出现异常",e[1043]="{0} 中存在编译错误，属性名 : {1}，属性值 : {2}",e[1044]="当前的 runtime 版本不支持视频播放,请使用最新的版本",e[1045]="没有设置要加载的资源地址",e[1046]="BitmapText 找不到对应字符:{0}，请检查配置文件",e[1047]="egret.localStorage.setItem保存失败,key={0}&value={1}",e[1048]="视频加载失败",e[1049]="声音在没有加载完之前不允许播放",e[1050]="ExternalInterface调用了js没有注册的方法: {0}",e[3e3]="主题配置文件加载失败: {0}",e[3001]="找不到主题中所配置的皮肤类名: {0}",e[3002]='索引:"{0}"超出集合元素索引范围',e[3003]="在此组件中不可用，若此组件为容器类，请使用",e[3004]="addChild(){0}addElement()代替",e[3005]="addChildAt(){0}addElementAt()代替",e[3006]="removeChild(){0}removeElement()代替",e[3007]="removeChildAt(){0}removeElementAt()代替",e[3008]="setChildIndex(){0}setElementIndex()代替",e[3009]="swapChildren(){0}swapElements()代替",e[3010]="swapChildrenAt(){0}swapElementsAt()代替",e[3011]='索引:"{0}"超出可视元素索引范围',e[3012]="此方法在Scroller组件内不可用!",e[3013]="UIStage是GUI根容器，只能有一个此实例在显示列表中！",e[3014]="设置全屏模式失败",e[3100]="当前浏览器不支持WebSocket",e[3101]="请先连接WebSocket",e[3102]="请先设置type为二进制类型",e[4e3]="An Bone cannot be added as a child to itself or one of its children (or children's children, etc.)",e[4001]="Abstract class can not be instantiated!",e[4002]="Unnamed data!",e[4003]="Nonsupport version!"}(egret||(egret={}));var egret;!function(t){var e;!function(){}(e=t.localStorage||(t.localStorage={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){function e(t){r.indexOf(t)<0&&r.push(t)}function i(t){var e=r.indexOf(t);return e>=0?(r.splice(e,1),!0):!1}var r=[];t.$pushSoundChannel=e,t.$popSoundChannel=i}(e=t.sys||(t.sys={}))}(egret||(egret={})),function(){}(egret||(egret={}));var egret;!function(){}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){this.onSuccessFunc=null,this.onSuccessThisObject=null,this.onErrorFunc=null,this.onErrorThisObject=null,this.downloadingSizeFunc=null,this.downloadingSizeThisObject=null,this.onResponseHeaderFunc=null,this.onResponseHeaderThisObject=null}return e.create=function(){return e.promiseObjectList.length?e.promiseObjectList.pop():new t.PromiseObject},e.prototype.onSuccess=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.onSuccessFunc&&this.onSuccessFunc.apply(this.onSuccessThisObject,t),this.destroy()},e.prototype.onError=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.onErrorFunc&&this.onErrorFunc.apply(this.onErrorThisObject,t),this.destroy()},e.prototype.downloadingSize=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.downloadingSizeFunc&&this.downloadingSizeFunc.apply(this.downloadingSizeThisObject,t)},e.prototype.onResponseHeader=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.onResponseHeaderFunc&&this.onResponseHeaderFunc.apply(this.onResponseHeaderThisObject,t)},e.prototype.destroy=function(){this.onSuccessFunc=void 0,this.onSuccessThisObject=void 0,this.onErrorFunc=void 0,this.onErrorThisObject=void 0,this.downloadingSizeFunc=void 0,this.downloadingSizeThisObject=void 0,this.onResponseHeaderFunc=void 0,this.onResponseHeaderThisObject=void 0,e.promiseObjectList.push(this)},e}();e.promiseObjectList=[],t.PromiseObject=e,__reflect(e.prototype,"egret.PromiseObject")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t}();e.GET="GET",e.POST="POST",t.HttpMethod=e,__reflect(e.prototype,"egret.HttpMethod")}(egret||(egret={}));var egret;!function(){}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t}();e.TEXT="text",e.ARRAY_BUFFER="arraybuffer",t.HttpResponseType=e,__reflect(e.prototype,"egret.HttpResponseType")}(egret||(egret={}));var egret;!function(){}(egret||(egret={}));var egret;!function(t){var e;!function(e){function i(t,e){var i=t.minX<e.minX?t.minX:e.minX,r=t.minY<e.minY?t.minY:e.minY,n=t.maxX>e.maxX?t.maxX:e.maxX,o=t.maxY>e.maxY?t.maxY:e.maxY;return(n-i)*(o-r)}var r=function(){function r(e){this.dirtyList=[],this.hasClipRect=!1,this.clipWidth=0,this.clipHeight=0,this.clipArea=0,this.clipRectChanged=!1,this.$dirtyRegionPolicy=t.DirtyRegionPolicy.ON,this.root=e}return r.prototype.setClipRect=function(t,e){this.hasClipRect=!0,this.clipRectChanged=!0,this.clipWidth=Math.ceil(t),this.clipHeight=Math.ceil(e),this.clipArea=this.clipWidth*this.clipHeight},r.prototype.addRegion=function(i){var r=i.minX,n=i.minY,o=i.maxX,a=i.maxY;if(this.hasClipRect&&(0>r&&(r=0),0>n&&(n=0),o>this.clipWidth&&(o=this.clipWidth),a>this.clipHeight&&(a=this.clipHeight)),r>=o||n>=a)return!1;if(this.clipRectChanged)return!0;var s=this.dirtyList,l=e.Region.create();return s.push(l.setTo(r,n,o,a)),this.$dirtyRegionPolicy!=t.DirtyRegionPolicy.OFF&&this.mergeDirtyList(s),!0},r.prototype.clear=function(){for(var t=this.dirtyList,i=t.length,r=0;i>r;r++)e.Region.release(t[r]);t.length=0},r.prototype.getDirtyRegions=function(){var i=this.dirtyList;if(this.$dirtyRegionPolicy==t.DirtyRegionPolicy.OFF||t.Capabilities.runtimeType==t.RuntimeType.NATIVE&&!t["native"].$supportCanvas){this.clipRectChanged=!0,this.clear();var r=e.Region.create();if(this.hasClipRect)i.push(r.setTo(0,0,this.clipWidth,this.clipHeight));else{var n=this.root.$getOriginalBounds();i.push(r.setTo(n.x,n.y,n.width,n.height))}}else if(this.clipRectChanged){this.clipRectChanged=!1,this.clear();var r=e.Region.create();i.push(r.setTo(0,0,this.clipWidth,this.clipHeight))}else for(;this.mergeDirtyList(i););var o=this.dirtyList.length;if(o>0)for(var a=0;o>a;a++)this.dirtyList[a].intValues();return this.dirtyList},r.prototype.mergeDirtyList=function(t){var r=t.length;if(2>r)return!1;for(var n=this.hasClipRect,o=r>3?Number.POSITIVE_INFINITY:0,a=0,s=0,l=0,h=0;r-1>h;h++){var u=t[h];n&&(l+=u.area);for(var c=h+1;r>c;c++){var p=t[c],d=i(u,p)-u.area-p.area;o>d&&(a=h,s=c,o=d)}}if(n&&l/this.clipArea>.95&&(this.clipRectChanged=!0),a!=s){var f=t[s];return t[a].union(f),e.Region.release(f),t.splice(s,1),!0}return!1},r.prototype.setDirtyRegionPolicy=function(t){this.$dirtyRegionPolicy=t},r}();e.DirtyRegion=r,__reflect(r.prototype,"egret.sys.DirtyRegion")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(i){function r(r){var n=i.call(this)||this;return n.isStage=!1,n.$renderNode=new e.BitmapNode,n.renderBuffer=null,n.offsetX=0,n.offsetY=0,n.offsetMatrix=new t.Matrix,n.isDirty=!1,n.needUpdateRegions=!1,n.dirtyNodeList=[],n.dirtyList=null,n.sizeChanged=!1,n.$dirtyRegionPolicy=t.DirtyRegionPolicy.ON,n.root=r,n.dirtyRegion=new e.DirtyRegion(r),n.isStage=r instanceof t.Stage,n.dirtyNodes=t.createMap(),n}return __extends(r,i),r.create=function(i){var r=new t.sys.DisplayList(i);try{var n=new e.RenderBuffer;r.renderBuffer=n}catch(o){return null}return r.root=i,r},r.prototype.$getRenderNode=function(){return this.$renderNode},r.prototype.$update=function(e){var i=this.root;if(null==i)return!1;i.$removeFlagsUp(768);var r=this.$renderNode,n=i.$getConcatenatedMatrix();if(e==t.DirtyRegionPolicy.OFF){var o=i.$parentDisplayList;if(this.needUpdateRegions&&this.updateDirtyRegions(),!o)return!1;var a=r.renderMatrix;a.copyFrom(n);var s=o.root;s!==i.$stage&&i.$getConcatenatedMatrixAt(s,a)}else{var l=i.$getOriginalBounds(),o=i.$parentDisplayList,h=r.renderRegion;if(this.needUpdateRegions&&this.updateDirtyRegions(),!o)return h.setTo(0,0,0,0),r.moved=!1,!1;if(!r.moved)return!1;r.moved=!1;var a=r.renderMatrix;a.copyFrom(n);var s=o.root;s!==i.$stage&&i.$getConcatenatedMatrixAt(s,a),h.updateRegion(l,a)}return!0},r.prototype.setClipRect=function(t,e){this.dirtyRegion.setClipRect(t,e),this.renderBuffer.resize(t,e)},r.prototype.markDirty=function(t){var e=t.$hashCode;if(!this.dirtyNodes[e]&&(this.dirtyNodes[e]=!0,this.dirtyNodeList.push(t),!this.needUpdateRegions)){this.needUpdateRegions=!0,this.isDirty=!0;var i=this.root.$parentDisplayList;i&&i.markDirty(this)}},r.prototype.updateDirtyRegions=function(){var e=this.dirtyNodeList;this.dirtyNodeList=[],this.dirtyNodes=t.createMap(),this.needUpdateRegions=!1;for(var i=this.dirtyRegion,r=e.length,n=0;r>n;n++){var o=e[n],a=o.$getRenderNode();if(a)if(a.needRedraw=!1,this.isStage){a.renderAlpha>0&&a.renderVisible&&i.addRegion(a.renderRegion)&&(a.needRedraw=!0);var s=o.$update(this.$dirtyRegionPolicy);a.renderAlpha>0&&a.renderVisible&&(s||!a.needRedraw)&&i.addRegion(a.renderRegion)&&(a.needRedraw=!0)}else{i.addRegion(a.renderRegion)&&(a.needRedraw=!0);var s=o.$update(this.$dirtyRegionPolicy);(s||!a.needRedraw)&&i.addRegion(a.renderRegion)&&(a.needRedraw=!0)}}return this.dirtyList=i.getDirtyRegions(),this.dirtyList},r.prototype.drawToSurface=function(){var i=0,r=this.dirtyList;if(r&&r.length>0){this.isStage||this.changeSurfaceSize();var n=this.renderBuffer;if(n.beginClip(this.dirtyList,this.offsetX,this.offsetY),r=this.$dirtyRegionPolicy==t.DirtyRegionPolicy.OFF?null:this.dirtyList,i=e.systemRenderer.render(this.root,n,this.offsetMatrix,r),n.endClip(),!this.isStage){var o=n.surface,a=this.$renderNode;a.drawData.length=0;var s=o.width,l=o.height;this.bitmapData?(this.bitmapData.source=o,this.bitmapData.width=s,this.bitmapData.height=l):this.bitmapData=new t.BitmapData(o),a.image=this.bitmapData,a.imageWidth=s,a.imageHeight=l,a.drawImage(0,0,s,l,-this.offsetX,-this.offsetY,s,l)}}return this.dirtyList=null,this.dirtyRegion.clear(),this.isDirty=!1,i},r.prototype.changeSurfaceSize=function(){var t=(this.root,this.offsetX),e=this.offsetY,i=this.root.$getOriginalBounds();this.offsetX=-i.x,this.offsetY=-i.y,this.offsetMatrix.setTo(1,0,0,1,this.offsetX,this.offsetY);var r=this.renderBuffer,n=Math.max(257,i.width),o=Math.max(257,i.height);(this.offsetX!=t||this.offsetY!=e||r.surface.width!=n||r.surface.height!=o)&&(this.sizeChanged?r.resizeTo(n,o,this.offsetX-t,this.offsetY-e):(this.sizeChanged=!0,r.resize(n,o)))},r.prototype.setDirtyRegionPolicy=function(t){this.$dirtyRegionPolicy=t,this.dirtyRegion.setDirtyRegionPolicy(t),this.renderBuffer.setDirtyRegionPolicy(t)},r}(t.HashObject);e.DisplayList=i,__reflect(i.prototype,"egret.sys.DisplayList",["egret.sys.Renderable"])}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(){}(egret||(egret={}));var egret;!function(){}(egret||(egret={}));var egret;!function(t){var e;!function(e){function i(i,r,n,o){if(r&&(t.log=function(){for(var t=arguments.length,i="",r=0;t>r;r++)i+=arguments[r]+" ";e.$logToFPS(i),console.log.apply(console,a(arguments))}),h=o?{}:o,r=!!r,this.showFPS=!!i,this.showLog=r,!this.fps){var s=void 0===o.x?0:o.x,c=void 0===o.y?0:o.y;l=this.fps=new FPS(this.stage,i,r,n,o),l.x=s,l.y=c;for(var p=u.length,d=0;p>d;d++)l.updateInfo(u[d]);u=null}}function r(t){t=!!t,this._showPaintRect!=t&&(this._showPaintRect=t,t?(this.stageDisplayList||(this.stageDisplayList=e.DisplayList.create(this.stage)),this.stage.$displayList=this.stageDisplayList):this.stage.$displayList=this.screenDisplayList)}function n(t){for(var e=t.length,i=[],r=0;e>r;r++){var n=t[r];i[r]=[n.minX,n.minY,n.width,n.height],n.width-=1,n.height-=1}var o=this.paintList;o.push(i),o.length>1&&o.shift();var a=this.screenDisplayList.renderBuffer,s=a.context;s.setTransform(1,0,0,1,0,0),s.clearRect(0,0,a.surface.width,a.surface.height),s.drawImage(this.stageDisplayList.renderBuffer.surface,0,0),e=o.length;for(var r=0;e>r;r++){i=o[r];for(var l=i.length-1;l>=0;l--){var h=i[l];this.drawDirtyRect(h[0],h[1],h[2],h[3],s)}}s.save(),s.beginPath(),e=t.length;for(var r=0;e>r;r++){var n=t[r];s.clearRect(n.minX,n.minY,n.width,n.height),s.rect(n.minX,n.minY,n.width,n.height)}s.clip(),s.drawImage(this.stageDisplayList.renderBuffer.surface,0,0),s.restore()}function o(t,e,i,r,n){n.strokeStyle="rgb(255,0,0)",n.lineWidth=5,n.strokeRect(t-.5,e-.5,i,r)}function a(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i]);return e}var s=function(a){function s(e,s,l){var h=a.call(this)||this;return h.isPlaying=!1,e||t.$error(1003,"buffer"),h.entryClassName=l,h.stage=s,h.screenDisplayList=h.createDisplayList(s,e),h.showFPS=!1,h.showLog=!1,h._showPaintRect=!1,h.stageDisplayList=null,h.paintList=[],h.displayFPS=i,h.showPaintRect=r,h.drawPaintRect=n,h.drawDirtyRect=o,h}return __extends(s,a),s.prototype.createDisplayList=function(t,i){var r=new e.DisplayList(t);return r.renderBuffer=i,t.$displayList=r,r},s.prototype.start=function(){!this.isPlaying&&this.stage&&(e.$TempStage=e.$TempStage||this.stage,this.isPlaying=!0,this.root||this.initialize(),e.$ticker.$addPlayer(this))},s.prototype.initialize=function(){var e;
if(this.entryClassName&&(e=t.getDefinitionByName(this.entryClassName)),e){var i=new e;this.root=i,i instanceof t.DisplayObject?this.stage.addChild(i):t.$error(1002,this.entryClassName)}else t.$error(1001,this.entryClassName)},s.prototype.stop=function(){this.pause(),this.stage=null},s.prototype.pause=function(){this.isPlaying&&(this.isPlaying=!1,e.$ticker.$removePlayer(this))},s.prototype.$render=function(e,i){(this.showFPS||this.showLog)&&this.stage.addChild(this.fps);var r=this.stage,n=t.getTimer(),o=r.$displayList.updateDirtyRegions(),a=t.getTimer();o=o.concat();var s=r.$displayList.drawToSurface();this._showPaintRect&&this.drawPaintRect(o);var l=t.getTimer();if(e&&this.showFPS){var h=0;if(s>0){for(var u=o.length,c=0,p=0;u>p;p++)c+=o[p].area;h=Math.ceil(1e3*c/(r.stageWidth*r.stageHeight))/10}this.fps.update(s,h,a-n,l-a,i)}},s.prototype.updateStageSize=function(e,i){var r=this.stage;r.$stageWidth=e,r.$stageHeight=i,this.screenDisplayList.setClipRect(e,i),this.stageDisplayList&&this.stageDisplayList.setClipRect(e,i),r.dispatchEventWith(t.Event.RESIZE),r.$invalidate(!0)},s}(t.HashObject);e.Player=s,__reflect(s.prototype,"egret.sys.Player");var l,h,u=[];e.$logToFPS=function(t){return l?void l.updateInfo(t):void u.push(t)},FPS=function(i){function r(e,r,n,o,a){i.call(this),this.isFPS=!0,this.infoLines=[],this.totalTime=0,this.totalTick=0,this.lastTime=0,this.drawCalls=0,this.dirtyRatio=0,this.costDirty=0,this.costRender=0,this.costTicker=0,this._stage=e,this.showFPS=r,this.showLog=n,this.logFilter=o,this.touchChildren=!1,this.touchEnabled=!1,this.styles=a,this.fpsDisplay=new t.FPSDisplay(e,r,n,o,a),this.addChild(this.fpsDisplay);var s;try{s=o?new RegExp(o):null}catch(l){t.log(l)}this.filter=function(t){return s?s.test(t):!o||0==t.indexOf(o)}}return __extends(r,i),r.prototype.update=function(i,r,n,o,a){var s=t.getTimer();if(this.totalTime+=s-this.lastTime,this.lastTime=s,this.totalTick++,this.drawCalls+=i,this.dirtyRatio+=r,this.costDirty+=n,this.costRender+=o,this.costTicker+=a,this.totalTime>=1e3){var l=Math.min(Math.ceil(1e3*this.totalTick/this.totalTime),e.$ticker.$frameRate),h=Math.round(this.drawCalls/this.totalTick),u=Math.round(this.dirtyRatio/this.totalTick),c=Math.round(this.costDirty/this.totalTick),p=Math.round(this.costRender/this.totalTick),d=Math.round(this.costTicker/this.totalTick);this.fpsDisplay.update({fps:l,draw:h,dirty:u,costTicker:d,costDirty:c,costRender:p}),this.totalTick=0,this.totalTime=this.totalTime%1e3,this.drawCalls=0,this.dirtyRatio=0,this.costDirty=0,this.costRender=0,this.costTicker=0}},r.prototype.updateInfo=function(t){t&&this.showLog&&this.filter(t)&&this.fpsDisplay.updateInfo(t)},r}(t.Sprite),t.warn=function(){console.warn.apply(console,a(arguments))},t.error=function(){console.error.apply(console,a(arguments))},t.assert=function(){console.assert.apply(console,a(arguments))},t.log=function(){console.log.apply(console,a(arguments))}}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){t.OrientationMode={AUTO:"auto",PORTRAIT:"portrait",LANDSCAPE:"landscape",LANDSCAPE_FLIPPED:"landscapeFlipped"}}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=[],i=function(){function t(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.width=0,this.height=0,this.area=0,this.moved=!1}return t.release=function(t){e.push(t)},t.create=function(){var i=e.pop();return i||(i=new t),i},t.prototype.setTo=function(t,e,i,r){return this.minX=t,this.minY=e,this.maxX=i,this.maxY=r,this.updateArea(),this},t.prototype.intValues=function(){this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this.updateArea()},t.prototype.updateArea=function(){this.width=this.maxX-this.minX,this.height=this.maxY-this.minY,this.area=this.width*this.height},t.prototype.union=function(t){this.minX>t.minX&&(this.minX=t.minX),this.minY>t.minY&&(this.minY=t.minY),this.maxX<t.maxX&&(this.maxX=t.maxX),this.maxY<t.maxY&&(this.maxY=t.maxY),this.updateArea()},t.prototype.intersect=function(t){return this.minX<t.minX&&(this.minX=t.minX),this.maxX>t.maxX&&(this.maxX=t.maxX),this.minX>=this.maxX?void this.setEmpty():(this.minY<t.minY&&(this.minY=t.minY),this.maxY>t.maxY&&(this.maxY=t.maxY),this.minY>=this.maxY?void this.setEmpty():void this.updateArea())},t.prototype.setEmpty=function(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.width=0,this.height=0,this.area=0},t.prototype.isEmpty=function(){return this.width<=0||this.height<=0},t.prototype.intersects=function(t){if(this.isEmpty())return!1;var e=this.minX>t.minX?this.minX:t.minX,i=this.maxX<t.maxX?this.maxX:t.maxX;return e>i?!1:(e=this.minY>t.minY?this.minY:t.minY,i=this.maxY<t.maxY?this.maxY:t.maxY,i>=e)},t.prototype.updateRegion=function(t,e){if(0==t.width||0==t.height)return void this.setEmpty();var i,r,n,o,a=e,s=a.a,l=a.b,h=a.c,u=a.d,c=a.tx,p=a.ty,d=t.x,f=t.y,g=d+t.width,y=f+t.height;if(1==s&&0==l&&0==h&&1==u)i=d+c-1,r=f+p-1,n=g+c+1,o=y+p+1;else{var v=s*d+h*f+c,m=l*d+u*f+p,_=s*g+h*f+c,b=l*g+u*f+p,T=s*g+h*y+c,x=l*g+u*y+p,E=s*d+h*y+c,$=l*d+u*y+p,S=0;v>_&&(S=v,v=_,_=S),T>E&&(S=T,T=E,E=S),i=(T>v?v:T)-1,n=(_>E?_:E)+1,m>b&&(S=m,m=b,b=S),x>$&&(S=x,x=$,$=S),r=(x>m?m:x)-1,o=(b>$?b:$)+1}this.minX=i,this.minY=r,this.maxX=n,this.maxY=o,this.width=n-i,this.height=o-r,this.area=this.width*this.height},t}();t.Region=i,__reflect(i.prototype,"egret.sys.Region")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(){}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.calculateStageSize=function(e,i,r,n,o){var a=i,s=r,l=n,h=o,u=i/l||0,c=r/h||0;switch(e){case t.StageScaleMode.EXACT_FIT:break;case t.StageScaleMode.FIXED_HEIGHT:l=Math.round(i/c);break;case t.StageScaleMode.FIXED_WIDTH:h=Math.round(r/u);break;case t.StageScaleMode.NO_BORDER:u>c?s=Math.round(h*u):a=Math.round(l*c);break;case t.StageScaleMode.SHOW_ALL:u>c?a=Math.round(l*c):s=Math.round(h*u);break;case t.StageScaleMode.FIXED_NARROW:u>c?l=Math.round(i/c):h=Math.round(r/u);break;case t.StageScaleMode.FIXED_WIDE:u>c?h=Math.round(r/u):l=Math.round(i/c);break;default:l=i,h=r}return a%2!=0&&(a+=1),s%2!=0&&(s+=1),{stageWidth:l,stageHeight:h,displayWidth:a,displayHeight:s}},i}(t.HashObject);e.DefaultScreenAdapter=i,__reflect(i.prototype,"egret.sys.DefaultScreenAdapter",["egret.sys.IScreenAdapter"])}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t}();e.NO_SCALE="noScale",e.SHOW_ALL="showAll",e.NO_BORDER="noBorder",e.EXACT_FIT="exactFit",e.FIXED_WIDTH="fixedWidth",e.FIXED_HEIGHT="fixedHeight",e.FIXED_NARROW="fixedNarrow",e.FIXED_WIDE="fixedWide",t.StageScaleMode=e,__reflect(e.prototype,"egret.StageScaleMode")}(egret||(egret={}));var egret;!function(t){var e;!function(){}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){e.$START_TIME=0,e.$invalidateRenderFlag=!1,e.$requestRenderingFlag=!1;var i=function(){function i(){this.playerList=[],this.callBackList=[],this.thisObjectList=[],this.$frameRate=30,this.lastTimeStamp=0,this.costEnterFrame=0,e.$ticker&&t.$error(1008,"egret.sys.SystemTicker"),e.$START_TIME=Date.now(),this.frameDeltaTime=1e3/this.$frameRate,this.lastCount=this.frameInterval=Math.round(6e4/this.$frameRate)}return i.prototype.$addPlayer=function(t){-1==this.playerList.indexOf(t)&&(egret_stages.push(t.stage),this.playerList=this.playerList.concat(),this.playerList.push(t))},i.prototype.$removePlayer=function(t){var e=this.playerList.indexOf(t);if(-1!==e){var i=egret_stages.indexOf(t.stage);egret_stages.splice(i,1),this.playerList=this.playerList.concat(),this.playerList.splice(e,1)}},i.prototype.$startTick=function(t,e){var i=this.getTickIndex(t,e);-1==i&&(this.concatTick(),this.callBackList.push(t),this.thisObjectList.push(e))},i.prototype.$stopTick=function(t,e){var i=this.getTickIndex(t,e);-1!=i&&(this.concatTick(),this.callBackList.splice(i,1),this.thisObjectList.splice(i,1))},i.prototype.getTickIndex=function(t,e){for(var i=this.callBackList,r=this.thisObjectList,n=i.length-1;n>=0;n--)if(i[n]==t&&r[n]==e)return n;return-1},i.prototype.concatTick=function(){this.callBackList=this.callBackList.concat(),this.thisObjectList=this.thisObjectList.concat()},i.prototype.$setFrameRate=function(e){return e=+e||0,0>=e?!1:this.$frameRate==e?!1:(this.$frameRate=e,e>60&&(e=60),t.Capabilities.runtimeType==t.RuntimeType.NATIVE&&(egret_native.setFrameRate(e),e=60),this.frameDeltaTime=1e3/e,this.lastCount=this.frameInterval=Math.round(6e4/e),!0)},i.prototype.update=function(){var i=t.getTimer(),r=this.callBackList,n=this.thisObjectList,o=r.length,a=e.$requestRenderingFlag,s=t.getTimer();this.callLaterAsyncs();for(var l=0;o>l;l++)r[l].call(n[l],s)&&(a=!0);var h=t.getTimer(),u=s-this.lastTimeStamp;if(this.lastTimeStamp=s,u>=this.frameDeltaTime)this.lastCount=this.frameInterval;else{if(this.lastCount-=1e3,this.lastCount>0)return void(a&&this.render(!1,this.costEnterFrame+h-i));this.lastCount+=this.frameInterval}this.render(!0,this.costEnterFrame+h-i);var c=t.getTimer();this.broadcastEnterFrame();var p=t.getTimer();this.costEnterFrame=p-c},i.prototype.render=function(t,i){var r=this.playerList,n=r.length;if(0!=n){this.callLaters(),e.$invalidateRenderFlag&&(this.broadcastRender(),e.$invalidateRenderFlag=!1);for(var o=0;n>o;o++)r[o].$render(t,i);e.$requestRenderingFlag=!1}},i.prototype.broadcastEnterFrame=function(){var e=t.DisplayObject.$enterFrameCallBackList,i=e.length;if(0!=i){e=e.concat();for(var r=0;i>r;r++)e[r].dispatchEventWith(t.Event.ENTER_FRAME)}},i.prototype.broadcastRender=function(){var e=t.DisplayObject.$renderCallBackList,i=e.length;if(0!=i){e=e.concat();for(var r=0;i>r;r++)e[r].dispatchEventWith(t.Event.RENDER)}},i.prototype.callLaters=function(){var e,i,r;if(t.$callLaterFunctionList.length>0&&(e=t.$callLaterFunctionList,t.$callLaterFunctionList=[],i=t.$callLaterThisList,t.$callLaterThisList=[],r=t.$callLaterArgsList,t.$callLaterArgsList=[]),e)for(var n=e.length,o=0;n>o;o++){var a=e[o];null!=a&&a.apply(i[o],r[o])}},i.prototype.callLaterAsyncs=function(){if(t.$callAsyncFunctionList.length>0){var e=t.$callAsyncFunctionList,i=t.$callAsyncThisList,r=t.$callAsyncArgsList;t.$callAsyncFunctionList=[],t.$callAsyncThisList=[],t.$callAsyncArgsList=[];for(var n=0;n<e.length;n++){var o=e[n];null!=o&&o.apply(i[n],r[n])}}},i}();e.SystemTicker=i,__reflect(i.prototype,"egret.sys.SystemTicker"),e.$ticker=new e.SystemTicker}(e=t.sys||(t.sys={}))}(egret||(egret={})),egret_stages=[];var egret;!function(t){var e;!function(e){var i=function(e){function i(t){var i=e.call(this)||this;return i.maxTouches=0,i.useTouchesCount=0,i.touchDownTarget={},i.lastTouchX=-1,i.lastTouchY=-1,i.stage=t,i}return __extends(i,e),i.prototype.$initMaxTouches=function(){this.maxTouches=this.stage.$maxTouches},i.prototype.onTouchBegin=function(e,i,r){if(!(this.useTouchesCount>=this.maxTouches)){this.lastTouchX=e,this.lastTouchY=i;var n=this.findTarget(e,i);null==this.touchDownTarget[r]&&(this.touchDownTarget[r]=n,this.useTouchesCount++),t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_BEGIN,!0,!0,e,i,r,!0)}},i.prototype.onTouchMove=function(e,i,r){if(null!=this.touchDownTarget[r]&&(this.lastTouchX!=e||this.lastTouchY!=i)){this.lastTouchX=e,this.lastTouchY=i;var n=this.findTarget(e,i);t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_MOVE,!0,!0,e,i,r,!0)}},i.prototype.onTouchEnd=function(e,i,r){if(null!=this.touchDownTarget[r]){var n=this.findTarget(e,i),o=this.touchDownTarget[r];delete this.touchDownTarget[r],this.useTouchesCount--,t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_END,!0,!0,e,i,r,!1),o==n?t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_TAP,!0,!0,e,i,r,!1):t.TouchEvent.dispatchTouchEvent(o,t.TouchEvent.TOUCH_RELEASE_OUTSIDE,!0,!0,e,i,r,!1)}},i.prototype.findTarget=function(t,e){var i=this.stage.$hitTest(t,e);return i||(i=this.stage),i},i}(t.HashObject);e.TouchHandler=i,__reflect(i.prototype,"egret.sys.TouchHandler")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(){var t=e.call(this)||this;return t.image=null,t.smoothing=!0,t.blendMode=null,t.alpha=0/0,t.filter=null,t.type=1,t}return __extends(i,e),i.prototype.drawImage=function(t,e,i,r,n,o,a,s){this.drawData.push(t,e,i,r,n,o,a,s),this.renderCount++},i.prototype.cleanBeforeRender=function(){e.prototype.cleanBeforeRender.call(this),this.image=null,this.matrix=null,this.blendMode=null,this.alpha=0/0,this.filter=null},i.$updateTextureData=function(e,r,n,o,a,s,l,h,u,c,p,d,f,g,y,v,m){if(r){var _=t.$TextureScaleFactor;if(e.smoothing=m,e.image=r,e.imageWidth=f,e.imageHeight=g,y)i.$updateTextureDataWithScale9Grid(e,y,n,o,a,s,l,h,u,c,p,d);else if(v==t.BitmapFillMode.SCALE){var b=p/u*_,T=d/c*_;e.drawImage(n,o,a,s,b*l,T*h,b*a,T*s)}else if(v==t.BitmapFillMode.CLIP){var x=Math.min(u,p),E=Math.min(c,d),$=a*_,S=s*_;i.drawClipImage(e,_,n,o,$,S,l,h,x,E)}else for(var $=a*_,S=s*_,C=0;p>C;C+=u)for(var w=0;d>w;w+=c){var x=Math.min(p-C,u),E=Math.min(d-w,c);i.drawClipImage(e,_,n,o,$,S,l,h,x,E,C,w)}}},i.$updateTextureDataWithScale9Grid=function(e,i,r,n,o,a,s,l,h,u,c,p){var d=o,f=a;c-=h-o*t.$TextureScaleFactor,p-=u-a*t.$TextureScaleFactor;var g=i.x-s,y=i.y-l,v=g/t.$TextureScaleFactor,m=y/t.$TextureScaleFactor,_=i.width/t.$TextureScaleFactor,b=i.height/t.$TextureScaleFactor;0==b&&(b=1,m>=f&&m--),0==_&&(_=1,v>=d&&v--);var T=r,x=T+v,E=x+_,$=d-v-_,S=n,C=S+m,w=C+b,O=f-m-b,P=$*t.$TextureScaleFactor,D=O*t.$TextureScaleFactor;if((v+$)*t.$TextureScaleFactor>c||(m+O)*t.$TextureScaleFactor>p)return void e.drawImage(r,n,o,a,s,l,c,p);var L=s,R=L+g,I=L+(c-P),M=c-g-P,A=l,B=A+y,N=A+p-D,F=p-y-D;m>0&&(v>0&&e.drawImage(T,S,v,m,L,A,g,y),_>0&&e.drawImage(x,S,_,m,R,A,M,y),$>0&&e.drawImage(E,S,$,m,I,A,P,y)),b>0&&(v>0&&e.drawImage(T,C,v,b,L,B,g,F),_>0&&e.drawImage(x,C,_,b,R,B,M,F),$>0&&e.drawImage(E,C,$,b,I,B,P,F)),O>0&&(v>0&&e.drawImage(T,w,v,O,L,N,g,D),_>0&&e.drawImage(x,w,_,O,R,N,M,D),$>0&&e.drawImage(E,w,$,O,I,N,P,D))},i.drawClipImage=function(t,e,i,r,n,o,a,s,l,h,u,c){void 0===u&&(u=0),void 0===c&&(c=0);var p=a+n-l;p>0&&(n-=p),p=s+o-h,p>0&&(o-=p),t.drawImage(i,r,n/e,o/e,u+a,c+s,n,o)},i}(e.RenderNode);e.BitmapNode=i,__reflect(i.prototype,"egret.sys.BitmapNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=["none","round","square"],r=["bevel","miter","round"],n=function(n){function o(){var t=n.call(this)||this;return t.dirtyRender=!0,t.type=3,t}return __extends(o,n),o.prototype.beginFill=function(t,i,r){void 0===i&&(i=1);var n=new e.FillPath;if(n.fillColor=t,n.fillAlpha=i,r){var o=this.drawData.lastIndexOf(r);this.drawData.splice(o,0,n)}else this.drawData.push(n);return n},o.prototype.beginGradientFill=function(i,r,n,o,a,s){var l=new t.Matrix;a?(l.a=819.2*a.a,l.b=819.2*a.b,l.c=819.2*a.c,l.d=819.2*a.d,l.tx=a.tx,l.ty=a.ty):(l.a=100,l.d=100);var h=new e.GradientFillPath;if(h.gradientType=i,h.colors=r,h.alphas=n,h.ratios=o,h.matrix=l,s){var u=this.drawData.lastIndexOf(s);this.drawData.splice(u,0,h)}else this.drawData.push(h);return h},o.prototype.lineStyle=function(n,o,a,s,l,h){void 0===a&&(a=1),void 0===h&&(h=3),-1==i.indexOf(s)&&(s="round"),-1==r.indexOf(l)&&(l="round");var u=new e.StrokePath;return u.lineWidth=n,u.lineColor=o,u.lineAlpha=a,u.caps=s||t.CapsStyle.ROUND,u.joints=l,u.miterLimit=h,this.drawData.push(u),u},o.prototype.clear=function(){this.drawData.length=0,this.dirtyRender=!0},o.prototype.cleanBeforeRender=function(){},o.prototype.clean=function(){this.$texture&&(t.WebGLUtils.deleteWebGLTexture(this.$texture),this.$texture=null,this.dirtyRender=!0)},o}(e.RenderNode);e.GraphicsNode=n,__reflect(n.prototype,"egret.sys.GraphicsNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=4,e}return __extends(e,t),e.prototype.addNode=function(t){this.drawData.push(t)},e.prototype.cleanBeforeRender=function(){for(var t=this.drawData,e=t.length-1;e>=0;e--)t[e].cleanBeforeRender()},e.prototype.$getRenderCount=function(){for(var t=0,e=this.drawData,i=e.length-1;i>=0;i--)t+=e[i].$getRenderCount();return t},e}(t.RenderNode);t.GroupNode=e,__reflect(e.prototype,"egret.sys.GroupNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(){var i=e.call(this)||this;return i.image=null,i.smoothing=!0,i.bounds=new t.Rectangle,i.type=7,i.vertices=[],i.uvs=[],i.indices=[],i}return __extends(i,e),i.prototype.drawMesh=function(t,e,i,r,n,o,a,s){this.drawData.push(t,e,i,r,n,o,a,s),this.renderCount++},i.prototype.cleanBeforeRender=function(){e.prototype.cleanBeforeRender.call(this),this.image=null,this.matrix=null},i}(e.RenderNode);e.MeshNode=i,__reflect(i.prototype,"egret.sys.MeshNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var i=e.call(this)||this;i.$renderBuffer=new t.sys.RenderBuffer;var r=new t.BitmapData(i.$renderBuffer.surface);return r.$deleteSource=!1,i._setBitmapData(r),i}return __extends(i,e),i.prototype.drawToTexture=function(e,i,r){if(void 0===r&&(r=1),i&&(0==i.width||0==i.height))return!1;var n=i||e.$getOriginalBounds();if(0==n.width||0==n.height)return!1;r/=t.$TextureScaleFactor;var o=(n.x+n.width)*r,a=(n.y+n.height)*r;i&&(o=n.width*r,a=n.height*r);var s=this.$renderBuffer;if(!s)return!1;s.resize(o,a),this._bitmapData.width=o,this._bitmapData.height=a;var l=t.Matrix.create();return l.identity(),i&&l.translate(-i.x,-i.y),l.scale(r,r),t.sys.systemRenderer.render(e,s,l,null,!0),t.Matrix.release(l),this.$initData(0,0,o,a,0,0,o,a,o,a),!0},i.prototype.getPixel32=function(e,i){var r;if(this.$renderBuffer){var n=t.$TextureScaleFactor;e=Math.round(e/n),i=Math.round(i/n),r=this.$renderBuffer.getPixels(e,i,1,1)}return r},i.prototype.dispose=function(){e.prototype.dispose.call(this),this.$renderBuffer=null},i}(t.Texture);t.RenderTexture=e,__reflect(e.prototype,"egret.RenderTexture")}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=6,e}return __extends(e,t),e.prototype.setAlpha=function(t){0!=this.drawData.length&&(this.drawData.length=0),this.drawData.push(t),this.renderCount++},e}(t.RenderNode);t.SetAlphaNode=e,__reflect(e.prototype,"egret.sys.SetAlphaNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(){var t=e.call(this)||this;return t.textColor=16777215,t.strokeColor=0,t.size=30,t.stroke=0,t.bold=!1,t.italic=!1,t.fontFamily="Arial",t.dirtyRender=!0,t.type=2,t}return __extends(i,e),i.prototype.drawText=function(t,e,i,r){this.drawData.push(t,e,i,r),this.renderCount++,this.dirtyRender=!0},i.prototype.cleanBeforeRender=function(){e.prototype.cleanBeforeRender.call(this)},i.prototype.clean=function(){this.$texture&&(t.WebGLUtils.deleteWebGLTexture(this.$texture),this.$texture=null,this.dirtyRender=!0)},i}(e.RenderNode);e.TextNode=i,__reflect(i.prototype,"egret.sys.TextNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=1,e}return __extends(e,t),e}(t.Path2D);t.FillPath=e,__reflect(e.prototype,"egret.sys.FillPath")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=2,e}return __extends(e,t),e}(t.Path2D);t.GradientFillPath=e,__reflect(e.prototype,"egret.sys.GradientFillPath")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.$graphics=new t.Graphics,i.$graphics.$setTarget(i),i}return __extends(i,e),Object.defineProperty(i.prototype,"graphics",{get:function(){return this.$graphics},enumerable:!0,configurable:!0}),i.prototype.$measureContentBounds=function(t){this.$graphics.$measureContentBounds(t)},i.prototype.$hitTest=function(t,i){var r=e.prototype.$hitTest.call(this,t,i);return r==this&&(r=this.$graphics.$hitTest(t,i)),r},i.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this),this.$graphics&&this.$graphics.$onRemoveFromStage()},i}(t.DisplayObject);t.Shape=e,__reflect(e.prototype,"egret.Shape"),t.$markReadOnly(e,"graphics")}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=3,e}return __extends(e,t),e}(t.Path2D);t.StrokePath=e,__reflect(e.prototype,"egret.sys.StrokePath")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){function e(t,e){var i=null==e.italic?t.italic:e.italic,r=null==e.bold?t.bold:e.bold,n=null==e.size?t.size:e.size,o=e.fontFamily||t.fontFamily,a=i?"italic ":"normal ";return a+=r?"bold ":"normal ",a+=n+"px "+o}function i(t,e){var i=t>>16,r=t>>8&255,n=255&t;return"rgba("+i+","+r+","+n+","+e+")"}function r(e,r,n,o,a){var s;s=r==t.GradientType.LINEAR?e.createLinearGradient(-1,0,1,0):e.createRadialGradient(0,0,0,0,0,1);for(var l=n.length,h=0;l>h;h++)s.addColorStop(a[h]/255,i(n[h],o[h]));return s}function n(t,e,i){void 0===i&&(i=0);for(var r=0,n=e.length;n>r;r++)t[r+i]=e[r]}function o(t,e,i,r){for(var n=r[0],o=r[1],a=r[2],s=r[3],l=r[4],h=r[5],u=r[6],c=r[7],p=r[8],d=r[9],f=r[10],g=r[11],y=r[12],v=r[13],m=r[14],_=r[15],b=r[16],T=r[17],x=r[18],E=r[19],$=0,S=e*i*4;S>$;$+=4){var C=t[$+0],w=t[$+1],O=t[$+2],P=t[$+3];t[$+0]=n*C+o*w+a*O+s*P+l,t[$+1]=h*C+u*w+c*O+p*P+d,t[$+2]=f*C+g*w+y*O+v*P+m,t[$+3]=_*C+b*w+T*O+x*P+E}}function a(t,e,i,r,n){s(t,e,i,r),l(t,e,i,n)}function s(t,e,i,r){var o;o=x?new Uint8ClampedArray(4*e):new Array(4*e);for(var a=4*e,s=2*r+1,l=0;i>l;l++){for(var h=l*a,u=0,c=0,p=0,d=0,f=0,g=0,y=4*-r,v=4*r+4;v>y;y+=4){var m=h+y;h>m||m>=h+a||(f=t[m+3],u+=t[m+0]*f,c+=t[m+1]*f,p+=t[m+2]*f,d+=f)}for(var y=h,v=h+a,_=0,b=y-4*r,T=y+4*(r+1);v>y;y+=4,_+=4,T+=4,b+=4)0===d?(o[_+0]=0,o[_+1]=0,o[_+2]=0,o[_+3]=0):(o[_+0]=u/d,o[_+1]=c/d,o[_+2]=p/d,o[_+3]=d/s),f=t[T+3],g=t[b+3],f||0==f?g||0==g?(u+=t[T+0]*f-t[b+0]*g,c+=t[T+1]*f-t[b+1]*g,p+=t[T+2]*f-t[b+2]*g,d+=f-g):(u+=t[T+0]*f,c+=t[T+1]*f,p+=t[T+2]*f,d+=f):(g||0==g)&&(u+=-t[b+0]*g,c+=-t[b+1]*g,p+=-t[b+2]*g,d+=-g);x?t.set(o,h):n(t,o,h)}}function l(t,e,i,r){var n;n=x?new Uint8ClampedArray(4*i):new Array(4*i);for(var o=4*e,a=2*r+1,s=0;e>s;s++){for(var l=4*s,h=0,u=0,c=0,p=0,d=0,f=0,g=-r*o,y=r*o+o;y>g;g+=o){var v=l+g;l>v||v>=l+i*o||(d=t[v+3],h+=t[v+0]*d,u+=t[v+1]*d,c+=t[v+2]*d,p+=d)}for(var g=l,y=l+i*o,m=0,_=l-r*o,b=l+(r+1)*o;y>g;g+=o,m+=4,b+=o,_+=o)0===p?(n[m+0]=0,n[m+1]=0,n[m+2]=0,n[m+3]=0):(n[m+0]=h/p,n[m+1]=u/p,n[m+2]=c/p,n[m+3]=p/a),d=t[b+3],f=t[_+3],d||0==d?f||0==f?(h+=t[b+0]*d-t[_+0]*f,u+=t[b+1]*d-t[_+1]*f,c+=t[b+2]*d-t[_+2]*f,p+=d-f):(h+=t[b+0]*d,u+=t[b+1]*d,c+=t[b+2]*d,p+=d):(f||0==f)&&(h+=-t[_+0]*f,u+=-t[_+1]*f,c+=-t[_+2]*f,p+=-f);for(var T=4*s,y=T+i*o,E=0;y>T;T+=o,E+=4)t[T+0]=n[E+0],t[T+1]=n[E+1],t[T+2]=n[E+2],t[T+3]=n[E+3]}}function h(t,e,i,r,o,s,l,h,f){var g=u(t,r);c(g,e,i,l,h),a(g,e,i,o,s),p(g,f),d(g,t),t.set(g),x?t.set(g):n(t,g)}function u(t,e){e||(e=[0,0,0,0]);var i;x?i=new Uint8ClampedArray(t):(i=new Array(t.length),n(i,t));for(var r=0,o=i.length;o>r;r+=4){var a=i[r+3];i[r+0]=e[0]*a,i[r+1]=e[1]*a,i[r+2]=e[2]*a}return i}function c(t,e,i,r,o){var a,s,l=Math.sin(r)*o|0,h=Math.cos(r)*o|0;if(x){a=new Int32Array(t.buffer),s=new Int32Array(a.length);for(var u=0;i>u;u++){var c=u+l;if(!(0>c||c>i))for(var p=0;e>p;p++){var d=p+h;0>d||d>e||(s[c*e+d]=a[u*e+p])}}a.set(s)}else{a=t,s=new Array(a.length);for(var u=0;i>u;u++){var c=u+l;if(!(0>c||c>i))for(var p=0;e>p;p++){var d=p+h;0>d||d>e||(s[4*(c*e+d)+0]=a[4*(u*e+p)+0],s[4*(c*e+d)+1]=a[4*(u*e+p)+1],s[4*(c*e+d)+2]=a[4*(u*e+p)+2],s[4*(c*e+d)+3]=a[4*(u*e+p)+3])}}n(a,s)}}function p(t,e){for(var i=0,r=t.length;r>i;i+=4)t[i+3]*=e}function d(t,e){for(var i=0,r=t.length;r>i;i+=4){var n=t[i+0],o=t[i+1],a=t[i+2],s=t[i+3]/255,l=e[i+0],h=e[i+1],u=e[i+2],c=e[i+3]/255;t[i+0]=l+n*(1-c),t[i+1]=h+o*(1-c),t[i+2]=u+a*(1-c),t[i+3]=255*(c+s*(1-c))}}function f(t,e,i){return t*(1-i)+e*i}function g(t,e,i,r,o,a,s,l,h,u,c,p){var d;d=x?new Uint8ClampedArray(t.length):new Array(t.length);for(var g,y,v=r[3],m=0,_=0,b=l*Math.cos(s),T=l*Math.sin(s),E=7,$=12,S=3.141592653589793,C=o/E,w=a/E,O=0;e>O;O++)for(var P=0;i>P;P++){for(var D=0,L=P*e*4+4*O,R=0,I=0,M=t[L+0]/255,A=t[L+1]/255,B=t[L+2]/255,N=t[L+3]/255,F=0;2*S>=F;F+=2*S/$){g=Math.cos(F+D),y=Math.sin(F+D);for(var k=0;E>k;k++){m=k*C*g,_=k*w*y;var j=Math.round(O+m-b),U=Math.round(P+_-T),H=0;if(j>=e||0>j||0>U||U>=i)H=0;else{var V=U*e*4+4*j;H=t[V+3]/255}R+=(E-k)*H,I+=E-k}}N=Math.max(N,1e-4);var X=R/I*h*v*(1-u)*Math.max(Math.min(p,c),1-N),G=(I-R)/I*h*v*u*N;N=Math.max(N*c*(1-p),1e-4);var z=G/(G+N),W=f(M,r[0],z),Y=f(A,r[1],z),q=f(B,r[2],z),K=X/(G+N+X),Q=f(W,r[0],K),Z=f(Y,r[1],K),J=f(q,r[2],K),te=Math.min(N+X+G,1);d[L+0]=255*Q,d[L+1]=255*Z,d[L+2]=255*J,d[L+3]=255*te}x?t.set(d):n(t,d)}var y=["source-over","lighter","destination-out"],v="source-over",m="#000000",_={none:"butt",square:"square",round:"round"},b=[],T=function(){function n(){this.nestLevel=0,this.renderingMask=!1}return n.prototype.render=function(t,e,i,r,n){this.nestLevel++;var o=e.context,a=n?t:null,s=this.drawDisplayObject(t,o,r,i,null,null,a);if(this.nestLevel--,0===this.nestLevel){b.length>6&&(b.length=6);for(var l=b.length,h=0;l>h;h++)b[h].resize(0,0)}return s},n.prototype.drawDisplayObject=function(e,i,r,n,o,a,s){var l,h=0;if(o&&!s?(o.isDirty&&(h+=o.drawToSurface()),l=o.$renderNode):l=e.$getRenderNode(),l){if(r){var u=l.renderRegion;if(a&&!a.intersects(u))l.needRedraw=!1;else if(!l.needRedraw)for(var c=r.length,p=0;c>p;p++)if(u.intersects(r[p])){l.needRedraw=!0;break}}else l.needRedraw=!0;if(l.needRedraw){var d=void 0,f=void 0;s?(d=e.$getConcatenatedAlphaAt(s,e.$getConcatenatedAlpha()),f=t.Matrix.create().copyFrom(e.$getConcatenatedMatrix()),e.$getConcatenatedMatrixAt(s,f),n.$preMultiplyInto(f,f),i.setTransform(f.a,f.b,f.c,f.d,f.tx,f.ty),t.Matrix.release(f)):(d=l.renderAlpha,f=l.renderMatrix,i.setTransform(f.a,f.b,f.c,f.d,f.tx+n.tx,f.ty+n.ty)),i.globalAlpha=d,h+=this.renderNode(l,i),l.needRedraw=!1}}if(o&&!s)return h;var g=e.$children;if(g)for(var y=g.length,v=0;y>v;v++){var m=g[v];if(!(!m.$visible||m.$alpha<=0||m.$maskedObject)){var _=m.$getFilters();_&&_.length>0?h+=this.drawWithFilter(m,i,r,n,a,s):0!==m.$blendMode||m.$mask&&(m.$mask.$parentDisplayList||s)?h+=this.drawWithClip(m,i,r,n,a,s):m.$scrollRect||m.$maskRect?h+=this.drawWithScrollRect(m,i,r,n,a,s):m.isFPS?this.drawDisplayObject(m,i,r,n,m.$displayList,a,s):h+=this.drawDisplayObject(m,i,r,n,m.$displayList,a,s)}}return h},n.prototype.drawWithFilter=function(e,i,r,n,s,l){if(t.Capabilities.runtimeType==t.RuntimeType.NATIVE){var u,c=0,p=e.$getFilters(),d=0!==e.$blendMode;if(d&&(u=y[e.$blendMode],u||(u=v)),1==p.length&&"colorTransform"==p[0].type&&!e.$children)return d&&(i.globalCompositeOperation=u),i.setGlobalShader(p[0]),c+=e.$mask&&(e.$mask.$parentDisplayList||l)?this.drawWithClip(e,i,r,n,s,l):e.$scrollRect||e.$maskRect?this.drawWithScrollRect(e,i,r,n,s,l):this.drawDisplayObject(e,i,r,n,e.$displayList,s,l),i.setGlobalShader(null),d&&(i.globalCompositeOperation=v),c;var f=t.Matrix.create();f.copyFrom(e.$getConcatenatedMatrix()),l&&e.$getConcatenatedMatrixAt(l,f);var m;m=t.sys.Region.create();var _=e.$getOriginalBounds();m.updateRegion(_,f);var T=this.createRenderBuffer(m.width,m.height);T.context.setTransform(1,0,0,1,-m.minX,-m.minY);var x=t.Matrix.create().setTo(1,0,0,1,-m.minX,-m.minY);return c+=e.$mask&&(e.$mask.$parentDisplayList||l)?this.drawWithClip(e,T.context,r,x,m,l):e.$scrollRect||e.$maskRect?this.drawWithScrollRect(e,T.context,r,x,m,l):this.drawDisplayObject(e,T.context,r,x,e.$displayList,m,l),t.Matrix.release(x),c>0&&(d&&(i.globalCompositeOperation=u),c++,i.globalAlpha=1,i.setTransform(1,0,0,1,m.minX+n.tx,m.minY+n.ty),i.setGlobalShader(p[0]),i.drawImage(T.surface,0,0,T.width,T.height,0,0,T.width,T.height),i.setGlobalShader(null),d&&(i.globalCompositeOperation=v)),b.push(T),t.sys.Region.release(m),t.Matrix.release(f),c}var E,$=0,S=e.$getFilters(),C=S.length,w=0!==e.$blendMode;w&&(E=y[e.$blendMode],E||(E=v));var O=t.Matrix.create();O.copyFrom(e.$getConcatenatedMatrix()),l&&e.$getConcatenatedMatrixAt(l,O);var P;P=t.sys.Region.create();var D=e.$getOriginalBounds();P.updateRegion(D,O);var L=this.createRenderBuffer(P.width,P.height),R=L.context;R.setTransform(1,0,0,1,-P.minX,-P.minY);var I=t.Matrix.create().setTo(1,0,0,1,-P.minX,-P.minY);if($+=e.$mask&&(e.$mask.$parentDisplayList||l)?this.drawWithClip(e,R,r,I,P,l):e.$scrollRect||e.$maskRect?this.drawWithScrollRect(e,R,r,I,P,l):this.drawDisplayObject(e,R,r,I,e.$displayList,P,l),t.Matrix.release(I),$>0){w&&(i.globalCompositeOperation=E),$++,i.globalAlpha=1,i.setTransform(1,0,0,1,P.minX+n.tx,P.minY+n.ty);for(var M=R.getImageData(0,0,L.surface.width,L.surface.height),A=0;C>A;A++){var B=S[A];if("colorTransform"==B.type)o(M.data,L.surface.width,L.surface.height,B.$matrix);else if("blur"==B.type)a(M.data,L.surface.width,L.surface.height,B.$blurX,B.$blurY);else if("glow"==B.type){var N=B.$red,F=B.$green,k=B.$blue,j=B.$alpha;B.$inner||B.$knockout||B.$hideObject?g(M.data,L.surface.width,L.surface.height,[N/255,F/255,k/255,j],B.$blurX,B.$blurY,B.$angle?B.$angle/180*Math.PI:0,B.$distance||0,B.$strength,B.$inner?1:0,B.$knockout?0:1,B.$hideObject?1:0):h(M.data,L.surface.width,L.surface.height,[N/255,F/255,k/255,j/255],B.$blurX,B.$blurY,B.$angle?B.$angle/180*Math.PI:0,B.$distance||0,B.$strength)}}R.putImageData(M,0,0),i.drawImage(L.surface,0,0),w&&(i.globalCompositeOperation=v)}return b.push(L),t.sys.Region.release(P),t.Matrix.release(O),$},n.prototype.drawWithClip=function(e,i,r,n,o,a){var s,l=0,h=0!==e.$blendMode;h&&(s=y[e.$blendMode],s||(s=v));var u,c=e.$scrollRect?e.$scrollRect:e.$maskRect,p=e.$mask;if(p&&(u=p.$getRenderNode())){var d=u.renderMatrix;if(0==d.a&&0==d.b||0==d.c&&0==d.d)return l}var f,g=t.Matrix.create();if(g.copyFrom(e.$getConcatenatedMatrix()),e.$parentDisplayList){var m=e.$parentDisplayList.root;m!==e.$stage&&e.$getConcatenatedMatrixAt(m,g)}var _;if(p){_=p.$getOriginalBounds(),f=t.sys.Region.create();var T=t.Matrix.create();T.copyFrom(p.$getConcatenatedMatrix()),f.updateRegion(_,T),t.Matrix.release(T)}var x;if(c&&(x=t.sys.Region.create(),x.updateRegion(c,g)),x&&f?(x.intersect(f),t.sys.Region.release(f)):!x&&f&&(x=f),x){if(x.isEmpty()||o&&!o.intersects(x))return t.sys.Region.release(x),t.Matrix.release(g),l}else x=t.sys.Region.create(),_=e.$getOriginalBounds(),x.updateRegion(_,g);var E=!1;if(r){for(var $=r.length,S=0;$>S;S++)if(x.intersects(r[S])){E=!0;break}}else E=!0;if(!E)return t.sys.Region.release(x),t.Matrix.release(g),l;if(!(p||e.$children&&0!=e.$children.length)){if(c){var T=g;i.save(),i.setTransform(T.a,T.b,T.c,T.d,T.tx-x.minX,T.ty-x.minY),i.beginPath(),i.rect(c.x,c.y,c.width,c.height),i.clip()}return h&&(i.globalCompositeOperation=s),l+=this.drawDisplayObject(e,i,r,n,e.$displayList,o,a),h&&(i.globalCompositeOperation=v),c&&i.restore(),l}if(p&&t.Capabilities.$runtimeType==t.RuntimeType.WEB&&(!p.$children||0==p.$children.length)&&u&&3==u.type&&1==u.drawData.length&&1==u.drawData[0].type&&1==u.drawData[0].fillAlpha){this.renderingMask=!0,i.save();var C=this.drawDisplayObject(p,i,r,n,p.$displayList,o,a);if(this.renderingMask=!1,c){var T=g;i.setTransform(T.a,T.b,T.c,T.d,T.tx-x.minX,T.ty-x.minY),i.beginPath(),i.rect(c.x,c.y,c.width,c.height),i.clip()}return C+=this.drawDisplayObject(e,i,r,n,e.$displayList,o,a),i.restore(),C}var w=this.createRenderBuffer(x.width,x.height),O=w.context;if(!O)return l+=this.drawDisplayObject(e,i,r,n,e.$displayList,o,a),t.sys.Region.release(x),t.Matrix.release(g),l;O.setTransform(1,0,0,1,-x.minX,-x.minY);var P=t.Matrix.create().setTo(1,0,0,1,-x.minX,-x.minY);if(l+=this.drawDisplayObject(e,O,r,P,e.$displayList,x,a),p)if(t.Capabilities.$runtimeType==t.RuntimeType.WEB&&u&&1==u.$getRenderCount()||p.$displayList)O.globalCompositeOperation="destination-in",l+=this.drawDisplayObject(p,O,r,P,p.$displayList,x,a);
else{var D=this.createRenderBuffer(x.width,x.height),L=D.context;if(!L)return l+=this.drawDisplayObject(e,i,r,n,e.$displayList,o,a),b.push(w),t.sys.Region.release(x),t.Matrix.release(g),l;L.setTransform(1,0,0,1,-x.minX,-x.minY),P=t.Matrix.create().setTo(1,0,0,1,-x.minX,-x.minY),l+=this.drawDisplayObject(p,L,r,P,p.$displayList,x,a),O.globalCompositeOperation="destination-in",O.setTransform(1,0,0,1,0,0),O.globalAlpha=1,O.drawImage(D.surface,0,0),b.push(D)}if(t.Matrix.release(P),l>0){if(l++,h&&(i.globalCompositeOperation=s),c){var T=g;i.save(),i.setTransform(T.a,T.b,T.c,T.d,T.tx-x.minX,T.ty-x.minY),i.beginPath(),i.rect(c.x,c.y,c.width,c.height),i.clip()}i.globalAlpha=1,i.setTransform(1,0,0,1,x.minX+n.tx,x.minY+n.ty),i.drawImage(w.surface,0,0),c&&i.restore(),h&&(i.globalCompositeOperation=v)}return b.push(w),t.sys.Region.release(x),t.Matrix.release(g),l},n.prototype.drawWithScrollRect=function(e,i,r,n,o,a){var s=0,l=e.$scrollRect?e.$scrollRect:e.$maskRect;if(l.isEmpty())return s;var h=t.Matrix.create();if(h.copyFrom(e.$getConcatenatedMatrix()),a)e.$getConcatenatedMatrixAt(a,h);else if(e.$parentDisplayList){var u=e.$parentDisplayList.root;u!==e.$stage&&e.$getConcatenatedMatrixAt(u,h)}var c=t.sys.Region.create();if(c.updateRegion(l,h),c.isEmpty()||o&&!o.intersects(c))return t.sys.Region.release(c),t.Matrix.release(h),s;var p=!1;if(r){for(var d=r.length,f=0;d>f;f++)if(c.intersects(r[f])){p=!0;break}}else p=!0;return p?(i.save(),i.setTransform(h.a,h.b,h.c,h.d,h.tx+n.tx,h.ty+n.ty),i.beginPath(),i.rect(l.x,l.y,l.width,l.height),i.clip(),s+=this.drawDisplayObject(e,i,r,n,e.$displayList,c,a),i.restore(),t.sys.Region.release(c),t.Matrix.release(h),s):(t.sys.Region.release(c),t.Matrix.release(h),s)},n.prototype.drawNodeToBuffer=function(t,e,i,r){var n=e.context;n.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty),this.renderNode(t,n,r)},n.prototype.renderNode=function(t,e,i){var r=0;switch(t.type){case 1:r=this.renderBitmap(t,e);break;case 2:r=1,this.renderText(t,e);break;case 3:r=this.renderGraphics(t,e,i);break;case 4:r=this.renderGroup(t,e);break;case 6:e.globalAlpha=t.drawData[0];break;case 7:r=this.renderMesh(t,e)}return r},n.prototype.renderMesh=function(e,i){if(t.Capabilities.runtimeType!=t.RuntimeType.NATIVE)return 0;var r=e.image,n=e.drawData,o=n.length,a=0,s=e.matrix;for(s&&(i.saveTransform(),i.transform(s.a,s.b,s.c,s.d,s.tx,s.ty));o>a;)i.drawMesh(r.source,n[a++],n[a++],n[a++],n[a++],n[a++],n[a++],n[a++],n[a++],e.imageWidth,e.imageHeight,e.uvs,e.vertices,e.indices,e.bounds);return s&&i.restoreTransform(),1},n.prototype.renderBitmap=function(e,i){var r=e.image;if(!r||!r.source)return 0;i.$imageSmoothingEnabled!=e.smoothing&&(i.imageSmoothingEnabled=e.smoothing,i.$imageSmoothingEnabled=e.smoothing);var n=e.drawData,a=n.length,s=0,l=e.matrix,h=e.blendMode,u=e.alpha,c=!1;l&&(i.saveTransform?i.saveTransform():i.save(),c=!0,i.transform(l.a,l.b,l.c,l.d,l.tx,l.ty)),h&&(i.globalCompositeOperation=y[h]);var p;u==u&&(p=i.globalAlpha,i.globalAlpha*=u);var d=0,f=e.filter;if(f&&8==a)if(t.Capabilities.runtimeType==t.RuntimeType.NATIVE){for(egret_native.Graphics.setGlobalShader(f);a>s;)d++,i.drawImage(r.source,n[s++],n[s++],n[s++],n[s++],n[s++],n[s++],n[s++],n[s++]);egret_native.Graphics.setGlobalShader(null)}else{var g=this.createRenderBuffer(n[6],n[7]),m=g.context;d++,m.drawImage(r.source,n[0],n[1],n[2],n[3],0,0,n[6],n[7]),d++;var _=m.getImageData(0,0,g.surface.width,g.surface.height);o(_.data,g.surface.width,g.surface.height,f.$matrix),m.putImageData(_,0,0),i.drawImage(g.surface,0,0,n[6],n[7],n[4],n[5],n[6],n[7]),b.push(g)}else for(;a>s;)d++,i.drawImage(r.source,n[s++],n[s++],n[s++],n[s++],n[s++],n[s++],n[s++],n[s++]);return c?i.restoreTransform?(i.restoreTransform(),h&&(i.globalCompositeOperation=v),u==u&&(i.globalAlpha=p)):i.restore():(h&&(i.globalCompositeOperation=v),u==u&&(i.globalAlpha=p)),d},n.prototype.renderText=function(i,r){r.textAlign="left",r.textBaseline="middle",r.lineJoin="round";for(var n=i.drawData,o=n.length,a=0;o>a;){var s=n[a++],l=n[a++],h=n[a++],u=n[a++];r.font=e(i,u);var c=null==u.textColor?i.textColor:u.textColor,p=null==u.strokeColor?i.strokeColor:u.strokeColor,d=null==u.stroke?i.stroke:u.stroke;r.fillStyle=t.toColorString(c),r.strokeStyle=t.toColorString(p),d&&(r.lineWidth=2*d,r.strokeText(h,s,l)),r.fillText(h,s,l)}},n.prototype.renderGraphics=function(t,e,n){var o=t.drawData,a=o.length;n=!!n;for(var s=0;a>s;s++){var l=o[s];switch(l.type){case 1:var h=l;e.fillStyle=n?m:i(h.fillColor,h.fillAlpha),this.renderPath(l,e),this.renderingMask?e.clip():e.fill();break;case 2:var u=l;e.fillStyle=n?m:r(e,u.gradientType,u.colors,u.alphas,u.ratios,u.matrix),e.save();var c=u.matrix;this.renderPath(l,e),e.transform(c.a,c.b,c.c,c.d,c.tx,c.ty),e.fill(),e.restore();break;case 3:var p=l,d=p.lineWidth;e.lineWidth=d,e.strokeStyle=n?m:i(p.lineColor,p.lineAlpha),e.lineCap=_[p.caps],e.lineJoin=p.joints,e.miterLimit=p.miterLimit;var f=1===d||3===d;f&&e.translate(.5,.5),this.renderPath(l,e),e.stroke(),f&&e.translate(-.5,-.5)}}return 0==a?0:1},n.prototype.renderPath=function(t,e){e.beginPath();for(var i=t.$data,r=t.$commands,n=r.length,o=0,a=0;n>a;a++){var s=r[a];switch(s){case 4:e.bezierCurveTo(i[o++],i[o++],i[o++],i[o++],i[o++],i[o++]);break;case 3:e.quadraticCurveTo(i[o++],i[o++],i[o++],i[o++]);break;case 2:e.lineTo(i[o++],i[o++]);break;case 1:e.moveTo(i[o++],i[o++])}}},n.prototype.renderGroup=function(t,e){for(var i=0,r=t.drawData,n=r.length,o=0;n>o;o++){var a=r[o];i+=this.renderNode(a,e)}return i},n.prototype.createRenderBuffer=function(e,i){var r=b.pop();return r?r.resize(e,i,!0):r=new t.sys.CanvasRenderBuffer(e,i),r},n}();t.CanvasRenderer=T,__reflect(T.prototype,"egret.CanvasRenderer",["egret.sys.SystemRenderer"]);var x=!1;try{x=void 0!==typeof Uint8ClampedArray}catch(E){}}(egret||(egret={}));var egret;!function(t){t.DeviceOrientation=null}(egret||(egret={}));var egret;!function(){}(egret||(egret={}));var egret;!function(){}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t}();e.WEB="web",e.NATIVE="native",t.RuntimeType=e,__reflect(e.prototype,"egret.RuntimeType");var i=function(){function t(){}return Object.defineProperty(t,"language",{get:function(){return t.$language},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isMobile",{get:function(){return t.$isMobile},enumerable:!0,configurable:!0}),Object.defineProperty(t,"os",{get:function(){return t.$os},enumerable:!0,configurable:!0}),Object.defineProperty(t,"runtimeType",{get:function(){return t.$runtimeType},enumerable:!0,configurable:!0}),Object.defineProperty(t,"supportVersion",{get:function(){return t.$supportVersion},enumerable:!0,configurable:!0}),Object.defineProperty(t,"engineVersion",{get:function(){return"3.2.6"},enumerable:!0,configurable:!0}),t.$setNativeCapabilities=function(e){var i=e.split("-");if(i.length<=4){var r=i[0];switch(r){case"android":r="Android";break;case"ios":r="iOS"}t.$os=r;var n=i[2].substring(1,i[2].length);t.$supportVersion=n}},Object.defineProperty(t,"renderMode",{get:function(){return t.$renderMode},enumerable:!0,configurable:!0}),Object.defineProperty(t,"boundingClientWidth",{get:function(){return t.$boundingClientWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t,"boundingClientHeight",{get:function(){return t.$boundingClientHeight},enumerable:!0,configurable:!0}),t}();i.$language="zh-CN",i.$os="Unknown",i.$runtimeType="Unknown",i.$supportVersion="Unknown",i.$renderMode="Unknown",i.$boundingClientWidth=0,i.$boundingClientHeight=0,t.Capabilities=i,__reflect(i.prototype,"egret.Capabilities"),t.$markReadOnly(i,"language",!1),t.$markReadOnly(i,"isMobile",!1),t.$markReadOnly(i,"os",!1),t.$markReadOnly(i,"runtimeType",!1),t.$markReadOnly(i,"supportVersion",!1),t.$markReadOnly(i,"renderMode",!1),t.$markReadOnly(i,"boundingClientWidth",!1),t.$markReadOnly(i,"boundingClientHeight",!1)}(egret||(egret={}));var testDeviceType=function(){if(!this.navigator)return!0;var t=navigator.userAgent.toLowerCase();return-1!=t.indexOf("mobile")||-1!=t.indexOf("android")},testRuntimeType=function(){return this.navigator?!0:!1};egret.Capabilities.$isMobile=testDeviceType(),egret.Capabilities.$runtimeType=testRuntimeType()?egret.RuntimeType.WEB:egret.RuntimeType.NATIVE;var egret;!function(t){t.BitmapFillMode={REPEAT:"repeat",SCALE:"scale",CLIP:"clip"}}(egret||(egret={}));var egret;!function(t){function e(t,e){r[t]=e}function i(t){return r[t]}var r={};t.registerImplementation=e,t.getImplementation=i}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,i){var r=t.call(this,e)||this;return r.firstCharHeight=0,r.charList="string"==typeof i?r.parseConfig(i):i&&i.hasOwnProperty("frames")?i.frames:{},r}return __extends(e,t),e.prototype.getTexture=function(t){var e=this._textureMap[t];if(!e){var i=this.charList[t];if(!i)return null;e=this.createTexture(t,i.x,i.y,i.w,i.h,i.offX,i.offY,i.sourceW,i.sourceH),this._textureMap[t]=e}return e},e.prototype.getConfig=function(t,e){return this.charList[t]?this.charList[t][e]:0},e.prototype._getFirstCharHeight=function(){if(0==this.firstCharHeight)for(var t in this.charList){var e=this.charList[t];if(e){var i=e.sourceH;if(void 0===i){var r=e.h;void 0===r&&(r=0);var n=e.offY;void 0===n&&(n=0),i=r+n}if(0>=i)continue;this.firstCharHeight=i;break}}return this.firstCharHeight},e.prototype.parseConfig=function(t){t=t.split("\r\n").join("\n");for(var e=t.split("\n"),i=this.getConfigByKey(e[3],"count"),r={},n=4;4+i>n;n++){var o=e[n],a=String.fromCharCode(this.getConfigByKey(o,"id")),s={};r[a]=s,s.x=this.getConfigByKey(o,"x"),s.y=this.getConfigByKey(o,"y"),s.w=this.getConfigByKey(o,"width"),s.h=this.getConfigByKey(o,"height"),s.offX=this.getConfigByKey(o,"xoffset"),s.offY=this.getConfigByKey(o,"yoffset"),s.xadvance=this.getConfigByKey(o,"xadvance")}return r},e.prototype.getConfigByKey=function(t,e){for(var i=t.split(" "),r=0,n=i.length;n>r;r++){var o=i[r];if(e==o.substring(0,e.length)){var a=o.substring(e.length+1);return parseInt(a)}}return 0},e}(t.SpriteSheet);t.BitmapFont=e,__reflect(e.prototype,"egret.BitmapFont")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.$textOffsetX=0,i.$textOffsetY=0,i.$textStartX=0,i.$textStartY=0,i.$lineHeights=[],i.$renderNode=new t.sys.BitmapNode,i.$BitmapText={0:0/0,1:0/0,2:"",3:0,4:0,5:null,6:!1,7:!1,8:!1,9:!1,10:"left",11:"top",12:t.Bitmap.defaultSmoothing},i}return __extends(i,e),Object.defineProperty(i.prototype,"smoothing",{get:function(){var t=this.$BitmapText;return t[12]},set:function(t){t=!!t;var e=this.$BitmapText;t!=e[12]&&(e[12]=t,this.$invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"text",{get:function(){return this.$BitmapText[2]},set:function(t){this.$setText(t)},enumerable:!0,configurable:!0}),i.prototype.$setText=function(t){null==t&&(t=""),t=String(t);var e=this.$BitmapText;return t==e[2]?!1:(e[2]=t,this.$invalidateContentBounds(),!0)},i.prototype.$getWidth=function(){var t=this.$BitmapText[0];return isNaN(t)?this.$getContentBounds().width:t},i.prototype.$setWidth=function(t){var e=this.$BitmapText;return 0>t||t==e[0]?!1:(e[0]=t,this.$invalidateContentBounds(),!0)},i.prototype.$invalidateContentBounds=function(){e.prototype.$invalidateContentBounds.call(this),this.$BitmapText[7]=!0},i.prototype.$getHeight=function(){var t=this.$BitmapText[1];return isNaN(t)?this.$getContentBounds().height:t},i.prototype.$setHeight=function(t){var e=this.$BitmapText;return 0>t||t==e[1]?!1:(e[1]=t,this.$invalidateContentBounds(),!0)},Object.defineProperty(i.prototype,"font",{get:function(){return this.$BitmapText[5]},set:function(t){this.$setFont(t)},enumerable:!0,configurable:!0}),i.prototype.$setFont=function(t){var e=this.$BitmapText;return e[5]==t?!1:(e[5]=t,this.$BitmapText[6]=!0,this.$invalidateContentBounds(),!0)},Object.defineProperty(i.prototype,"lineSpacing",{get:function(){return this.$BitmapText[3]},set:function(t){this.$setLineSpacing(t)},enumerable:!0,configurable:!0}),i.prototype.$setLineSpacing=function(t){t=+t||0;var e=this.$BitmapText;return e[3]==t?!1:(e[3]=t,this.$invalidateContentBounds(),!0)},Object.defineProperty(i.prototype,"letterSpacing",{get:function(){return this.$BitmapText[4]},set:function(t){this.$setLetterSpacing(t)},enumerable:!0,configurable:!0}),i.prototype.$setLetterSpacing=function(t){t=+t||0;var e=this.$BitmapText;return e[4]==t?!1:(e[4]=t,this.$invalidateContentBounds(),!0)},Object.defineProperty(i.prototype,"textAlign",{get:function(){return this.$BitmapText[10]},set:function(t){this.$setTextAlign(t)},enumerable:!0,configurable:!0}),i.prototype.$setTextAlign=function(t){var e=this.$BitmapText;return e[10]==t?!1:(e[10]=t,this.$invalidateContentBounds(),!0)},Object.defineProperty(i.prototype,"verticalAlign",{get:function(){return this.$BitmapText[11]},set:function(t){this.$setVerticalAlign(t)},enumerable:!0,configurable:!0}),i.prototype.$setVerticalAlign=function(t){var e=this.$BitmapText;return e[11]==t?!1:(e[11]=t,this.$invalidateContentBounds(),!0)},i.prototype.$render=function(){var e=this.$BitmapText,r=this.$getTextLines(),n=r.length;if(0!=n){var o=this.$textLinesWidth,a=e[5],s=this.$renderNode;a.$texture&&(s.image=a.$texture._bitmapData),s.smoothing=e[12];for(var l=a._getFirstCharHeight(),h=Math.ceil(l*i.EMPTY_FACTOR),u=!isNaN(e[1]),c=e[8],p=e[0],d=e[1],f=e[10],g=this.$textOffsetY+this.$textStartY,y=this.$lineHeights,v=0;n>v;v++){var m=y[v];if(u&&v>0&&g+m>d)break;var _=r[v],b=_.length,T=this.$textOffsetX;if(f!=t.HorizontalAlign.LEFT){var x=p>c?p:c;f==t.HorizontalAlign.RIGHT?T+=x-o[v]:f==t.HorizontalAlign.CENTER&&(T+=Math.floor((x-o[v])/2))}for(var E=0;b>E;E++){var $=_.charAt(E),S=a.getTexture($);if(S){var C=S._bitmapWidth,w=S._bitmapHeight;s.imageWidth=S._sourceWidth,s.imageHeight=S._sourceHeight,s.drawImage(S._bitmapX,S._bitmapY,C,w,T+S._offsetX,g+S._offsetY,S.$getScaleBitmapWidth(),S.$getScaleBitmapHeight()),T+=(a.getConfig($,"xadvance")||S.$getTextureWidth())+e[4]}else" "==$?T+=h:t.$warn(1046,$)}g+=m+e[3]}}},i.prototype.$measureContentBounds=function(t){var e=this.$getTextLines();0==e.length?t.setEmpty():t.setTo(this.$textOffsetX+this.$textStartX,this.$textOffsetY+this.$textStartY,this.$BitmapText[8]-this.$textOffsetX,this.$BitmapText[9]-this.$textOffsetY)},Object.defineProperty(i.prototype,"textWidth",{get:function(){return this.$getTextLines(),this.$BitmapText[8]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"textHeight",{get:function(){return this.$getTextLines(),this.$BitmapText[9]},enumerable:!0,configurable:!0}),i.prototype.$getTextLines=function(){function e(t){return _&&n.length>0&&f>_?!1:(f+=h+c,s||l||(u-=p),n.push(t),a.push(h),o.push(u),d=Math.max(u,d),!0)}var r=this.$BitmapText;if(!r[7])return this.textLines;var n=[];this.textLines=n;var o=[];this.$textLinesWidth=o,r[7]=!1;var a=[];if(this.$lineHeights=a,!r[2]||!r[5])return n;for(var s,l,h,u,c=r[3],p=r[4],d=0,f=0,g=0,y=0,v=!isNaN(r[0]),m=r[0],_=r[1],b=r[5],T=b._getFirstCharHeight(),x=Math.ceil(T*i.EMPTY_FACTOR),E=r[2],$=E.split(/(?:\r\n|\r|\n)/),S=$.length,C=!0,w=0;S>w;w++){var O=$[w],P=O.length;h=0,u=0,s=!0,l=!1;for(var D=0;P>D;D++){s||(u+=p);var L=O.charAt(D),R=void 0,I=void 0,M=0,A=0,B=b.getTexture(L);if(B)R=B.$getTextureWidth(),I=B.$getTextureHeight(),M=B._offsetX,A=B._offsetY;else{if(" "!=L){t.$warn(1046,L),s&&(s=!1);continue}R=x,I=T}if(s&&(s=!1,g=Math.min(M,g)),C&&(C=!1,y=Math.min(A,y)),v&&D>0&&u+R>m){if(!e(O.substring(0,D)))break;O=O.substring(D),P=O.length,D=0,u=D==P-1?R:b.getConfig(L,"xadvance")||R,h=I}else u+=D==P-1?R:b.getConfig(L,"xadvance")||R,h=Math.max(I,h)}if(_&&w>0&&f>_)break;if(l=!0,!e(O))break}f-=c,r[8]=d,r[9]=f,this.$textOffsetX=g,this.$textOffsetY=y,this.$textStartX=0,this.$textStartY=0;var N;return m>d&&(N=r[10],N==t.HorizontalAlign.RIGHT?this.$textStartX=m-d:N==t.HorizontalAlign.CENTER&&(this.$textStartX=Math.floor((m-d)/2))),_>f&&(N=r[11],N==t.VerticalAlign.BOTTOM?this.$textStartY=_-f:N==t.VerticalAlign.MIDDLE&&(this.$textStartY=Math.floor((_-f)/2))),n},i}(t.DisplayObject);e.EMPTY_FACTOR=.33,t.BitmapText=e,__reflect(e.prototype,"egret.BitmapText")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t}();e.LEFT="left",e.RIGHT="right",e.CENTER="center",e.JUSTIFY="justify",e.CONTENT_JUSTIFY="contentJustify",t.HorizontalAlign=e,__reflect(e.prototype,"egret.HorizontalAlign")}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){this.replaceArr=[],this.resutlArr=[],this.initReplaceArr()}return e.prototype.initReplaceArr=function(){this.replaceArr=[],this.replaceArr.push([/&lt;/g,"<"]),this.replaceArr.push([/&gt;/g,">"]),this.replaceArr.push([/&amp;/g,"&"]),this.replaceArr.push([/&quot;/g,'"']),this.replaceArr.push([/&apos;/g,"'"])},e.prototype.replaceSpecial=function(t){for(var e=0;e<this.replaceArr.length;e++){var i=this.replaceArr[e][0],r=this.replaceArr[e][1];t=t.replace(i,r)}return t},e.prototype.parser=function(e){this.stackArray=[],this.resutlArr=[];for(var i=0,r=e.length;r>i;){var n=e.indexOf("<",i);if(0>n)this.addToResultArr(e.substring(i)),i=r;else{this.addToResultArr(e.substring(i,n));var o=e.indexOf(">",n);-1==o?(t.$error(1038),o=n):"/"==e.charAt(n+1)?this.stackArray.pop():this.addToArray(e.substring(n+1,o)),i=o+1}}return this.resutlArr},e.prototype.addToResultArr=function(t){""!=t&&(t=this.replaceSpecial(t),this.resutlArr.push(this.stackArray.length>0?{text:t,style:this.stackArray[this.stackArray.length-1]}:{text:t}))},e.prototype.changeStringToObject=function(t){t=t.trim();var e={},i=[];if("i"==t.charAt(0)||"b"==t.charAt(0)||"u"==t.charAt(0))this.addProperty(e,t,"true");else if(i=t.match(/^(font|a)\s/)){t=t.substring(i[0].length).trim();for(var r=0,n=void 0;n=t.match(this.getHeadReg());){var o=n[0],a="";t=t.substring(o.length).trim(),'"'==t.charAt(0)?(r=t.indexOf('"',1),a=t.substring(1,r),r+=1):"'"==t.charAt(0)?(r=t.indexOf("'",1),a=t.substring(1,r),r+=1):(a=t.match(/(\S)+/)[0],r=a.length),this.addProperty(e,o.substring(0,o.length-1).trim(),a.trim()),t=t.substring(r).trim()}}return e},e.prototype.getHeadReg=function(){return/^(color|textcolor|strokecolor|stroke|b|bold|i|italic|u|size|fontfamily|href|target)(\s)*=/},e.prototype.addProperty=function(t,e,i){switch(e.toLowerCase()){case"color":case"textcolor":i=i.replace(/#/,"0x"),t.textColor=parseInt(i);break;case"strokecolor":i=i.replace(/#/,"0x"),t.strokeColor=parseInt(i);break;case"stroke":t.stroke=parseInt(i);break;case"b":case"bold":t.bold="true"==i;break;case"u":t.underline="true"==i;break;case"i":case"italic":t.italic="true"==i;break;case"size":t.size=parseInt(i);break;case"fontfamily":t.fontFamily=i;break;case"href":t.href=this.replaceSpecial(i);break;case"target":t.target=this.replaceSpecial(i)}},e.prototype.addToArray=function(t){var e=this.changeStringToObject(t);if(0==this.stackArray.length)this.stackArray.push(e);else{var i=this.stackArray[this.stackArray.length-1];for(var r in i)null==e[r]&&(e[r]=i[r]);this.stackArray.push(e)}},e}();t.HtmlTextParser=e,__reflect(e.prototype,"egret.HtmlTextParser")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.stageTextAdded=!1,t._text=null,t._isFocus=!1,t}return __extends(i,e),i.prototype.init=function(e){this._text=e,this.stageText=new t.StageText,this.stageText.$setTextField(this._text)},i.prototype._addStageText=function(){this.stageTextAdded||(this._text.$inputEnabled||(this._text.$touchEnabled=!0),this.tempStage=this._text.stage,this.stageText.$addToStage(),this.stageText.addEventListener("updateText",this.updateTextHandler,this),this._text.addEventListener(t.TouchEvent.TOUCH_BEGIN,this.onMouseDownHandler,this),this.stageText.addEventListener("blur",this.blurHandler,this),this.stageText.addEventListener("focus",this.focusHandler,this),this.stageTextAdded=!0)},i.prototype._removeStageText=function(){this.stageTextAdded&&(this._text.$inputEnabled||(this._text.$touchEnabled=!1),this.stageText.$removeFromStage(),this.stageText.removeEventListener("updateText",this.updateTextHandler,this),this._text.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onMouseDownHandler,this),this.tempStage.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onStageDownHandler,this),this.stageText.removeEventListener("blur",this.blurHandler,this),this.stageText.removeEventListener("focus",this.focusHandler,this),this.stageTextAdded=!1)},i.prototype._getText=function(){return this.stageText.$getText()},i.prototype._setText=function(t){this.stageText.$setText(t)},i.prototype._setColor=function(t){this.stageText.$setColor(t)},i.prototype.focusHandler=function(e){this._isFocus||(this._isFocus=!0,e.showing||(this._text.$isTyping=!0),this._text.$invalidateContentBounds(),this._text.dispatchEvent(new t.FocusEvent(t.FocusEvent.FOCUS_IN,!0)))},i.prototype.blurHandler=function(){this._isFocus&&(this._isFocus=!1,this.tempStage.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onStageDownHandler,this),this._text.$isTyping=!1,this._text.$invalidateContentBounds(),this.stageText.$onBlur(),this._text.dispatchEvent(new t.FocusEvent(t.FocusEvent.FOCUS_OUT,!0)))},i.prototype.onMouseDownHandler=function(){this.$onFocus()},i.prototype.$onFocus=function(){this._text.visible&&(this._isFocus||(this.tempStage.addEventListener(t.TouchEvent.TOUCH_BEGIN,this.onStageDownHandler,this),this.stageText.$show()))},i.prototype.onStageDownHandler=function(t){t.$target!=this._text&&this.stageText.$hide()},i.prototype.updateTextHandler=function(){var e,i,r=this._text.$TextField,n=this.stageText.$getText(),o=!1;null!=r[35]&&(e=new RegExp("["+r[35]+"]","g"),i=n.match(e),n=i?i.join(""):"",o=!0),null!=r[36]&&(e=new RegExp("[^"+r[36]+"]","g"),i=n.match(e),n=i?i.join(""):"",o=!0),o&&this.stageText.$getText()!=n&&this.stageText.$setText(n),this.resetText(),this._text.dispatchEvent(new t.Event(t.Event.CHANGE,!0))},i.prototype.resetText=function(){this._text.$setBaseText(this.stageText.$getText())},i.prototype._hideInput=function(){this.stageText.$removeFromStage()},i.prototype.updateInput=function(){!this._text.$visible&&this.stageText&&this._hideInput()},i.prototype._updateProperties=function(){if(this._isFocus)return this.stageText.$resetStageText(),void this.updateInput();var t=this._text.$stage;if(null==t);else for(var e=this._text,i=e.$visible;i&&(e=e.parent,e!=t);)i=e.$visible;this.stageText.$setText(this._text.$TextField[13]),this.stageText.$resetStageText(),this.updateInput()},i}(t.HashObject);t.InputController=e,__reflect(e.prototype,"egret.InputController")}(egret||(egret={}));var egret;!function(){}(egret||(egret={}));var egret;!function(t){function e(e,i,n){n=n||{};var o=null==n.italic?i[16]:n.italic,a=null==n.bold?i[15]:n.bold,s=null==n.size?i[0]:n.size,l=n.fontFamily||i[8]||r.default_fontFamily;return t.sys.measureText(e,l,s,a,o)}var i=new RegExp("(?=[\\u00BF-\\u1FFF\\u2C00-\\uD7FF]|\\b|\\s)(?![。，！、》…）)}”】\\.\\,\\!\\?\\]\\:])"),r=function(r){function n(){var e=r.call(this)||this;e.$inputEnabled=!1,e.inputUtils=null,e.graphicsNode=null,e.isFlow=!1,e.textArr=[],e.linesArr=[],e.$isTyping=!1;var i=new t.sys.TextNode;return i.fontFamily=n.default_fontFamily,e.textNode=i,e.$renderNode=i,e.$TextField={0:n.default_size,1:0,2:n.default_textColor,3:0/0,4:0/0,5:0,6:0,7:0,8:n.default_fontFamily,9:"left",10:"top",11:"#ffffff",12:"",13:"",14:[],15:!1,16:!1,17:!0,18:!1,19:!1,20:!1,21:0,22:0,23:0,24:t.TextFieldType.DYNAMIC,25:0,26:"#000000",27:0,28:-1,29:0,30:!1,31:!1,32:0,33:!1,34:16777215,35:null,36:null,37:t.TextFieldInputType.TEXT},e}return __extends(n,r),n.prototype.isInput=function(){return this.$TextField[24]==t.TextFieldType.INPUT},n.prototype.$setTouchEnabled=function(t){var e=r.prototype.$setTouchEnabled.call(this,t);return this.isInput()&&(this.$inputEnabled=!0),e},Object.defineProperty(n.prototype,"fontFamily",{get:function(){return this.$TextField[8]},set:function(t){this.$setFontFamily(t)},enumerable:!0,configurable:!0}),n.prototype.$setFontFamily=function(t){var e=this.$TextField;return e[8]==t?!1:(e[8]=t,this.invalidateFontString(),!0)},Object.defineProperty(n.prototype,"size",{get:function(){return this.$TextField[0]},set:function(t){this.$setSize(t)},enumerable:!0,configurable:!0}),n.prototype.$setSize=function(t){t=+t||0;var e=this.$TextField;return e[0]==t?!1:(e[0]=t,this.invalidateFontString(),!0)},Object.defineProperty(n.prototype,"bold",{get:function(){return this.$TextField[15]},set:function(t){this.$setBold(t)},enumerable:!0,configurable:!0}),n.prototype.$setBold=function(t){t=!!t;var e=this.$TextField;return t==e[15]?!1:(e[15]=t,this.invalidateFontString(),!0)},Object.defineProperty(n.prototype,"italic",{get:function(){return this.$TextField[16]},set:function(t){this.$setItalic(t)},enumerable:!0,configurable:!0}),n.prototype.$setItalic=function(t){t=!!t;var e=this.$TextField;return t==e[16]?!1:(e[16]=t,this.invalidateFontString(),!0)},n.prototype.invalidateFontString=function(){this.$TextField[17]=!0,this.$invalidateTextField()},Object.defineProperty(n.prototype,"textAlign",{get:function(){return this.$TextField[9]},set:function(t){this.$setTextAlign(t)},enumerable:!0,configurable:!0}),n.prototype.$setTextAlign=function(t){var e=this.$TextField;return e[9]==t?!1:(e[9]=t,this.$invalidateTextField(),!0)},Object.defineProperty(n.prototype,"verticalAlign",{get:function(){return this.$TextField[10]},set:function(t){this.$setVerticalAlign(t)},enumerable:!0,configurable:!0}),n.prototype.$setVerticalAlign=function(t){var e=this.$TextField;return e[10]==t?!1:(e[10]=t,this.$invalidateTextField(),!0)},Object.defineProperty(n.prototype,"lineSpacing",{get:function(){return this.$TextField[1]},set:function(t){this.$setLineSpacing(t)},enumerable:!0,configurable:!0}),n.prototype.$setLineSpacing=function(t){t=+t||0;var e=this.$TextField;return e[1]==t?!1:(e[1]=t,this.$invalidateTextField(),!0)},Object.defineProperty(n.prototype,"textColor",{get:function(){return this.$TextField[2]},set:function(t){this.$setTextColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setTextColor=function(t){t=0|+t;var e=this.$TextField;return e[2]==t?!1:(e[2]=t,this.inputUtils&&this.inputUtils._setColor(this.$TextField[2]),this.$invalidate(),!0)},Object.defineProperty(n.prototype,"wordWrap",{get:function(){return this.$TextField[19]},set:function(t){this.$setWordWrap(t)},enumerable:!0,configurable:!0}),n.prototype.$setWordWrap=function(t){t=!!t;var e=this.$TextField;t!=e[19]&&(e[20]||(e[19]=t,this.$invalidateTextField()))},Object.defineProperty(n.prototype,"type",{get:function(){return this.$TextField[24]},set:function(t){this.$setType(t)},enumerable:!0,configurable:!0}),n.prototype.$setType=function(e){var i=this.$TextField;return i[24]!=e?(i[24]=e,e==t.TextFieldType.INPUT?(isNaN(i[3])&&this.$setWidth(100),isNaN(i[4])&&this.$setHeight(30),this.$setTouchEnabled(!0),null==this.inputUtils&&(this.inputUtils=new t.InputController),this.inputUtils.init(this),this.$invalidateTextField(),this.$stage&&this.inputUtils._addStageText()):(this.inputUtils&&(this.inputUtils._removeStageText(),this.inputUtils=null),this.$setTouchEnabled(!1)),!0):!1},Object.defineProperty(n.prototype,"inputType",{get:function(){return this.$TextField[37]},set:function(t){this.$TextField[37]=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"text",{get:function(){return this.$getText()},set:function(t){this.$setText(t)},enumerable:!0,configurable:!0}),n.prototype.$getText=function(){return this.$TextField[24]==t.TextFieldType.INPUT?this.inputUtils._getText():this.$TextField[13]},n.prototype.$setBaseText=function(t){null==t&&(t=""),t=t.toString(),this.isFlow=!1;var e=this.$TextField;if(e[13]!=t){this.$invalidateTextField(),e[13]=t;var i="";return i=e[20]?this.changeToPassText(t):t,this.setMiddleStyle([{text:i}]),!0}return!1},n.prototype.$setText=function(t){null==t&&(t="");var e=this.$setBaseText(t);return this.inputUtils&&this.inputUtils._setText(this.$TextField[13]),e},Object.defineProperty(n.prototype,"displayAsPassword",{get:function(){return this.$TextField[20]},set:function(t){this.$setDisplayAsPassword(t)},enumerable:!0,configurable:!0}),n.prototype.$setDisplayAsPassword=function(t){var e=this.$TextField;if(e[20]!=t){e[20]=t,this.$invalidateTextField();var i="";return i=t?this.changeToPassText(e[13]):e[13],this.setMiddleStyle([{text:i}]),!0}return!1},Object.defineProperty(n.prototype,"strokeColor",{get:function(){return this.$TextField[25]},set:function(t){t=+t||0,this.$setStrokeColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setStrokeColor=function(e){var i=this.$TextField;return i[25]!=e?(this.$invalidateTextField(),i[25]=e,i[26]=t.toColorString(e),!0):!1},Object.defineProperty(n.prototype,"stroke",{get:function(){return this.$TextField[27]},set:function(t){this.$setStroke(t)},enumerable:!0,configurable:!0}),n.prototype.$setStroke=function(t){return this.$TextField[27]!=t?(this.$invalidateTextField(),this.$TextField[27]=t,!0):!1},Object.defineProperty(n.prototype,"maxChars",{get:function(){return this.$TextField[21]},set:function(t){this.$setMaxChars(t)},enumerable:!0,configurable:!0}),n.prototype.$setMaxChars=function(t){return this.$TextField[21]!=t?(this.$TextField[21]=t,!0):!1},Object.defineProperty(n.prototype,"scrollV",{get:function(){return Math.min(Math.max(this.$TextField[28],1),this.maxScrollV)},set:function(t){this.$TextField[28]=Math.max(t,1),this.$invalidateTextField()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxScrollV",{get:function(){return this.$getLinesArr(),Math.max(this.$TextField[29]-t.TextFieldUtils.$getScrollNum(this)+1,1)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionBeginIndex",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionEndIndex",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"caretIndex",{get:function(){return 0},enumerable:!0,configurable:!0}),n.prototype.$setSelection=function(){return!1},n.prototype.$getLineHeight=function(){return this.$TextField[1]+this.$TextField[0]},Object.defineProperty(n.prototype,"numLines",{get:function(){return this.$getLinesArr(),this.$TextField[29]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"multiline",{get:function(){return this.$TextField[30]},set:function(t){this.$setMultiline(t)},enumerable:!0,configurable:!0}),n.prototype.$setMultiline=function(t){return this.$TextField[30]=t,this.$invalidateTextField(),!0},Object.defineProperty(n.prototype,"restrict",{get:function(){var t=this.$TextField,e=null;return null!=t[35]&&(e=t[35]),null!=t[36]&&(null==e&&(e=""),e+="^"+t[36]),e},set:function(t){var e=this.$TextField;if(null==t)e[35]=null,e[36]=null;else{for(var i=-1;i<t.length&&(i=t.indexOf("^",i),0!=i)&&i>0&&"\\"==t.charAt(i-1);)i++;0==i?(e[35]=null,e[36]=t.substring(i+1)):i>0?(e[35]=t.substring(0,i),e[36]=t.substring(i+1)):(e[35]=t,e[36]=null)}},enumerable:!0,configurable:!0}),n.prototype.$setWidth=function(t){var e=this.$TextField;if(isNaN(t)){if(isNaN(e[3]))return!1;e[3]=0/0}else{if(e[3]==t)return!1;e[3]=t}return t=+t,0>t?!1:(this.$invalidateTextField(),!0)},n.prototype.$setHeight=function(t){var e=this.$TextField;if(isNaN(t)){if(isNaN(e[4]))return!1;e[4]=0/0}else{if(e[4]==t)return!1;e[4]=t}return t=+t,0>t?!1:(this.$invalidateTextField(),!0)},n.prototype.$getWidth=function(){var t=this.$TextField;return isNaN(t[3])?this.$getContentBounds().width:t[3]},n.prototype.$getHeight=function(){var t=this.$TextField;return isNaN(t[4])?this.$getContentBounds().height:t[4]},Object.defineProperty(n.prototype,"border",{get:function(){return this.$TextField[31]},set:function(t){this.$setBorder(t)},enumerable:!0,configurable:!0}),n.prototype.$setBorder=function(t){this.$TextField[31]=!!t,this.$invalidate()},Object.defineProperty(n.prototype,"borderColor",{get:function(){return this.$TextField[32]},set:function(t){this.$setBorderColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setBorderColor=function(t){this.$TextField[32]=+t||0,this.$invalidate()},Object.defineProperty(n.prototype,"background",{get:function(){return this.$TextField[33]
},set:function(t){this.$setBackground(t)},enumerable:!0,configurable:!0}),n.prototype.$setBackground=function(t){this.$TextField[33]=t,this.$invalidate()},Object.defineProperty(n.prototype,"backgroundColor",{get:function(){return this.$TextField[34]},set:function(t){this.$setBackgroundColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setBackgroundColor=function(t){this.$TextField[34]=t,this.$invalidate()},n.prototype.fillBackground=function(e){var i=this.graphicsNode;i&&i.clear();var r=this.$TextField;if(r[33]||r[31]||e&&e.length>0){if(!i){i=this.graphicsNode=new t.sys.GraphicsNode;var n=new t.sys.GroupNode;n.addNode(i),n.addNode(this.textNode),this.$renderNode=n}var o=void 0,a=void 0;if(r[33]&&(o=i.beginFill(r[34]),o.drawRect(0,0,this.$getWidth(),this.$getHeight())),r[31]&&(a=i.lineStyle(1,r[32]),a.drawRect(0,0,this.$getWidth()-1,this.$getHeight()-1)),e&&e.length>0)for(var s=r[2],l=-1,h=e.length,u=0;h>u;u+=4){var c=e[u],p=e[u+1],d=e[u+2],f=e[u+3]||s;(0>l||l!=f)&&(l=f,a=i.lineStyle(2,f,1,t.CapsStyle.NONE)),a.moveTo(c,p),a.lineTo(c+d,p)}}if(i){var g=this.$getRenderBounds();i.x=g.x,i.y=g.y,i.width=g.width,i.height=g.height,t.Rectangle.release(g)}},n.prototype.setFocus=function(){this.type==t.TextFieldType.INPUT&&this.$stage&&this.inputUtils.$onFocus()},n.prototype.$onRemoveFromStage=function(){r.prototype.$onRemoveFromStage.call(this),this.removeEvent(),this.$TextField[24]==t.TextFieldType.INPUT&&this.inputUtils._removeStageText(),this.textNode&&this.textNode.clean()},n.prototype.$onAddToStage=function(e,i){r.prototype.$onAddToStage.call(this,e,i),this.addEvent(),this.$TextField[24]==t.TextFieldType.INPUT&&this.inputUtils._addStageText()},n.prototype.$invalidateTextField=function(){this.$invalidateContentBounds(),this.$TextField[18]=!0},n.prototype.$update=function(e){var i=this.$getRenderBounds(),n=r.prototype.$update.call(this,e,i);return t.Rectangle.release(i),n},n.prototype.$getRenderBounds=function(){var e=this.$getContentBounds(),i=t.Rectangle.create();i.copyFrom(e),this.$TextField[31]&&(i.width+=2,i.height+=2);var r=2*this.$TextField[27];return r>0&&(i.width+=2*r,i.height+=2*r),i.x-=r+2,i.y-=r+2,i.width=Math.ceil(i.width)+4,i.height=Math.ceil(i.height)+4,i},n.prototype.$measureContentBounds=function(e){this.$getLinesArr();var i=isNaN(this.$TextField[3])?this.$TextField[5]:this.$TextField[3],r=isNaN(this.$TextField[4])?t.TextFieldUtils.$getTextHeight(this):this.$TextField[4];e.setTo(0,0,i,r)},n.prototype.$render=function(){if(this.$TextField[24]==t.TextFieldType.INPUT){if((this.$hasAnyFlags(2032)||this.$hasAnyFlags(1648))&&this.inputUtils._updateProperties(),this.$isTyping)return void this.fillBackground()}else if(0==this.$TextField[3])return;var e=this.drawText();this.fillBackground(e);var i=this.$getRenderBounds(),r=this.textNode;r.x=i.x,r.y=i.y,r.width=Math.ceil(i.width),r.height=Math.ceil(i.height),t.Rectangle.release(i)},Object.defineProperty(n.prototype,"textFlow",{get:function(){return this.textArr},set:function(t){this.isFlow=!0;var e="";null==t&&(t=[]);for(var i=0;i<t.length;i++){var r=t[i];e+=r.text}this.$TextField[20]?this.$setBaseText(e):(this.$TextField[13]=e,this.setMiddleStyle(t))},enumerable:!0,configurable:!0}),n.prototype.changeToPassText=function(t){if(this.$TextField[20]){for(var e="",i=0,r=t.length;r>i;i++)switch(t.charAt(i)){case"\n":e+="\n";break;case"\r":break;default:e+="*"}return e}return t},n.prototype.setMiddleStyle=function(t){this.$TextField[18]=!0,this.textArr=t,this.$invalidateTextField()},Object.defineProperty(n.prototype,"textWidth",{get:function(){return this.$getLinesArr(),this.$TextField[5]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textHeight",{get:function(){return this.$getLinesArr(),t.TextFieldUtils.$getTextHeight(this)},enumerable:!0,configurable:!0}),n.prototype.appendText=function(t){this.appendElement({text:t})},n.prototype.appendElement=function(t){var e=this.$TextField[13]+t.text;this.$TextField[20]?this.$setBaseText(e):(this.$TextField[13]=e,this.textArr.push(t),this.setMiddleStyle(this.textArr))},n.prototype.$getLinesArr=function(){var r=this.$TextField;if(!r[18])return this.linesArr;r[18]=!1;var n=this.textArr;this.linesArr.length=0,r[6]=0,r[5]=0;var o=r[3];if(!isNaN(o)&&0==o)return r[29]=0,[{width:0,height:0,charNum:0,elements:[],hasNextLine:!1}];for(var a,s=this.linesArr,l=0,h=0,u=0,c=0,p=0,d=n.length;d>p;p++){var f=n[p];if(f.text){f.style=f.style||{};for(var g=f.text.toString(),y=g.split(/(?:\r\n|\r|\n)/),v=0,m=y.length;m>v;v++){null==s[c]&&(a={width:0,height:0,elements:[],charNum:0,hasNextLine:!1},s[c]=a,l=0,u=0,h=0),u=r[24]==t.TextFieldType.INPUT?r[0]:Math.max(u,f.style.size||r[0]);var _=!0;if(""==y[v])v==m-1&&(_=!1);else{var b=e(y[v],r,f.style);if(isNaN(o))l+=b,h+=y[v].length,a.elements.push({width:b,text:y[v],style:f.style}),v==m-1&&(_=!1);else if(o>=l+b)a.elements.push({width:b,text:y[v],style:f.style}),l+=b,h+=y[v].length,v==m-1&&(_=!1);else{var T=0,x=0,E=y[v],$=void 0;$=r[19]?E.split(i):E.match(/./g);for(var S=$.length,C=0;S>T;T++){var w=$[T].length,O=!1;if(1==w&&S-1>T){var P=$[T].charCodeAt(0),D=$[T+1].charCodeAt(0);if(P>=55296&&56319>=P&&56320==(64512&D)){var L=$[T]+$[T+1];w=2,O=!0,b=e(L,r,f.style)}else b=e($[T],r,f.style)}else b=e($[T],r,f.style);if(0!=l&&l+b>o&&l+T!=0)break;if(x+b>o)for(var R=$[T].match(/./g),I=0,M=R.length;M>I;I++){var w=R[I].length,A=!1;if(1==w&&M-1>I){var P=R[I].charCodeAt(0),D=R[I+1].charCodeAt(0);if(P>=55296&&56319>=P&&56320==(64512&D)){var L=R[I]+R[I+1];w=2,A=!0,b=e(L,r,f.style)}else b=e(R[I],r,f.style)}else b=e(R[I],r,f.style);if(I>0&&l+b>o)break;C+=w,x+=b,l+=b,h+=C,A&&I++}else C+=w,x+=b,l+=b,h+=C;O&&T++}if(T>0){a.elements.push({width:x,text:E.substring(0,C),style:f.style});var B=E.substring(C),N=void 0,F=B.length;for(N=0;F>N&&" "==B.charAt(N);N++);y[v]=B.substring(N)}""!=y[v]&&(v--,_=!1)}}_&&(h++,a.hasNextLine=!0),v<y.length-1&&(a.width=l,a.height=u,a.charNum=h,r[5]=Math.max(r[5],l),r[6]+=u,c++)}p==n.length-1&&a&&(a.width=l,a.height=u,a.charNum=h,r[5]=Math.max(r[5],l),r[6]+=u)}else a&&(a.width=l,a.height=u,a.charNum=h,r[5]=Math.max(r[5],l),r[6]+=u)}return r[29]=s.length,s},n.prototype.drawText=function(){var e=this.textNode,i=this.$TextField;e.bold=i[15],e.fontFamily=i[8]||n.default_fontFamily,e.italic=i[16],e.size=i[0],e.stroke=i[27],e.strokeColor=i[25],e.textColor=i[2];var r=this.$getLinesArr();if(0==i[5])return[];var o=isNaN(i[3])?i[5]:i[3],a=t.TextFieldUtils.$getTextHeight(this),s=0,l=t.TextFieldUtils.$getStartLine(this),h=i[4];if(!isNaN(h)&&h>a){var u=t.TextFieldUtils.$getValign(this);s+=u*(h-a)}s=Math.round(s);for(var c=t.TextFieldUtils.$getHalign(this),p=0,d=[],f=l,g=i[29];g>f;f++){var y=r[f],v=y.height;if(s+=v/2,f!=l){if(i[24]==t.TextFieldType.INPUT&&!i[30])break;if(!isNaN(h)&&s>h)break}p=Math.round((o-y.width)*c);for(var m=0,_=y.elements.length;_>m;m++){var b=y.elements[m],T=b.style.size||i[0];e.drawText(p,s+(v-T)/2,b.text,b.style),b.style.underline&&d.push(p,s+v/2,b.width,b.style.textColor),p+=b.width}s+=v/2+i[1]}return d},n.prototype.addEvent=function(){this.addEventListener(t.TouchEvent.TOUCH_TAP,this.onTapHandler,this)},n.prototype.removeEvent=function(){this.removeEventListener(t.TouchEvent.TOUCH_TAP,this.onTapHandler,this)},n.prototype.onTapHandler=function(e){if(this.$TextField[24]!=t.TextFieldType.INPUT){var i=t.TextFieldUtils.$getTextElement(this,e.localX,e.localY);if(null!=i){var r=i.style;if(r&&r.href)if(r.href.match(/^event:/)){var n=r.href.match(/^event:/)[0];t.TextEvent.dispatchTextEvent(this,t.TextEvent.LINK,r.href.substring(n.length))}else open(r.href,r.target||"_blank")}}},n}(t.DisplayObject);r.default_fontFamily="Arial",r.default_size=30,r.default_textColor=16777215,t.TextField=r,__reflect(r.prototype,"egret.TextField"),t.$markReadOnly(r,"numLines"),t.$markReadOnly(r,"textWidth"),t.$markReadOnly(r,"textHeight")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t}();e.TEXT="text",e.TEL="tel",e.PASSWORD="password",t.TextFieldInputType=e,__reflect(e.prototype,"egret.TextFieldInputType")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t}();e.DYNAMIC="dynamic",e.INPUT="input",t.TextFieldType=e,__reflect(e.prototype,"egret.TextFieldType")}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){}return e.$getStartLine=function(t){var i=t.$TextField,r=e.$getTextHeight(t),n=0,o=i[4];return isNaN(o)||(o>r||r>o&&(n=Math.max(i[28]-1,0),n=Math.min(i[29]-1,n)),i[30]||(n=Math.max(i[28]-1,0),i[29]>0&&(n=Math.min(i[29]-1,n)))),n},e.$getHalign=function(e){var i=e.$getLinesArr(),r=0;return e.$TextField[9]==t.HorizontalAlign.CENTER?r=.5:e.$TextField[9]==t.HorizontalAlign.RIGHT&&(r=1),e.$TextField[24]==t.TextFieldType.INPUT&&!e.$TextField[30]&&i.length>1&&(r=0),r},e.$getTextHeight=function(e){var i=t.TextFieldType.INPUT!=e.$TextField[24]||e.$TextField[30]?e.$TextField[6]+(e.$TextField[29]-1)*e.$TextField[1]:e.$TextField[0];return i},e.$getValign=function(i){var r=e.$getTextHeight(i),n=i.$TextField[4];if(!isNaN(n)&&n>r){var o=0;return i.$TextField[10]==t.VerticalAlign.MIDDLE?o=.5:i.$TextField[10]==t.VerticalAlign.BOTTOM&&(o=1),o}return 0},e.$getTextElement=function(t,i,r){var n=e.$getHit(t,i,r),o=t.$getLinesArr();return n&&o[n.lineIndex]&&o[n.lineIndex].elements[n.textElementIndex]?o[n.lineIndex].elements[n.textElementIndex]:null},e.$getHit=function(t,i,r){var n=t.$getLinesArr();if(0==t.$TextField[3])return null;var o=0,a=e.$getTextHeight(t),s=0,l=t.$TextField[4];if(!isNaN(l)&&l>a){var h=e.$getValign(t);s=h*(l-a),0!=s&&(r-=s)}for(var u=e.$getStartLine(t),c=0,p=u;p<n.length;p++){var d=n[p];if(c+d.height>=r){r>c&&(o=p+1);break}if(c+=d.height,c+t.$TextField[1]>r)return null;c+=t.$TextField[1]}if(0==o)return null;var f=n[o-1],g=t.$TextField[3];isNaN(g)&&(g=t.textWidth);var y=e.$getHalign(t);i-=y*(g-f.width);for(var v=0,p=0;p<f.elements.length;p++){var m=f.elements[p];if(v+m.width<=i)v+=m.width;else if(i>v)return{lineIndex:o-1,textElementIndex:p}}return null},e.$getScrollNum=function(t){var e=1;if(t.$TextField[30]){var i=t.height,r=t.size,n=t.lineSpacing;e=Math.floor(i/(r+n));var o=i-(r+n)*e;o>r/2&&e++}return e},e}();t.TextFieldUtils=e,__reflect(e.prototype,"egret.TextFieldUtils")}(egret||(egret={}));var egret;!function(t){var e;!function(){}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t}();e.TOP="top",e.BOTTOM="bottom",e.MIDDLE="middle",e.JUSTIFY="justify",e.CONTENT_JUSTIFY="contentJustify",t.VerticalAlign=e,__reflect(e.prototype,"egret.VerticalAlign")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t}();e.LITTLE_ENDIAN="littleEndian",e.BIG_ENDIAN="bigEndian",t.Endian=e,__reflect(e.prototype,"egret.Endian");var i=function(){function i(t){this.BUFFER_EXT_SIZE=0,this.EOF_byte=-1,this.EOF_code_point=-1,this._setArrayBuffer(t||new ArrayBuffer(this.BUFFER_EXT_SIZE)),this.endian=e.BIG_ENDIAN}return i.prototype._setArrayBuffer=function(t){this.write_position=t.byteLength,this.data=new DataView(t),this._position=0},i.prototype.setArrayBuffer=function(){},Object.defineProperty(i.prototype,"buffer",{get:function(){return this.data.buffer},set:function(t){this.data=new DataView(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dataView",{get:function(){return this.data},set:function(t){this.data=t,this.write_position=t.byteLength},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bufferOffset",{get:function(){return this.data.byteOffset},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t,this.write_position=t>this.write_position?t:this.write_position},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"length",{get:function(){return this.write_position},set:function(t){this.write_position=t;var e=new Uint8Array(new ArrayBuffer(t)),i=this.data.buffer.byteLength;i>t&&(this._position=t);var r=Math.min(i,t);e.set(new Uint8Array(this.data.buffer,0,r)),this.buffer=e.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bytesAvailable",{get:function(){return this.data.byteLength-this._position},enumerable:!0,configurable:!0}),i.prototype.clear=function(){this._setArrayBuffer(new ArrayBuffer(this.BUFFER_EXT_SIZE))},i.prototype.readBoolean=function(){return this.validate(i.SIZE_OF_BOOLEAN)?0!=this.data.getUint8(this.position++):null},i.prototype.readByte=function(){return this.validate(i.SIZE_OF_INT8)?this.data.getInt8(this.position++):null},i.prototype.readBytes=function(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=0),0==r)r=this.bytesAvailable;else if(!this.validate(r))return null;t?t.validateBuffer(e+r):t=new i(new ArrayBuffer(e+r));for(var n=0;r>n;n++)t.data.setUint8(n+e,this.data.getUint8(this.position++))},i.prototype.readDouble=function(){if(!this.validate(i.SIZE_OF_FLOAT64))return null;var t=this.data.getFloat64(this.position,this.endian==e.LITTLE_ENDIAN);return this.position+=i.SIZE_OF_FLOAT64,t},i.prototype.readFloat=function(){if(!this.validate(i.SIZE_OF_FLOAT32))return null;var t=this.data.getFloat32(this.position,this.endian==e.LITTLE_ENDIAN);return this.position+=i.SIZE_OF_FLOAT32,t},i.prototype.readInt=function(){if(!this.validate(i.SIZE_OF_INT32))return null;var t=this.data.getInt32(this.position,this.endian==e.LITTLE_ENDIAN);return this.position+=i.SIZE_OF_INT32,t},i.prototype.readShort=function(){if(!this.validate(i.SIZE_OF_INT16))return null;var t=this.data.getInt16(this.position,this.endian==e.LITTLE_ENDIAN);return this.position+=i.SIZE_OF_INT16,t},i.prototype.readUnsignedByte=function(){return this.validate(i.SIZE_OF_UINT8)?this.data.getUint8(this.position++):null},i.prototype.readUnsignedInt=function(){if(!this.validate(i.SIZE_OF_UINT32))return null;var t=this.data.getUint32(this.position,this.endian==e.LITTLE_ENDIAN);return this.position+=i.SIZE_OF_UINT32,t},i.prototype.readUnsignedShort=function(){if(!this.validate(i.SIZE_OF_UINT16))return null;var t=this.data.getUint16(this.position,this.endian==e.LITTLE_ENDIAN);return this.position+=i.SIZE_OF_UINT16,t},i.prototype.readUTF=function(){if(!this.validate(i.SIZE_OF_UINT16))return null;var t=this.data.getUint16(this.position,this.endian==e.LITTLE_ENDIAN);return this.position+=i.SIZE_OF_UINT16,t>0?this.readUTFBytes(t):""},i.prototype.readUTFBytes=function(t){if(!this.validate(t))return null;var e=new Uint8Array(this.buffer,this.bufferOffset+this.position,t);return this.position+=t,this.decodeUTF8(e)},i.prototype.writeBoolean=function(t){this.validateBuffer(i.SIZE_OF_BOOLEAN),this.data.setUint8(this.position++,t?1:0)},i.prototype.writeByte=function(t){this.validateBuffer(i.SIZE_OF_INT8),this.data.setInt8(this.position++,t)},i.prototype.writeBytes=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var r;if(!(0>e)&&!(0>i)&&(r=0==i?t.length-e:Math.min(t.length-e,i),r>0)){this.validateBuffer(r);for(var n=new DataView(t.buffer),o=r,a=4;o>a;o-=a)this.data.setUint32(this._position,n.getUint32(e)),this.position+=a,e+=a;for(;o>0;o--)this.data.setUint8(this.position++,n.getUint8(e++))}},i.prototype.writeDouble=function(t){this.validateBuffer(i.SIZE_OF_FLOAT64),this.data.setFloat64(this.position,t,this.endian==e.LITTLE_ENDIAN),this.position+=i.SIZE_OF_FLOAT64},i.prototype.writeFloat=function(t){this.validateBuffer(i.SIZE_OF_FLOAT32),this.data.setFloat32(this.position,t,this.endian==e.LITTLE_ENDIAN),this.position+=i.SIZE_OF_FLOAT32},i.prototype.writeInt=function(t){this.validateBuffer(i.SIZE_OF_INT32),this.data.setInt32(this.position,t,this.endian==e.LITTLE_ENDIAN),this.position+=i.SIZE_OF_INT32},i.prototype.writeShort=function(t){this.validateBuffer(i.SIZE_OF_INT16),this.data.setInt16(this.position,t,this.endian==e.LITTLE_ENDIAN),this.position+=i.SIZE_OF_INT16},i.prototype.writeUnsignedInt=function(t){this.validateBuffer(i.SIZE_OF_UINT32),this.data.setUint32(this.position,t,this.endian==e.LITTLE_ENDIAN),this.position+=i.SIZE_OF_UINT32},i.prototype.writeUnsignedShort=function(t){this.validateBuffer(i.SIZE_OF_UINT16),this.data.setUint16(this.position,t,this.endian==e.LITTLE_ENDIAN),this.position+=i.SIZE_OF_UINT16},i.prototype.writeUTF=function(t){var r=this.encodeUTF8(t),n=r.length;this.validateBuffer(i.SIZE_OF_UINT16+n),this.data.setUint16(this.position,n,this.endian==e.LITTLE_ENDIAN),this.position+=i.SIZE_OF_UINT16,this._writeUint8Array(r,!1)},i.prototype.writeUTFBytes=function(t){this._writeUint8Array(this.encodeUTF8(t))},i.prototype.toString=function(){return"[ByteArray] length:"+this.length+", bytesAvailable:"+this.bytesAvailable},i.prototype._writeUint8Array=function(t,e){void 0===e&&(e=!0),e&&this.validateBuffer(this.position+t.length);for(var i=0;i<t.length;i++)this.data.setUint8(this.position++,t[i])},i.prototype.validate=function(e){return this.data.byteLength>0&&this._position+e<=this.data.byteLength?!0:void t.$error(1025)},i.prototype.validateBuffer=function(t,e){if(void 0===e&&(e=!1),this.write_position=t>this.write_position?t:this.write_position,t+=this._position,this.data.byteLength<t||e){var i=new Uint8Array(new ArrayBuffer(t+this.BUFFER_EXT_SIZE)),r=Math.min(this.data.buffer.byteLength,t+this.BUFFER_EXT_SIZE);i.set(new Uint8Array(this.data.buffer,0,r)),this.buffer=i.buffer}},i.prototype.encodeUTF8=function(t){for(var e=0,i=this.stringToCodePoints(t),r=[];i.length>e;){var n=i[e++];if(this.inRange(n,55296,57343))this.encoderError(n);else if(this.inRange(n,0,127))r.push(n);else{var o=void 0,a=void 0;for(this.inRange(n,128,2047)?(o=1,a=192):this.inRange(n,2048,65535)?(o=2,a=224):this.inRange(n,65536,1114111)&&(o=3,a=240),r.push(this.div(n,Math.pow(64,o))+a);o>0;){var s=this.div(n,Math.pow(64,o-1));r.push(128+s%64),o-=1}}}return new Uint8Array(r)},i.prototype.decodeUTF8=function(t){for(var e,i=!1,r=0,n="",o=0,a=0,s=0,l=0;t.length>r;){var h=t[r++];if(h==this.EOF_byte)e=0!=a?this.decoderError(i):this.EOF_code_point;else if(0==a)this.inRange(h,0,127)?e=h:(this.inRange(h,194,223)?(a=1,l=128,o=h-192):this.inRange(h,224,239)?(a=2,l=2048,o=h-224):this.inRange(h,240,244)?(a=3,l=65536,o=h-240):this.decoderError(i),o*=Math.pow(64,a),e=null);else if(this.inRange(h,128,191))if(s+=1,o+=(h-128)*Math.pow(64,a-s),s!==a)e=null;else{var u=o,c=l;o=0,a=0,s=0,l=0,e=this.inRange(u,c,1114111)&&!this.inRange(u,55296,57343)?u:this.decoderError(i,h)}else o=0,a=0,s=0,l=0,r--,e=this.decoderError(i,h);null!==e&&e!==this.EOF_code_point&&(65535>=e?e>0&&(n+=String.fromCharCode(e)):(e-=65536,n+=String.fromCharCode(55296+(e>>10&1023)),n+=String.fromCharCode(56320+(1023&e))))}return n},i.prototype.encoderError=function(e){t.$error(1026,e)},i.prototype.decoderError=function(e,i){return e&&t.$error(1027),i||65533},i.prototype.inRange=function(t,e,i){return t>=e&&i>=t},i.prototype.div=function(t,e){return Math.floor(t/e)},i.prototype.stringToCodePoints=function(t){for(var e=[],i=0,r=t.length;i<t.length;){var n=t.charCodeAt(i);if(this.inRange(n,55296,57343))if(this.inRange(n,56320,57343))e.push(65533);else if(i==r-1)e.push(65533);else{var o=t.charCodeAt(i+1);if(this.inRange(o,56320,57343)){var a=1023&n,s=1023&o;i+=1,e.push(65536+(a<<10)+s)}else e.push(65533)}else e.push(n);i+=1}return e},i}();i.SIZE_OF_BOOLEAN=1,i.SIZE_OF_INT8=1,i.SIZE_OF_INT16=2,i.SIZE_OF_INT32=4,i.SIZE_OF_UINT8=1,i.SIZE_OF_UINT16=2,i.SIZE_OF_UINT32=4,i.SIZE_OF_FLOAT32=4,i.SIZE_OF_FLOAT64=8,t.ByteArray=i,__reflect(i.prototype,"egret.ByteArray")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t}();e.NORMAL="normal",e.ADD="add",e.ERASE="erase",t.BlendMode=e,__reflect(e.prototype,"egret.BlendMode")}(egret||(egret={})),function(t){var e;!function(t){function e(t){var e=n[t];return void 0===e?0:e}function i(t){var e=r[t];return void 0===e?"normal":e}for(var r=["normal","add","erase"],n={},o=r.length,a=0;o>a;a++){var s=r[a];n[s]=a}t.blendModeToNumber=e,t.numberToBlendMode=i}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){function e(e,i){t.useFontMapping=!0,t.fontMapping[e]=i}t.fontMapping={},t.useFontMapping=!1,t.registerFontMapping=e}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.$stageWidth=0,i.$stageHeight=0,i.$scaleMode=t.StageScaleMode.SHOW_ALL,i.$orientation=t.OrientationMode.AUTO,i.$maxTouches=99,i.$dirtyRegionPolicy=t.DirtyRegionPolicy.ON,i.$stage=i,i.$nestLevel=1,i}return __extends(i,e),Object.defineProperty(i.prototype,"frameRate",{get:function(){return t.sys.$ticker.$frameRate},set:function(e){t.sys.$ticker.$setFrameRate(e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"stageWidth",{get:function(){return this.$stageWidth},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"stageHeight",{get:function(){return this.$stageHeight},enumerable:!0,configurable:!0}),i.prototype.invalidate=function(){t.sys.$invalidateRenderFlag=!0},i.prototype.registerImplementation=function(e,i){t.registerImplementation(e,i)},i.prototype.getImplementation=function(e){return t.getImplementation(e)},Object.defineProperty(i.prototype,"scaleMode",{get:function(){return this.$scaleMode},set:function(t){this.$scaleMode!=t&&(this.$scaleMode=t,this.$screen.updateScreenSize())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"orientation",{get:function(){return this.$orientation},set:function(t){this.$orientation!=t&&(this.$orientation=t,this.$screen.updateScreenSize())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"textureScaleFactor",{get:function(){return t.$TextureScaleFactor},set:function(e){t.$TextureScaleFactor=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxTouches",{get:function(){return this.$maxTouches},set:function(t){this.$maxTouches!=t&&(this.$maxTouches=t,this.$screen.updateMaxTouches())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dirtyRegionPolicy",{get:function(){return this.$dirtyRegionPolicy},set:function(t){this.$dirtyRegionPolicy!=t&&(this.$dirtyRegionPolicy=t,this.$displayList.setDirtyRegionPolicy(t))},enumerable:!0,configurable:!0}),i.prototype.setContentSize=function(t,e){this.$screen.setContentSize(t,e)},i}(t.DisplayObjectContainer);t.Stage=e,__reflect(e.prototype,"egret.Stage"),t.$markCannotUse(e,"alpha",1),t.$markCannotUse(e,"visible",!0),t.$markCannotUse(e,"x",0),t.$markCannotUse(e,"y",0),t.$markCannotUse(e,"scaleX",1),t.$markCannotUse(e,"scaleY",1),t.$markCannotUse(e,"rotation",0),t.$markCannotUse(e,"cacheAsBitmap",!1),t.$markCannotUse(e,"scrollRect",null),t.$markCannotUse(e,"filters",null),t.$markCannotUse(e,"blendMode",null),t.$markCannotUse(e,"touchEnabled",!0),t.$markCannotUse(e,"matrix",null),t.$markReadOnly(e,"stageWidth"),t.$markReadOnly(e,"stageHeight")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"logLevel",{set:function(){},enumerable:!0,configurable:!0}),t}();e.ALL="all",e["true"]="debug",e.INFO="info",e.WARN="warn",e.ERROR="error",e.OFF="off",t.Logger=e,__reflect(e.prototype,"egret.Logger")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.isNumber=function(t){return"number"==typeof t&&!isNaN(t)},t.sin=function(e){var i=Math.floor(e),r=i+1,n=t.sinInt(i);if(i==e)return n;var o=t.sinInt(r);return(e-i)*o+(r-e)*n},t.sinInt=function(t){return t%=360,0>t&&(t+=360),egret_sin_map[t]},t.cos=function(e){var i=Math.floor(e),r=i+1,n=t.cosInt(i);if(i==e)return n;var o=t.cosInt(r);return(e-i)*o+(r-e)*n},t.cosInt=function(t){return t%=360,0>t&&(t+=360),egret_cos_map[t]},t}();t.NumberUtils=e,__reflect(e.prototype,"egret.NumberUtils")}(egret||(egret={}));for(var egret_sin_map={},egret_cos_map={},DEG_TO_RAD=Math.PI/180,NumberUtils_i=0;360>NumberUtils_i;NumberUtils_i++)egret_sin_map[NumberUtils_i]=Math.sin(NumberUtils_i*DEG_TO_RAD),egret_cos_map[NumberUtils_i]=Math.cos(NumberUtils_i*DEG_TO_RAD);egret_sin_map[90]=1,egret_cos_map[90]=0,egret_sin_map[180]=0,egret_cos_map[180]=-1,egret_sin_map[270]=-1,egret_cos_map[270]=0,Function.prototype.bind||(Function.prototype.bind=function(t){"function"!=typeof this&&egret.$error(1029);var e=Array.prototype.slice.call(arguments,1),i=this,r=function(){},n=function(){return i.apply(this instanceof r&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};return r.prototype=this.prototype,n.prototype=new r,n});var egret;!function(t){var e=function(e){function i(t,i){void 0===i&&(i=0);var r=e.call(this)||this;return r._delay=0,r._currentCount=0,r._running=!1,r.updateInterval=1e3,r.lastCount=1e3,r.lastTimeStamp=0,r.delay=t,r.repeatCount=0|+i,r}return __extends(i,e),Object.defineProperty(i.prototype,"delay",{get:function(){return this._delay},set:function(t){1>t&&(t=1),this._delay!=t&&(this._delay=t,this.lastCount=this.updateInterval=Math.round(60*t))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentCount",{get:function(){return this._currentCount},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"running",{get:function(){return this._running},enumerable:!0,configurable:!0}),i.prototype.reset=function(){this.stop(),this._currentCount=0},i.prototype.start=function(){this._running||(this.lastCount=this.updateInterval,this.lastTimeStamp=t.getTimer(),t.sys.$ticker.$startTick(this.$update,this),this._running=!0)},i.prototype.stop=function(){this._running&&(t.stopTick(this.$update,this),this._running=!1)},i.prototype.$update=function(e){var i=e-this.lastTimeStamp;if(i>=this._delay)this.lastCount=this.updateInterval;else{if(this.lastCount-=1e3,this.lastCount>0)return!1;this.lastCount+=this.updateInterval}this.lastTimeStamp=e,this._currentCount++;var r=this.repeatCount>0&&this._currentCount>=this.repeatCount;return t.TimerEvent.dispatchTimerEvent(this,t.TimerEvent.TIMER),r&&(this.stop(),t.TimerEvent.dispatchTimerEvent(this,t.TimerEvent.TIMER_COMPLETE)),!1},i}(t.EventDispatcher);t.Timer=e,__reflect(e.prototype,"egret.Timer"),t.$markReadOnly(e,"currentCount"),t.$markReadOnly(e,"running")}(egret||(egret={}));var egret;!function(){}(egret||(egret={}));var egret;!function(t){function e(e,i){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];t.$callLaterFunctionList.push(e),t.$callLaterThisList.push(i),t.$callLaterArgsList.push(r)}function i(e,i){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];t.$callAsyncFunctionList.push(e),t.$callAsyncThisList.push(i),t.$callAsyncArgsList.push(r)}t.$callLaterFunctionList=[],t.$callLaterThisList=[],t.$callLaterArgsList=[],t.callLater=e,t.$callAsyncFunctionList=[],t.$callAsyncThisList=[],t.$callAsyncArgsList=[],t.$callAsync=i}(egret||(egret={}));var egret;!function(t){function e(t,e,i){for(var r=[],n=3;n<arguments.length;n++)r[n-3]=arguments[n];var o,a=t.prototype;t.hasOwnProperty("__sets__")||Object.defineProperty(t,"__sets__",{value:{}}),o=t.__sets__;var s=o[i];if(s)return s.apply(e,r);var l=Object.getPrototypeOf(a);if(null!=l){for(;!l.hasOwnProperty(i);)if(l=Object.getPrototypeOf(l),null==l)return;s=Object.getOwnPropertyDescriptor(l,i).set,o[i]=s,s.apply(e,r)}}function i(t,e,i){var r,n=t.prototype;t.hasOwnProperty("__gets__")||Object.defineProperty(t,"__gets__",{value:{}}),r=t.__gets__;var o=r[i];if(o)return o.call(e);var a=Object.getPrototypeOf(n);if(null!=a){for(;!a.hasOwnProperty(i);)if(a=Object.getPrototypeOf(a),null==a)return;return o=Object.getOwnPropertyDescriptor(a,i).get,r[i]=o,o.call(e)}}t.superSetter=e,t.superGetter=i}(egret||(egret={}));var egret;!function(t){function e(t){if(!t)return null;var e=i[t];if(e)return e;var r=t.split("."),n=r.length;e=__global;for(var o=0;n>o;o++){var a=r[o];if(e=e[a],!e)return null}return i[t]=e,e}var i={};t.getDefinitionByName=e,t.cleanCache=function(){i={}}}(egret||(egret={}));var __global=this.__global||this,egret;!function(){}(egret||(egret={}));var egret;!function(t){function e(t){var e=typeof t;if(!t||"object"!=e&&!t.prototype)return e;var i=t.prototype?t.prototype:Object.getPrototypeOf(t);if(i.hasOwnProperty("__class__"))return i.__class__;var r=i.constructor.toString().trim(),n=r.indexOf("("),o=r.substring(9,n);return Object.defineProperty(i,"__class__",{value:o,enumerable:!1,writable:!0}),o}t.getQualifiedClassName=e}(egret||(egret={}));var egret;!function(t){function e(e){if(!e||"object"!=typeof e&&!e.prototype)return null;var i=e.prototype?e.prototype:Object.getPrototypeOf(e),r=Object.getPrototypeOf(i);if(!r)return null;var n=t.getQualifiedClassName(r.constructor);return n?n:null}t.getQualifiedSuperclassName=e}(egret||(egret={}));var egret;!function(t){function e(){return Date.now()-t.sys.$START_TIME}t.getTimer=e}(egret||(egret={}));var egret;!function(t){function e(e){var i=t.getDefinitionByName(e);return i?!0:!1}t.hasDefinition=e}(egret||(egret={}));var egret;!function(t){function e(t,e){if(!t||"object"!=typeof t)return!1;var i=Object.getPrototypeOf(t),r=i?i.__types__:null;return r?-1!==r.indexOf(e):!1}t.is=e}(egret||(egret={}));var egret;!function(t){function e(e,i){e||t.$error(1003,"callBack"),t.sys.$ticker.$startTick(e,i)}t.startTick=e}(egret||(egret={}));var egret;!function(t){function e(e,i){e||t.$error(1003,"callBack"),t.sys.$ticker.$stopTick(e,i)}t.stopTick=e}(egret||(egret={}));var egret;!function(t){function e(t){0>t&&(t=0),t>16777215&&(t=16777215);for(var e=t.toString(16).toUpperCase();e.length>6;)e=e.slice(1,e.length);for(;e.length<6;)e="0"+e;return"#"+e}t.toColorString=e}(egret||(egret={}));var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},egret;!function(t){var e;!function(e){var i=function(){function e(t){this.defaultVertexSrc="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec2 aColor;\nuniform vec2 projectionVector;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nconst vec2 center = vec2(-1.0, 1.0);\nvoid main(void) {\n   gl_Position = vec4( (aVertexPosition / projectionVector) + center , 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vColor = vec4(aColor.x, aColor.x, aColor.x, aColor.x);\n}",this.fragmentSrc="",this.gl=null,this.program=null,this.uniforms={projectionVector:{type:"2f",value:{x:0,y:0},dirty:!0}},this.gl=t}return e.prototype.init=function(){var e=this.gl,i=t.WebGLUtils.compileProgram(e,this.defaultVertexSrc,this.fragmentSrc);e.useProgram(i),this.aVertexPosition=e.getAttribLocation(i,"aVertexPosition"),this.aTextureCoord=e.getAttribLocation(i,"aTextureCoord"),this.colorAttribute=e.getAttribLocation(i,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aTextureCoord,this.colorAttribute];for(var r in this.uniforms)this.uniforms[r].uniformLocation=e.getUniformLocation(i,r);this.initUniforms(),this.program=i},e.prototype.initUniforms=function(){if(this.uniforms){var t,e=this.gl;for(var i in this.uniforms){t=this.uniforms[i],t.dirty=!0;var r=t.type;"mat2"===r||"mat3"===r||"mat4"===r?(t.glMatrix=!0,t.glValueLength=1,"mat2"===r?t.glFunc=e.uniformMatrix2fv:"mat3"===r?t.glFunc=e.uniformMatrix3fv:"mat4"===r&&(t.glFunc=e.uniformMatrix4fv)):(t.glFunc=e["uniform"+r],t.glValueLength="2f"===r||"2i"===r?2:"3f"===r||"3i"===r?3:"4f"===r||"4i"===r?4:1)}}},e.prototype.syncUniforms=function(){if(this.uniforms){var t,e=this.gl;for(var i in this.uniforms)t=this.uniforms[i],t.dirty&&(1===t.glValueLength?t.glMatrix===!0?t.glFunc.call(e,t.uniformLocation,t.transpose,t.value):t.glFunc.call(e,t.uniformLocation,t.value):2===t.glValueLength?t.glFunc.call(e,t.uniformLocation,t.value.x,t.value.y):3===t.glValueLength?t.glFunc.call(e,t.uniformLocation,t.value.x,t.value.y,t.value.z):4===t.glValueLength&&t.glFunc.call(e,t.uniformLocation,t.value.x,t.value.y,t.value.z,t.value.w),t.dirty=!1)}},e.prototype.setProjection=function(t,e){var i=this.uniforms.projectionVector;(i.value.x!=t||i.value.y!=e)&&(i.value.x=t,i.value.y=e,i.dirty=!0)},e.prototype.setAttribPointer=function(t){var e=this.gl;e.vertexAttribPointer(this.aVertexPosition,2,e.FLOAT,!1,t,0),e.vertexAttribPointer(this.aTextureCoord,2,e.FLOAT,!1,t,8),e.vertexAttribPointer(this.colorAttribute,1,e.FLOAT,!1,t,16)
},e}();e.EgretShader=i,__reflect(i.prototype,"egret.web.EgretShader")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.apply(this,arguments)||this;return e.fragmentSrc="precision lowp float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nuniform sampler2D uSampler;\nvoid main(void) {\ngl_FragColor = texture2D(uSampler, vTextureCoord) * vColor;\n}",e}return __extends(e,t),e}(t.EgretShader);t.TextureShader=e,__reflect(e.prototype,"egret.web.TextureShader")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i;!function(){function i(t){return window.localStorage.getItem(t)}function r(e,i){try{return window.localStorage.setItem(e,i),!0}catch(r){return t.$warn(1047,e,i),!1}}function n(t){window.localStorage.removeItem(t)}function o(){window.localStorage.clear()}e.getItem=i,e.setItem=r,e.removeItem=n,e.clear=o}(i=e.web||(e.web={}))}(e=t.localStorage||(t.localStorage={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(i){function r(){var t=i.call(this)||this;return t.loaded=!1,t}return __extends(r,i),Object.defineProperty(r.prototype,"length",{get:function(){if(this.originAudio)return this.originAudio.duration;throw new Error("sound not loaded!")},enumerable:!0,configurable:!0}),r.prototype.load=function(e){function i(){o(),l.indexOf("firefox")>=0&&(s.pause(),s.muted=!1),a.loaded=!0,a.dispatchEventWith(t.Event.COMPLETE)}function n(){o(),a.dispatchEventWith(t.IOErrorEvent.IO_ERROR)}function o(){s.removeEventListener("canplaythrough",i),s.removeEventListener("error",n)}var a=this;this.url=e,e||t.$error(3002);var s=new Audio(e);s.addEventListener("canplaythrough",i),s.addEventListener("error",n);var l=navigator.userAgent.toLowerCase();l.indexOf("firefox")>=0&&(s.autoplay=!0,s.muted=!0),s.load(),this.originAudio=s,r.$recycle(this.url,s)},r.prototype.play=function(i,n){i=+i||0,n=+n||0,0==this.loaded&&t.$error(1049);var o=r.$pop(this.url);null==o&&(o=this.originAudio.cloneNode()),o.autoplay=!0;var a=new e.HtmlSoundChannel(o);return a.$url=this.url,a.$loops=n,a.$startTime=i,a.$play(),t.sys.$pushSoundChannel(a),a},r.prototype.close=function(){0==this.loaded&&this.originAudio&&(this.originAudio.src=""),this.originAudio&&(this.originAudio=null),r.$clear(this.url)},r.$clear=function(t){var e=r.audios[t];e&&(e.length=0)},r.$pop=function(t){var e=r.audios[t];return e&&e.length>0?e.pop():null},r.$recycle=function(t,e){var i=r.audios[t];null==r.audios[t]&&(i=r.audios[t]=[]),i.push(e)},r}(t.EventDispatcher);i.MUSIC="music",i.EFFECT="effect",i.audios={},e.HtmlSound=i,__reflect(i.prototype,"egret.web.HtmlSound",["egret.Sound"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(i){function r(e){var r=i.call(this)||this;return r.$startTime=0,r.audio=null,r.isStopped=!1,r.canPlay=function(){r.audio.removeEventListener("canplay",r.canPlay);try{r.audio.currentTime=r.$startTime}catch(t){}finally{r.audio.play()}},r.onPlayEnd=function(){return 1==r.$loops?(r.stop(),void r.dispatchEventWith(t.Event.SOUND_COMPLETE)):(r.$loops>0&&r.$loops--,void r.$play())},r._volume=1,e.addEventListener("ended",r.onPlayEnd),r.audio=e,r}return __extends(r,i),r.prototype.$play=function(){if(this.isStopped)return void t.$error(1036);try{this.audio.volume=this._volume,this.audio.currentTime=this.$startTime}catch(e){return void this.audio.addEventListener("canplay",this.canPlay)}this.audio.play()},r.prototype.stop=function(){if(this.audio){this.isStopped||t.sys.$popSoundChannel(this),this.isStopped=!0;var i=this.audio;i.removeEventListener("ended",this.onPlayEnd),i.volume=0,this._volume=0,this.audio=null;var r=this.$url;window.setTimeout(function(){i.pause(),e.HtmlSound.$recycle(r,i)},200)}},Object.defineProperty(r.prototype,"volume",{get:function(){return this._volume},set:function(e){return this.isStopped?void t.$error(1036):(this._volume=e,void(this.audio&&(this.audio.volume=e)))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"position",{get:function(){return this.audio?this.audio.currentTime:0},enumerable:!0,configurable:!0}),r}(t.EventDispatcher);e.HtmlSoundChannel=i,__reflect(i.prototype,"egret.web.HtmlSoundChannel",["egret.SoundChannel","egret.IEventDispatcher"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(i){function r(){var t=i.call(this)||this;return t.loaded=!1,t}return __extends(r,i),r.prototype.load=function(i){var r=this;this.url=i,i||t.$error(3002),QZAppExternal.preloadSound(function(e){0==e.code?(r.loaded=!0,r.dispatchEventWith(t.Event.COMPLETE)):r.dispatchEventWith(t.IOErrorEvent.IO_ERROR)},{bid:-1,url:e.Html5Capatibility._QQRootPath+i,refresh:1})},Object.defineProperty(r.prototype,"length",{get:function(){throw new Error("qq sound not supported!")},enumerable:!0,configurable:!0}),r.prototype.play=function(i,r){i=+i||0,r=+r||0,0==this.loaded&&t.$error(1049);var n=new e.QQSoundChannel;return n.$url=this.url,n.$loops=r,n.$type=this.type,n.$startTime=i,n.$play(),t.sys.$pushSoundChannel(n),n},r.prototype.close=function(){},r}(t.EventDispatcher);i.MUSIC="music",i.EFFECT="effect",e.QQSound=i,__reflect(i.prototype,"egret.web.QQSound",["egret.Sound"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(){var i=e.call(this)||this;return i.$startTime=0,i.isStopped=!1,i.onPlayEnd=function(){return 1==i.$loops?(i.stop(),void i.dispatchEventWith(t.Event.SOUND_COMPLETE)):(i.$loops>0&&i.$loops--,void i.$play())},i._startTime=0,i}return __extends(i,e),i.prototype.$play=function(){if(this.isStopped)return void t.$error(1036);var e=this;this._startTime=Date.now();var i=0;i=e.$loops>0?e.$loops-1:-1,this.$type==t.Sound.EFFECT?QZAppExternal.playLocalSound(function(){},{bid:-1,url:e.$url,loop:i}):QZAppExternal.playLocalBackSound(function(){},{bid:-1,url:e.$url,loop:i})},i.prototype.stop=function(){this.$type==t.Sound.EFFECT?QZAppExternal.stopSound():QZAppExternal.stopBackSound(),this.isStopped||t.sys.$popSoundChannel(this),this.isStopped=!0},Object.defineProperty(i.prototype,"volume",{get:function(){return 1},set:function(){return this.isStopped?void t.$error(1036):void 0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return(Date.now()-this._startTime)/1e3},enumerable:!0,configurable:!0}),i}(t.EventDispatcher);e.QQSoundChannel=i,__reflect(i.prototype,"egret.web.QQSoundChannel",["egret.SoundChannel","egret.IEventDispatcher"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(){function t(){}return t.decodeAudios=function(){if(!(t.decodeArr.length<=0||t.isDecoding)){t.isDecoding=!0;var e=t.decodeArr.shift();t.ctx.decodeAudioData(e.buffer,function(i){e.self.audioBuffer=i,e.success&&e.success(),t.isDecoding=!1,t.decodeAudios()},function(){alert("sound decode error: "+e.url+"！\nsee http://edn.egret.com/cn/docs/page/156"),e.fail&&e.fail(),t.isDecoding=!1,t.decodeAudios()})}},t}();i.canUseWebAudio=window.AudioContext||window.webkitAudioContext||window.mozAudioContext,i.ctx=i.canUseWebAudio?new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext):void 0,i.decodeArr=[],i.isDecoding=!1,e.WebAudioDecode=i,__reflect(i.prototype,"egret.web.WebAudioDecode");var r=function(r){function n(){var t=r.call(this)||this;return t.loaded=!1,t}return __extends(n,r),Object.defineProperty(n.prototype,"length",{get:function(){if(this.audioBuffer)return this.audioBuffer.duration;throw new Error("sound not loaded!")},enumerable:!0,configurable:!0}),n.prototype.load=function(e){function r(){o.loaded=!0,o.dispatchEventWith(t.Event.COMPLETE)}function n(){o.dispatchEventWith(t.IOErrorEvent.IO_ERROR)}var o=this;this.url=e,e||t.$error(3002);var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=function(){i.decodeArr.push({buffer:a.response,success:r,fail:n,self:o,url:o.url}),i.decodeAudios()},a.send()},n.prototype.play=function(i,r){i=+i||0,r=+r||0,0==this.loaded&&t.$error(1049);var n=new e.WebAudioSoundChannel;return n.$url=this.url,n.$loops=r,n.$audioBuffer=this.audioBuffer,n.$startTime=i,n.$play(),t.sys.$pushSoundChannel(n),n},n.prototype.close=function(){},n}(t.EventDispatcher);r.MUSIC="music",r.EFFECT="effect",e.WebAudioSound=r,__reflect(r.prototype,"egret.web.WebAudioSound",["egret.Sound"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(i){function r(){var r=i.call(this)||this;return r.$startTime=0,r.bufferSource=null,r.context=e.WebAudioDecode.ctx,r.isStopped=!1,r._currentTime=0,r._volume=1,r.onPlayEnd=function(){return 1==r.$loops?(r.stop(),void r.dispatchEventWith(t.Event.SOUND_COMPLETE)):(r.$loops>0&&r.$loops--,void r.$play())},r._startTime=0,r.gain=r.context.createGain?r.context.createGain():r.context.createGainNode(),r}return __extends(r,i),r.prototype.$play=function(){if(this.isStopped)return void t.$error(1036);this.bufferSource&&(this.bufferSource.onended=null,this.bufferSource=null);var e=this.context,i=this.gain,r=e.createBufferSource();this.bufferSource=r,r.buffer=this.$audioBuffer,r.connect(i),i.connect(e.destination),r.onended=this.onPlayEnd,this._startTime=Date.now(),this.gain.gain.value=this._volume,r.start(0,this.$startTime),this._currentTime=0},r.prototype.stop=function(){if(this.bufferSource){var e=this.bufferSource;e.stop?e.stop(0):e.noteOff(0),this.bufferSource.disconnect(),this.bufferSource=null,this.$audioBuffer=null}this.isStopped||t.sys.$popSoundChannel(this),this.isStopped=!0},Object.defineProperty(r.prototype,"volume",{get:function(){return this._volume},set:function(e){return this.isStopped?void t.$error(1036):(this._volume=e,void(this.gain.gain.value=e))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"position",{get:function(){return this.bufferSource?(Date.now()-this._startTime)/1e3+this.$startTime:0},enumerable:!0,configurable:!0}),r}(t.EventDispatcher);e.WebAudioSoundChannel=i,__reflect(i.prototype,"egret.web.WebAudioSoundChannel",["egret.SoundChannel","egret.IEventDispatcher"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(i,r){void 0===r&&(r=!0);var n=e.call(this)||this;return n.loaded=!1,n.closed=!1,n.heightSet=0/0,n.widthSet=0/0,n.isPlayed=!1,n.screenChanged=function(){var e=!!n.video.webkitDisplayingFullscreen;e||(n.checkFullScreen(!1),t.Capabilities.isMobile||(n._fullscreen=e))},n._fullscreen=!0,n.onVideoLoaded=function(){n.video.removeEventListener("canplay",n.onVideoLoaded);var e=n.video;n.loaded=!0,n.posterData&&(n.posterData.width=n.getPlayWidth(),n.posterData.height=n.getPlayHeight()),e.width=e.videoWidth,e.height=e.videoHeight,n.$invalidateContentBounds(),window.setTimeout(function(){n.dispatchEventWith(t.Event.COMPLETE)},200)},n.$renderNode=new t.sys.BitmapNode,n.src=i,n.once(t.Event.ADDED_TO_STAGE,n.loadPoster,n),i&&n.load(),n}return __extends(i,e),i.prototype.load=function(e,i){var r=this;if(void 0===i&&(i=!0),e=e||this.src,this.src=e,e||t.$error(3002),!this.video||this.video.src!=e){var n;!this.video||t.Capabilities.isMobile?(n=document.createElement("video"),this.video=n,n.controls=null):n=this.video,n.src=e,n.setAttribute("autoplay","autoplay"),n.setAttribute("webkit-playsinline","true"),n.addEventListener("canplay",this.onVideoLoaded),n.addEventListener("error",function(){return r.onVideoError()}),n.addEventListener("ended",function(){return r.onVideoEnded()}),n.load(),n.play(),n.style.position="absolute",n.style.top="0px",n.style.zIndex="-88888",n.style.left="0px",n.height=1,n.width=1,window.setTimeout(function(){return n.pause()},170)}},i.prototype.play=function(e,i){var r=this;if(void 0===i&&(i=!1),0==this.loaded)return this.load(this.src),void this.once(t.Event.COMPLETE,function(){return r.play(e,i)},this);this.isPlayed=!0;var n=this.video;void 0!=e&&(n.currentTime=+e||0),n.loop=!!i,n.style.zIndex=t.Capabilities.isMobile?"-88888":"9999",n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.height=n.videoHeight,n.width=n.videoWidth,"Windows PC"!=t.Capabilities.os&&"Mac OS"!=t.Capabilities.os&&window.setTimeout(function(){n.width=0},1e3),this.checkFullScreen(this._fullscreen)},i.prototype.checkFullScreen=function(e){var i=this.video;if(e)null==i.parentElement&&(i.removeAttribute("webkit-playsinline"),document.body.appendChild(i)),t.stopTick(this.markDirty,this),this.goFullscreen();else if(null!=i.parentElement&&i.parentElement.removeChild(i),i.setAttribute("webkit-playsinline","true"),this.setFullScreenMonitor(!1),t.startTick(this.markDirty,this),t.Capabilities.isMobile)return this.video.currentTime=0,void this.onVideoEnded();i.play()},i.prototype.goFullscreen=function(){var e,i=this.video;return e=t.web.getPrefixStyleName("requestFullscreen",i),i[e]||(e=t.web.getPrefixStyleName("requestFullScreen",i),i[e])?(i.removeAttribute("webkit-playsinline"),i[e](),this.setFullScreenMonitor(!0),!0):!0},i.prototype.setFullScreenMonitor=function(t){var e=this.video;t?(e.addEventListener("mozfullscreenchange",this.screenChanged),e.addEventListener("webkitfullscreenchange",this.screenChanged),e.addEventListener("mozfullscreenerror",this.screenError),e.addEventListener("webkitfullscreenerror",this.screenError)):(e.removeEventListener("mozfullscreenchange",this.screenChanged),e.removeEventListener("webkitfullscreenchange",this.screenChanged),e.removeEventListener("mozfullscreenerror",this.screenError),e.removeEventListener("webkitfullscreenerror",this.screenError))},i.prototype.screenError=function(){t.$error(3014)},i.prototype.exitFullscreen=function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.oCancelFullScreen?document.oCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()},i.prototype.onVideoEnded=function(){this.pause(),this.isPlayed=!1,this.$invalidateContentBounds(),this.dispatchEventWith(t.Event.ENDED)},i.prototype.onVideoError=function(){this.dispatchEventWith(t.IOErrorEvent.IO_ERROR)},i.prototype.close=function(){var t=this;this.closed=!0,this.video.removeEventListener("canplay",this.onVideoLoaded),this.video.removeEventListener("error",function(){return t.onVideoError()}),this.video.removeEventListener("ended",function(){return t.onVideoEnded()}),this.pause(),0==this.loaded&&this.video&&(this.video.src=""),this.video&&this.video.parentElement&&(this.video.parentElement.removeChild(this.video),this.video=null),this.loaded=!1},i.prototype.pause=function(){this.video&&this.video.pause(),t.stopTick(this.markDirty,this),this.$invalidate()},Object.defineProperty(i.prototype,"volume",{get:function(){return this.video?this.video.volume:1},set:function(t){this.video&&(this.video.volume=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this.video?this.video.currentTime:0},set:function(t){this.video&&(this.video.currentTime=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fullscreen",{get:function(){return this._fullscreen},set:function(e){t.Capabilities.isMobile||(this._fullscreen=!!e,this.video&&0==this.video.paused&&this.checkFullScreen(this._fullscreen))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bitmapData",{get:function(){return this.video&&this.loaded?(this._bitmapData||(this.video.width=this.video.videoWidth,this.video.height=this.video.videoHeight,this._bitmapData=new t.BitmapData(this.video),this._bitmapData.$deleteSource=!1),this._bitmapData):null},enumerable:!0,configurable:!0}),i.prototype.loadPoster=function(){var e=this,i=this.poster;if(i){var r=new t.ImageLoader;r.once(t.Event.COMPLETE,function(){r.data,e.posterData=r.data,e.posterData.width=e.getPlayWidth(),e.posterData.height=e.getPlayHeight(),e.$invalidateContentBounds()},this),r.load(i)}},i.prototype.$measureContentBounds=function(t){var e=this.bitmapData,i=this.posterData;e?t.setTo(0,0,this.getPlayWidth(),this.getPlayHeight()):i?t.setTo(0,0,this.getPlayWidth(),this.getPlayHeight()):t.setEmpty()},i.prototype.getPlayWidth=function(){return isNaN(this.widthSet)?this.bitmapData?this.bitmapData.width:this.posterData?this.posterData.width:0/0:this.widthSet},i.prototype.getPlayHeight=function(){return isNaN(this.heightSet)?this.bitmapData?this.bitmapData.height:this.posterData?this.posterData.height:0/0:this.heightSet},i.prototype.$render=function(){var e=this.$renderNode,i=this.bitmapData,r=this.posterData,n=this.getPlayWidth(),o=this.getPlayHeight();this.isPlayed&&!t.Capabilities.isMobile||!r?this.isPlayed&&i&&(e.image=i,e.imageWidth=i.width,e.imageHeight=i.height,t.WebGLUtils.deleteWebGLTexture(i.webGLTexture),i.webGLTexture=null,e.drawImage(0,0,i.width,i.height,0,0,n,o)):(e.image=r,e.imageWidth=n,e.imageHeight=o,e.drawImage(0,0,r.width,r.height,0,0,n,o))},i.prototype.markDirty=function(){return this.$invalidate(),!0},i.prototype.$setHeight=function(t){return this.heightSet=+t||0,this.$invalidate(),this.$invalidateContentBounds(),e.prototype.$setHeight.call(this,t)},i.prototype.$setWidth=function(t){return this.widthSet=+t||0,this.$invalidate(),this.$invalidateContentBounds(),e.prototype.$setWidth.call(this,t)},Object.defineProperty(i.prototype,"paused",{get:function(){return this.video?this.video.paused:!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"length",{get:function(){if(this.video)return this.video.duration;throw new Error("Video not loaded!")},enumerable:!0,configurable:!0}),i}(t.DisplayObject);e.WebVideo=i,__reflect(i.prototype,"egret.web.WebVideo",["egret.Video"]),t.Video=i}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(){var t=e.call(this)||this;return t._url="",t._method="",t}return __extends(i,e),Object.defineProperty(i.prototype,"response",{get:function(){if(!this._xhr)return null;if(void 0!=this._xhr.response)return this._xhr.response;if("text"==this._responseType)return this._xhr.responseText;if("arraybuffer"==this._responseType&&/msie 9.0/i.test(navigator.userAgent)){var t=window;return t.convertResponseBodyToText(this._xhr.responseBody)}return"document"==this._responseType?this._xhr.responseXML:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"responseType",{get:function(){return this._responseType},set:function(t){this._responseType=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"withCredentials",{get:function(){return this._withCredentials},set:function(t){this._withCredentials=t},enumerable:!0,configurable:!0}),i.prototype.getXHR=function(){return window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP")},i.prototype.open=function(t,e){void 0===e&&(e="GET"),this._url=t,this._method=e,this._xhr&&(this._xhr.abort(),this._xhr=null),this._xhr=this.getXHR(),this._xhr.onreadystatechange=this.onReadyStateChange.bind(this),this._xhr.onprogress=this.updateProgress.bind(this),this._xhr.open(this._method,this._url,!0)},i.prototype.send=function(t){if(null!=this._responseType&&(this._xhr.responseType=this._responseType),null!=this._withCredentials&&(this._xhr.withCredentials=this._withCredentials),this.headerObj)for(var e in this.headerObj)this._xhr.setRequestHeader(e,this.headerObj[e]);this._xhr.send(t)},i.prototype.abort=function(){this._xhr&&this._xhr.abort()},i.prototype.getAllResponseHeaders=function(){if(!this._xhr)return null;var t=this._xhr.getAllResponseHeaders();return t?t:""},i.prototype.setRequestHeader=function(t,e){this.headerObj||(this.headerObj={}),this.headerObj[t]=e},i.prototype.getResponseHeader=function(t){if(!this._xhr)return null;var e=this._xhr.getResponseHeader(t);return e?e:""},i.prototype.onReadyStateChange=function(){var e=this._xhr;if(4==e.readyState){var i=e.status>=400||0==e.status,r=this._url,n=this;window.setTimeout(function(){i?(n.hasEventListener(t.IOErrorEvent.IO_ERROR)||t.$error(1011,r),n.dispatchEventWith(t.IOErrorEvent.IO_ERROR)):n.dispatchEventWith(t.Event.COMPLETE)},0)}},i.prototype.updateProgress=function(e){e.lengthComputable&&t.ProgressEvent.dispatchProgressEvent(this,t.ProgressEvent.PROGRESS,e.loaded,e.total)},i}(t.EventDispatcher);e.WebHttpRequest=i,__reflect(i.prototype,"egret.web.WebHttpRequest",["egret.HttpRequest"]),t.HttpRequest=i,t.$markReadOnly(i,"response")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=window.URL||window.webkitURL,r=function(r){function n(){var t=r.apply(this,arguments)||this;return t.data=null,t._crossOrigin=null,t._hasCrossOriginSet=!1,t.currentImage=null,t.request=null,t}return __extends(n,r),Object.defineProperty(n.prototype,"crossOrigin",{get:function(){return this._crossOrigin},set:function(t){this._hasCrossOriginSet=!0,this._crossOrigin=t},enumerable:!0,configurable:!0}),n.prototype.load=function(i){if(e.Html5Capatibility._canUseBlob&&0!=i.indexOf("wxLocalResource:")&&0!=i.indexOf("data:")&&0!=i.indexOf("http:")&&0!=i.indexOf("https:")){var r=this.request;r||(r=this.request=new t.web.WebHttpRequest,r.addEventListener(t.Event.COMPLETE,this.onBlobLoaded,this),r.addEventListener(t.IOErrorEvent.IO_ERROR,this.onBlobError,this),r.responseType="blob"),this.currentURL=i,r.open(i),r.send()}else this.loadImage(i)},n.prototype.onBlobLoaded=function(){var t=this.request.response;this.loadImage(i.createObjectURL(t))},n.prototype.onBlobError=function(){this.dispatchIOError(this.currentURL)},n.prototype.loadImage=function(t){var e=new Image;this.data=null,this.currentImage=e,this._hasCrossOriginSet?this._crossOrigin&&(e.crossOrigin=this._crossOrigin):n.crossOrigin&&(e.crossOrigin=n.crossOrigin),e.onload=this.onImageComplete.bind(this),e.onerror=this.onLoadError.bind(this),e.src=t},n.prototype.onImageComplete=function(e){var i=this.getImage(e);if(i){this.data=new t.BitmapData(i);var r=this;window.setTimeout(function(){r.dispatchEventWith(t.Event.COMPLETE)},0)}},n.prototype.onLoadError=function(t){var e=this.getImage(t);e&&this.dispatchIOError(e.src)},n.prototype.dispatchIOError=function(e){var i=this;window.setTimeout(function(){i.hasEventListener(t.IOErrorEvent.IO_ERROR)||t.$error(1011,e),i.dispatchEventWith(t.IOErrorEvent.IO_ERROR)},0)},n.prototype.getImage=function(e){var r=e.target,n=r.src;if(0==n.indexOf("blob:"))try{i.revokeObjectURL(r.src)}catch(o){t.$warn(1037)}return r.onerror=null,r.onload=null,this.currentImage!==r?null:(this.currentImage=null,r)},n}(t.EventDispatcher);r.crossOrigin=null,e.WebImageLoader=r,__reflect(r.prototype,"egret.web.WebImageLoader",["egret.ImageLoader"]),t.ImageLoader=r}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(i){function r(){var t=i.call(this)||this;return t._isNeedShow=!1,t.inputElement=null,t.inputDiv=null,t._gscaleX=0,t._gscaleY=0,t._isNeesHide=!1,t.textValue="",t.colorValue=16777215,t._styleInfoes={},t}return __extends(r,i),r.prototype.$setTextField=function(t){return this.$textfield=t,!0},r.prototype.$addToStage=function(){this.htmlInput=t.web.$getTextAdapter(this.$textfield)},r.prototype._initElement=function(){var e=this.$textfield.localToGlobal(0,0),i=e.x,r=e.y,n=this.htmlInput.$scaleX,o=this.htmlInput.$scaleY;this.inputDiv.style.left=i*n+"px",this.inputDiv.style.top=r*o+"px",this.$textfield.multiline&&this.$textfield.height>this.$textfield.size?(this.inputDiv.style.top=r*o+"px",this.inputElement.style.top=-this.$textfield.lineSpacing/2*o+"px"):(this.inputDiv.style.top=r*o+"px",this.inputElement.style.top="0px");for(var a=this.$textfield,s=1,l=1,h=0;a.parent;)s*=a.scaleX,l*=a.scaleY,h+=a.rotation,a=a.parent;var u=t.web.getPrefixStyleName("transform");this.inputDiv.style[u]="rotate("+h+"deg)",this._gscaleX=n*s,this._gscaleY=o*l},r.prototype.$show=function(){this.htmlInput.isCurrentStageText(this)?this.inputElement.onblur=null:(this.inputElement=this.htmlInput.getInputElement(this),this.inputElement.type=this.$textfield.multiline?"text":this.$textfield.inputType,this.inputDiv=this.htmlInput._inputDIV),this.htmlInput._needShow=!0,this._isNeedShow=!0,this._initElement()},r.prototype.onBlurHandler=function(){this.htmlInput.clearInputElement(),window.scrollTo(0,0)},r.prototype.executeShow=function(){this.inputElement.value=this.$getText(),null==this.inputElement.onblur&&(this.inputElement.onblur=this.onBlurHandler.bind(this)),this.$resetStageText(),this.$textfield.maxChars>0?this.inputElement.setAttribute("maxlength",this.$textfield.maxChars):this.inputElement.removeAttribute("maxlength"),this.inputElement.selectionStart=this.inputElement.value.length,this.inputElement.selectionEnd=this.inputElement.value.length,this.inputElement.focus()},r.prototype.$hide=function(){this._isNeesHide=!0,this.htmlInput&&t.web.Html5Capatibility._System_OS==t.web.SystemOSType.IOS&&this.htmlInput.disconnectStageText(this)},r.prototype.$getText=function(){return this.textValue||(this.textValue=""),this.textValue},r.prototype.$setText=function(t){return this.textValue=t,this.resetText(),!0},r.prototype.resetText=function(){this.inputElement&&(this.inputElement.value=this.textValue)},r.prototype.$setColor=function(t){return this.colorValue=t,this.resetColor(),!0},r.prototype.resetColor=function(){this.inputElement&&this.setElementStyle("color",t.toColorString(this.colorValue))},r.prototype.$onBlur=function(){e.Html5Capatibility._System_OS==e.SystemOSType.WPHONE&&t.Event.dispatchEvent(this,"updateText",!1)},r.prototype._onInput=function(){var i=this;if(e.Html5Capatibility._System_OS==e.SystemOSType.WPHONE){var r=this.$textfield.$TextField;null==r[35]&&null==r[36]?(i.textValue=i.inputElement.value,t.Event.dispatchEvent(i,"updateText",!1)):window.setTimeout(function(){i.inputElement&&i.inputElement.selectionStart&&i.inputElement.selectionEnd&&i.inputElement.selectionStart==i.inputElement.selectionEnd&&(i.textValue=i.inputElement.value,t.Event.dispatchEvent(i,"updateText",!1))},0)}else window.setTimeout(function(){i.inputElement&&i.inputElement.selectionStart==i.inputElement.selectionEnd&&(i.textValue=i.inputElement.value,t.Event.dispatchEvent(i,"updateText",!1))},0)},r.prototype.setAreaHeight=function(){var e=this.$textfield;if(e.multiline){var i=t.TextFieldUtils.$getTextHeight(e);if(e.height<=e.size)this.setElementStyle("height",e.size*this._gscaleY+"px"),this.setElementStyle("padding","0px"),this.setElementStyle("lineHeight",e.size*this._gscaleY+"px");else if(e.height<i)this.setElementStyle("height",e.height*this._gscaleY+"px"),this.setElementStyle("padding","0px"),this.setElementStyle("lineHeight",(e.size+e.lineSpacing)*this._gscaleY+"px");else{this.setElementStyle("height",(i+e.lineSpacing)*this._gscaleY+"px");var r=(e.height-i)*this._gscaleY,n=t.TextFieldUtils.$getValign(e),o=r*n,a=r-o;this.setElementStyle("padding",o+"px 0px "+a+"px 0px"),this.setElementStyle("lineHeight",(e.size+e.lineSpacing)*this._gscaleY+"px")}}},r.prototype._onClickHandler=function(e){this._isNeedShow&&(e.stopImmediatePropagation(),this._isNeedShow=!1,this.executeShow(),this.dispatchEvent(new t.Event("focus")))},r.prototype._onDisconnect=function(){this.inputElement=null,this.dispatchEvent(new t.Event("blur"))},r.prototype.setElementStyle=function(t,e){this.inputElement&&this._styleInfoes[t]!=e&&(this.inputElement.style[t]=e)},r.prototype.$removeFromStage=function(){this.inputElement&&this.htmlInput.disconnectStageText(this)},r.prototype.$resetStageText=function(){if(this.inputElement){var e=this.$textfield;this.setElementStyle("fontFamily",e.fontFamily),this.setElementStyle("fontStyle",e.italic?"italic":"normal"),this.setElementStyle("fontWeight",e.bold?"bold":"normal"),this.setElementStyle("textAlign",e.textAlign),this.setElementStyle("fontSize",e.size*this._gscaleY+"px"),this.setElementStyle("color",t.toColorString(e.textColor));var i=void 0;if(e.stage?(i=e.localToGlobal(0,0).x,i=Math.min(e.width,e.stage.stageWidth-i)):i=e.width,this.setElementStyle("width",i*this._gscaleX+"px"),this.setElementStyle("verticalAlign",e.verticalAlign),e.multiline)this.setAreaHeight();else if(this.setElementStyle("lineHeight",e.size*this._gscaleY+"px"),e.height<e.size){this.setElementStyle("height",e.size*this._gscaleY+"px");var r=e.size/2*this._gscaleY;this.setElementStyle("padding","0px 0px "+r+"px 0px")}else{this.setElementStyle("height",e.size*this._gscaleY+"px");var n=(e.height-e.size)*this._gscaleY,o=t.TextFieldUtils.$getValign(e),a=n*o,r=n-a;r<e.size/2*this._gscaleY&&(r=e.size/2*this._gscaleY),this.setElementStyle("padding",a+"px 0px "+r+"px 0px")}this.inputDiv.style.clip="rect(0px "+e.width*this._gscaleX+"px "+e.height*this._gscaleY+"px 0px)",this.inputDiv.style.height=e.height*this._gscaleY+"px",this.inputDiv.style.width=i*this._gscaleX+"px"}},r}(t.EventDispatcher);e.HTML5StageText=i,__reflect(i.prototype,"egret.web.HTML5StageText",["egret.StageText"]),t.StageText=i}(e=t.web||(t.web={}))}(egret||(egret={})),function(t){var e;!function(e){var i=function(){function e(){this._needShow=!1,this.$scaleX=1,this.$scaleY=1}return e.prototype.isInputOn=function(){return null!=this._stageText},e.prototype.isCurrentStageText=function(t){return this._stageText==t},e.prototype.initValue=function(t){t.style.position="absolute",t.style.left="0px",t.style.top="0px",t.style.border="none",t.style.padding="0"},e.prototype.$updateSize=function(){if(this.canvas){var e=this.canvas.width,i=this.canvas.height,r=this.canvas.style.width.split("px")[0],n=this.canvas.style.height.split("px")[0];this.$scaleX=r/e,this.$scaleY=n/i,this.StageDelegateDiv.style.left=this.canvas.style.left,this.StageDelegateDiv.style.top=this.canvas.style.top;var o=t.web.getPrefixStyleName("transform");this.StageDelegateDiv.style[o]=this.canvas.style[o],this.StageDelegateDiv.style[t.web.getPrefixStyleName("transformOrigin")]="0% 0% 0px"}},e.prototype._initStageDelegateDiv=function(e,i){this.canvas=i;var r,n=this;r||(r=document.createElement("div"),this.StageDelegateDiv=r,r.id="StageDelegateDiv",e.appendChild(r),n.initValue(r),n._inputDIV=document.createElement("div"),n.initValue(n._inputDIV),n._inputDIV.style.width="0px",n._inputDIV.style.height="0px",n._inputDIV.style.left="0px",n._inputDIV.style.top="-100px",n._inputDIV.style[t.web.getPrefixStyleName("transformOrigin")]="0% 0% 0px",r.appendChild(n._inputDIV),this.canvas.addEventListener("click",function(t){n._needShow?(n._needShow=!1,n._stageText._onClickHandler(t),n.show()):n._inputElement&&(n.clearInputElement(),n._inputElement.blur(),n._inputElement=null)}),n.initInputElement(!0),n.initInputElement(!1))},e.prototype.initInputElement=function(t){var e,i=this;t?(e=document.createElement("textarea"),e.style.resize="none",i._multiElement=e,e.id="egretTextarea"):(e=document.createElement("input"),i._simpleElement=e,e.id="egretInput"),e.type="text",i._inputDIV.appendChild(e),e.setAttribute("tabindex","-1"),e.style.width="1px",e.style.height="12px",i.initValue(e),e.style.outline="thin",e.style.background="none",e.style.overflow="hidden",e.style.wordBreak="break-all",e.style.opacity=0,e.oninput=function(){i._stageText&&i._stageText._onInput()}},e.prototype.show=function(){var e=this,i=e._inputElement;t.$callAsync(function(){i.style.opacity=1},e)},e.prototype.disconnectStageText=function(t){(null==this._stageText||this._stageText==t)&&(this.clearInputElement(),this._inputElement&&this._inputElement.blur())},e.prototype.clearInputElement=function(){var t=this;if(t._inputElement){t._inputElement.value="",t._inputElement.onblur=null,t._inputElement.style.width="1px",t._inputElement.style.height="12px",t._inputElement.style.left="0px",t._inputElement.style.top="0px",t._inputElement.style.opacity=0;var e=void 0;e=t._simpleElement==t._inputElement?t._multiElement:t._simpleElement,e.style.display="block",t._inputDIV.style.left="0px",t._inputDIV.style.top="-100px",t._inputDIV.style.height="0px",t._inputDIV.style.width="0px"}t._stageText&&(t._stageText._onDisconnect(),t._stageText=null,this.canvas.userTyping=!1)
},e.prototype.getInputElement=function(t){var e=this;e.clearInputElement(),e._stageText=t,this.canvas.userTyping=!0,e._inputElement=e._stageText.$textfield.multiline?e._multiElement:e._simpleElement;var i;return i=e._simpleElement==e._inputElement?e._multiElement:e._simpleElement,i.style.display="none",e._inputElement},e}();e.HTMLInput=i,__reflect(i.prototype,"egret.web.HTMLInput")}(e=t.web||(t.web={}))}(egret||(egret={})),function(t){var e;!function(t){function e(t){var e=t.stage?t.stage.$hashCode:0,i=r[e],a=n[e],s=o[e];return a&&s&&(delete n[e],delete o[e]),i}function i(t,e,i,a){t._initStageDelegateDiv(i,a),r[e.$hashCode]=t,n[e.$hashCode]=a,o[e.$hashCode]=i}var r={},n={},o={};t.$getTextAdapter=e,t.$cacheTextAdapter=i}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(){function e(t,e,n,o,a){r||i();var s="";return a&&(s+="italic "),o&&(s+="bold "),s+=(n||12)+"px ",s+=e||"Arial",r.font=s,r.measureText(t).width}function i(){r=t.sys.canvasHitTestBuffer.context,r.textAlign="left",r.textBaseline="middle"}var r=null;t.sys.measureText=e}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){function e(t,e){var i=document.createElement("canvas");isNaN(t)||isNaN(e)||(i.width=t,i.height=e);var r=i.getContext("2d");if(void 0===r.imageSmoothingEnabled){for(var n,o=["webkitImageSmoothingEnabled","mozImageSmoothingEnabled","msImageSmoothingEnabled"],a=o.length-1;a>=0&&(n=o[a],void 0===r[n]);a--);try{Object.defineProperty(r,"imageSmoothingEnabled",{get:function(){return this[n]},set:function(t){this[n]=t}})}catch(s){r.imageSmoothingEnabled=r[n]}}return i}var i,r=function(){function t(t,i){this.surface=e(t,i),this.context=this.surface.getContext("2d")}return Object.defineProperty(t.prototype,"width",{get:function(){return this.surface.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.surface.height},enumerable:!0,configurable:!0}),t.prototype.resize=function(t,e,i){var r=this.surface;if(i){var n=!1;r.width<t&&(r.width=t,n=!0),r.height<e&&(r.height=e,n=!0),n||(this.context.globalCompositeOperation="source-over",this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1)}else r.width!=t&&(r.width=t),r.height!=e&&(r.height=e);this.clear()},t.prototype.resizeTo=function(t,r,n,o){i||(i=e());var a=(this.context,this.surface),s=i,l=s.getContext("2d");i=a,this.context=l,this.surface=s,s.width=Math.max(t,257),s.height=Math.max(r,257),l.setTransform(1,0,0,1,0,0),l.drawImage(a,n,o),a.height=1,a.width=1},t.prototype.setDirtyRegionPolicy=function(){},t.prototype.beginClip=function(t,e,i){e=+e||0,i=+i||0;var r=this.context;r.save(),r.beginPath(),r.setTransform(1,0,0,1,e,i);for(var n=t.length,o=0;n>o;o++){var a=t[o];r.clearRect(a.minX,a.minY,a.width,a.height),r.rect(a.minX,a.minY,a.width,a.height)}r.clip()},t.prototype.endClip=function(){this.context.restore()},t.prototype.getPixels=function(t,e,i,r){return void 0===i&&(i=1),void 0===r&&(r=1),this.context.getImageData(t,e,i,r).data},t.prototype.toDataURL=function(t,e){return this.surface.toDataURL(t,e)},t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.surface.width,this.surface.height)},t.prototype.destroy=function(){this.surface.width=this.surface.height=0},t}();t.CanvasRenderBuffer=r,__reflect(r.prototype,"egret.web.CanvasRenderBuffer",["egret.sys.RenderBuffer"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(i,r){var n=e.call(this)||this;return n.onTouchBegin=function(t){var e=n.getLocation(t);n.touch.onTouchBegin(e.x,e.y,t.identifier)},n.onTouchMove=function(t){var e=n.getLocation(t);n.touch.onTouchMove(e.x,e.y,t.identifier)},n.onTouchEnd=function(t){var e=n.getLocation(t);n.touch.onTouchEnd(e.x,e.y,t.identifier)},n.scaleX=1,n.scaleY=1,n.rotation=0,n.canvas=r,n.touch=new t.sys.TouchHandler(i),n.addListeners(),n}return __extends(i,e),i.prototype.addListeners=function(){var e=this;window.navigator.msPointerEnabled?(this.canvas.addEventListener("MSPointerDown",function(t){t.identifier=t.pointerId,e.onTouchBegin(t),e.prevent(t)},!1),this.canvas.addEventListener("MSPointerMove",function(t){t.identifier=t.pointerId,e.onTouchMove(t),e.prevent(t)},!1),this.canvas.addEventListener("MSPointerUp",function(t){t.identifier=t.pointerId,e.onTouchEnd(t),e.prevent(t)},!1)):(t.Capabilities.$isMobile||this.addMouseListener(),this.addTouchListener())},i.prototype.addMouseListener=function(){this.canvas.addEventListener("mousedown",this.onTouchBegin),this.canvas.addEventListener("mousemove",this.onTouchMove),this.canvas.addEventListener("mouseup",this.onTouchEnd)},i.prototype.addTouchListener=function(){var t=this;this.canvas.addEventListener("touchstart",function(e){for(var i=e.changedTouches.length,r=0;i>r;r++)t.onTouchBegin(e.changedTouches[r]);t.prevent(e)},!1),this.canvas.addEventListener("touchmove",function(e){for(var i=e.changedTouches.length,r=0;i>r;r++)t.onTouchMove(e.changedTouches[r]);t.prevent(e)},!1),this.canvas.addEventListener("touchend",function(e){for(var i=e.changedTouches.length,r=0;i>r;r++)t.onTouchEnd(e.changedTouches[r]);t.prevent(e)},!1),this.canvas.addEventListener("touchcancel",function(e){for(var i=e.changedTouches.length,r=0;i>r;r++)t.onTouchEnd(e.changedTouches[r]);t.prevent(e)},!1)},i.prototype.prevent=function(t){t.stopPropagation(),1==t.isScroll||this.canvas.userTyping||t.preventDefault()},i.prototype.getLocation=function(e){e.identifier=+e.identifier||0;var i=document.documentElement,r=this.canvas.getBoundingClientRect(),n=r.left+window.pageXOffset-i.clientLeft,o=r.top+window.pageYOffset-i.clientTop,a=e.pageX-n,s=a,l=e.pageY-o,h=l;return 90==this.rotation?(s=l,h=r.width-a):-90==this.rotation&&(s=r.height-l,h=a),s/=this.scaleX,h/=this.scaleY,t.$TempPoint.setTo(Math.round(s),Math.round(h))},i.prototype.updateScaleMode=function(t,e,i){this.scaleX=t,this.scaleY=e,this.rotation=i},i.prototype.$updateMaxTouches=function(){this.touch.$initMaxTouches()},i}(t.HashObject);e.WebTouchHandler=i,__reflect(i.prototype,"egret.web.WebTouchHandler")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(t){var i=e.call(this)||this;return i.isActivate=!0,i.stage=t,i.registerListener(),i}return __extends(i,e),i.prototype.registerListener=function(){var e=this,i=function(){e.isActivate&&(e.isActivate=!1,e.stage.dispatchEvent(new t.Event(t.Event.DEACTIVATE)))},r=function(){e.isActivate||(e.isActivate=!0,e.stage.dispatchEvent(new t.Event(t.Event.ACTIVATE)))},n=function(){document[o]?i():r()};window.addEventListener("focus",r,!1),window.addEventListener("blur",i,!1);var o,a;"undefined"!=typeof document.hidden?(o="hidden",a="visibilitychange"):"undefined"!=typeof document.mozHidden?(o="mozHidden",a="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(o="msHidden",a="msvisibilitychange"):"undefined"!=typeof document.webkitHidden?(o="webkitHidden",a="webkitvisibilitychange"):"undefined"!=typeof document.oHidden&&(o="oHidden",a="ovisibilitychange"),"onpageshow"in window&&"onpagehide"in window&&(window.addEventListener("pageshow",r,!1),window.addEventListener("pagehide",i,!1)),o&&a&&document.addEventListener(a,n,!1);var s=navigator.userAgent,l=/micromessenger/gi.test(s),h=/mqq/gi.test(s),u=/mobile.*qq/gi.test(s);if((u||l)&&(h=!1),h){var c=window.browser||{};c.execWebFn=c.execWebFn||{},c.execWebFn.postX5GamePlayerMessage=function(t){var e=t.type;"app_enter_background"==e?i():"app_enter_foreground"==e&&r()},window.browser=c}},i}(t.HashObject);e.WebHideHandler=i,__reflect(i.prototype,"egret.web.WebHideHandler")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function i(t,e){var i="";if(null!=e)i=r(t,e);else{if(null==s){var n=document.createElement("div").style;s=r("transform",n)}i=s}return""==i?t:i+t.charAt(0).toUpperCase()+t.substring(1,t.length)}function r(t,e){if(t in e)return"";t=t.charAt(0).toUpperCase()+t.substring(1,t.length);for(var i=["webkit","ms","Moz","O"],r=0;r<i.length;r++){var n=i[r]+t;if(n in e)return i[r]}return""}var n=function(){function t(){}return t}();n.QQ_AUDIO=1,n.WEB_AUDIO=2,n.HTML5_AUDIO=3,e.AudioType=n,__reflect(n.prototype,"egret.web.AudioType");var o=function(){function t(){}return t}();o.WPHONE=1,o.IOS=2,o.ADNROID=3,e.SystemOSType=o,__reflect(o.prototype,"egret.web.SystemOSType");var a=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.$init=function(){var e=navigator.userAgent.toLowerCase();i.ua=e,t.Capabilities.$isMobile=-1!=e.indexOf("mobile")||-1!=e.indexOf("android"),i._canUseBlob=!1;var r,a=i._audioType,s=window.AudioContext||window.webkitAudioContext||window.mozAudioContext;if(1==a||2==a||3==a?(r=!1,i.setAudioType(a)):(r=!0,i.setAudioType(n.HTML5_AUDIO)),e.indexOf("windows phone")>=0)i._System_OS=o.WPHONE,t.Capabilities.$os="Windows Phone";else if(e.indexOf("android")>=0){if(t.Capabilities.$os="Android",i._System_OS=o.ADNROID,r&&i.setAudioType(s?n.WEB_AUDIO:n.HTML5_AUDIO),window.hasOwnProperty("QZAppExternal")&&e.indexOf("qzone")>=0){r&&i.setAudioType(n.QQ_AUDIO);var l=document.getElementsByTagName("base");if(l&&l.length>0)i._QQRootPath=l[0].baseURI;else{var h=window.location.href.indexOf("?");-1==h&&(h=window.location.href.length);var u=window.location.href.substring(0,h);u=u.substring(0,u.lastIndexOf("/")),i._QQRootPath=u+"/"}}}else e.indexOf("iphone")>=0||e.indexOf("ipad")>=0||e.indexOf("ipod")>=0?(t.Capabilities.$os="iOS",i._System_OS=o.IOS,i.getIOSVersion()>=7&&(i._canUseBlob=!0,r&&i.setAudioType(n.WEB_AUDIO))):-1!=e.indexOf("windows nt")?t.Capabilities.$os="Windows PC":-1!=e.indexOf("mac os")&&(t.Capabilities.$os="Mac OS");var c=window.URL||window.webkitURL;c||(i._canUseBlob=!1),t.Sound=i._AudioClass},i.setAudioType=function(e){switch(i._audioType=e,e){case n.QQ_AUDIO:i._AudioClass=t.web.QQSound;break;case n.WEB_AUDIO:i._AudioClass=t.web.WebAudioSound;break;case n.HTML5_AUDIO:i._AudioClass=t.web.HtmlSound}},i.getIOSVersion=function(){var t=i.ua.toLowerCase().match(/cpu [^\d]*\d.*like mac os x/)[0];return parseInt(t.match(/\d+(_\d)*/)[0])||0},i.checkHtml5Support=function(){var e=(navigator.language||navigator.browserLanguage).toLowerCase(),i=e.split("-");i.length>1&&(i[1]=i[1].toUpperCase()),t.Capabilities.$language=i.join("-")},i}(t.HashObject);a._canUseBlob=!1,a._audioType=0,a._QQRootPath="",a._System_OS=0,a.ua="",e.Html5Capatibility=a,__reflect(a.prototype,"egret.web.Html5Capatibility");var s=null;e.getPrefixStyleName=i,e.getPrefix=r}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function i(){if(s)for(var t=document.querySelectorAll(".egret-player"),e=t.length,i=0;e>i;i++){var r=t[i],n=r["egret-player"];n.updateScreenSize()}}function r(i){if(!s){if(s=!0,i||(i={}),e.Html5Capatibility._audioType=i.audioType,e.Html5Capatibility.$init(),"webgl"==i.renderMode){var r=i.antialias;e.WebGLRenderContext.antialias=!!r}t.sys.CanvasRenderBuffer=e.CanvasRenderBuffer,n(i.renderMode);var a=t.sys.$ticker;o(a),i.screenAdapter?t.sys.screenAdapter=i.screenAdapter:t.sys.screenAdapter||(t.sys.screenAdapter=new t.sys.DefaultScreenAdapter);for(var l=document.querySelectorAll(".egret-player"),h=l.length,u=0;h>u;u++){var c=l[u],p=new e.WebPlayer(c,i);c["egret-player"]=p,"webgl"==t.Capabilities.$renderMode&&(p.stage.dirtyRegionPolicy=t.DirtyRegionPolicy.OFF)}"webgl"==t.Capabilities.$renderMode&&(t.sys.DisplayList.prototype.setDirtyRegionPolicy=function(){})}}function n(i){"webgl"==i&&t.WebGLUtils.checkCanUseWebGL()?(t.sys.RenderBuffer=e.WebGLRenderBuffer,t.sys.systemRenderer=new e.WebGLRenderer,t.sys.canvasRenderer=new t.CanvasRenderer,t.sys.customHitTestBuffer=new e.WebGLRenderBuffer(3,3),t.sys.canvasHitTestBuffer=new e.CanvasRenderBuffer(3,3),t.Capabilities.$renderMode="webgl"):(t.sys.RenderBuffer=e.CanvasRenderBuffer,t.sys.systemRenderer=new t.CanvasRenderer,t.sys.canvasRenderer=t.sys.systemRenderer,t.sys.customHitTestBuffer=new e.CanvasRenderBuffer(3,3),t.sys.canvasHitTestBuffer=t.sys.customHitTestBuffer,t.Capabilities.$renderMode="canvas")}function o(t){function e(){t.update(),i.call(window,e)}var i=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;i||(i=function(t){return window.setTimeout(t,1e3/60)}),i.call(window,e)}function a(){l=0/0,t.updateAllScreens()}var s=!1;window.isNaN=function(t){return t=+t,t!==t},t.runEgret=r,t.updateAllScreens=i;var l=0/0;window.addEventListener("resize",function(){isNaN(l)&&(l=window.setTimeout(a,300))})}(e=t.web||(t.web={}))}(egret||(egret={}));var language=navigator.language||navigator.browserLanguage||"en_US";language=language.replace("-","_"),language in egret.$locale_strings&&(egret.$language=language);var egret;!function(t){var e;!function(e){var i=function(){function e(){}return e.detect=function(){var i=t.Capabilities,r=navigator.userAgent.toLowerCase();i.$isMobile=-1!=r.indexOf("mobile")||-1!=r.indexOf("android"),i.$isMobile?r.indexOf("windows")<0&&(-1!=r.indexOf("iphone")||-1!=r.indexOf("ipad")||-1!=r.indexOf("ipod"))?i.$os="iOS":-1!=r.indexOf("android")&&-1!=r.indexOf("linux")?i.$os="Android":-1!=r.indexOf("windows")&&(i.$os="Windows Phone"):-1!=r.indexOf("windows nt")?i.$os="Windows PC":-1!=r.indexOf("mac os")&&(i.$os="Mac OS");var n=(navigator.language||navigator.browserLanguage).toLowerCase(),o=n.split("-");o.length>1&&(o[1]=o[1].toUpperCase()),i.$language=o.join("-"),e.injectUIntFixOnIE9()},e.injectUIntFixOnIE9=function(){if(/msie 9.0/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)){var t="<!-- IEBinaryToArray_ByteStr -->\r\n<script type='text/vbscript' language='VBScript'>\r\nFunction IEBinaryToArray_ByteStr(Binary)\r\n   IEBinaryToArray_ByteStr = CStr(Binary)\r\nEnd Function\r\nFunction IEBinaryToArray_ByteStr_Last(Binary)\r\n   Dim lastIndex\r\n   lastIndex = LenB(Binary)\r\n   if lastIndex mod 2 Then\r\n       IEBinaryToArray_ByteStr_Last = Chr( AscB( MidB( Binary, lastIndex, 1 ) ) )\r\n   Else\r\n       IEBinaryToArray_ByteStr_Last = \"\"\r\n   End If\r\nEnd Function\r\n</script>\r\n<!-- convertResponseBodyToText -->\r\n<script>\r\nlet convertResponseBodyToText = function (binary) {\r\n   let byteMapping = {};\r\n   for ( let i = 0; i < 256; i++ ) {\r\n       for ( let j = 0; j < 256; j++ ) {\r\n           byteMapping[ String.fromCharCode( i + j * 256 ) ] =\r\n           String.fromCharCode(i) + String.fromCharCode(j);\r\n       }\r\n   }\r\n   let rawBytes = IEBinaryToArray_ByteStr(binary);\r\n   let lastChr = IEBinaryToArray_ByteStr_Last(binary);\r\n   return rawBytes.replace(/[\\s\\S]/g,                           function( match ) { return byteMapping[match]; }) + lastChr;\r\n};\r\n</script>\r\n";document.write(t)}},e}();e.WebCapability=i,__reflect(i.prototype,"egret.web.WebCapability"),i.detect()}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=["source-over","lighter","destination-out"],r="source-over",n=[],o=function(){function o(){this.nestLevel=0}return o.prototype.render=function(t,e,i,r,o){this.nestLevel++;var a=e,s=a.context,l=o?t:null;s.pushBuffer(a),this.drawDisplayObject(t,a,r,i,null,null,l),s.$drawWebGL();var h=a.$drawCalls;if(a.onRenderFinish(),s.popBuffer(),this.nestLevel--,0===this.nestLevel){n.length>6&&(n.length=6);for(var u=n.length,c=0;u>c;c++)n[c].resize(0,0)}return h},o.prototype.drawDisplayObject=function(e,i,r,n,o,a,s){var l,h=0;if(o&&!s?(o.isDirty&&(h+=o.drawToSurface()),l=o.$renderNode):l=e.$getRenderNode(),l){if(r){var u=l.renderRegion;if(a&&!a.intersects(u))l.needRedraw=!1;else if(!l.needRedraw)for(var c=r.length,p=0;c>p;p++)if(u.intersects(r[p])){l.needRedraw=!0;break}}else l.needRedraw=!0;if(l.needRedraw){h++;var d=void 0,f=void 0;s?(d=e.$getConcatenatedAlphaAt(s,e.$getConcatenatedAlpha()),f=t.Matrix.create().copyFrom(e.$getConcatenatedMatrix()),e.$getConcatenatedMatrixAt(s,f),n.$preMultiplyInto(f,f),i.setTransform(f.a,f.b,f.c,f.d,f.tx,f.ty),t.Matrix.release(f)):(d=l.renderAlpha,f=l.renderMatrix,i.setTransform(f.a,f.b,f.c,f.d,f.tx+n.tx,f.ty+n.ty)),i.globalAlpha=d,this.renderNode(l,i),l.needRedraw=!1}}if(o&&!s)return h;var g=e.$children;if(g)for(var y=g.length,v=0;y>v;v++){var m=g[v];if(!(!m.$visible||m.$alpha<=0||m.$maskedObject)){var _=m.$getFilters();_&&_.length>0?h+=this.drawWithFilter(m,i,r,n,a,s):0!==m.$blendMode||m.$mask&&(m.$mask.$parentDisplayList||s)?h+=this.drawWithClip(m,i,r,n,a,s):m.$scrollRect||m.$maskRect?h+=this.drawWithScrollRect(m,i,r,n,a,s):m.isFPS?(i.context.$drawWebGL(),i.$computeDrawCall=!1,this.drawDisplayObject(m,i,r,n,m.$displayList,a,s),i.context.$drawWebGL(),i.$computeDrawCall=!0):h+=this.drawDisplayObject(m,i,r,n,m.$displayList,a,s)}}return h},o.prototype.drawWithFilter=function(e,o,a,s,l,h){var u,c=0,p=e.$getFilters(),d=0!==e.$blendMode;if(d&&(u=i[e.$blendMode],u||(u=r)),1==p.length&&"colorTransform"==p[0].type&&!e.$children)return d&&o.context.setGlobalCompositeOperation(u),o.context.$filter=p[0],c+=e.$mask&&(e.$mask.$parentDisplayList||h)?this.drawWithClip(e,o,a,s,l,h):e.$scrollRect||e.$maskRect?this.drawWithScrollRect(e,o,a,s,l,h):this.drawDisplayObject(e,o,a,s,e.$displayList,l,h),o.context.$filter=null,d&&o.context.setGlobalCompositeOperation(r),c;var f=t.Matrix.create();f.copyFrom(e.$getConcatenatedMatrix()),h&&e.$getConcatenatedMatrixAt(h,f);var g;g=t.sys.Region.create();var y=e.$getOriginalBounds();g.updateRegion(y,f);var v=this.createRenderBuffer(g.width,g.height);v.context.pushBuffer(v),v.setTransform(1,0,0,1,-g.minX,-g.minY);var m=t.Matrix.create().setTo(1,0,0,1,-g.minX,-g.minY);return c+=e.$mask&&(e.$mask.$parentDisplayList||h)?this.drawWithClip(e,v,a,m,g,h):e.$scrollRect||e.$maskRect?this.drawWithScrollRect(e,v,a,m,g,h):this.drawDisplayObject(e,v,a,m,e.$displayList,g,h),t.Matrix.release(m),v.context.popBuffer(),c>0&&(d&&o.context.setGlobalCompositeOperation(u),c++,o.globalAlpha=1,o.setTransform(1,0,0,1,g.minX+s.tx,g.minY+s.ty),o.context.drawTargetWidthFilters(p,v),d&&o.context.setGlobalCompositeOperation(r)),n.push(v),t.sys.Region.release(g),t.Matrix.release(f),c},o.prototype.drawWithClip=function(e,o,a,s,l,h){var u,c=0,p=0!==e.$blendMode;p&&(u=i[e.$blendMode],u||(u=r));var d=e.$scrollRect?e.$scrollRect:e.$maskRect,f=e.$mask;if(f){var g=f.$getRenderNode();if(g){var y=g.renderMatrix;if(0==y.a&&0==y.b||0==y.c&&0==y.d)return c}}var v,m=t.Matrix.create();if(m.copyFrom(e.$getConcatenatedMatrix()),e.$parentDisplayList){var _=e.$parentDisplayList.root;_!==e.$stage&&e.$getConcatenatedMatrixAt(_,m)}var b;if(f){b=f.$getOriginalBounds(),v=t.sys.Region.create();var T=t.Matrix.create();T.copyFrom(f.$getConcatenatedMatrix()),v.updateRegion(b,T),t.Matrix.release(T)}var x;if(d&&(x=t.sys.Region.create(),x.updateRegion(d,m)),x&&v?(x.intersect(v),t.sys.Region.release(v)):!x&&v&&(x=v),x){if(x.isEmpty()||l&&!l.intersects(x))return t.sys.Region.release(x),t.Matrix.release(m),c}else x=t.sys.Region.create(),b=e.$getOriginalBounds(),x.updateRegion(b,m);var E=!1;if(a){for(var $=a.length,S=0;$>S;S++)if(x.intersects(a[S])){E=!0;break}}else E=!0;if(!E)return t.sys.Region.release(x),t.Matrix.release(m),c;if(f||e.$children&&0!=e.$children.length){var C=this.createRenderBuffer(x.width,x.height);C.context.pushBuffer(C),C.setTransform(1,0,0,1,-x.minX,-x.minY);var w=t.Matrix.create().setTo(1,0,0,1,-x.minX,-x.minY);if(c+=this.drawDisplayObject(e,C,a,w,e.$displayList,x,h),f){var O=this.createRenderBuffer(x.width,x.height);O.context.pushBuffer(O),O.setTransform(1,0,0,1,-x.minX,-x.minY),w=t.Matrix.create().setTo(1,0,0,1,-x.minX,-x.minY),c+=this.drawDisplayObject(f,O,a,w,f.$displayList,x,h),O.context.popBuffer(),C.context.setGlobalCompositeOperation("destination-in"),C.setTransform(1,0,0,-1,0,O.height),C.globalAlpha=1;var P=O.rootRenderTarget.width,D=O.rootRenderTarget.height;C.context.drawTexture(O.rootRenderTarget.texture,0,0,P,D,0,0,P,D,P,D),C.context.setGlobalCompositeOperation("source-over"),n.push(O)}if(t.Matrix.release(w),C.context.setGlobalCompositeOperation(r),C.context.popBuffer(),c>0){if(c++,p&&o.context.setGlobalCompositeOperation(u),d){var T=m;C.setTransform(T.a,T.b,T.c,T.d,T.tx-x.minX,T.ty-x.minY),C.context.pushMask(d)}o.globalAlpha=1,o.setTransform(1,0,0,-1,x.minX+s.tx,x.minY+s.ty+C.height);var L=C.rootRenderTarget.width,R=C.rootRenderTarget.height;o.context.drawTexture(C.rootRenderTarget.texture,0,0,L,R,0,0,L,R,L,R),d&&C.context.popMask(),p&&o.context.setGlobalCompositeOperation(r)}return n.push(C),t.sys.Region.release(x),t.Matrix.release(m),c}if(d){var T=m;o.setTransform(T.a,T.b,T.c,T.d,T.tx-x.minX,T.ty-x.minY),o.context.pushMask(d)}return p&&o.context.setGlobalCompositeOperation(u),c+=this.drawDisplayObject(e,o,a,s,e.$displayList,l,h),p&&o.context.setGlobalCompositeOperation(r),d&&o.context.popMask(),t.sys.Region.release(x),t.Matrix.release(m),c},o.prototype.drawWithScrollRect=function(e,i,r,n,o,a){var s=0,l=e.$scrollRect?e.$scrollRect:e.$maskRect;if(l.isEmpty())return s;var h=t.Matrix.create();if(h.copyFrom(e.$getConcatenatedMatrix()),a)e.$getConcatenatedMatrixAt(a,h);else if(e.$parentDisplayList){var u=e.$parentDisplayList.root;u!==e.$stage&&e.$getConcatenatedMatrixAt(u,h)}var c=t.sys.Region.create();if(c.updateRegion(l,h),c.isEmpty()||o&&!o.intersects(c))return t.sys.Region.release(c),t.Matrix.release(h),s;var p=!1;if(r){for(var d=r.length,f=0;d>f;f++)if(c.intersects(r[f])){p=!0;break}}else p=!0;if(!p)return t.sys.Region.release(c),t.Matrix.release(h),s;i.setTransform(h.a,h.b,h.c,h.d,h.tx+n.tx,h.ty+n.ty);var g=i.context,y=!1;if(i.$hasScissor||0!=h.b||0!=h.c)g.pushMask(l);else{var v=l.x,m=l.y,_=l.width,b=l.height;v=v*h.a+h.tx+n.tx,m=m*h.d+h.ty+n.ty,_*=h.a,b*=h.d,g.enableScissor(v,-m-b+i.height,_,b),y=!0}return s+=this.drawDisplayObject(e,i,r,n,e.$displayList,c,a),i.setTransform(h.a,h.b,h.c,h.d,h.tx+n.tx,h.ty+n.ty),y?g.disableScissor():g.popMask(),t.sys.Region.release(c),t.Matrix.release(h),s},o.prototype.drawNodeToBuffer=function(t,e,i,r){var n=e;n.context.pushBuffer(n),n.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty),this.renderNode(t,e,r),n.context.$drawWebGL(),n.onRenderFinish(),n.context.popBuffer()},o.prototype.renderNode=function(t,e,i){switch(t.type){case 1:this.renderBitmap(t,e);break;case 2:this.renderText(t,e);break;case 3:this.renderGraphics(t,e,i);break;case 4:this.renderGroup(t,e);break;case 6:e.globalAlpha=t.drawData[0];break;case 7:this.renderMesh(t,e)}},o.prototype.renderBitmap=function(t,e){var n=t.image;if(n){var o=t.drawData,a=o.length,s=0,l=t.matrix,h=t.blendMode,u=t.alpha;l&&(e.saveTransform(),e.transform(l.a,l.b,l.c,l.d,l.tx,l.ty)),h&&e.context.setGlobalCompositeOperation(i[h]);var c;if(u==u&&(c=e.globalAlpha,e.globalAlpha*=u),t.filter){for(e.context.$filter=t.filter;a>s;)e.context.drawImage(n,o[s++],o[s++],o[s++],o[s++],o[s++],o[s++],o[s++],o[s++],t.imageWidth,t.imageHeight);e.context.$filter=null}else for(;a>s;)e.context.drawImage(n,o[s++],o[s++],o[s++],o[s++],o[s++],o[s++],o[s++],o[s++],t.imageWidth,t.imageHeight);h&&e.context.setGlobalCompositeOperation(r),u==u&&(e.globalAlpha=c),l&&e.restoreTransform()}},o.prototype.renderMesh=function(t,e){var i=t.image,r=t.drawData,n=r.length,o=0,a=t.matrix;for(a&&(e.saveTransform(),e.transform(a.a,a.b,a.c,a.d,a.tx,a.ty));n>o;)e.context.drawMesh(i,r[o++],r[o++],r[o++],r[o++],r[o++],r[o++],r[o++],r[o++],t.imageWidth,t.imageHeight,t.uvs,t.vertices,t.indices,t.bounds);a&&e.restoreTransform()},o.prototype.renderText=function(i,r){var n=i.width-i.x,o=i.height-i.y;if(0!=i.drawData.length&&(this.canvasRenderBuffer&&this.canvasRenderBuffer.context?i.dirtyRender&&this.canvasRenderBuffer.resize(n,o):(this.canvasRenderer=new t.CanvasRenderer,this.canvasRenderBuffer=new e.CanvasRenderBuffer(n,o)),this.canvasRenderBuffer.context)){if((i.x||i.y)&&(i.dirtyRender&&this.canvasRenderBuffer.context.translate(-i.x,-i.y),r.transform(1,0,0,1,i.x,i.y)),i.dirtyRender){var a=this.canvasRenderBuffer.surface;this.canvasRenderer.renderText(i,this.canvasRenderBuffer.context);var s=i.$texture;s?r.context.updateTexture(s,a):(s=r.context.createTexture(a),i.$texture=s),i.$textureWidth=a.width,i.$textureHeight=a.height}var l=i.$textureWidth,h=i.$textureHeight;r.context.drawTexture(i.$texture,0,0,l,h,0,0,l,h,l,h),(i.x||i.y)&&(i.dirtyRender&&this.canvasRenderBuffer.context.translate(i.x,i.y),r.transform(1,0,0,1,-i.x,-i.y)),i.dirtyRender=!1}},o.prototype.renderGraphics=function(i,r,n){var o=i.width,a=i.height;if(!(0>=o||0>=a)&&o&&a&&0!=i.drawData.length&&(this.canvasRenderBuffer&&this.canvasRenderBuffer.context?(i.dirtyRender||n)&&this.canvasRenderBuffer.resize(o,a):(this.canvasRenderer=new t.CanvasRenderer,this.canvasRenderBuffer=new e.CanvasRenderBuffer(o,a)),this.canvasRenderBuffer.context)){(i.x||i.y)&&((i.dirtyRender||n)&&this.canvasRenderBuffer.context.translate(-i.x,-i.y),r.transform(1,0,0,1,i.x,i.y));var s=this.canvasRenderBuffer.surface;if(n){this.canvasRenderer.renderGraphics(i,this.canvasRenderBuffer.context,!0),t.WebGLUtils.deleteWebGLTexture(s);var l=r.context.getWebGLTexture(s);r.context.drawTexture(l,0,0,o,a,0,0,o,a,s.width,s.height)}else{if(i.dirtyRender){this.canvasRenderer.renderGraphics(i,this.canvasRenderBuffer.context);var l=i.$texture;l?r.context.updateTexture(l,s):(l=r.context.createTexture(s),i.$texture=l),i.$textureWidth=s.width,i.$textureHeight=s.height}var h=i.$textureWidth,u=i.$textureHeight;r.context.drawTexture(i.$texture,0,0,h,u,0,0,h,u,h,u)}(i.x||i.y)&&((i.dirtyRender||n)&&this.canvasRenderBuffer.context.translate(i.x,i.y),r.transform(1,0,0,1,-i.x,-i.y)),n||(i.dirtyRender=!1)}},o.prototype.renderGroup=function(t,e){for(var i=t.drawData,r=i.length,n=0;r>n;n++){var o=i[n];this.renderNode(o,e)}},o.prototype.createRenderBuffer=function(t,i){var r=n.pop();return r?r.resize(t,i):(r=new e.WebGLRenderBuffer(t,i),r.$computeDrawCall=!1),r},o}();e.WebGLRenderer=o,__reflect(o.prototype,"egret.web.WebGLRenderer",["egret.sys.SystemRenderer"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function i(t){if(window.location){var e=mo.PROJ.search;if(""==e)return"";e=e.slice(1);for(var i=e.split("&"),r=i.length,n=0;r>n;n++){var o=i[n],a=o.split("=");if(a[0]==t)return a[1]}}return""}e.getOption=i,t.getOption=i}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(i){function r(t,e){var r=i.call(this)||this;return r.init(t,e),r.initOrientation(),r}return __extends(r,i),r.prototype.init=function(i,r){var n=this.readOption(i,r),o=new t.Stage;o.$screen=this,o.$scaleMode=n.scaleMode,o.$orientation=n.orientation,o.$maxTouches=n.maxTouches,o.frameRate=n.frameRate,o.textureScaleFactor=n.textureScaleFactor;var a=new t.sys.RenderBuffer(void 0,void 0,!0),s=a.surface;this.attachCanvas(i,s);var l=new e.WebTouchHandler(o,s),h=new t.sys.Player(a,o,n.entryClassName),u=new t.web.WebHideHandler(o),c=new e.HTMLInput;h.showPaintRect(n.showPaintRect),(n.showFPS||n.showLog)&&h.displayFPS(n.showFPS,n.showLog,n.logFilter,n.fpsStyles),this.playerOption=n,this.container=i,this.canvas=s,this.stage=o,this.player=h,this.webTouchHandler=l,this.webInput=c,this.webHide=u,t.web.$cacheTextAdapter(c,o,i,s),this.updateScreenSize(),this.updateMaxTouches(),h.start()},r.prototype.initOrientation=function(){var e=this;window.addEventListener("orientationchange",function(){window.setTimeout(function(){t.StageOrientationEvent.dispatchStageOrientationEvent(e.stage,t.StageOrientationEvent.ORIENTATION_CHANGE)},350)})},r.prototype.readOption=function(e,i){var r={};r.entryClassName=e.getAttribute("data-entry-class"),r.scaleMode=e.getAttribute("data-scale-mode")||t.StageScaleMode.NO_SCALE,r.frameRate=+e.getAttribute("data-frame-rate")||30,r.contentWidth=+e.getAttribute("data-content-width")||480,r.contentHeight=+e.getAttribute("data-content-height")||800,r.orientation=e.getAttribute("data-orientation")||t.OrientationMode.AUTO,r.maxTouches=+e.getAttribute("data-multi-fingered")||2,r.textureScaleFactor=+e.getAttribute("texture-scale-factor")||1,r.showPaintRect="webgl"==i.renderMode?!1:"true"==e.getAttribute("data-show-paint-rect"),r.showFPS="true"==e.getAttribute("data-show-fps");for(var n=e.getAttribute("data-show-fps-style")||"",o=n.split(","),a={},s=0;s<o.length;s++){var l=o[s].split(":");a[l[0]]=l[1]}return r.fpsStyles=a,r.showLog="true"==e.getAttribute("data-show-log"),r.logFilter=e.getAttribute("data-log-filter"),r},r.prototype.attachCanvas=function(t,e){var i=e.style;i.cursor="inherit",i.position="absolute",i.top="0",i.bottom="0",i.left="0",i.right="0",t.appendChild(e),i=t.style,i.overflow="hidden",i.position="relative",i.webkitTransform="translateZ(0)"},r.prototype.updateScreenSize=function(){var e=this.canvas;if(!e.userTyping){var i=this.playerOption,r=this.container.getBoundingClientRect(),n=!1,o=this.stage.$orientation;o!=t.OrientationMode.AUTO&&(n=o!=t.OrientationMode.PORTRAIT&&r.height>r.width||o==t.OrientationMode.PORTRAIT&&r.width>r.height);var a=n?r.height:r.width,s=n?r.width:r.height;t.Capabilities.$boundingClientWidth=a,t.Capabilities.$boundingClientHeight=s;var l=t.sys.screenAdapter.calculateStageSize(this.stage.$scaleMode,a,s,i.contentWidth,i.contentHeight),h=l.stageWidth,u=l.stageHeight,c=l.displayWidth,p=l.displayHeight;e.width!==h&&(e.width=h),e.height!==u&&(e.height=u),e.style[t.web.getPrefixStyleName("transformOrigin")]="0% 0% 0px",e.style.width=c+"px",e.style.height=p+"px";var d=0;n?o==t.OrientationMode.LANDSCAPE?(d=90,e.style.top=(r.height-c)/2+"px",e.style.left=(r.width+p)/2+"px"):(d=-90,e.style.top=(r.height+c)/2+"px",e.style.left=(r.width-p)/2+"px"):(e.style.top=(r.height-p)/2+"px",e.style.left=(r.width-c)/2+"px");var f="rotate("+d+"deg)";e.style[t.web.getPrefixStyleName("transform")]=f;var g=c/h,y=p/u;this.webTouchHandler.updateScaleMode(g,y,d),this.webInput.$updateSize(),this.player.updateStageSize(h,u)}},r.prototype.setContentSize=function(t,e){var i=this.playerOption;i.contentWidth=t,i.contentHeight=e,this.updateScreenSize()},r.prototype.updateMaxTouches=function(){this.webTouchHandler.$updateMaxTouches()},r}(t.HashObject);e.WebPlayer=i,__reflect(i.prototype,"egret.web.WebPlayer",["egret.sys.Screen"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(){function e(e,i){a||(a=document.createElement("canvas"),s=a.getContext("2d"));var r=e.$getTextureWidth(),n=e.$getTextureHeight();null==i&&(i=t.$TempRectangle,i.x=0,i.y=0,i.width=r,i.height=n),i.x=Math.min(i.x,r-1),i.y=Math.min(i.y,n-1),i.width=Math.min(i.width,r-i.x),i.height=Math.min(i.height,n-i.y);var o=i.width,l=i.height,h=a;if(h.style.width=o+"px",h.style.height=l+"px",a.width=o,a.height=l,"webgl"==t.Capabilities.$renderMode){var u=void 0;e.$renderBuffer?u=e:(u=new t.RenderTexture,u.drawToTexture(new t.Bitmap(e)));for(var c=u.$renderBuffer.getPixels(i.x,i.y,o,l),p=new ImageData(o,l),d=0;d<c.length;d++)p.data[d]=c[d];return s.putImageData(p,0,0),e.$renderBuffer||u.dispose(),h}var f=e,g=Math.round(f._offsetX),y=Math.round(f._offsetY),v=f._bitmapWidth,m=f._bitmapHeight;return s.drawImage(f._bitmapData.source,f._bitmapX+i.x/t.$TextureScaleFactor,f._bitmapY+i.y/t.$TextureScaleFactor,v*i.width/r,m*i.height/n,g,y,i.width,i.height),h}function i(i,r){try{var n=e(this,r),o=n.toDataURL(i);return o}catch(a){t.$error(1033)}return null}function r(t,e,r){var n=i.call(this,t,r);if(null!=n){var o=n.replace(/^data:image[^;]*/,"data:image/octet-stream"),a=document.createElement("a");a.download=e,a.href=o;var s=document.createEvent("HTMLEvents");s.initEvent("click",!1,!1),a.dispatchEvent(s)}}function n(e,i){return t.$warn(1041,"getPixel32","getPixels"),this.getPixels(e,i)}function o(i,r,n,o){void 0===n&&(n=1),void 0===o&&(o=1);try{var a=(e(this),s.getImageData(i,r,n,o).data);return a}catch(l){t.$error(1039)}}var a,s;t.Texture.prototype.toDataURL=i,t.Texture.prototype.saveToFile=r,t.Texture.prototype.getPixel32=n,t.Texture.prototype.getPixels=o}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function i(t){for(var e=s.parseFromString(t,"text/xml"),i=e.childNodes.length,n=0;i>n;n++){var o=e.childNodes[n];
if(1==o.nodeType)return r(o,null)}return null}function r(t,e){if("parsererror"==t.localName)throw new Error(t.textContent);for(var i=new o(t.localName,e,t.prefix,t.namespaceURI,t.nodeName),n=t.attributes,s=i.attributes,l=n.length,h=0;l>h;h++){var u=n[h],c=u.name;0!=c.indexOf("xmlns:")&&(s[c]=u.value,i["$"+c]=u.value)}var p=t.childNodes;l=p.length;for(var d=i.children,h=0;l>h;h++){var f=p[h],g=f.nodeType,y=null;if(1==g)y=r(f,i);else if(3==g){var v=f.textContent.trim();v&&(y=new a(v,i))}y&&d.push(y)}return i}var n=function(){function t(t,e){this.nodeType=t,this.parent=e}return t}();e.XMLNode=n,__reflect(n.prototype,"egret.web.XMLNode");var o=function(t){function e(e,i,r,n,o){var a=t.call(this,1,i)||this;return a.attributes={},a.children=[],a.localName=e,a.prefix=r,a.namespace=n,a.name=o,a}return __extends(e,t),e}(n);e.XML=o,__reflect(o.prototype,"egret.web.XML");var a=function(t){function e(e,i){var r=t.call(this,3,i)||this;return r.text=e,r}return __extends(e,t),e}(n);e.XMLText=a,__reflect(a.prototype,"egret.web.XMLText");var s=new DOMParser;t.XML={parse:i}}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(){var i=e.apply(this,arguments)||this;return i.onChange=function(e){var r=new t.OrientationEvent(t.Event.CHANGE);r.beta=e.beta,r.gamma=e.gamma,r.alpha=e.alpha,i.dispatchEvent(r)},i}return __extends(i,e),i.prototype.start=function(){window.addEventListener("deviceorientation",this.onChange)},i.prototype.stop=function(){window.removeEventListener("deviceorientation",this.onChange)},i}(t.EventDispatcher);e.WebDeviceOrientation=i,__reflect(i.prototype,"egret.web.WebDeviceOrientation",["egret.DeviceOrientation"])}(e=t.web||(t.web={}))}(egret||(egret={})),egret.DeviceOrientation=egret.web.WebDeviceOrientation;var egret;!function(t){var e;!function(e){var i=function(e){function i(){var i=e.call(this)||this;return i.onUpdate=function(e){var r=new t.GeolocationEvent(t.Event.CHANGE),n=e.coords;r.altitude=n.altitude,r.heading=n.heading,r.accuracy=n.accuracy,r.latitude=n.latitude,r.longitude=n.longitude,r.speed=n.speed,r.altitudeAccuracy=n.altitudeAccuracy,i.dispatchEvent(r)},i.onError=function(e){var r=t.GeolocationEvent.UNAVAILABLE;e.code==e.PERMISSION_DENIED&&(r=t.GeolocationEvent.PERMISSION_DENIED);var n=new t.GeolocationEvent(t.IOErrorEvent.IO_ERROR);n.errorType=r,n.errorMessage=e.message,i.dispatchEvent(n)},i.geolocation=navigator.geolocation,i}return __extends(i,e),i.prototype.start=function(){var e=this.geolocation;e?this.watchId=e.watchPosition(this.onUpdate,this.onError):this.onError({code:2,message:t.sys.tr(3004),PERMISSION_DENIED:1,POSITION_UNAVAILABLE:2})},i.prototype.stop=function(){var t=this.geolocation;t.clearWatch(this.watchId)},i}(t.EventDispatcher);e.WebGeolocation=i,__reflect(i.prototype,"egret.web.WebGeolocation",["egret.Geolocation"]),t.Geolocation=t.web.WebGeolocation}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(){var i=e.apply(this,arguments)||this;return i.onChange=function(e){var r=new t.MotionEvent(t.Event.CHANGE),n={x:e.acceleration.x,y:e.acceleration.y,z:e.acceleration.z},o={x:e.accelerationIncludingGravity.x,y:e.accelerationIncludingGravity.y,z:e.accelerationIncludingGravity.z},a={alpha:e.rotationRate.alpha,beta:e.rotationRate.beta,gamma:e.rotationRate.gamma};r.acceleration=n,r.accelerationIncludingGravity=o,r.rotationRate=a,i.dispatchEvent(r)},i}return __extends(i,e),i.prototype.start=function(){window.addEventListener("devicemotion",this.onChange)},i.prototype.stop=function(){window.removeEventListener("devicemotion",this.onChange)},i}(t.EventDispatcher);e.WebMotion=i,__reflect(i.prototype,"egret.web.WebMotion",["egret.Motion"]),t.Motion=t.web.WebMotion}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(){function e(e){switch(null==i&&(i={error:console.error,debug:console.debug,warn:console.warn,info:console.info,log:console.log}),e){case t.Logger.OFF:console.error=function(){};case t.Logger.ERROR:console.warn=function(){};case t.Logger.WARN:console.info=function(){},console.log=function(){};case t.Logger.INFO:console.debug=function(){}}switch(e){case t.Logger.ALL:case t.Logger["true"]:console.debug=i.debug;case t.Logger.INFO:console.log=i.log,console.info=i.info;case t.Logger.WARN:console.warn=i.warn;case t.Logger.ERROR:console.error=i.error}}var i;Object.defineProperty(t.Logger,"logLevel",{set:e,enumerable:!0,configurable:!0})}(e=t.web||(t.web={}))}(egret||(egret={})),void 0==window.HTMLVideoElement&&(window.HTMLVideoElement=HTMLDivElement);var egret;!function(t){var e;!function(){var e="egret.BitmapData";t.registerClass(HTMLImageElement,e),t.registerClass(HTMLCanvasElement,e),t.registerClass(HTMLVideoElement,e)}(e=t.web||(t.web={}))}(egret||(egret={})),function(t){function e(e){return e.hashCode=e.$hashCode=t.$hashCount++,e}t.$toBitmapData=e}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(){function t(){}return t.call=function(){},t.addCallback=function(){},t}();e.WebExternalInterface=i,__reflect(i.prototype,"egret.web.WebExternalInterface",["egret.ExternalInterface"]),t.ExternalInterface=i}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.apply(this,arguments)||this;return e.fragmentSrc="precision lowp float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvoid main(void) {\ngl_FragColor = vColor;\n}",e}return __extends(e,t),e}(t.EgretShader);t.PrimitiveShader=e,__reflect(e.prototype,"egret.web.PrimitiveShader")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.apply(this,arguments)||this;return e.fragmentSrc="precision mediump float;uniform vec2 blur;uniform sampler2D uSampler;varying vec2 vTextureCoord;uniform vec2 uTextureSize;void main(){const int sampleRadius = 5;const int samples = sampleRadius * 2 + 1;vec2 blurUv = blur / uTextureSize;vec4 color = vec4(0, 0, 0, 0);vec2 uv = vec2(0.0, 0.0);blurUv /= float(sampleRadius);for (int i = -sampleRadius; i <= sampleRadius; i++) {uv.x = vTextureCoord.x + float(i) * blurUv.x;uv.y = vTextureCoord.y + float(i) * blurUv.y;color += texture2D(uSampler, uv);}color /= float(samples);gl_FragColor = color;}",e.uniforms={projectionVector:{type:"2f",value:{x:0,y:0},dirty:!0},blur:{type:"2f",value:{x:2,y:2},dirty:!0},uTextureSize:{type:"2f",value:{x:100,y:100},dirty:!0}},e}return __extends(e,t),e.prototype.setBlur=function(t,e){var i=this.uniforms.blur;(i.value.x!=t||i.value.y!=e)&&(i.value.x=t,i.value.y=e,i.dirty=!0)},e.prototype.setTextureSize=function(t,e){var i=this.uniforms.uTextureSize;(t!=i.value.x||e!=i.value.y)&&(i.value.x=t,i.value.y=e,i.dirty=!0)},e}(t.TextureShader);t.BlurShader=e,__reflect(e.prototype,"egret.web.BlurShader")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.apply(this,arguments)||this;return e.fragmentSrc="precision mediump float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nuniform mat4 matrix;\nuniform vec4 colorAdd;\nuniform sampler2D uSampler;\nvoid main(void) {\nvec4 texColor = texture2D(uSampler, vTextureCoord);\nif(texColor.a > 0.) {texColor = vec4(texColor.rgb / texColor.a, texColor.a);\n}vec4 locColor = clamp(texColor * matrix + colorAdd, 0., 1.);\ngl_FragColor = vColor * vec4(locColor.rgb * locColor.a, locColor.a);\n}",e.uniforms={projectionVector:{type:"2f",value:{x:0,y:0},dirty:!0},matrix:{type:"mat4",value:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],dirty:!0},colorAdd:{type:"4f",value:{x:0,y:0,z:0,w:0},dirty:!0}},e}return __extends(e,t),e.prototype.setMatrix=function(t){var e=this.uniforms.matrix;(e.value[0]!=t[0]||e.value[0]!=t[0]||e.value[1]!=t[1]||e.value[2]!=t[2]||e.value[3]!=t[3]||e.value[4]!=t[5]||e.value[5]!=t[6]||e.value[6]!=t[7]||e.value[7]!=t[8]||e.value[8]!=t[10]||e.value[9]!=t[11]||e.value[10]!=t[12]||e.value[11]!=t[13]||e.value[12]!=t[15]||e.value[13]!=t[16]||e.value[14]!=t[17]||e.value[15]!=t[18])&&(e.value[0]=t[0],e.value[1]=t[1],e.value[2]=t[2],e.value[3]=t[3],e.value[4]=t[5],e.value[5]=t[6],e.value[6]=t[7],e.value[7]=t[8],e.value[8]=t[10],e.value[9]=t[11],e.value[10]=t[12],e.value[11]=t[13],e.value[12]=t[15],e.value[13]=t[16],e.value[14]=t[17],e.value[15]=t[18],e.dirty=!0);var i=this.uniforms.colorAdd;(i.value.x!=t[4]/255||i.value.y!=t[9]/255||i.value.z!=t[14]/255||i.value.w!=t[19]/255)&&(i.value.x=t[4]/255,i.value.y=t[9]/255,i.value.z=t[14]/255,i.value.w=t[19]/255,i.dirty=!0)},e}(t.TextureShader);t.ColorTransformShader=e,__reflect(e.prototype,"egret.web.ColorTransformShader")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.apply(this,arguments)||this;return e.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","uniform sampler2D uSampler;","uniform float distance;","uniform float angle;","uniform vec4 color;","uniform float alpha;","uniform float blurX;","uniform float blurY;","uniform float strength;","uniform float inner;","uniform float knockout;","uniform float hideObject;","uniform vec2 uTextureSize;vec2 px = vec2(1.0 / uTextureSize.x, 1.0 / uTextureSize.y);","float random(vec3 scale, float seed)","{","return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);","}","void main(void) {","const float linearSamplingTimes = 7.0;","const float circleSamplingTimes = 12.0;","vec4 ownColor = texture2D(uSampler, vTextureCoord);","vec4 curColor;","float totalAlpha = 0.0;","float maxTotalAlpha = 0.0;","float curDistanceX = 0.0;","float curDistanceY = 0.0;","float offsetX = distance * cos(angle) * px.x;","float offsetY = distance * sin(angle) * px.y;","const float PI = 3.14159265358979323846264;","float cosAngle;","float sinAngle;","float offset = PI * 2.0 / circleSamplingTimes * random(vec3(12.9898, 78.233, 151.7182), 0.0);","float stepX = blurX * px.x / linearSamplingTimes;","float stepY = blurY * px.y / linearSamplingTimes;","for (float a = 0.0; a <= PI * 2.0; a += PI * 2.0 / circleSamplingTimes) {","cosAngle = cos(a + offset);","sinAngle = sin(a + offset);","for (float i = 1.0; i <= linearSamplingTimes; i++) {","curDistanceX = i * stepX * cosAngle;","curDistanceY = i * stepY * sinAngle;","curColor = texture2D(uSampler, vec2(vTextureCoord.x + curDistanceX - offsetX, vTextureCoord.y + curDistanceY + offsetY));","totalAlpha += (linearSamplingTimes - i) * curColor.a;","maxTotalAlpha += (linearSamplingTimes - i);","}","}","ownColor.a = max(ownColor.a, 0.0001);","ownColor.rgb = ownColor.rgb / ownColor.a;","float outerGlowAlpha = (totalAlpha / maxTotalAlpha) * strength * alpha * (1. - inner) * max(min(hideObject, knockout), 1. - ownColor.a);","float innerGlowAlpha = ((maxTotalAlpha - totalAlpha) / maxTotalAlpha) * strength * alpha * inner * ownColor.a;","ownColor.a = max(ownColor.a * knockout * (1. - hideObject), 0.0001);","vec3 mix1 = mix(ownColor.rgb, color.rgb, innerGlowAlpha / (innerGlowAlpha + ownColor.a));","vec3 mix2 = mix(mix1, color.rgb, outerGlowAlpha / (innerGlowAlpha + ownColor.a + outerGlowAlpha));","float resultAlpha = min(ownColor.a + outerGlowAlpha + innerGlowAlpha, 1.);","gl_FragColor = vec4(mix2 * resultAlpha, resultAlpha);","}"].join("\n"),e.uniforms={projectionVector:{type:"2f",value:{x:0,y:0},dirty:!0},distance:{type:"1f",value:15,dirty:!0},angle:{type:"1f",value:1,dirty:!0},color:{type:"4f",value:{x:1,y:0,z:0,w:0},dirty:!0},alpha:{type:"1f",value:1,dirty:!0},blurX:{type:"1f",value:1,dirty:!0},blurY:{type:"1f",value:1,dirty:!0},strength:{type:"1f",value:1,dirty:!0},inner:{type:"1f",value:1,dirty:!0},knockout:{type:"1f",value:1,dirty:!0},hideObject:{type:"1f",value:0,dirty:!0},uTextureSize:{type:"2f",value:{x:100,y:100},dirty:!0}},e}return __extends(e,t),e.prototype.setDistance=function(t){var e=this.uniforms.distance;e.value!=t&&(e.value=t,e.dirty=!0)},e.prototype.setAngle=function(t){var e=this.uniforms.angle;e.value!=t&&(e.value=t,e.dirty=!0)},e.prototype.setColor=function(t,e,i){var r=this.uniforms.color;(r.value.x!=t||r.value.y!=e||r.value.z!=i)&&(r.value.x=t,r.value.y=e,r.value.z=i,r.dirty=!0)},e.prototype.setAlpha=function(t){var e=this.uniforms.alpha;e.value!=t&&(e.value=t,e.dirty=!0)},e.prototype.setBlurX=function(t){var e=this.uniforms.blurX;e.value!=t&&(e.value=t,e.dirty=!0)},e.prototype.setBlurY=function(t){var e=this.uniforms.blurY;e.value!=t&&(e.value=t,e.dirty=!0)},e.prototype.setStrength=function(t){var e=this.uniforms.strength;e.value!=t&&(e.value=t,e.dirty=!0)},e.prototype.setInner=function(t){var e=this.uniforms.inner;e.value!=t&&(e.value=t,e.dirty=!0)},e.prototype.setKnockout=function(t){var e=this.uniforms.knockout;e.value!=t&&(e.value=t,e.dirty=!0)},e.prototype.setHideObject=function(t){var e=this.uniforms.hideObject;e.value!=t&&(e.value=t,e.dirty=!0)},e.prototype.setTextureSize=function(t,e){var i=this.uniforms.uTextureSize;(t!=i.value.x||e!=i.value.y)&&(i.value.x=t,i.value.y=e,i.dirty=!0)},e}(t.TextureShader);t.GlowShader=e,__reflect(e.prototype,"egret.web.GlowShader")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function e(t){this.gl=null,this.maxAttibs=10,this.attribState=[],this.tempAttribState=[],this.currentShader=null,this.defaultShader=null,this.primitiveShader=null,this.colorTransformShader=null,this.blurShader=null,this.glowShader=null;for(var e=0;e<this.maxAttibs;e++)this.attribState[e]=!1;this.setContext(t)}return e.prototype.setContext=function(e){this.gl=e,this.primitiveShader=new t.PrimitiveShader(e),this.defaultShader=new t.TextureShader(e),this.colorTransformShader=new t.ColorTransformShader(e),this.glowShader=new t.GlowShader(e),this.blurShader=new t.BlurShader(e),this.primitiveShader.init(),this.defaultShader.init(),this.colorTransformShader.init(),this.blurShader.init(),this.glowShader.init()},e.prototype.activateShader=function(t,e){this.currentShader!=t&&(this.gl.useProgram(t.program),this.setAttribs(t.attributes),t.setAttribPointer(e),this.currentShader=t)},e.prototype.setAttribs=function(t){var e,i;for(i=this.tempAttribState.length,e=0;i>e;e++)this.tempAttribState[e]=!1;for(i=t.length,e=0;i>e;e++){var r=t[e];this.tempAttribState[r]=!0}var n=this.gl;for(i=this.attribState.length,e=0;i>e;e++)this.attribState[e]!==this.tempAttribState[e]&&(this.attribState[e]=this.tempAttribState[e],this.tempAttribState[e]?n.enableVertexAttribArray(e):n.disableVertexAttribArray(e))},e}();t.WebGLShaderManager=e,__reflect(e.prototype,"egret.web.WebGLShaderManager")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function t(){this.drawData=[],this.drawDataLen=0}return t.prototype.pushDrawRect=function(){if(0==this.drawDataLen||1!=this.drawData[this.drawDataLen-1].type){var t=this.drawData[this.drawDataLen]||{};t.type=1,t.count=0,this.drawData[this.drawDataLen]=t,this.drawDataLen++}this.drawData[this.drawDataLen-1].count+=2},t.prototype.pushDrawTexture=function(t,e,i,r,n){if(void 0===e&&(e=2),i){var o=this.drawData[this.drawDataLen]||{};o.type=0,o.texture=t,o.filter=i,o.count=e,o.textureWidth=r,o.textureHeight=n,this.drawData[this.drawDataLen]=o,this.drawDataLen++}else{if(0==this.drawDataLen||0!=this.drawData[this.drawDataLen-1].type||t!=this.drawData[this.drawDataLen-1].texture||this.drawData[this.drawDataLen-1].filter){var o=this.drawData[this.drawDataLen]||{};o.type=0,o.texture=t,o.count=0,this.drawData[this.drawDataLen]=o,this.drawDataLen++}this.drawData[this.drawDataLen-1].count+=e}},t.prototype.pushPushMask=function(t){void 0===t&&(t=1);var e=this.drawData[this.drawDataLen]||{};e.type=2,e.count=2*t,this.drawData[this.drawDataLen]=e,this.drawDataLen++},t.prototype.pushPopMask=function(t){void 0===t&&(t=1);var e=this.drawData[this.drawDataLen]||{};e.type=3,e.count=2*t,this.drawData[this.drawDataLen]=e,this.drawDataLen++},t.prototype.pushSetBlend=function(t){for(var e=this.drawDataLen,i=!1,r=e-1;r>=0;r--){var n=this.drawData[r];if(n){if((0==n.type||1==n.type)&&(i=!0),!i&&4==n.type){this.drawData.splice(r,1),this.drawDataLen--;continue}if(4==n.type){if(n.value==t)return;break}}}var o=this.drawData[this.drawDataLen]||{};o.type=4,o.value=t,this.drawData[this.drawDataLen]=o,this.drawDataLen++},t.prototype.pushResize=function(t,e,i){var r=this.drawData[this.drawDataLen]||{};r.type=5,r.buffer=t,r.width=e,r.height=i,this.drawData[this.drawDataLen]=r,this.drawDataLen++},t.prototype.pushClearColor=function(){var t=this.drawData[this.drawDataLen]||{};t.type=6,this.drawData[this.drawDataLen]=t,this.drawDataLen++},t.prototype.pushActivateBuffer=function(t){for(var e=this.drawDataLen,i=!1,r=e-1;r>=0;r--){var n=this.drawData[r];!n||(4!=n.type&&7!=n.type&&(i=!0),i||7!=n.type)||(this.drawData.splice(r,1),this.drawDataLen--)}var o=this.drawData[this.drawDataLen]||{};o.type=7,o.buffer=t,o.width=t.rootRenderTarget.width,o.height=t.rootRenderTarget.height,this.drawData[this.drawDataLen]=o,this.drawDataLen++},t.prototype.pushEnableScissor=function(t,e,i,r){var n=this.drawData[this.drawDataLen]||{};n.type=8,n.x=t,n.y=e,n.width=i,n.height=r,this.drawData[this.drawDataLen]=n,this.drawDataLen++},t.prototype.pushDisableScissor=function(){var t=this.drawData[this.drawDataLen]||{};t.type=9,this.drawData[this.drawDataLen]=t,this.drawDataLen++},t.prototype.clear=function(){for(var t=0;t<this.drawDataLen;t++){var e=this.drawData[t];e.type=0,e.count=0,e.texture=null,e.filter=null,e.uv=null,e.value="",e.buffer=null,e.width=0,e.height=0}this.drawDataLen=0},t}();t.WebGLDrawCmdManager=e,__reflect(e.prototype,"egret.web.WebGLDrawCmdManager")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function t(){this.size=2e3,this.vertexMaxSize=4*this.size,this.indicesMaxSize=6*this.size,this.vertSize=5,this.vertices=null,this.indices=null,this.indicesForMesh=null,this.vertexIndex=0,this.indexIndex=0,this.hasMesh=!1;var t=this.vertexMaxSize*this.vertSize,e=this.indicesMaxSize;this.vertices=new Float32Array(t),this.indices=new Uint16Array(e),this.indicesForMesh=new Uint16Array(e);for(var i=0,r=0;e>i;i+=6,r+=4)this.indices[i+0]=r+0,this.indices[i+1]=r+1,this.indices[i+2]=r+2,this.indices[i+3]=r+0,this.indices[i+4]=r+2,this.indices[i+5]=r+3}return t.prototype.reachMaxSize=function(t,e){return void 0===t&&(t=4),void 0===e&&(e=6),this.vertexIndex>this.vertexMaxSize-t||this.indexIndex>this.indicesMaxSize-e},t.prototype.getVertices=function(){var t=this.vertices.subarray(0,this.vertexIndex*this.vertSize);return t},t.prototype.getIndices=function(){return this.indices},t.prototype.getMeshIndices=function(){return this.indicesForMesh},t.prototype.changeToMeshIndices=function(){if(!this.hasMesh){for(var t=0,e=this.indexIndex;e>t;++t)this.indicesForMesh[t]=this.indices[t];this.hasMesh=!0}},t.prototype.isMesh=function(){return this.hasMesh},t.prototype.cacheArrays=function(t,e,i,r,n,o,a,s,l,h,u,c,p,d,f){var g=t,y=g.a,v=g.b,m=g.c,_=g.d,b=g.tx,T=g.ty;(0!=a||0!=s)&&g.append(1,0,0,1,a,s),(n/l!=1||o/h!=1)&&g.append(l/n,0,0,h/o,0,0);var x=g.a,E=g.b,$=g.c,S=g.d,C=g.tx,w=g.ty;if(g.a=y,g.b=v,g.c=m,g.d=_,g.tx=b,g.ty=T,d){var O=this.vertices,P=this.vertexIndex*this.vertSize,D=0,L=0,R=0,I=0,M=0,A=0,B=0;for(D=0,R=p.length;R>D;D+=2)L=5*D/2,A=d[D],B=d[D+1],I=p[D],M=p[D+1],O[P+L+0]=x*A+$*B+C,O[P+L+1]=E*A+S*B+w,O[P+L+2]=(i+I*n)/u,O[P+L+3]=(r+M*o)/c,O[P+L+4]=e;if(this.hasMesh)for(var N=0,F=f.length;F>N;++N)this.indicesForMesh[this.indexIndex+N]=f[N]+this.vertexIndex;this.vertexIndex+=p.length/2,this.indexIndex+=f.length}else{var k=u,j=c,U=n,H=o;i/=k,r/=j,n/=k,o/=j;var O=this.vertices,P=this.vertexIndex*this.vertSize;if(O[P++]=C,O[P++]=w,O[P++]=i,O[P++]=r,O[P++]=e,O[P++]=x*U+C,O[P++]=E*U+w,O[P++]=n+i,O[P++]=r,O[P++]=e,O[P++]=x*U+$*H+C,O[P++]=S*H+E*U+w,O[P++]=n+i,O[P++]=o+r,O[P++]=e,O[P++]=$*H+C,O[P++]=S*H+w,O[P++]=i,O[P++]=o+r,O[P++]=e,this.hasMesh){var V=this.indicesForMesh;V[this.indexIndex+0]=0+this.vertexIndex,V[this.indexIndex+1]=1+this.vertexIndex,V[this.indexIndex+2]=2+this.vertexIndex,V[this.indexIndex+3]=0+this.vertexIndex,V[this.indexIndex+4]=2+this.vertexIndex,V[this.indexIndex+5]=3+this.vertexIndex}this.vertexIndex+=4,this.indexIndex+=6}},t.prototype.clear=function(){this.hasMesh=!1,this.vertexIndex=0,this.indexIndex=0},t}();t.WebGLVertexArrayObject=e,__reflect(e.prototype,"egret.web.WebGLVertexArrayObject")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(t){function e(e,i,r){var n=t.call(this)||this;return n.clearColor=[0,0,0,0],n.useFrameBuffer=!0,n.gl=e,n.width=i||1,n.height=r||1,n.texture=n.createTexture(),n.frameBuffer=e.createFramebuffer(),e.bindFramebuffer(e.FRAMEBUFFER,n.frameBuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n.texture,0),n.stencilBuffer=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,n.stencilBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,n.stencilBuffer),n}return __extends(e,t),e.prototype.resize=function(t,e){var i=this.gl;i.bindTexture(i.TEXTURE_2D,this.texture),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,t,e,0,i.RGBA,i.UNSIGNED_BYTE,null),i.bindFramebuffer(i.FRAMEBUFFER,this.frameBuffer),i.bindRenderbuffer(i.RENDERBUFFER,this.stencilBuffer),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t,e),this.width=t,this.height=e},e.prototype.activate=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer())},e.prototype.getFrameBuffer=function(){return this.useFrameBuffer?this.frameBuffer:null},e.prototype.createTexture=function(){var t=this.gl,e=t.createTexture();return t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),e},e.prototype.clear=function(t){var e=this.gl;t&&this.activate(),e.colorMask(!0,!0,!0,!0),e.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),e.clear(e.COLOR_BUFFER_BIT)},e}(t.HashObject);e.WebGLRenderTarget=i,__reflect(i.prototype,"egret.web.WebGLRenderTarget")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function i(t,e){var i=document.createElement("canvas");return isNaN(t)||isNaN(e)||(i.width=t,i.height=e),i}var r=function(){function r(t,r){this.glID=null,this.projectionX=0/0,this.projectionY=0/0,this.shaderManager=null,this.contextLost=!1,this.$scissorState=!1,this.vertSize=5,this.blurFilter=null,this.surface=i(t,r),this.initWebGL(),this.$bufferStack=[];var n=this.context;this.vertexBuffer=n.createBuffer(),this.indexBuffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.vertexBuffer),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer),this.drawCmdManager=new e.WebGLDrawCmdManager,this.vao=new e.WebGLVertexArrayObject,this.setGlobalCompositeOperation("source-over")}return r.getInstance=function(t,e){return this.instance?this.instance:(this.instance=new r(t,e),this.instance)},r.prototype.pushBuffer=function(t){this.$bufferStack.push(t),t!=this.currentBuffer&&(this.currentBuffer,this.drawCmdManager.pushActivateBuffer(t)),this.currentBuffer=t},r.prototype.popBuffer=function(){if(!(this.$bufferStack.length<=1)){var t=this.$bufferStack.pop(),e=this.$bufferStack[this.$bufferStack.length-1];t!=e&&this.drawCmdManager.pushActivateBuffer(e),this.currentBuffer=e}},r.prototype.activateBuffer=function(t){t.rootRenderTarget.activate(),this.bindIndices||(this.uploadIndicesArray(this.vao.getIndices()),this.bindIndices=!0),t.restoreStencil(),t.restoreScissor(),this.onResize(t.width,t.height)},r.prototype.uploadVerticesArray=function(t){var e=this.context;e.bufferData(e.ARRAY_BUFFER,t,e.STREAM_DRAW)},r.prototype.uploadIndicesArray=function(t){var e=this.context;e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)},r.prototype.destroy=function(){this.surface.width=this.surface.height=0},r.prototype.onResize=function(t,e){t=t||this.surface.width,e=e||this.surface.height,this.projectionX=t/2,this.projectionY=-e/2,this.context&&this.context.viewport(0,0,t,e)},r.prototype.resize=function(t,e,i){var r=this.surface;i?(r.width<t&&(r.width=t),r.height<e&&(r.height=e)):(r.width!=t&&(r.width=t),r.height!=e&&(r.height=e)),this.onResize()},r.prototype.initWebGL=function(){this.onResize(),this.surface.addEventListener("webglcontextlost",this.handleContextLost.bind(this),!1),this.surface.addEventListener("webglcontextrestored",this.handleContextRestored.bind(this),!1),this.getWebGLContext(),this.shaderManager=new e.WebGLShaderManager(this.context)},r.prototype.handleContextLost=function(){this.contextLost=!0},r.prototype.handleContextRestored=function(){this.initWebGL(),this.contextLost=!1},r.prototype.getWebGLContext=function(){for(var e,i={antialias:r.antialias,stencil:!0},n=["webgl","experimental-webgl"],o=0;o<n.length;o++){try{e=this.surface.getContext(n[o],i)}catch(a){}if(e)break}e||t.$error(1021),this.setContext(e)},r.prototype.setContext=function(t){this.context=t,t.id=r.glContextId++,this.glID=t.id,t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE),t.enable(t.BLEND),t.colorMask(!0,!0,!0,!0),t.activeTexture(t.TEXTURE0)},r.prototype.enableStencilTest=function(){var t=this.context;t.enable(t.STENCIL_TEST)},r.prototype.disableStencilTest=function(){var t=this.context;t.disable(t.STENCIL_TEST)},r.prototype.enableScissorTest=function(t){var e=this.context;e.enable(e.SCISSOR_TEST),e.scissor(t.x,t.y,t.width,t.height)},r.prototype.disableScissorTest=function(){var t=this.context;t.disable(t.SCISSOR_TEST)},r.prototype.getPixels=function(t,e,i,r,n){var o=this.context;o.readPixels(t,e,i,r,o.RGBA,o.UNSIGNED_BYTE,n)},r.prototype.createTexture=function(t){var e=this.context,i=e.createTexture();return i?(i.glContext=e,e.bindTexture(e.TEXTURE_2D,i),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),i):void(this.contextLost=!0)},r.prototype.createTextureFromCompressedData=function(){return null},r.prototype.updateTexture=function(t,e){var i=this.context;i.bindTexture(i.TEXTURE_2D,t),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,e)},r.prototype.getWebGLTexture=function(t){return t.webGLTexture||("image"==t.format?t.webGLTexture=this.createTexture(t.source):"pvr"==t.format&&(t.webGLTexture=this.createTextureFromCompressedData(t.source.pvrtcData,t.width,t.height,t.source.mipmapsCount,t.source.format)),t.$deleteSource&&t.webGLTexture&&(t.source=null)),t.webGLTexture},r.prototype.clearRect=function(t,e,i,r){if(0!=t||0!=e||i!=this.surface.width||r!=this.surface.height){var n=this.currentBuffer;if(n.$hasScissor)this.setGlobalCompositeOperation("destination-out"),this.drawRect(t,e,i,r),this.setGlobalCompositeOperation("source-over");else{var o=n.globalMatrix;0==o.b&&0==o.c?(t=t*o.a+o.tx,e=e*o.d+o.ty,i*=o.a,r*=o.d,this.enableScissor(t,-e-r+n.height,i,r),this.clear(),this.disableScissor()):(this.setGlobalCompositeOperation("destination-out"),this.drawRect(t,e,i,r),this.setGlobalCompositeOperation("source-over"))}}else this.clear()},r.prototype.setGlobalCompositeOperation=function(t){this.drawCmdManager.pushSetBlend(t)},r.prototype.drawImage=function(t,e,i,r,n,o,a,s,l,h,u){var c=this.currentBuffer;if(!this.contextLost&&t&&c){var p;if(t.texture||t.source&&t.source.texture)p=t.texture||t.source.texture,c.saveTransform(),c.transform(1,0,0,-1,0,l+2*a);else{if(!t.source&&!t.webGLTexture)return;p=this.getWebGLTexture(t)}p&&(this.drawTexture(p,e,i,r,n,o,a,s,l,h,u),t.source&&t.source.texture&&c.restoreTransform())}},r.prototype.drawMesh=function(t,e,i,r,n,o,a,s,l,h,u,c,p,d,f){var g=this.currentBuffer;if(!this.contextLost&&t&&g){var y;if(t.texture||t.source&&t.source.texture)y=t.texture||t.source.texture,g.saveTransform(),g.transform(1,0,0,-1,0,l+2*a);else{if(!t.source&&!t.webGLTexture)return;y=this.getWebGLTexture(t)}y&&this.drawTexture(y,e,i,r,n,o,a,s,l,h,u,c,p,d,f)}},r.prototype.drawTexture=function(t,e,i,r,n,o,a,s,l,h,u,c,p,d){var f=this.currentBuffer;if(!this.contextLost&&t&&f){p&&d?this.vao.reachMaxSize(p.length/2,d.length)&&this.$drawWebGL():this.vao.reachMaxSize()&&this.$drawWebGL(),c&&this.vao.changeToMeshIndices();var g=f.globalMatrix,y=f.globalAlpha,v=d?d.length/3:2;this.drawCmdManager.pushDrawTexture(t,v,this.$filter),this.vao.cacheArrays(g,y,e,i,r,n,o,a,s,l,h,u,c,p,d)}},r.prototype.drawRect=function(t,e,i,r){var n=this.currentBuffer;!this.contextLost&&n&&(this.vao.reachMaxSize()&&this.$drawWebGL(),this.drawCmdManager.pushDrawRect(),this.vao.cacheArrays(n.globalMatrix,n.globalAlpha,0,0,i,r,t,e,i,r,i,r))},r.prototype.pushMask=function(t){var e=this.currentBuffer;if(!this.contextLost&&e){e.$stencilList.push(t),this.vao.reachMaxSize()&&this.$drawWebGL();var i=t.length;if(i){this.drawCmdManager.pushPushMask(i);for(var r=0;i>r;r++){var n=t[r];this.vao.cacheArrays(e.globalMatrix,e.globalAlpha,0,0,n.width,n.height,n.minX,n.minY,n.width,n.height,n.width,n.height)}}else this.drawCmdManager.pushPushMask(),this.vao.cacheArrays(e.globalMatrix,e.globalAlpha,0,0,t.width,t.height,t.x,t.y,t.width,t.height,t.width,t.height)}},r.prototype.popMask=function(){var t=this.currentBuffer;if(!this.contextLost&&t){var e=t.$stencilList.pop();this.vao.reachMaxSize()&&this.$drawWebGL();var i=e.length;if(i){this.drawCmdManager.pushPopMask(i);for(var r=0;i>r;r++){var n=e[r];this.vao.cacheArrays(t.globalMatrix,t.globalAlpha,0,0,n.width,n.height,n.minX,n.minY,n.width,n.height,n.width,n.height)}}else this.drawCmdManager.pushPopMask(),this.vao.cacheArrays(t.globalMatrix,t.globalAlpha,0,0,e.width,e.height,e.x,e.y,e.width,e.height,e.width,e.height)}},r.prototype.clear=function(){this.drawCmdManager.pushClearColor()},r.prototype.enableScissor=function(t,e,i,r){var n=this.currentBuffer;this.drawCmdManager.pushEnableScissor(t,e,i,r),n.$hasScissor=!0},r.prototype.disableScissor=function(){var t=this.currentBuffer;this.drawCmdManager.pushDisableScissor(),t.$hasScissor=!1},r.prototype.$drawWebGL=function(){if(0!=this.drawCmdManager.drawDataLen&&!this.contextLost){this.uploadVerticesArray(this.vao.getVertices()),this.vao.isMesh()&&this.uploadIndicesArray(this.vao.getMeshIndices());for(var t=this.drawCmdManager.drawDataLen,e=0,i=0;t>i;i++){var r=this.drawCmdManager.drawData[i];e=this.drawData(r,e),7==r.type&&(this.activatedBuffer=r.buffer),(0==r.type||1==r.type||2==r.type||3==r.type)&&this.activatedBuffer&&this.activatedBuffer.$computeDrawCall&&this.activatedBuffer.$drawCalls++}this.vao.isMesh()&&this.uploadIndicesArray(this.vao.getIndices()),this.drawCmdManager.clear(),this.vao.clear()}},r.prototype.drawData=function(t,e){if(t){var i;switch(t.type){case 0:var r=t.filter;r?"colorTransform"==r.type?(i=this.shaderManager.colorTransformShader,i.setMatrix(r.$matrix)):"blur"==r.type?(i=this.shaderManager.blurShader,i.setBlur(r.$blurX,r.$blurY),i.setTextureSize(t.textureWidth,t.textureHeight)):"glow"==r.type&&(i=this.shaderManager.glowShader,i.setDistance(r.$distance||0),i.setAngle(r.$angle?r.$angle/180*Math.PI:0),i.setColor(r.$red/255,r.$green/255,r.$blue/255),i.setAlpha(r.$alpha),i.setBlurX(r.$blurX),i.setBlurY(r.$blurY),i.setStrength(r.$strength),i.setInner(r.$inner?1:0),i.setKnockout(r.$knockout?0:1),i.setHideObject(r.$hideObject?1:0),i.setTextureSize(t.textureWidth,t.textureHeight)):i=this.shaderManager.defaultShader,i.setProjection(this.projectionX,this.projectionY),this.shaderManager.activateShader(i,4*this.vertSize),i.syncUniforms(),e+=this.drawTextureElements(t,e);break;case 1:i=this.shaderManager.primitiveShader,i.setProjection(this.projectionX,this.projectionY),this.shaderManager.activateShader(i,4*this.vertSize),i.syncUniforms(),e+=this.drawRectElements(t,e);
break;case 2:i=this.shaderManager.primitiveShader,i.setProjection(this.projectionX,this.projectionY),this.shaderManager.activateShader(i,4*this.vertSize),i.syncUniforms(),e+=this.drawPushMaskElements(t,e);break;case 3:i=this.shaderManager.primitiveShader,i.setProjection(this.projectionX,this.projectionY),this.shaderManager.activateShader(i,4*this.vertSize),i.syncUniforms(),e+=this.drawPopMaskElements(t,e);break;case 4:this.setBlendMode(t.value);break;case 5:t.buffer.rootRenderTarget.resize(t.width,t.height),this.onResize(t.width,t.height);break;case 6:if(this.activatedBuffer){var n=this.activatedBuffer.rootRenderTarget;(0!=n.width||0!=n.height)&&n.clear()}break;case 7:this.activateBuffer(t.buffer);break;case 8:var o=this.activatedBuffer;o&&o.enableScissor(t.x,t.y,t.width,t.height);break;case 9:o=this.activatedBuffer,o&&o.disableScissor()}return e}},r.prototype.drawTextureElements=function(t,e){var i=this.context;i.bindTexture(i.TEXTURE_2D,t.texture);var r=3*t.count;return i.drawElements(i.TRIANGLES,r,i.UNSIGNED_SHORT,2*e),r},r.prototype.drawRectElements=function(t,e){var i=this.context,r=3*t.count;return i.drawElements(i.TRIANGLES,r,i.UNSIGNED_SHORT,2*e),r},r.prototype.drawPushMaskElements=function(t,e){var i=this.context,r=3*t.count,n=this.activatedBuffer;if(n){0==n.stencilHandleCount&&(n.enableStencil(),i.clear(i.STENCIL_BUFFER_BIT));var o=n.stencilHandleCount;n.stencilHandleCount++,i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,o,255),i.stencilOp(i.KEEP,i.KEEP,i.INCR),i.drawElements(i.TRIANGLES,r,i.UNSIGNED_SHORT,2*e),i.stencilFunc(i.EQUAL,o+1,255),i.colorMask(!0,!0,!0,!0),i.stencilOp(i.KEEP,i.KEEP,i.KEEP)}return r},r.prototype.drawPopMaskElements=function(t,e){var i=this.context,r=3*t.count,n=this.activatedBuffer;if(n)if(n.stencilHandleCount--,0==n.stencilHandleCount)n.disableStencil();else{var o=n.stencilHandleCount;i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,o+1,255),i.stencilOp(i.KEEP,i.KEEP,i.DECR),i.drawElements(i.TRIANGLES,r,i.UNSIGNED_SHORT,2*e),i.stencilFunc(i.EQUAL,o,255),i.colorMask(!0,!0,!0,!0),i.stencilOp(i.KEEP,i.KEEP,i.KEEP)}return r},r.prototype.setBlendMode=function(t){var e=this.context,i=r.blendModesForGL[t];i&&e.blendFunc(i[0],i[1])},r.prototype.drawTargetWidthFilters=function(t,i){var r,n=i,o=t.length;if(o>1)for(var a=0;o-1>a;a++){var s=t[a],l=i.rootRenderTarget.width,h=i.rootRenderTarget.height;r=e.WebGLRenderBuffer.create(l,h),r.setTransform(1,0,0,1,0,0),r.globalAlpha=1,this.drawToRenderTarget(s,i,r),i!=n&&e.WebGLRenderBuffer.release(i),i=r}var u=t[o-1];this.drawToRenderTarget(u,i,this.currentBuffer),i!=n&&e.WebGLRenderBuffer.release(i)},r.prototype.drawToRenderTarget=function(i,r,n){if(!this.contextLost){this.vao.reachMaxSize()&&this.$drawWebGL(),this.pushBuffer(n);var o,a=r,s=r.rootRenderTarget.width,l=r.rootRenderTarget.height;"blur"==i.type&&(this.blurFilter||(this.blurFilter=new t.BlurFilter(2,2)),0!=i.blurX&&0!=i.blurY?(this.blurFilter.blurX=i.blurX,this.blurFilter.blurY=0,o=e.WebGLRenderBuffer.create(s,l),o.setTransform(1,0,0,1,0,0),o.globalAlpha=1,this.drawToRenderTarget(this.blurFilter,r,o),r!=a&&e.WebGLRenderBuffer.release(r),r=o,this.blurFilter.blurX=0,this.blurFilter.blurY=i.blurY):(this.blurFilter.blurX=i.blurX,this.blurFilter.blurY=i.blurY),i=this.blurFilter),n.saveTransform(),n.transform(1,0,0,-1,0,l),this.vao.cacheArrays(n.globalMatrix,n.globalAlpha,0,0,s,l,0,0,s,l,s,l),n.restoreTransform();var h;h="blur"==i.type?{type:"blur",$blurX:i.$blurX,$blurY:i.$blurY}:i,this.drawCmdManager.pushDrawTexture(r.rootRenderTarget.texture,2,h,s,l),r!=a&&e.WebGLRenderBuffer.release(r),this.popBuffer()}},r.initBlendMode=function(){r.blendModesForGL={},r.blendModesForGL["source-over"]=[1,771],r.blendModesForGL.lighter=[1,1],r.blendModesForGL["lighter-in"]=[770,771],r.blendModesForGL["destination-out"]=[0,771],r.blendModesForGL["destination-in"]=[0,770]},r}();r.glContextId=0,r.blendModesForGL=null,e.WebGLRenderContext=r,__reflect(r.prototype,"egret.web.WebGLRenderContext"),r.initBlendMode()}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(i){function n(r,n,o){var a=i.call(this)||this;if(a.globalAlpha=1,a.stencilState=!1,a.$stencilList=[],a.stencilHandleCount=0,a.$scissorState=!1,a.scissorRect=new t.Rectangle,a.$hasScissor=!1,a.dirtyRegionPolicy=!0,a._dirtyRegionPolicy=!0,a.$drawCalls=0,a.$computeDrawCall=!1,a.globalMatrix=new t.Matrix,a.savedGlobalMatrix=new t.Matrix,a.context=e.WebGLRenderContext.getInstance(r,n),a.rootRenderTarget=new e.WebGLRenderTarget(a.context.context,3,3),r&&n&&a.resize(r,n),a.root=o,a.root)a.context.pushBuffer(a),a.surface=a.context.surface;else{var s=a.context.activatedBuffer;s&&s.rootRenderTarget.activate(),a.surface=a.rootRenderTarget}return a}return __extends(n,i),n.prototype.enableStencil=function(){this.stencilState||(this.context.enableStencilTest(),this.stencilState=!0)},n.prototype.disableStencil=function(){this.stencilState&&(this.context.disableStencilTest(),this.stencilState=!1)},n.prototype.restoreStencil=function(){this.stencilState?this.context.enableStencilTest():this.context.disableStencilTest()},n.prototype.enableScissor=function(t,e,i,r){this.$scissorState||(this.$scissorState=!0,this.scissorRect.setTo(t,e,i,r),this.context.enableScissorTest(this.scissorRect))},n.prototype.disableScissor=function(){this.$scissorState&&(this.$scissorState=!1,this.scissorRect.setEmpty(),this.context.disableScissorTest())},n.prototype.restoreScissor=function(){this.$scissorState?this.context.enableScissorTest(this.scissorRect):this.context.disableScissorTest()},Object.defineProperty(n.prototype,"width",{get:function(){return this.rootRenderTarget.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.rootRenderTarget.height},enumerable:!0,configurable:!0}),n.prototype.resize=function(t,e,i){this.context.pushBuffer(this),t=t||1,e=e||1,(t!=this.rootRenderTarget.width||e!=this.rootRenderTarget.height)&&(this.context.drawCmdManager.pushResize(this,t,e),this.rootRenderTarget.width=t,this.rootRenderTarget.height=e),this.root&&this.context.resize(t,e,i),this.context.clear(),this.context.popBuffer()},n.prototype.resizeTo=function(t,e,i,r){this.context.pushBuffer(this);var o=this.rootRenderTarget.width,a=this.rootRenderTarget.height,s=n.create(o,a);this.context.pushBuffer(s),this.context.drawImage(this.rootRenderTarget,0,0,o,a,0,0,o,a,o,a),this.context.popBuffer(),this.resize(t,e),this.setTransform(1,0,0,1,0,0),this.context.drawImage(s.rootRenderTarget,0,0,o,a,i,r,o,a,o,a),n.release(s),this.context.popBuffer()},n.prototype.setDirtyRegionPolicy=function(t){this.dirtyRegionPolicy="on"==t},n.prototype.beginClip=function(t,e,i){this.context.pushBuffer(this),this.root&&(this._dirtyRegionPolicy?(this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate()):(this.rootRenderTarget.useFrameBuffer=!1,this.rootRenderTarget.activate(),this.context.clear())),e=+e||0,i=+i||0,this.setTransform(1,0,0,1,e,i);var r=t.length;if(1==r&&0==t[0].minX&&0==t[0].minY&&t[0].width==this.rootRenderTarget.width&&t[0].height==this.rootRenderTarget.height)return this.maskPushed=!1,this.rootRenderTarget.useFrameBuffer&&this.context.clear(),void this.context.popBuffer();for(var n=0;r>n;n++){var o=t[n];this.context.clearRect(o.minX,o.minY,o.width,o.height)}if(r>0){if(this.$hasScissor||1!=r)this.scissorEnabled=!1;else{var o=t[0];t=t.slice(1);var a=o.minX+e,s=o.minY+i,l=o.width,h=o.height;this.context.enableScissor(a,-s-h+this.height,l,h),this.scissorEnabled=!0}t.length>0?(this.context.pushMask(t),this.maskPushed=!0):this.maskPushed=!1,this.offsetX=e,this.offsetY=i}else this.maskPushed=!1;this.context.popBuffer()},n.prototype.endClip=function(){(this.maskPushed||this.scissorEnabled)&&(this.context.pushBuffer(this),this.maskPushed&&(this.setTransform(1,0,0,1,this.offsetX,this.offsetY),this.context.popMask()),this.scissorEnabled&&this.context.disableScissor(),this.context.popBuffer())},n.prototype.getPixels=function(t,e,i,r){void 0===i&&(i=1),void 0===r&&(r=1);var n=new Uint8Array(4*i*r),o=this.rootRenderTarget.useFrameBuffer;this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate(),this.context.getPixels(t,e,i,r,n),this.rootRenderTarget.useFrameBuffer=o,this.rootRenderTarget.activate();for(var a=new Uint8Array(4*i*r),s=0;r>s;s++)for(var l=0;i>l;l++)a[4*(i*(r-s-1)+l)]=n[4*(i*s+l)],a[4*(i*(r-s-1)+l)+1]=n[4*(i*s+l)+1],a[4*(i*(r-s-1)+l)+2]=n[4*(i*s+l)+2],a[4*(i*(r-s-1)+l)+3]=n[4*(i*s+l)+3];return a},n.prototype.toDataURL=function(t,e){return this.context.surface.toDataURL(t,e)},n.prototype.destroy=function(){this.context.destroy()},n.prototype.onRenderFinish=function(){this.$drawCalls=0,this.root&&(!this._dirtyRegionPolicy&&this.dirtyRegionPolicy&&this.drawSurfaceToFrameBuffer(0,0,this.rootRenderTarget.width,this.rootRenderTarget.height,0,0,this.rootRenderTarget.width,this.rootRenderTarget.height,!0),this._dirtyRegionPolicy&&this.drawFrameBufferToSurface(0,0,this.rootRenderTarget.width,this.rootRenderTarget.height,0,0,this.rootRenderTarget.width,this.rootRenderTarget.height),this._dirtyRegionPolicy=this.dirtyRegionPolicy)},n.prototype.drawFrameBufferToSurface=function(t,e,i,r,n,o,a,s,l){void 0===l&&(l=!1),this.rootRenderTarget.useFrameBuffer=!1,this.rootRenderTarget.activate(),this.context.disableStencilTest(),this.context.disableScissorTest(),this.setTransform(1,0,0,1,0,0),this.globalAlpha=1,this.context.setGlobalCompositeOperation("source-over"),l&&this.context.clear(),this.context.drawImage(this.rootRenderTarget,t,e,i,r,n,o,a,s,i,r),this.context.$drawWebGL(),this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate(),this.restoreStencil(),this.restoreScissor()},n.prototype.drawSurfaceToFrameBuffer=function(t,e,i,r,n,o,a,s,l){void 0===l&&(l=!1),this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate(),this.context.disableStencilTest(),this.context.disableScissorTest(),this.setTransform(1,0,0,1,0,0),this.globalAlpha=1,this.context.setGlobalCompositeOperation("source-over"),l&&this.context.clear(),this.context.drawImage(this.context.surface,t,e,i,r,n,o,a,s,i,r),this.context.$drawWebGL(),this.rootRenderTarget.useFrameBuffer=!1,this.rootRenderTarget.activate(),this.restoreStencil(),this.restoreScissor()},n.prototype.clear=function(){this.context.clear()},n.prototype.setTransform=function(t,e,i,r,n,o){var a=this.globalMatrix;a.a=t,a.b=e,a.c=i,a.d=r,a.tx=n,a.ty=o},n.prototype.transform=function(t,e,i,r,n,o){var a=this.globalMatrix,s=a.a,l=a.b,h=a.c,u=a.d;(1!=t||0!=e||0!=i||1!=r)&&(a.a=t*s+e*h,a.b=t*l+e*u,a.c=i*s+r*h,a.d=i*l+r*u),a.tx=n*s+o*h+a.tx,a.ty=n*l+o*u+a.ty},n.prototype.translate=function(t,e){var i=this.globalMatrix;i.tx+=t,i.ty+=e},n.prototype.saveTransform=function(){var t=this.globalMatrix,e=this.savedGlobalMatrix;e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.tx=t.tx,e.ty=t.ty},n.prototype.restoreTransform=function(){var t=this.globalMatrix,e=this.savedGlobalMatrix;t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t.tx=e.tx,t.ty=e.ty},n.create=function(t,e){var i=r.pop();if(i){i.resize(t,e);var o=i.globalMatrix;o.a=1,o.b=0,o.c=0,o.d=1,o.tx=0,o.ty=0}else i=new n(t,e),i.$computeDrawCall=!1;return i},n.release=function(t){r.push(t)},n}(t.HashObject);e.WebGLRenderBuffer=i,__reflect(i.prototype,"egret.web.WebGLRenderBuffer",["egret.sys.RenderBuffer"]);var r=[]}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(i,r,n,o,a){var s=e.call(this)||this;if(s.showPanle=!0,s.fpsHeight=0,s.WIDTH=101,s.HEIGHT=20,s.bgCanvasColor="#18304b",s.fpsFrontColor="#18fefe",s.WIDTH_COST=33,s.cost1Color="#18fefe",s.cost2Color="#ffff00",s.cost3Color="#ff0000",s.arrFps=[],s.arrCost=[],s.arrLog=[],r||n){s.renderMode="canvas"==t.Capabilities.renderMode?"Canvas":"WebGL",s.panelX=void 0===a.x?0:parseInt(a.x),s.panelY=void 0===a.y?0:parseInt(a.y),s.fontColor=void 0===a.textColor?"#ffffff":a.textColor.replace("0x","#"),s.fontSize=void 0===a.size?12:parseInt(a.size),t.Capabilities.isMobile&&(s.fontSize-=2);var l=document.createElement("div");l.style.position="absolute",l.style.background="rgba(0,0,0,"+a.bgAlpha+")",l.style.left=s.panelX+"px",l.style.top=s.panelY+"px",l.style.pointerEvents="none",document.body.appendChild(l);var h=document.createElement("div");h.style.color=s.fontColor,h.style.fontSize=s.fontSize+"px",h.style.lineHeight=s.fontSize+"px",h.style.margin="4px 4px 4px 4px",s.container=h,l.appendChild(h),r&&s.addFps(),n&&s.addLog()}return s}return __extends(i,e),i.prototype.addFps=function(){var t=document.createElement("div");t.style.display="inline-block",this.containerFps=t,this.container.appendChild(t);var e=document.createElement("div");e.style.paddingBottom="2px",this.fps=e,this.containerFps.appendChild(e),e.innerHTML="0 FPS "+this.renderMode+"<br/>min0 max0 avg0";var i=document.createElement("canvas");this.containerFps.appendChild(i),i.width=this.WIDTH,i.height=this.HEIGHT,this.canvasFps=i;var r=i.getContext("2d");this.contextFps=r,r.fillStyle=this.bgCanvasColor,r.fillRect(0,0,this.WIDTH,this.HEIGHT);var n=document.createElement("div");this.divDatas=n,this.containerFps.appendChild(n);var o=document.createElement("div");o.style["float"]="left",o.innerHTML="Draw<br/>Dirty<br/>Cost",n.appendChild(o);var a=document.createElement("div");a.style.paddingLeft=o.offsetWidth+20+"px",n.appendChild(a);var s=document.createElement("div");this.divDraw=s,s.innerHTML="0<br/>0<br/>",a.appendChild(s);var l=document.createElement("div");this.divCost=l,l.innerHTML='<font  style="color:'+this.cost1Color+'">0<font/> <font  style="color:'+this.cost2Color+'">0<font/> <font  style="color:'+this.cost3Color+'">0<font/>',a.appendChild(l),i=document.createElement("canvas"),this.canvasCost=i,this.containerFps.appendChild(i),i.width=this.WIDTH,i.height=this.HEIGHT,r=i.getContext("2d"),this.contextCost=r,r.fillStyle=this.bgCanvasColor,r.fillRect(0,0,this.WIDTH,this.HEIGHT),r.fillStyle="#000000",r.fillRect(this.WIDTH_COST,0,1,this.HEIGHT),r.fillRect(2*this.WIDTH_COST+1,0,1,this.HEIGHT),this.fpsHeight=this.container.offsetHeight},i.prototype.addLog=function(){var t=document.createElement("div");t.style.maxWidth=document.body.clientWidth-8-this.panelX+"px",t.style.wordWrap="break-word",this.log=t,this.container.appendChild(t)},i.prototype.update=function(t,e){void 0===e&&(e=!1);var i,r,n,o;e?(i=this.arrFps[this.arrFps.length-1],r=this.arrCost[this.arrCost.length-1][0],n=this.arrCost[this.arrCost.length-1][1],o=this.arrCost[this.arrCost.length-1][2]):(i=t.fps,r=t.costTicker,n=t.costDirty,o=t.costRender,this.lastNumDraw=t.draw,this.lastNumDirty=t.dirty,this.arrFps.push(i),this.arrCost.push([r,n,o]));var a=0,s=this.arrFps.length;s>101&&(s=101,this.arrFps.shift());for(var l=this.arrFps[0],h=this.arrFps[0],u=0;s>u;u++){var c=this.arrFps[u];a+=c,l>c?l=c:c>h&&(h=c)}var p=this.WIDTH,d=this.HEIGHT,f=this.contextFps;f.drawImage(this.canvasFps,1,0,p-1,d,0,0,p-1,d),f.fillStyle=this.bgCanvasColor,f.fillRect(p-1,0,1,d);var g=Math.floor(i/60*20);1>g&&(g=1),f.fillStyle=this.fpsFrontColor,f.fillRect(p-1,20-g,1,g);var y=this.WIDTH_COST;f=this.contextCost,f.drawImage(this.canvasCost,1,0,y-1,d,0,0,y-1,d),f.drawImage(this.canvasCost,y+2,0,y-1,d,y+1,0,y-1,d),f.drawImage(this.canvasCost,2*y+3,0,y-1,d,2*y+2,0,y-1,d);var v=Math.floor(r/2);1>v?v=1:v>20&&(v=20);var m=Math.floor(n/2);1>m?m=1:m>20&&(m=20);var _=Math.floor(o/2);1>_?_=1:_>20&&(_=20),f.fillStyle=this.bgCanvasColor,f.fillRect(y-1,0,1,d),f.fillRect(2*y,0,1,d),f.fillRect(3*y+1,0,1,d),f.fillStyle=this.cost1Color,f.fillRect(y-1,20-v,1,v),f.fillStyle=this.cost2Color,f.fillRect(2*y,20-m,1,m),f.fillStyle=this.cost3Color,f.fillRect(3*y+1,20-_,1,_);var b=Math.floor(a/s),T=i+" FPS "+this.renderMode;this.showPanle&&(T+="<br/>min"+l+" max"+h+" avg"+b,this.divDraw.innerHTML=this.lastNumDraw+"<br/>"+this.lastNumDirty+"%<br/>",this.divCost.innerHTML='<font  style="color:#18fefe">'+r+'<font/> <font  style="color:#ffff00">'+n+'<font/> <font  style="color:#ff0000">'+o+"<font/>"),this.fps.innerHTML=T},i.prototype.updateInfo=function(t){for(this.arrLog.push(t),this.log.innerHTML=this.arrLog.join("<br/>");document.body.clientHeight<this.log.offsetHeight+this.fpsHeight+this.panelY+2*this.fontSize;)this.arrLog.shift(),this.log.innerHTML=this.arrLog.join("<br/>")},i}(t.DisplayObject);e.WebFps=i,__reflect(i.prototype,"egret.web.WebFps",["egret.FPSDisplay"]),t.FPSDisplay=i}(e=t.web||(t.web={}))}(egret||(egret={}));var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},egret;!function(t){var e=function(t){function e(e,i,r){var n=t.call(this)||this;return n._name=e,n._frame=0|i,r&&(n._end=0|r),n}return __extends(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frame",{get:function(){return this._frame},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this._end},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this._name,this._frame,this._end)},e}(t.EventDispatcher);t.FrameLabel=e,__reflect(e.prototype,"egret.FrameLabel")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(i){var r=e.call(this)||this;return r.$bitmapData=null,r.offsetPoint=t.Point.create(0,0),r.$movieClipData=null,r.frames=null,r.$totalFrames=0,r.frameLabels=null,r.$frameLabelStart=0,r.$frameLabelEnd=0,r.frameEvents=null,r.frameIntervalTime=0,r.$eventPool=null,r.$isPlaying=!1,r.isStopped=!0,r.playTimes=0,r.$currentFrameNum=0,r.$nextFrameNum=1,r.displayedKeyFrameNum=0,r.passedTime=0,r.$frameRate=0/0,r.lastTime=0,r.$smoothing=t.Bitmap.defaultSmoothing,r.$renderNode=new t.sys.BitmapNode,r.setMovieClipData(i),r}return __extends(i,e),Object.defineProperty(i.prototype,"smoothing",{get:function(){return this.$smoothing},set:function(t){t=!!t,t!=this.$smoothing&&(this.$smoothing=t,this.$invalidate())},enumerable:!0,configurable:!0}),i.prototype.$init=function(){this.$reset();var t=this.$movieClipData;t&&t.$isDataValid()&&(this.frames=t.frames,this.$totalFrames=t.numFrames,this.frameLabels=t.labels,this.frameEvents=t.events,this.$frameRate=t.frameRate,this.frameIntervalTime=1e3/this.$frameRate,this._initFrame())},i.prototype.$reset=function(){this.frames=null,this.playTimes=0,this.$isPlaying=!1,this.setIsStopped(!0),this.$currentFrameNum=0,this.$nextFrameNum=1,this.displayedKeyFrameNum=0,this.passedTime=0,this.$eventPool=[]},i.prototype._initFrame=function(){this.$movieClipData.$isTextureValid()&&(this.advanceFrame(),this.constructFrame())},i.prototype.$render=function(){var e=this.$bitmapData;if(e){var i=Math.round(this.offsetPoint.x),r=Math.round(this.offsetPoint.y),n=e._bitmapWidth,o=e._bitmapHeight,a=e.$getTextureWidth(),s=e.$getTextureHeight(),l=Math.round(e.$getScaleBitmapWidth()),h=Math.round(e.$getScaleBitmapHeight()),u=e._sourceWidth,c=e._sourceHeight;t.sys.BitmapNode.$updateTextureData(this.$renderNode,e._bitmapData,e._bitmapX,e._bitmapY,n,o,i,r,a,s,l,h,u,c,null,t.BitmapFillMode.SCALE,this.$smoothing)}},i.prototype.$measureContentBounds=function(t){var e=this.$bitmapData;if(e){var i=this.offsetPoint.x,r=this.offsetPoint.y,n=e.$getTextureWidth(),o=e.$getTextureHeight();t.setTo(i,r,n,o)}else t.setEmpty()},i.prototype.$onAddToStage=function(t,i){e.prototype.$onAddToStage.call(this,t,i),this.$isPlaying&&this.$totalFrames>1&&this.setIsStopped(!1)},i.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this),this.setIsStopped(!0)},i.prototype.getFrameLabelByName=function(t,e){void 0===e&&(e=!1),e&&(t=t.toLowerCase());var i=this.frameLabels;if(i)for(var r=null,n=0;n<i.length;n++)if(r=i[n],e?r.name.toLowerCase()==t:r.name==t)return r;return null},i.prototype.getFrameStartEnd=function(t){var e=this.frameLabels;if(e)for(var i=null,r=0;r<e.length;r++)if(i=e[r],t==i.name){this.$frameLabelStart=i.frame,this.$frameLabelEnd=i.end;break}},i.prototype.getFrameLabelByFrame=function(t){var e=this.frameLabels;if(e)for(var i=null,r=0;r<e.length;r++)if(i=e[r],i.frame==t)return i;return null},i.prototype.getFrameLabelForFrame=function(t){var e=null,i=null,r=this.frameLabels;if(r)for(var n=0;n<r.length;n++){if(i=r[n],i.frame>t)return e;e=i}return e},i.prototype.play=function(t){void 0===t&&(t=0),this.$isPlaying=!0,this.setPlayTimes(t),this.$totalFrames>1&&this.$stage&&this.setIsStopped(!1)},i.prototype.stop=function(){this.$isPlaying=!1,this.setIsStopped(!0)},i.prototype.prevFrame=function(){this.gotoAndStop(this.$currentFrameNum-1)},i.prototype.nextFrame=function(){this.gotoAndStop(this.$currentFrameNum+1)},i.prototype.gotoAndPlay=function(e,i){void 0===i&&(i=0),(0==arguments.length||arguments.length>2)&&t.$error(1022,"MovieClip.gotoAndPlay()"),"string"==typeof e?this.getFrameStartEnd(e):(this.$frameLabelStart=0,this.$frameLabelEnd=0),this.play(i),this.gotoFrame(e)},i.prototype.gotoAndStop=function(e){1!=arguments.length&&t.$error(1022,"MovieClip.gotoAndStop()"),this.stop(),this.gotoFrame(e)},i.prototype.gotoFrame=function(e){var i;"string"==typeof e?i=this.getFrameLabelByName(e).frame:(i=parseInt(e+"",10),i!=e&&t.$error(1022,"Frame Label Not Found")),1>i?i=1:i>this.$totalFrames&&(i=this.$totalFrames),i!=this.$nextFrameNum&&(this.$nextFrameNum=i,this.advanceFrame(),this.constructFrame(),this.handlePendingEvent())},i.prototype.advanceTime=function(e){var i=this,r=e-i.lastTime;i.lastTime=e;var n=i.frameIntervalTime,o=i.passedTime+r;i.passedTime=o%n;var a=o/n;if(1>a)return!1;for(;a>=1;){if(a--,i.$nextFrameNum++,i.$nextFrameNum>i.$totalFrames||i.$frameLabelStart>0&&i.$nextFrameNum>i.$frameLabelEnd)if(-1==i.playTimes)i.$eventPool.push(t.Event.LOOP_COMPLETE),i.$nextFrameNum=1;else{if(i.playTimes--,!(i.playTimes>0)){i.$nextFrameNum=i.$totalFrames,i.$eventPool.push(t.Event.COMPLETE),i.stop();break}i.$eventPool.push(t.Event.LOOP_COMPLETE),i.$nextFrameNum=1}i.$currentFrameNum==i.$frameLabelEnd&&(i.$nextFrameNum=i.$frameLabelStart),i.advanceFrame()}return i.constructFrame(),i.handlePendingEvent(),!1},i.prototype.advanceFrame=function(){this.$currentFrameNum=this.$nextFrameNum;var e=this.frameEvents[this.$nextFrameNum];e&&""!=e&&t.MovieClipEvent.dispatchMovieClipEvent(this,t.MovieClipEvent.FRAME_LABEL,e)},i.prototype.constructFrame=function(){var t=this.$currentFrameNum;this.displayedKeyFrameNum!=t&&(this.$bitmapData=this.$movieClipData.getTextureByFrame(t),this.$movieClipData.$getOffsetByFrame(t,this.offsetPoint),this.$invalidateContentBounds(),this.displayedKeyFrameNum=t)},i.prototype.$renderFrame=function(){this.$bitmapData=this.$movieClipData.getTextureByFrame(this.$currentFrameNum),this.$invalidateContentBounds()},i.prototype.handlePendingEvent=function(){if(0!=this.$eventPool.length){this.$eventPool.reverse();for(var e=this.$eventPool,i=e.length,r=!1,n=!1,o=0;i>o;o++){var a=e.pop();a==t.Event.LOOP_COMPLETE?n=!0:a==t.Event.COMPLETE?r=!0:this.dispatchEventWith(a)}n&&this.dispatchEventWith(t.Event.LOOP_COMPLETE),r&&this.dispatchEventWith(t.Event.COMPLETE)}},Object.defineProperty(i.prototype,"totalFrames",{get:function(){return this.$totalFrames},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentFrame",{get:function(){return this.$currentFrameNum},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentFrameLabel",{get:function(){var t=this.getFrameLabelByFrame(this.$currentFrameNum);return t&&t.name},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentLabel",{get:function(){var t=this.getFrameLabelForFrame(this.$currentFrameNum);return t?t.name:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"frameRate",{get:function(){return this.$frameRate},set:function(t){t!=this.$frameRate&&(this.$frameRate=t,this.frameIntervalTime=1e3/this.$frameRate)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isPlaying",{get:function(){return this.$isPlaying},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"movieClipData",{get:function(){return this.$movieClipData},set:function(t){this.setMovieClipData(t)},enumerable:!0,configurable:!0}),i.prototype.setMovieClipData=function(t){this.$movieClipData!=t&&(this.$movieClipData=t,this.$init())},i.prototype.setPlayTimes=function(t){(0>t||t>=1)&&(this.playTimes=0>t?-1:Math.floor(t))},i.prototype.setIsStopped=function(e){this.isStopped!=e&&(this.isStopped=e,e?t.sys.$ticker.$stopTick(this.advanceTime,this):(this.playTimes=0==this.playTimes?1:this.playTimes,this.lastTime=t.getTimer(),t.sys.$ticker.$startTick(this.advanceTime,this)))},i}(t.DisplayObject);t.MovieClip=e,__reflect(e.prototype,"egret.MovieClip")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.$mcData=null,t.numFrames=1,t.frames=[],t.labels=null,t.events=[],t.frameRate=0,t.textureData=null,t.spriteSheet=null,t}return __extends(i,e),i.prototype.$init=function(t,e,i){this.textureData=e,this.spriteSheet=i,this.setMCData(t)},i.prototype.getKeyFrameData=function(t){var e=this.frames[t-1];return e.frame&&(e=this.frames[e.frame-1]),e},i.prototype.getTextureByFrame=function(t){var e=this.getKeyFrameData(t);if(e.res){var i=this.getTextureByResName(e.res);return i}return null},i.prototype.$getOffsetByFrame=function(t,e){var i=this.getKeyFrameData(t);i.res&&e.setTo(0|i.x,0|i.y)},i.prototype.getTextureByResName=function(t){if(null==this.spriteSheet)return null;var e=this.spriteSheet.getTexture(t);if(!e){var i=this.textureData[t];e=this.spriteSheet.createTexture(t,i.x,i.y,i.w,i.h)}return e},i.prototype.$isDataValid=function(){return this.frames.length>0},i.prototype.$isTextureValid=function(){return null!=this.textureData&&null!=this.spriteSheet},i.prototype.$fillMCData=function(t){this.frameRate=t.frameRate||24,this.fillFramesData(t.frames),this.fillFrameLabelsData(t.labels),this.fillFrameEventsData(t.events)},i.prototype.fillFramesData=function(t){for(var e,i=this.frames,r=t?t.length:0,n=0;r>n;n++){var o=t[n];if(i.push(o),o.duration){var a=parseInt(o.duration);if(a>1){e=i.length;for(var s=1;a>s;s++)i.push({frame:e})}}}this.numFrames=i.length},i.prototype.fillFrameLabelsData=function(e){if(e){var i=e.length;if(i>0){this.labels=[];for(var r=0;i>r;r++){var n=e[r];this.labels.push(new t.FrameLabel(n.name,n.frame,n.end))}}}},i.prototype.fillFrameEventsData=function(t){if(t){var e=t.length;if(e>0){this.events=[];for(var i=0;e>i;i++){var r=t[i];this.events[r.frame]=r.name}}}},Object.defineProperty(i.prototype,"mcData",{get:function(){return this.$mcData},set:function(t){this.setMCData(t)},enumerable:!0,configurable:!0}),i.prototype.setMCData=function(t){this.$mcData!=t&&(this.$mcData=t,t&&this.$fillMCData(t))},i}(t.HashObject);t.MovieClipData=e,__reflect(e.prototype,"egret.MovieClipData")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i){var r=e.call(this)||this;return r.enableCache=!0,r.$mcDataCache={},r.$mcDataSet=t,r.setTexture(i),r}return __extends(i,e),i.prototype.clearCache=function(){this.$mcDataCache={}},i.prototype.generateMovieClipData=function(e){if(void 0===e&&(e=""),""==e&&this.$mcDataSet)for(e in this.$mcDataSet.mc)break;if(""==e)return null;var i=this.findFromCache(e,this.$mcDataCache);return i||(i=new t.MovieClipData,this.fillData(e,i,this.$mcDataCache)),i},i.prototype.findFromCache=function(t,e){return this.enableCache&&e[t]?e[t]:null},i.prototype.fillData=function(t,e,i){if(this.$mcDataSet){var r=this.$mcDataSet.mc[t];r&&(e.$init(r,this.$mcDataSet.res,this.$spriteSheet),this.enableCache&&(i[t]=e))}},Object.defineProperty(i.prototype,"mcDataSet",{get:function(){return this.$mcDataSet},set:function(t){this.$mcDataSet=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"texture",{set:function(t){this.setTexture(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"spriteSheet",{get:function(){return this.$spriteSheet},enumerable:!0,configurable:!0}),i.prototype.setTexture=function(e){this.$spriteSheet=e?new t.SpriteSheet(e):null},i}(t.EventDispatcher);t.MovieClipDataFactory=e,__reflect(e.prototype,"egret.MovieClipDataFactory")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,r,n){void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===n&&(n=null);var o=e.call(this,t,i,r)||this;return o.frameLabel=null,o.frameLabel=n,o}return __extends(i,e),i.dispatchMovieClipEvent=function(e,r,n){void 0===n&&(n=null);var o=t.Event.create(i,r);o.frameLabel=n;var a=e.dispatchEvent(o);return t.Event.release(o),a},i}(t.Event);e.FRAME_LABEL="frame_label",t.MovieClipEvent=e,__reflect(e.prototype,"egret.MovieClipEvent")}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){t.$error(1014)}return e.get=function(t){return-1>t&&(t=-1),t>1&&(t=1),function(e){return 0==t?e:0>t?e*(e*-t+1+t):e*((2-e)*t+(1-t))}},e.getPowOut=function(t){return function(e){return 1-Math.pow(1-e,t)}},e}();e.quintOut=e.getPowOut(5),e.quartOut=e.getPowOut(4),t.ScrollEase=e,__reflect(e.prototype,"egret.ScrollEase");var i=function(e){function i(t,i,r){var n=e.call(this)||this;return n._target=null,n._useTicks=!1,n.ignoreGlobalPause=!1,n.loop=!1,n.pluginData=null,n._steps=null,n._actions=null,n.paused=!1,n.duration=0,n._prevPos=-1,n.position=null,n._prevPosition=0,n._stepPosition=0,n.passive=!1,n.initialize(t,i,r),n}return __extends(i,e),i.get=function(t,e,r,n){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=!1),n&&i.removeTweens(t),new i(t,e,r)},i.removeTweens=function(t){if(t.tween_count){for(var e=i._tweens,r=e.length-1;r>=0;r--)e[r]._target==t&&(e[r].paused=!0,e.splice(r,1));t.tween_count=0}},i.tick=function(t,e){void 0===e&&(e=!1);var r=t-i._lastTime;i._lastTime=t;for(var n=i._tweens.concat(),o=n.length-1;o>=0;o--){var a=n[o];e&&!a.ignoreGlobalPause||a.paused||a.tick(a._useTicks?1:r)}return!1},i._register=function(e,r){var n=e._target,o=i._tweens;if(r)n&&(n.tween_count=n.tween_count>0?n.tween_count+1:1),o.push(e),i._inited||(i._lastTime=t.getTimer(),t.sys.$ticker.$startTick(i.tick,null),i._inited=!0);else{n&&n.tween_count--;for(var a=o.length;a--;)if(o[a]==e)return void o.splice(a,1)}},i.prototype.initialize=function(t,e,r){this._target=t,e&&(this._useTicks=e.useTicks,this.ignoreGlobalPause=e.ignoreGlobalPause,this.loop=e.loop,e.onChange&&this.addEventListener("change",e.onChange,e.onChangeObj),e.override&&i.removeTweens(t)),this.pluginData=r||{},this._curQueueProps={},this._initQueueProps={},this._steps=[],this._actions=[],e&&e.paused?this.paused=!0:i._register(this,!0),e&&null!=e.position&&this.setPosition(e.position)},i.prototype.setPosition=function(t,e){void 0===e&&(e=1),0>t&&(t=0);var i=t,r=!1;if(i>=this.duration&&(this.loop?i%=this.duration:(i=this.duration,r=!0)),i==this._prevPos)return r;var n=this._prevPos;if(this.position=this._prevPos=i,this._prevPosition=t,this._target)if(r)this._updateTargetProps(null,1);else if(this._steps.length>0){var o=void 0,a=this._steps.length;for(o=0;a>o&&!(this._steps[o].t>i);o++);var s=this._steps[o-1];this._updateTargetProps(s,(this._stepPosition=i-s.t)/s.d)}return r&&this.setPaused(!0),0!=e&&this._actions.length>0&&(this._useTicks?this._runActions(i,i):1==e&&n>i?(n!=this.duration&&this._runActions(n,this.duration),this._runActions(0,i,!0)):this._runActions(n,i)),this.dispatchEventWith("change"),r},i.prototype._runActions=function(t,e,i){void 0===i&&(i=!1);var r=t,n=e,o=-1,a=this._actions.length,s=1;for(t>e&&(r=e,n=t,o=a,a=s=-1);(o+=s)!=a;){var l=this._actions[o],h=l.t;(h==n||h>r&&n>h||i&&h==t)&&l.f.apply(l.o,l.p)}},i.prototype._updateTargetProps=function(t,e){var r,n,o,a,s,l;if(t||1!=e){if(this.passive=!!t.v,this.passive)return;t.e&&(e=t.e(e,0,1,1)),r=t.p0,n=t.p1}else this.passive=!1,r=n=this._curQueueProps;for(var h in this._initQueueProps){null==(a=r[h])&&(r[h]=a=this._initQueueProps[h]),null==(s=n[h])&&(n[h]=s=a),o=a==s||0==e||1==e||"number"!=typeof a?1==e?s:a:a+(s-a)*e;
var u=!1;if(l=i._plugins[h])for(var c=0,p=l.length;p>c;c++){var d=l[c].tween(this,h,o,r,n,e,!!t&&r==n,!t);d==i.IGNORE?u=!0:o=d}u||(this._target[h]=o)}},i.prototype.setPaused=function(t){return this.paused=t,i._register(this,!t),this},i.prototype._cloneProps=function(t){var e={};for(var i in t)e[i]=t[i];return e},i.prototype._addStep=function(t){return t.d>0&&(this._steps.push(t),t.t=this.duration,this.duration+=t.d),this},i.prototype._appendQueueProps=function(t){var e,r,n,o,a;for(var s in t)if(void 0===this._initQueueProps[s]){if(r=this._target[s],e=i._plugins[s])for(n=0,o=e.length;o>n;n++)r=e[n].init(this,s,r);this._initQueueProps[s]=this._curQueueProps[s]=void 0===r?null:r}else r=this._curQueueProps[s];for(var s in t){if(r=this._curQueueProps[s],e=i._plugins[s])for(a=a||{},n=0,o=e.length;o>n;n++)e[n].step&&e[n].step(this,s,r,t[s],a);this._curQueueProps[s]=t[s]}return a&&this._appendQueueProps(a),this._curQueueProps},i.prototype._addAction=function(t){return t.t=this.duration,this._actions.push(t),this},i.prototype.to=function(t,e,i){return void 0===i&&(i=void 0),(isNaN(e)||0>e)&&(e=0),this._addStep({d:e||0,p0:this._cloneProps(this._curQueueProps),e:i,p1:this._cloneProps(this._appendQueueProps(t))})},i.prototype.call=function(t,e,i){return void 0===e&&(e=void 0),void 0===i&&(i=void 0),this._addAction({f:t,p:i?i:[],o:e?e:this._target})},i.prototype.tick=function(t){this.paused||this.setPosition(this._prevPosition+t)},i}(t.EventDispatcher);i._tweens=[],i.IGNORE={},i._plugins={},i._inited=!1,i._lastTime=0,t.ScrollTween=i,__reflect(i.prototype,"egret.ScrollTween")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(i){void 0===i&&(i=null);var r=e.call(this)||this;return r.scrollBeginThreshold=10,r.scrollSpeed=1,r._content=null,r.delayTouchBeginEvent=null,r.touchBeginTimer=null,r.touchEnabled=!0,r._ScrV_Props_=new t.ScrollViewProperties,i&&r.setContent(i),r}return __extends(i,e),Object.defineProperty(i.prototype,"bounces",{get:function(){return this._ScrV_Props_._bounces},set:function(t){this._ScrV_Props_._bounces=!!t},enumerable:!0,configurable:!0}),i.prototype.setContent=function(t){this._content!==t&&(this.removeContent(),t&&(this._content=t,e.prototype.addChild.call(this,t),this._addEvents()))},i.prototype.removeContent=function(){this._content&&(this._removeEvents(),e.prototype.removeChildAt.call(this,0)),this._content=null},Object.defineProperty(i.prototype,"verticalScrollPolicy",{get:function(){return this._ScrV_Props_._verticalScrollPolicy},set:function(t){t!=this._ScrV_Props_._verticalScrollPolicy&&(this._ScrV_Props_._verticalScrollPolicy=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"horizontalScrollPolicy",{get:function(){return this._ScrV_Props_._horizontalScrollPolicy},set:function(t){t!=this._ScrV_Props_._horizontalScrollPolicy&&(this._ScrV_Props_._horizontalScrollPolicy=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scrollLeft",{get:function(){return this._ScrV_Props_._scrollLeft},set:function(t){t!=this._ScrV_Props_._scrollLeft&&(this._ScrV_Props_._scrollLeft=t,this._validatePosition(!1,!0),this._updateContentPosition())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scrollTop",{get:function(){return this._ScrV_Props_._scrollTop},set:function(t){t!=this._ScrV_Props_._scrollTop&&(this._ScrV_Props_._scrollTop=t,this._validatePosition(!0,!1),this._updateContentPosition())},enumerable:!0,configurable:!0}),i.prototype.setScrollPosition=function(t,e,i){if(void 0===i&&(i=!1),!(i&&0==t&&0==e||!i&&this._ScrV_Props_._scrollTop==t&&this._ScrV_Props_._scrollLeft==e)){var r=this._ScrV_Props_._scrollTop,n=this._ScrV_Props_._scrollLeft;if(i){var o=this.getMaxScrollLeft(),a=this.getMaxScrollTop();(0>=r||r>=a)&&(t/=2),(0>=n||n>=o)&&(e/=2);var s=r+t,l=n+e,h=this._ScrV_Props_._bounces;h||((0>=s||s>=a)&&(s=Math.max(0,Math.min(s,a))),(0>=l||l>=o)&&(l=Math.max(0,Math.min(l,o)))),this._ScrV_Props_._scrollTop=s,this._ScrV_Props_._scrollLeft=l}else this._ScrV_Props_._scrollTop=t,this._ScrV_Props_._scrollLeft=e;this._validatePosition(!0,!0),this._updateContentPosition()}},i.prototype._validatePosition=function(t,e){if(void 0===t&&(t=!1),void 0===e&&(e=!1),t){var i=this.height,r=this._getContentHeight();this._ScrV_Props_._scrollTop=Math.max(this._ScrV_Props_._scrollTop,(0-i)/2),this._ScrV_Props_._scrollTop=Math.min(this._ScrV_Props_._scrollTop,r>i?r-i/2:i/2)}if(e){var n=this.width,o=this._getContentWidth();this._ScrV_Props_._scrollLeft=Math.max(this._ScrV_Props_._scrollLeft,(0-n)/2),this._ScrV_Props_._scrollLeft=Math.min(this._ScrV_Props_._scrollLeft,o>n?o-n/2:n/2)}},i.prototype.$setWidth=function(t){if(this.$getExplicitWidth()==t)return!1;var i=e.prototype.$setWidth.call(this,t);return this._updateContentPosition(),i},i.prototype.$setHeight=function(t){return this.$getExplicitHeight()==t?!1:(e.prototype.$setHeight.call(this,t),this._updateContentPosition(),!0)},i.prototype._updateContentPosition=function(){var e=this.height,i=this.width;this.scrollRect=new t.Rectangle(Math.round(this._ScrV_Props_._scrollLeft),Math.round(this._ScrV_Props_._scrollTop),i,e),this.dispatchEvent(new t.Event(t.Event.CHANGE))},i.prototype._checkScrollPolicy=function(){var t=this._ScrV_Props_._horizontalScrollPolicy,e=this.__checkScrollPolicy(t,this._getContentWidth(),this.width);this._ScrV_Props_._hCanScroll=e;var i=this._ScrV_Props_._verticalScrollPolicy,r=this.__checkScrollPolicy(i,this._getContentHeight(),this.height);return this._ScrV_Props_._vCanScroll=r,e||r},i.prototype.__checkScrollPolicy=function(t,e,i){return"on"==t?!0:"off"==t?!1:e>i},i.prototype._addEvents=function(){this.addEventListener(t.TouchEvent.TOUCH_BEGIN,this._onTouchBegin,this),this.addEventListener(t.TouchEvent.TOUCH_BEGIN,this._onTouchBeginCapture,this,!0),this.addEventListener(t.TouchEvent.TOUCH_END,this._onTouchEndCapture,this,!0)},i.prototype._removeEvents=function(){this.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this._onTouchBegin,this),this.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this._onTouchBeginCapture,this,!0),this.removeEventListener(t.TouchEvent.TOUCH_END,this._onTouchEndCapture,this,!0)},i.prototype._onTouchBegin=function(e){if(!e.$isDefaultPrevented){var i=this._checkScrollPolicy();i&&(this._ScrV_Props_._touchStartPosition.x=e.stageX,this._ScrV_Props_._touchStartPosition.y=e.stageY,(this._ScrV_Props_._isHTweenPlaying||this._ScrV_Props_._isVTweenPlaying)&&this._onScrollFinished(),this._tempStage=this.stage,this._tempStage.addEventListener(t.TouchEvent.TOUCH_MOVE,this._onTouchMove,this),this._tempStage.addEventListener(t.TouchEvent.TOUCH_END,this._onTouchEnd,this),this._tempStage.addEventListener(t.TouchEvent.LEAVE_STAGE,this._onTouchEnd,this),this.addEventListener(t.Event.ENTER_FRAME,this._onEnterFrame,this),this._logTouchEvent(e),e.preventDefault())}},i.prototype._onTouchBeginCapture=function(e){var i=this._checkScrollPolicy();if(i){for(var r=e.target;r!=this;){if("_checkScrollPolicy"in r&&(i=r._checkScrollPolicy()))return;r=r.parent}e.stopPropagation();var n=this.cloneTouchEvent(e);this.delayTouchBeginEvent=n,this.touchBeginTimer||(this.touchBeginTimer=new t.Timer(100,1),this.touchBeginTimer.addEventListener(t.TimerEvent.TIMER_COMPLETE,this._onTouchBeginTimer,this)),this.touchBeginTimer.start(),this._onTouchBegin(e)}},i.prototype._onTouchEndCapture=function(e){var i=this;if(this.delayTouchBeginEvent){this._onTouchBeginTimer(),e.stopPropagation();var r=this.cloneTouchEvent(e);t.callLater(function(){i.stage&&i.dispatchPropagationEvent(r)},this)}},i.prototype._onTouchBeginTimer=function(){this.touchBeginTimer.stop();var t=this.delayTouchBeginEvent;this.delayTouchBeginEvent=null,this.stage&&this.dispatchPropagationEvent(t)},i.prototype.dispatchPropagationEvent=function(e){for(var i=e.$target,r=this.$getPropagationList(i),n=r.length,o=.5*r.length,a=-1,s=0;n>s;s++)if(r[s]===this._content){a=s;break}r.splice(0,a+1),o-=a+1,this.$dispatchPropagationEvent(e,r,o),t.Event.release(e)},i.prototype._onTouchMove=function(t){if(this._ScrV_Props_._lastTouchPosition.x!=t.stageX||this._ScrV_Props_._lastTouchPosition.y!=t.stageY){if(!this._ScrV_Props_._scrollStarted){var e=t.stageX-this._ScrV_Props_._touchStartPosition.x,i=t.stageY-this._ScrV_Props_._touchStartPosition.y,r=Math.sqrt(e*e+i*i);if(r<this.scrollBeginThreshold)return void this._logTouchEvent(t)}this._ScrV_Props_._scrollStarted=!0,this.delayTouchBeginEvent&&(this.delayTouchBeginEvent=null,this.touchBeginTimer.stop()),this.touchChildren=!1;var n=this._getPointChange(t);this.setScrollPosition(n.y,n.x,!0),this._calcVelocitys(t),this._logTouchEvent(t)}},i.prototype._onTouchEnd=function(){this.touchChildren=!0,this._ScrV_Props_._scrollStarted=!1,this._tempStage.removeEventListener(t.TouchEvent.TOUCH_MOVE,this._onTouchMove,this),this._tempStage.removeEventListener(t.TouchEvent.TOUCH_END,this._onTouchEnd,this),this._tempStage.removeEventListener(t.TouchEvent.LEAVE_STAGE,this._onTouchEnd,this),this.removeEventListener(t.Event.ENTER_FRAME,this._onEnterFrame,this),this._moveAfterTouchEnd()},i.prototype._onEnterFrame=function(){var e=t.getTimer();e-this._ScrV_Props_._lastTouchTime>100&&e-this._ScrV_Props_._lastTouchTime<300&&this._calcVelocitys(this._ScrV_Props_._lastTouchEvent)},i.prototype._logTouchEvent=function(e){this._ScrV_Props_._lastTouchPosition.x=e.stageX,this._ScrV_Props_._lastTouchPosition.y=e.stageY,this._ScrV_Props_._lastTouchEvent=this.cloneTouchEvent(e),this._ScrV_Props_._lastTouchTime=t.getTimer()},i.prototype._getPointChange=function(t){return{x:this._ScrV_Props_._hCanScroll===!1?0:this._ScrV_Props_._lastTouchPosition.x-t.stageX,y:this._ScrV_Props_._vCanScroll===!1?0:this._ScrV_Props_._lastTouchPosition.y-t.stageY}},i.prototype._calcVelocitys=function(e){var i=t.getTimer();if(0==this._ScrV_Props_._lastTouchTime)return void(this._ScrV_Props_._lastTouchTime=i);var r=this._getPointChange(e),n=i-this._ScrV_Props_._lastTouchTime;r.x/=n,r.y/=n,this._ScrV_Props_._velocitys.push(r),this._ScrV_Props_._velocitys.length>5&&this._ScrV_Props_._velocitys.shift(),this._ScrV_Props_._lastTouchPosition.x=e.stageX,this._ScrV_Props_._lastTouchPosition.y=e.stageY},i.prototype._getContentWidth=function(){return this._content.$getExplicitWidth()||this._content.width},i.prototype._getContentHeight=function(){return this._content.$getExplicitHeight()||this._content.height},i.prototype.getMaxScrollLeft=function(){var t=this._getContentWidth()-this.width;return Math.max(0,t)},i.prototype.getMaxScrollTop=function(){var t=this._getContentHeight()-this.height;return Math.max(0,t)},i.prototype._moveAfterTouchEnd=function(){if(0!=this._ScrV_Props_._velocitys.length){for(var t={x:0,y:0},e=0,r=0;r<this._ScrV_Props_._velocitys.length;r++){var n=this._ScrV_Props_._velocitys[r],o=i.weight[r];t.x+=n.x*o,t.y+=n.y*o,e+=o}this._ScrV_Props_._velocitys.length=0,this.scrollSpeed<=0&&(this.scrollSpeed=1);var a=t.x/e*this.scrollSpeed,s=t.y/e*this.scrollSpeed,l=Math.abs(a),h=Math.abs(s),u=this.getMaxScrollLeft(),c=this.getMaxScrollTop(),p=l>.02?this.getAnimationDatas(a,this._ScrV_Props_._scrollLeft,u):{position:this._ScrV_Props_._scrollLeft,duration:1},d=h>.02?this.getAnimationDatas(s,this._ScrV_Props_._scrollTop,c):{position:this._ScrV_Props_._scrollTop,duration:1};this.setScrollLeft(p.position,p.duration),this.setScrollTop(d.position,d.duration)}},i.prototype.onTweenFinished=function(t){t==this._ScrV_Props_._vScrollTween&&(this._ScrV_Props_._isVTweenPlaying=!1),t==this._ScrV_Props_._hScrollTween&&(this._ScrV_Props_._isHTweenPlaying=!1),0==this._ScrV_Props_._isHTweenPlaying&&0==this._ScrV_Props_._isVTweenPlaying&&this._onScrollFinished()},i.prototype._onScrollStarted=function(){},i.prototype._onScrollFinished=function(){t.ScrollTween.removeTweens(this),this._ScrV_Props_._hScrollTween=null,this._ScrV_Props_._vScrollTween=null,this._ScrV_Props_._isHTweenPlaying=!1,this._ScrV_Props_._isVTweenPlaying=!1,this.dispatchEvent(new t.Event(t.Event.COMPLETE))},i.prototype.setScrollTop=function(e,i){void 0===i&&(i=0);var r=Math.min(this.getMaxScrollTop(),Math.max(e,0));if(0==i)return void(this.scrollTop=r);0==this._ScrV_Props_._bounces&&(e=r);var n=t.ScrollTween.get(this).to({scrollTop:e},i,t.ScrollEase.quartOut);r!=e&&n.to({scrollTop:r},300,t.ScrollEase.quintOut),this._ScrV_Props_._isVTweenPlaying=!0,this._ScrV_Props_._vScrollTween=n,n.call(this.onTweenFinished,this,[n]),this._ScrV_Props_._isHTweenPlaying||this._onScrollStarted()},i.prototype.setScrollLeft=function(e,i){void 0===i&&(i=0);var r=Math.min(this.getMaxScrollLeft(),Math.max(e,0));if(0==i)return void(this.scrollLeft=r);0==this._ScrV_Props_._bounces&&(e=r);var n=t.ScrollTween.get(this).to({scrollLeft:e},i,t.ScrollEase.quartOut);r!=e&&n.to({scrollLeft:r},300,t.ScrollEase.quintOut),this._ScrV_Props_._isHTweenPlaying=!0,this._ScrV_Props_._hScrollTween=n,n.call(this.onTweenFinished,this,[n]),this._ScrV_Props_._isVTweenPlaying||this._onScrollStarted()},i.prototype.getAnimationDatas=function(t,e,i){var r=Math.abs(t),n=.95,o=0,a=.998,s=.02,l=e+500*t;if(0>l||l>i)for(l=e;Math.abs(t)!=1/0&&Math.abs(t)>s;)l+=t,t*=0>l||l>i?a*n:a,o++;else o=500*-Math.log(s/r);var h={position:Math.min(i+50,Math.max(l,-50)),duration:o};return h},i.prototype.cloneTouchEvent=function(e){var i=new t.TouchEvent(e.type,e.bubbles,e.cancelable);return i.touchPointID=e.touchPointID,i.$stageX=e.stageX,i.$stageY=e.stageY,i.touchDown=e.touchDown,i.$isDefaultPrevented=!1,i.$target=e.target,i},i.prototype.throwNotSupportedError=function(){t.$error(1023)},i.prototype.addChild=function(){return this.throwNotSupportedError(),null},i.prototype.addChildAt=function(){return this.throwNotSupportedError(),null},i.prototype.removeChild=function(){return this.throwNotSupportedError(),null},i.prototype.removeChildAt=function(){return this.throwNotSupportedError(),null},i.prototype.setChildIndex=function(){this.throwNotSupportedError()},i.prototype.swapChildren=function(){this.throwNotSupportedError()},i.prototype.swapChildrenAt=function(){this.throwNotSupportedError()},i}(t.DisplayObjectContainer);e.weight=[1,1.33,1.66,2,2.33],t.ScrollView=e,__reflect(e.prototype,"egret.ScrollView")}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){this._verticalScrollPolicy="auto",this._horizontalScrollPolicy="auto",this._scrollLeft=0,this._scrollTop=0,this._hCanScroll=!1,this._vCanScroll=!1,this._lastTouchPosition=new t.Point(0,0),this._touchStartPosition=new t.Point(0,0),this._scrollStarted=!1,this._lastTouchTime=0,this._lastTouchEvent=null,this._velocitys=[],this._isHTweenPlaying=!1,this._isVTweenPlaying=!1,this._hScrollTween=null,this._vScrollTween=null,this._bounces=!0}return e}();t.ScrollViewProperties=e,__reflect(e.prototype,"egret.ScrollViewProperties")}(egret||(egret={}));var egret;!function(t){function e(e){var i=e.url;return-1==i.indexOf("?")&&e.method==t.URLRequestMethod.GET&&e.data&&e.data instanceof t.URLVariables&&(i=i+"?"+e.data.toString()),i}t.$getUrl=e}(egret||(egret={}));var egret;!function(t){function e(e,i,l){for(var h=[],u=3;u<arguments.length;u++)h[u-3]=arguments[u];var c={listener:e,thisObject:i,delay:l,params:h};return a++,1==a&&t.sys.$ticker&&(s=t.getTimer(),t.sys.$ticker.$startTick(r,null)),o++,n[o]=c,o}function i(e){n[e]&&(a--,delete n[e],0==a&&t.sys.$ticker&&t.sys.$ticker.$stopTick(r,null))}function r(t){var e=t-s;s=t;for(var r in n){var o=r,a=n[o];a.delay-=e,a.delay<=0&&(a.listener.apply(a.thisObject,a.params),i(o))}return!1}var n={},o=0,a=0,s=0;t.setTimeout=e,t.clearTimeout=i}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t}();e.BINARY="binary",e.TEXT="text",e.VARIABLES="variables",e.TEXTURE="texture",e.SOUND="sound",t.URLLoaderDataFormat=e,__reflect(e.prototype,"egret.URLLoaderDataFormat")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(i){void 0===i&&(i=null);var r=e.call(this)||this;return r.data=null,r.method=t.URLRequestMethod.GET,r.url="",r.requestHeaders=[],r.url=i,r}return __extends(i,e),i}(t.HashObject);t.URLRequest=e,__reflect(e.prototype,"egret.URLRequest")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(t,e){this.name="",this.value="",this.name=t,this.value=e}return t}();t.URLRequestHeader=e,__reflect(e.prototype,"egret.URLRequestHeader")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t}();e.GET="get",e.POST="post",t.URLRequestMethod=e,__reflect(e.prototype,"egret.URLRequestMethod")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return i.variables=null,null!==e&&i.decode(e),i}return __extends(e,t),e.prototype.decode=function(t){this.variables||(this.variables={}),t=t.split("+").join(" ");for(var e,i=/[?&]?([^=]+)=([^&]*)/g;e=i.exec(t);){var r=decodeURIComponent(e[1]),n=decodeURIComponent(e[2]);if(r in this.variables!=0){var o=this.variables[r];o instanceof Array?o.push(n):this.variables[r]=[o,n]}else this.variables[r]=n}},e.prototype.toString=function(){if(!this.variables)return"";var t=this.variables,e=[];for(var i in t)e.push(this.encodeValue(i,t[i]));return e.join("&")},e.prototype.encodeValue=function(t,e){return e instanceof Array?this.encodeArray(t,e):encodeURIComponent(t)+"="+encodeURIComponent(e)},e.prototype.encodeArray=function(t,e){return t?0==e.length?encodeURIComponent(t)+"=":e.map(function(e){return encodeURIComponent(t)+"="+encodeURIComponent(e)}).join("&"):""},e}(t.HashObject);t.URLVariables=e,__reflect(e.prototype,"egret.URLVariables")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var r=e.call(this)||this;return r._timeScale=1,r._paused=!1,r._callIndex=-1,r._lastTime=0,r.callBackList=[],null!=i.instance&&t.$error(1033),t.sys.$ticker.$startTick(r.update,r),r._lastTime=t.getTimer(),r}return __extends(i,e),i.prototype.update=function(t){var e=t-this._lastTime;if(this._lastTime=t,this._paused)return!1;var i=e*this._timeScale;for(this._callList=this.callBackList.concat(),this._callIndex=0;this._callIndex<this._callList.length;this._callIndex++){var r=this._callList[this._callIndex];r.listener.call(r.thisObject,i)}return this._callIndex=-1,this._callList=null,!1},i.prototype.register=function(t,e,i){void 0===i&&(i=0),this.$insertEventBin(this.callBackList,"",t,e,!1,i,!1)},i.prototype.unregister=function(t,e){this.$removeEventBin(this.callBackList,t,e)},i.prototype.setTimeScale=function(t){this._timeScale=t},i.prototype.getTimeScale=function(){return this._timeScale},i.prototype.pause=function(){this._paused=!0},i.prototype.resume=function(){this._paused=!1},i.getInstance=function(){return null==i.instance&&(i.instance=new i),i.instance},i}(t.EventDispatcher);t.Ticker=e,__reflect(e.prototype,"egret.Ticker")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),Object.defineProperty(i.prototype,"stage",{get:function(){return t.sys.$TempStage},enumerable:!0,configurable:!0}),Object.defineProperty(i,"runtimeType",{get:function(){return t.$warn(1041,"egret.MainContext.runtimeType","egret.Capabilities.runtimeType"),i._runtimeType},enumerable:!0,configurable:!0}),i.prototype.run=function(){},Object.defineProperty(i,"instance",{get:function(){return null==i._instance&&(i._instance=new i),i._instance},enumerable:!0,configurable:!0}),i}(t.EventDispatcher);e.deviceType=null,e.DEVICE_PC="web",e.DEVICE_MOBILE="native",e.RUNTIME_HTML5="runtimeHtml5",e.RUNTIME_NATIVE="runtimeNative",t.MainContext=e,__reflect(e.prototype,"egret.MainContext")}(egret||(egret={}));var testDeviceType1=function(){if(!this.navigator)return!0;var t=navigator.userAgent.toLowerCase();return-1!=t.indexOf("mobile")||-1!=t.indexOf("android")},testRuntimeType1=function(){return this.navigator?!0:!1};egret.MainContext.deviceType=testDeviceType1()?egret.MainContext.DEVICE_MOBILE:egret.MainContext.DEVICE_PC,egret.MainContext._runtimeType=testRuntimeType1()?egret.MainContext.RUNTIME_HTML5:egret.MainContext.RUNTIME_NATIVE,delete testDeviceType1,delete testRuntimeType1;var egret;!function(t){var e=function(e){function i(t){void 0===t&&(t=300);var i=e.call(this)||this;return i.objectPool=[],i._length=0,1>t&&(t=1),i.autoDisposeTime=t,i.frameCount=0,i}return __extends(i,e),i.$init=function(){t.sys.$ticker.$startTick(i.onUpdate,i)},i.onUpdate=function(){for(var t=i._callBackList,e=t.length-1;e>=0;e--)t[e].$checkFrame();return!1},i.prototype.$checkFrame=function(){this.frameCount--,this.frameCount<=0&&this.dispose()},Object.defineProperty(i.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),i.prototype.push=function(t){var e=this.objectPool;-1==e.indexOf(t)&&(e.push(t),t.__recycle&&t.__recycle(),this._length++,0==this.frameCount&&(this.frameCount=this.autoDisposeTime,i._callBackList.push(this)))},i.prototype.pop=function(){return 0==this._length?null:(this._length--,this.objectPool.pop())},i.prototype.dispose=function(){this._length>0&&(this.objectPool=[],this._length=0),this.frameCount=0;var t=i._callBackList,e=t.indexOf(this);-1!=e&&t.splice(e,1)},i}(t.HashObject);e._callBackList=[],t.Recycler=e,__reflect(e.prototype,"egret.Recycler"),e.$init()}(egret||(egret={}));var egret;!function(t){function e(e,i,l){for(var h=[],u=3;u<arguments.length;u++)h[u-3]=arguments[u];var c={listener:e,thisObject:i,delay:l,originDelay:l,params:h};return a++,1==a&&(s=t.getTimer(),t.sys.$ticker.$startTick(r,null)),o++,n[o]=c,o}function i(e){n[e]&&(a--,delete n[e],0==a&&t.sys.$ticker.$stopTick(r,null))}function r(t){var e=t-s;s=t;for(var i in n){var r=n[i];r.delay-=e,r.delay<=0&&(r.delay=r.originDelay,r.listener.apply(r.thisObject,r.params))}return!1}var n={},o=0,a=0,s=0;t.setInterval=e,t.clearInterval=i}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(i){void 0===i&&(i=null);var r=e.call(this)||this;return r.dataFormat=t.URLLoaderDataFormat.TEXT,r.data=null,r._request=null,r._status=-1,i&&r.load(i),r}return __extends(i,e),i.prototype.load=function(e){this._request=e,this.data=null,t.NetContext.getNetContext().proceed(this)},i.prototype.__recycle=function(){this._request=null,this.data=null},i}(t.EventDispatcher);t.URLLoader=e,__reflect(e.prototype,"egret.URLLoader")}(egret||(egret={}));var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},egret;!function(t){var e;!function(e){var i=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.proceed=function(e){function i(t){e.dispatchEvent(t)}function r(t){o(),e.dispatchEvent(t)}function n(){switch(o(),e.dataFormat){case t.URLLoaderDataFormat.VARIABLES:e.data=new t.URLVariables(h.response);break;default:e.data=h.response}window.setTimeout(function(){t.Event.dispatchEvent(e,t.Event.COMPLETE)},0)}function o(){h.removeEventListener(t.Event.COMPLETE,n,a),h.removeEventListener(t.IOErrorEvent.IO_ERROR,r,a),h.removeEventListener(t.ProgressEvent.PROGRESS,i,a)}var a=this;if(e.dataFormat==t.URLLoaderDataFormat.TEXTURE)return void this.loadTexture(e);if(e.dataFormat==t.URLLoaderDataFormat.SOUND)return void this.loadSound(e);var s=e._request,l=a.getVirtualUrl(t.$getUrl(s)),h=new t.HttpRequest;if(h.addEventListener(t.Event.COMPLETE,n,this),h.addEventListener(t.IOErrorEvent.IO_ERROR,r,this),h.addEventListener(t.ProgressEvent.PROGRESS,i,this),h.open(l,s.method),h.responseType=this.getResponseType(e.dataFormat),s.method!=t.URLRequestMethod.GET&&s.data)if(s.data instanceof t.URLVariables){h.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var u=s.data;h.send(u.toString())}else h.setRequestHeader("Content-Type","multipart/form-data"),h.send(s.data);else h.send()},i.prototype.getResponseType=function(e){switch(e){case t.URLLoaderDataFormat.TEXT:case t.URLLoaderDataFormat.VARIABLES:return t.URLLoaderDataFormat.TEXT;case t.URLLoaderDataFormat.BINARY:return"arraybuffer";default:return e}},i.prototype.loadSound=function(e){function i(t){e.dispatchEvent(t)}function r(t){o(),e.dispatchEvent(t)}function n(){o(),e.data=l,window.setTimeout(function(){e.dispatchEventWith(t.Event.COMPLETE)},0)}function o(){l.removeEventListener(t.Event.COMPLETE,n,a),l.removeEventListener(t.IOErrorEvent.IO_ERROR,r,a),l.removeEventListener(t.ProgressEvent.PROGRESS,i,a)}var a=this,s=this.getVirtualUrl(e._request.url),l=new t.Sound;l.addEventListener(t.Event.COMPLETE,n,a),l.addEventListener(t.IOErrorEvent.IO_ERROR,r,a),l.addEventListener(t.ProgressEvent.PROGRESS,i,a),l.load(s)},i.prototype.loadTexture=function(e){function i(t){e.dispatchEvent(t)}function r(t){o(),e.dispatchEvent(t)}function n(){o();var i=l.data;i.source.setAttribute("bitmapSrc",s);var r=new t.Texture;r._setBitmapData(i),e.data=r,window.setTimeout(function(){e.dispatchEventWith(t.Event.COMPLETE)},a)}function o(){l.removeEventListener(t.Event.COMPLETE,n,a),l.removeEventListener(t.IOErrorEvent.IO_ERROR,r,a),l.removeEventListener(t.ProgressEvent.PROGRESS,i,a)}var a=this,s=this.getVirtualUrl(e._request.url),l=new t.ImageLoader;l.addEventListener(t.Event.COMPLETE,n,a),l.addEventListener(t.IOErrorEvent.IO_ERROR,r,a),l.addEventListener(t.ProgressEvent.PROGRESS,i,a),l.load(s)},i.prototype.getChangeList=function(){return[]},i.prototype.getVirtualUrl=function(t){return t},i.getNetContext=function(){return null==i._instance&&(i._instance=new i),i._instance},i}(t.HashObject);e.HTML5NetContext=i,__reflect(i.prototype,"egret.web.HTML5NetContext",["egret.NetContext"]),t.NetContext=i}(e=t.web||(t.web={}))}(egret||(egret={}));var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},egret;!function(t){var e=function(){function e(){t.$error(1014)}return e.get=function(t){return-1>t&&(t=-1),t>1&&(t=1),function(e){return 0==t?e:0>t?e*(e*-t+1+t):e*((2-e)*t+(1-t))}},e.getPowIn=function(t){return function(e){return Math.pow(e,t)}},e.getPowOut=function(t){return function(e){return 1-Math.pow(1-e,t)}},e.getPowInOut=function(t){return function(e){return(e*=2)<1?.5*Math.pow(e,t):1-.5*Math.abs(Math.pow(2-e,t))}},e.sineIn=function(t){return 1-Math.cos(t*Math.PI/2)},e.sineOut=function(t){return Math.sin(t*Math.PI/2)},e.sineInOut=function(t){return-.5*(Math.cos(Math.PI*t)-1)},e.getBackIn=function(t){return function(e){return e*e*((t+1)*e-t)}},e.getBackOut=function(t){return function(e){return--e*e*((t+1)*e+t)+1}},e.getBackInOut=function(t){return t*=1.525,function(e){return(e*=2)<1?.5*e*e*((t+1)*e-t):.5*((e-=2)*e*((t+1)*e+t)+2)}},e.circIn=function(t){return-(Math.sqrt(1-t*t)-1)},e.circOut=function(t){return Math.sqrt(1- --t*t)},e.circInOut=function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},e.bounceIn=function(t){return 1-e.bounceOut(1-t)},e.bounceOut=function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},e.bounceInOut=function(t){return.5>t?.5*e.bounceIn(2*t):.5*e.bounceOut(2*t-1)+.5},e.getElasticIn=function(t,e){var i=2*Math.PI;return function(r){if(0==r||1==r)return r;var n=e/i*Math.asin(1/t);return-(t*Math.pow(2,10*(r-=1))*Math.sin((r-n)*i/e))}},e.getElasticOut=function(t,e){var i=2*Math.PI;return function(r){if(0==r||1==r)return r;var n=e/i*Math.asin(1/t);return t*Math.pow(2,-10*r)*Math.sin((r-n)*i/e)+1}},e.getElasticInOut=function(t,e){var i=2*Math.PI;return function(r){var n=e/i*Math.asin(1/t);return(r*=2)<1?-.5*t*Math.pow(2,10*(r-=1))*Math.sin((r-n)*i/e):t*Math.pow(2,-10*(r-=1))*Math.sin((r-n)*i/e)*.5+1}},e}();e.quadIn=e.getPowIn(2),e.quadOut=e.getPowOut(2),e.quadInOut=e.getPowInOut(2),e.cubicIn=e.getPowIn(3),e.cubicOut=e.getPowOut(3),e.cubicInOut=e.getPowInOut(3),e.quartIn=e.getPowIn(4),e.quartOut=e.getPowOut(4),e.quartInOut=e.getPowInOut(4),e.quintIn=e.getPowIn(5),e.quintOut=e.getPowOut(5),e.quintInOut=e.getPowInOut(5),e.backIn=e.getBackIn(1.7),e.backOut=e.getBackOut(1.7),e.backInOut=e.getBackInOut(1.7),e.elasticIn=e.getElasticIn(1,.3),e.elasticOut=e.getElasticOut(1,.3),e.elasticInOut=e.getElasticInOut(1,.3*1.5),t.Ease=e,__reflect(e.prototype,"egret.Ease")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,r){var n=e.call(this)||this;return n._target=null,n._useTicks=!1,n.ignoreGlobalPause=!1,n.loop=!1,n.pluginData=null,n._steps=null,n.paused=!1,n.duration=0,n._prevPos=-1,n.position=null,n._prevPosition=0,n._stepPosition=0,n.passive=!1,n.initialize(t,i,r),n}return __extends(i,e),i.get=function(t,e,r,n){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=!1),n&&i.removeTweens(t),new i(t,e,r)},i.removeTweens=function(t){if(t.tween_count){for(var e=i._tweens,r=e.length-1;r>=0;r--)e[r]._target==t&&(e[r].paused=!0,e.splice(r,1));t.tween_count=0}},i.pauseTweens=function(e){if(e.tween_count)for(var i=t.Tween._tweens,r=i.length-1;r>=0;r--)i[r]._target==e&&(i[r].paused=!0)},i.resumeTweens=function(e){if(e.tween_count)for(var i=t.Tween._tweens,r=i.length-1;r>=0;r--)i[r]._target==e&&(i[r].paused=!1)},i.tick=function(t,e){void 0===e&&(e=!1);var r=t-i._lastTime;i._lastTime=t;for(var n=i._tweens.concat(),o=n.length-1;o>=0;o--){var a=n[o];e&&!a.ignoreGlobalPause||a.paused||a.$tick(a._useTicks?1:r)}return!1},i._register=function(e,r){var n=e._target,o=i._tweens;if(r)n&&(n.tween_count=n.tween_count>0?n.tween_count+1:1),o.push(e),i._inited||(i._lastTime=t.getTimer(),t.sys.$ticker.$startTick(i.tick,null),i._inited=!0);else{n&&n.tween_count--;for(var a=o.length;a--;)if(o[a]==e)return void o.splice(a,1)}},i.removeAllTweens=function(){for(var t=i._tweens,e=0,r=t.length;r>e;e++){var n=t[e];n.paused=!0,n._target.tweenjs_count=0}t.length=0},i.prototype.initialize=function(t,e,r){this._target=t,e&&(this._useTicks=e.useTicks,this.ignoreGlobalPause=e.ignoreGlobalPause,this.loop=e.loop,e.onChange&&this.addEventListener("change",e.onChange,e.onChangeObj),e.override&&i.removeTweens(t)),this.pluginData=r||{},this._curQueueProps={},this._initQueueProps={},this._steps=[],e&&e.paused?this.paused=!0:i._register(this,!0),e&&null!=e.position&&this.setPosition(e.position,i.NONE)},i.prototype.setPosition=function(t,e){void 0===e&&(e=1),0>t&&(t=0);var i=t,r=!1;if(i>=this.duration&&(this.loop?i%=this.duration:(i=this.duration,r=!0)),i==this._prevPos)return r;r&&this.setPaused(!0);var n=this._prevPos;if(this.position=this._prevPos=i,this._prevPosition=t,this._target&&this._steps.length>0){for(var o=this._steps.length,a=-1,s=0;o>s&&!("step"==this._steps[s].type&&(a=s,this._steps[s].t<=i&&this._steps[s].t+this._steps[s].d>=i));s++);for(var s=0;o>s;s++)if("action"==this._steps[s].type)0!=e&&(this._useTicks?this._runAction(this._steps[s],i,i):1==e&&n>i?(n!=this.duration&&this._runAction(this._steps[s],n,this.duration),this._runAction(this._steps[s],0,i,!0)):this._runAction(this._steps[s],n,i));else if("step"==this._steps[s].type&&a==s){var l=this._steps[a];this._updateTargetProps(l,Math.min((this._stepPosition=i-l.t)/l.d,1))}}return this.dispatchEventWith("change"),r},i.prototype._runAction=function(t,e,i,r){void 0===r&&(r=!1);var n=e,o=i;e>i&&(n=i,o=e);var a=t.t;(a==o||a>n&&o>a||r&&a==e)&&t.f.apply(t.o,t.p)},i.prototype._updateTargetProps=function(t,e){var r,n,o,a,s,l;if(t||1!=e){if(this.passive=!!t.v,this.passive)return;t.e&&(e=t.e(e,0,1,1)),r=t.p0,n=t.p1}else this.passive=!1,r=n=this._curQueueProps;for(var h in this._initQueueProps){null==(a=r[h])&&(r[h]=a=this._initQueueProps[h]),null==(s=n[h])&&(n[h]=s=a),o=a==s||0==e||1==e||"number"!=typeof a?1==e?s:a:a+(s-a)*e;var u=!1;if(l=i._plugins[h])for(var c=0,p=l.length;p>c;c++){var d=l[c].tween(this,h,o,r,n,e,!!t&&r==n,!t);d==i.IGNORE?u=!0:o=d}u||(this._target[h]=o)}},i.prototype.setPaused=function(t){return this.paused=t,i._register(this,!t),this
},i.prototype._cloneProps=function(t){var e={};for(var i in t)e[i]=t[i];return e},i.prototype._addStep=function(t){return t.d>0&&(t.type="step",this._steps.push(t),t.t=this.duration,this.duration+=t.d),this},i.prototype._appendQueueProps=function(t){var e,r,n,o,a;for(var s in t)if(void 0===this._initQueueProps[s]){if(r=this._target[s],e=i._plugins[s])for(n=0,o=e.length;o>n;n++)r=e[n].init(this,s,r);this._initQueueProps[s]=this._curQueueProps[s]=void 0===r?null:r}else r=this._curQueueProps[s];for(var s in t){if(r=this._curQueueProps[s],e=i._plugins[s])for(a=a||{},n=0,o=e.length;o>n;n++)e[n].step&&e[n].step(this,s,r,t[s],a);this._curQueueProps[s]=t[s]}return a&&this._appendQueueProps(a),this._curQueueProps},i.prototype._addAction=function(t){return t.t=this.duration,t.type="action",this._steps.push(t),this},i.prototype._set=function(t,e){for(var i in t)e[i]=t[i]},i.prototype.wait=function(t,e){if(null==t||0>=t)return this;var i=this._cloneProps(this._curQueueProps);return this._addStep({d:t,p0:i,p1:i,v:e})},i.prototype.to=function(t,e,i){return void 0===i&&(i=void 0),(isNaN(e)||0>e)&&(e=0),this._addStep({d:e||0,p0:this._cloneProps(this._curQueueProps),e:i,p1:this._cloneProps(this._appendQueueProps(t))}),this.set(t)},i.prototype.call=function(t,e,i){return void 0===e&&(e=void 0),void 0===i&&(i=void 0),this._addAction({f:t,p:i?i:[],o:e?e:this._target})},i.prototype.set=function(t,e){return void 0===e&&(e=null),this._appendQueueProps(t),this._addAction({f:this._set,o:this,p:[t,e?e:this._target]})},i.prototype.play=function(t){return t||(t=this),this.call(t.setPaused,t,[!1])},i.prototype.pause=function(t){return t||(t=this),this.call(t.setPaused,t,[!0])},i.prototype.$tick=function(t){this.paused||this.setPosition(this._prevPosition+t)},i}(t.EventDispatcher);e.NONE=0,e.LOOP=1,e.REVERSE=2,e._tweens=[],e.IGNORE={},e._plugins={},e._inited=!1,e._lastTime=0,t.Tween=e,__reflect(e.prototype,"egret.Tween")}(egret||(egret={}));var egret;!function(t){var e;!function(e){function i(e){if("function"==typeof e)return e;var i=t.Ease[e];return"function"==typeof i?i:null}function r(t,e,i,r){var n=t.prototype;n.__meta__=n.__meta__||{},n.__meta__[e]=i,r&&(n.__defaultProperty__=e)}var n=function(t){function e(){var e=t.apply(this,arguments)||this;return e.name="",e}return __extends(e,t),e}(t.EventDispatcher);e.BasePath=n,__reflect(n.prototype,"egret.tween.BasePath");var o=function(t){function e(){var e=t.apply(this,arguments)||this;return e.props=void 0,e.duration=500,e.ease=void 0,e}return __extends(e,t),e}(n);e.To=o,__reflect(o.prototype,"egret.tween.To");var a=function(t){function e(){var e=t.apply(this,arguments)||this;return e.duration=500,e.passive=void 0,e}return __extends(e,t),e}(n);e.Wait=a,__reflect(a.prototype,"egret.tween.Wait");var s=function(t){function e(){var e=t.apply(this,arguments)||this;return e.props=void 0,e}return __extends(e,t),e}(n);e.Set=s,__reflect(s.prototype,"egret.tween.Set");var l=function(t){function e(){var e=t.apply(this,arguments)||this;return e.delta=0,e}return __extends(e,t),e}(n);e.Tick=l,__reflect(l.prototype,"egret.tween.Tick");var h=function(e){function r(){return e.call(this)||this}return __extends(r,e),Object.defineProperty(r.prototype,"props",{get:function(){return this._props},set:function(t){this._props=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"target",{get:function(){return this._target},set:function(t){this._target=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"paths",{get:function(){return this._paths},set:function(t){this._paths=t||[]},enumerable:!0,configurable:!0}),r.prototype.play=function(t){this.tween?(this.tween.setPaused(!1),void 0!==t&&null!==t&&this.tween.setPosition(t)):this.createTween()},r.prototype.pause=function(){this.tween&&this.tween.setPaused(!0)},r.prototype.stop=function(){this.pause(),this.tween=null},r.prototype.createTween=function(){this.tween=t.Tween.get(this._target,this._props),this._paths&&this.applyPaths()},r.prototype.applyPaths=function(){for(var t=0;t<this._paths.length;t++){var e=this._paths[t];this.applyPath(e)}},r.prototype.applyPath=function(t){var e=this;t instanceof o?this.tween.to(t.props,t.duration,i(t.ease)):t instanceof a?this.tween.wait(t.duration,t.passive):t instanceof s?this.tween.set(t.props):t instanceof l&&this.tween.$tick(t.delta),this.tween.call(function(){return e.pathComplete(t)})},r.prototype.pathComplete=function(t){t.dispatchEventWith("complete"),this.dispatchEventWith("pathComplete",!1,t);var e=this._paths.indexOf(t);e>=0&&e===this._paths.length-1&&this.dispatchEventWith("complete")},r}(t.EventDispatcher);e.TweenItem=h,__reflect(h.prototype,"egret.tween.TweenItem"),r(h,"paths","Array",!0);var u=function(t){function e(){var e=t.call(this)||this;return e.completeCount=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"items",{get:function(){return this._items},set:function(t){this.completeCount=0,this.registerEvent(!1),this._items=t,this.registerEvent(!0)},enumerable:!0,configurable:!0}),e.prototype.registerEvent=function(t){var e=this;this._items&&this._items.forEach(function(i){t?i.addEventListener("complete",e.itemComplete,e):i.removeEventListener("complete",e.itemComplete,e)})},e.prototype.play=function(t){if(this._items)for(var e=0;e<this._items.length;e++){var i=this._items[e];i.play(t)}},e.prototype.pause=function(){if(this._items)for(var t=0;t<this._items.length;t++){var e=this._items[t];e.pause()}},e.prototype.stop=function(){if(this._items)for(var t=0;t<this._items.length;t++){var e=this._items[t];e.stop()}},e.prototype.itemComplete=function(t){var e=t.currentTarget;this.completeCount++,this.dispatchEventWith("itemComplete",!1,e),this.completeCount===this.items.length&&(this.dispatchEventWith("complete"),this.completeCount=0)},e}(t.EventDispatcher);e.TweenGroup=u,__reflect(u.prototype,"egret.tween.TweenGroup"),r(u,"items","Array",!0)}(e=t.tween||(t.tween={}))}(egret||(egret={}));var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},RES;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.resourceConfig=null,i.resourceConfig=t.configInstance,i}return __extends(i,e),i.prototype.addSubkey=function(t,e){this.resourceConfig.addSubkey(t,e)},i.prototype.loadFile=function(){},i.prototype.getRes=function(){},i.prototype.destroyRes=function(){return!1},i.getStringPrefix=function(t){if(!t)return"";var e=t.indexOf(".");return-1!=e?t.substring(0,e):""},i.getStringTail=function(t){if(!t)return"";var e=t.indexOf(".");return-1!=e?t.substring(e+1):""},i}(egret.HashObject);t.AnalyzerBase=e,__reflect(e.prototype,"RES.AnalyzerBase")}(RES||(RES={}));var RES;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.fileDic={},t.resItemDic=[],t._dataFormat=egret.HttpResponseType.ARRAY_BUFFER,t.recycler=[],t}return __extends(i,e),i.prototype.loadFile=function(e,i,r){if(this.fileDic[e.name])return void i.call(r,e);var n=this.getRequest();this.resItemDic[n.hashCode]={item:e,func:i,thisObject:r},n.open(t.$getVirtualUrl(e.url)),n.send()},i.prototype.getRequest=function(){var t=this.recycler.pop();return t||(t=new egret.HttpRequest,t.addEventListener(egret.Event.COMPLETE,this.onLoadFinish,this),t.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadFinish,this)),t.responseType=this._dataFormat,t},i.prototype.onLoadFinish=function(t){var e=t.target,i=this.resItemDic[e.hashCode];delete this.resItemDic[e.hashCode];var r=i.item,n=i.func;r.loaded=t.type==egret.Event.COMPLETE,r.loaded&&this.analyzeData(r,e.response),this.recycler.push(e),n.call(i.thisObject,r)},i.prototype.analyzeData=function(t,e){var i=t.name;this.fileDic[i]||""!=e&&!e||(this.fileDic[i]=e)},i.prototype.getRes=function(t){return this.fileDic[t]},i.prototype.hasRes=function(t){var e=this.getRes(t);return null!=e},i.prototype.destroyRes=function(t){return this.fileDic[t]?(this.onResourceDestroy(this.fileDic[t]),delete this.fileDic[t],!0):!1},i.prototype.onResourceDestroy=function(){},i}(t.AnalyzerBase);t.BinAnalyzer=e,__reflect(e.prototype,"RES.BinAnalyzer")}(RES||(RES={}));var RES;!function(t){var e=function(){function t(t,e,i){this.groupName="",this.data=null,this._loaded=!1,this.name=t,this.url=e,this.type=i}return Object.defineProperty(t.prototype,"loaded",{get:function(){return this.data?this.data.loaded:this._loaded},set:function(t){this.data&&(this.data.loaded=t),this._loaded=t},enumerable:!0,configurable:!0}),t.prototype.toString=function(){return'[ResourceItem name="'+this.name+'" url="'+this.url+'" type="'+this.type+'"]'},t}();e.TYPE_XML="xml",e.TYPE_IMAGE="image",e.TYPE_BIN="bin",e.TYPE_TEXT="text",e.TYPE_JSON="json",e.TYPE_SHEET="sheet",e.TYPE_FONT="font",e.TYPE_SOUND="sound",t.ResourceItem=e,__reflect(e.prototype,"RES.ResourceItem")}(RES||(RES={}));var RES;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.sheetMap={},t.textureMap={},t.recyclerIamge=[],t._dataFormat=egret.HttpResponseType.TEXT,t}return __extends(i,e),i.prototype.getRes=function(e){var i=this.fileDic[e];if(i||(i=this.textureMap[e]),!i){var r=t.AnalyzerBase.getStringPrefix(e);if(i=this.fileDic[r]){var n=t.AnalyzerBase.getStringTail(e);i=i.getTexture(n)}}return i},i.prototype.onLoadFinish=function(t){var e=t.target,i=this.resItemDic[e.$hashCode];delete this.resItemDic[e.hashCode];var r=i.item,n=i.func;if(r.loaded=t.type==egret.Event.COMPLETE,r.loaded)if(e instanceof egret.HttpRequest){r.loaded=!1;var o=this.analyzeConfig(r,e.response);if(o)return this.loadImage(o,i),void this.recycler.push(e)}else{var a=new egret.Texture;a._setBitmapData(e.data),this.analyzeBitmap(r,a)}e instanceof egret.HttpRequest?this.recycler.push(e):this.recyclerIamge.push(e),n.call(i.thisObject,r)},i.prototype.analyzeConfig=function(t,e){var i,r=t.name,n="";try{var o=e;i=JSON.parse(o)}catch(a){egret.$warn(1017,t.url,e)}return i&&(this.sheetMap[r]=i,n=this.getRelativePath(t.url,i.file)),n},i.prototype.analyzeBitmap=function(t,e){var i=t.name;if(!this.fileDic[i]&&e){var r=this.sheetMap[i];delete this.sheetMap[i];var n=t.data&&t.data.subkeys?"":i,o=this.parseSpriteSheet(e,r,n);this.fileDic[i]=o}},i.prototype.getRelativePath=function(t,e){t=t.split("\\").join("/");var i=t.match(/#.*|\?.*/),r="";i&&(r=i[0]);var n=t.lastIndexOf("/");return t=-1!=n?t.substring(0,n+1)+e:e,t+r},i.prototype.parseSpriteSheet=function(t,e,i){var r=e.frames;if(!r)return null;var n=new egret.SpriteSheet(t),o=this.textureMap;for(var a in r){var s=r[a],l=n.createTexture(a,s.x,s.y,s.w,s.h,s.offX,s.offY,s.sourceW,s.sourceH);if(s.scale9grid){var h=s.scale9grid,u=h.split(",");l.scale9Grid=new egret.Rectangle(parseInt(u[0]),parseInt(u[1]),parseInt(u[2]),parseInt(u[3]))}null==o[a]&&(o[a]=l,i&&this.addSubkey(a,i))}return n},i.prototype.destroyRes=function(t){var e=this.fileDic[t];if(e){delete this.fileDic[t];var i=void 0;for(var r in e._textureMap)null==i&&(i=e._textureMap[r],this.onResourceDestroy(i),i=null),delete this.textureMap[r];return e.dispose&&e.dispose(),!0}return!1},i.prototype.loadImage=function(e,i){var r=this.getImageLoader();this.resItemDic[r.hashCode]=i,r.load(t.$getVirtualUrl(e))},i.prototype.getImageLoader=function(){var t=this.recyclerIamge.pop();return t||(t=new egret.ImageLoader,t.addEventListener(egret.Event.COMPLETE,this.onLoadFinish,this),t.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadFinish,this)),t},i.prototype.onResourceDestroy=function(t){t&&t.dispose()},i}(t.BinAnalyzer);t.SheetAnalyzer=e,__reflect(e.prototype,"RES.SheetAnalyzer")}(RES||(RES={}));var RES;!function(){}(RES||(RES={}));var RES;!function(t){var e=function(t){function e(e,i,r){void 0===i&&(i=!1),void 0===r&&(r=!1);var n=t.call(this,e,i,r)||this;return n.itemsLoaded=0,n.itemsTotal=0,n.groupName="",n.resItem=null,n}return __extends(e,t),e.dispatchResourceEvent=function(t,i,r,n,o,a){void 0===r&&(r=""),void 0===n&&(n=null),void 0===o&&(o=0),void 0===a&&(a=0);var s=egret.Event.create(e,i);s.groupName=r,s.resItem=n,s.itemsLoaded=o,s.itemsTotal=a;var l=t.dispatchEvent(s);return egret.Event.release(s),l},e}(egret.Event);e.ITEM_LOAD_ERROR="itemLoadError",e.CONFIG_COMPLETE="configComplete",e.CONFIG_LOAD_ERROR="configLoadError",e.GROUP_PROGRESS="groupProgress",e.GROUP_COMPLETE="groupComplete",e.GROUP_LOAD_ERROR="groupLoadError",t.ResourceEvent=e,__reflect(e.prototype,"RES.ResourceEvent")}(RES||(RES={}));var RES;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._dataFormat=egret.HttpResponseType.TEXT,e}return __extends(e,t),e}(t.BinAnalyzer);t.TextAnalyzer=e,__reflect(e.prototype,"RES.TextAnalyzer")}(RES||(RES={}));var RES;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._dataFormat=egret.HttpResponseType.TEXT,e}return __extends(e,t),e.prototype.analyzeData=function(t,e){var i=t.name;if(!this.fileDic[i]&&e)try{var r=e;this.fileDic[i]=JSON.parse(r)}catch(n){egret.$warn(1017,t.url,e)}},e}(t.BinAnalyzer);t.JsonAnalyzer=e,__reflect(e.prototype,"RES.JsonAnalyzer")}(RES||(RES={}));var RES;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.thread=2,t.loadingCount=0,t.callBack=null,t.resInstance=null,t.groupTotalDic={},t.numLoadedDic={},t.itemListDic={},t.groupErrorDic={},t.retryTimesDic={},t.maxRetryTimes=3,t.failedList=new Array,t.priorityQueue={},t.lazyLoadList=new Array,t.analyzerDic={},t.queueIndex=0,t}return __extends(i,e),i.prototype.isGroupInLoading=function(t){return void 0!==this.itemListDic[t]},i.prototype.loadGroup=function(e,i,r){if(void 0===r&&(r=0),!this.itemListDic[i]&&i){if(!e||0==e.length){egret.$warn(3201,i);var n=new t.ResourceEvent(t.ResourceEvent.GROUP_LOAD_ERROR);return n.groupName=i,void this.dispatchEvent(n)}this.priorityQueue[r]?this.priorityQueue[r].push(i):this.priorityQueue[r]=[i],this.itemListDic[i]=e;for(var o=e.length,a=0;o>a;a++){var s=e[a];s.groupName=i}this.groupTotalDic[i]=e.length,this.numLoadedDic[i]=0,this.next()}},i.prototype.loadItem=function(t){this.lazyLoadList.push(t),t.groupName="",this.next()},i.prototype.next=function(){for(;this.loadingCount<this.thread;){var t=this.getOneResourceItem();if(!t)break;if(this.loadingCount++,t.loaded)this.onItemComplete(t);else{var e=this.resInstance.$getAnalyzerByType(t.type);e.loadFile(t,this.onItemComplete,this)}}},i.prototype.getOneResourceItem=function(){if(this.failedList.length>0)return this.failedList.shift();var t=Number.NEGATIVE_INFINITY;for(var e in this.priorityQueue)t=Math.max(t,e);var i=this.priorityQueue[t];if(!i||0==i.length)return 0==this.lazyLoadList.length?null:this.lazyLoadList.pop();for(var r,n=i.length,o=0;n>o&&(this.queueIndex>=n&&(this.queueIndex=0),r=this.itemListDic[i[this.queueIndex]],!(r.length>0));o++)this.queueIndex++;return 0==r.length?null:r.shift()},i.prototype.onItemComplete=function(e){this.loadingCount--;var i=e.groupName;if(!e.loaded){var r=this.retryTimesDic[e.name]||1;if(!(r>this.maxRetryTimes))return this.retryTimesDic[e.name]=r+1,this.failedList.push(e),void this.next();delete this.retryTimesDic[e.name],t.ResourceEvent.dispatchResourceEvent(this.resInstance,t.ResourceEvent.ITEM_LOAD_ERROR,i,e)}if(i){this.numLoadedDic[i]++;var n=this.numLoadedDic[i],o=this.groupTotalDic[i];if(e.loaded||(this.groupErrorDic[i]=!0),t.ResourceEvent.dispatchResourceEvent(this.resInstance,t.ResourceEvent.GROUP_PROGRESS,i,e,n,o),n==o){var a=this.groupErrorDic[i];this.removeGroupName(i),delete this.groupTotalDic[i],delete this.numLoadedDic[i],delete this.itemListDic[i],delete this.groupErrorDic[i],a?t.ResourceEvent.dispatchResourceEvent(this,t.ResourceEvent.GROUP_LOAD_ERROR,i):t.ResourceEvent.dispatchResourceEvent(this,t.ResourceEvent.GROUP_COMPLETE,i)}}else this.callBack.call(this.resInstance,e);this.next()},i.prototype.removeGroupName=function(t){for(var e in this.priorityQueue){for(var i=this.priorityQueue[e],r=0,n=!1,o=i.length,a=0;o>a;a++){var s=i[a];if(s==t){i.splice(r,1),n=!0;break}r++}if(n){0==i.length&&delete this.priorityQueue[e];break}}},i}(egret.EventDispatcher);t.ResourceLoader=e,__reflect(e.prototype,"RES.ResourceLoader")}(RES||(RES={}));var RES;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.analyzeConfig=function(t,e){var i,r=t.name,n="";try{var o=e;i=JSON.parse(o)}catch(a){}return i?n=this.getRelativePath(t.url,i.file):(i=e,n=this.getTexturePath(t.url,i)),this.sheetMap[r]=i,n},e.prototype.analyzeBitmap=function(t,e){var i=t.name;if(!this.fileDic[i]&&e){var r=this.sheetMap[i];delete this.sheetMap[i];var n=new egret.BitmapFont(e,r);this.fileDic[i]=n}},e.prototype.getTexturePath=function(t,e){var i="",r=e.split("\n"),n=r[2],o=n.indexOf('file="');return-1!=o&&(n=n.substring(o+6),o=n.indexOf('"'),i=n.substring(0,o)),t=t.split("\\").join("/"),o=t.lastIndexOf("/"),t=-1!=o?t.substring(0,o+1)+i:i},e.prototype.onResourceDestroy=function(t){t&&t.dispose()},e}(t.SheetAnalyzer);t.FontAnalyzer=e,__reflect(e.prototype,"RES.FontAnalyzer")}(RES||(RES={}));var RES;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.soundDic={},t.resItemDic=[],t}return __extends(i,e),i.prototype.loadFile=function(e,i,r){if(this.soundDic[e.name])return void i.call(r,e);var n=new egret.Sound;n.addEventListener(egret.Event.COMPLETE,this.onLoadFinish,this),n.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadFinish,this),this.resItemDic[n.$hashCode]={item:e,func:i,thisObject:r},n.load(t.$getVirtualUrl(e.url)),e.data&&(n.type=e.data.soundType)},i.prototype.onLoadFinish=function(t){var e=t.$target;e.removeEventListener(egret.Event.COMPLETE,this.onLoadFinish,this),e.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadFinish,this);var i=this.resItemDic[e.$hashCode];delete this.resItemDic[e.$hashCode];var r=i.item,n=i.func;r.loaded=t.$type==egret.Event.COMPLETE,r.loaded&&this.analyzeData(r,e),n.call(i.thisObject,r)},i.prototype.analyzeData=function(t,e){var i=t.name;!this.soundDic[i]&&e&&(this.soundDic[i]=e)},i.prototype.getRes=function(t){return this.soundDic[t]},i.prototype.hasRes=function(t){return!!this.getRes(t)},i.prototype.destroyRes=function(t){return this.soundDic[t]?(delete this.soundDic[t],!0):!1},i}(t.AnalyzerBase);t.SoundAnalyzer=e,__reflect(e.prototype,"RES.SoundAnalyzer")}(RES||(RES={}));var RES;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._dataFormat=egret.HttpResponseType.TEXT,e}return __extends(e,t),e.prototype.analyzeData=function(t,e){var i=t.name;if(!this.fileDic[i]&&e)try{var r=e,n=egret.XML.parse(r);this.fileDic[i]=n}catch(o){}},e}(t.BinAnalyzer);t.XMLAnalyzer=e,__reflect(e.prototype,"RES.XMLAnalyzer")}(RES||(RES={}));var RES;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.fileDic={},t.resItemDic=[],t.recycler=[],t}return __extends(i,e),i.prototype.loadFile=function(e,i,r){if(this.fileDic[e.name])return void i.call(r,e);var n=this.getLoader();this.resItemDic[n.$hashCode]={item:e,func:i,thisObject:r},n.load(t.$getVirtualUrl(e.url))},i.prototype.getLoader=function(){var t=this.recycler.pop();return t||(t=new egret.ImageLoader,t.addEventListener(egret.Event.COMPLETE,this.onLoadFinish,this),t.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadFinish,this)),t},i.prototype.onLoadFinish=function(t){var e=t.$target,i=this.resItemDic[e.$hashCode];delete this.resItemDic[e.$hashCode];var r=i.item,n=i.func;if(r.loaded=t.$type==egret.Event.COMPLETE,r.loaded){var o=new egret.Texture;o._setBitmapData(e.data),this.analyzeData(r,o)}this.recycler.push(e),n.call(i.thisObject,r)},i.prototype.analyzeData=function(t,e){var i=t.name;if(!this.fileDic[i]&&e){this.fileDic[i]=e;var r=t.data;if(r&&r.scale9grid){var n=r.scale9grid,o=n.split(",");e.scale9Grid=new egret.Rectangle(parseInt(o[0]),parseInt(o[1]),parseInt(o[2]),parseInt(o[3]))}}},i.prototype.getRes=function(t){return this.fileDic[t]},i.prototype.hasRes=function(t){var e=this.getRes(t);return null!=e},i.prototype.destroyRes=function(t){return this.fileDic[t]?(this.onResourceDestroy(this.fileDic[t]),delete this.fileDic[t],!0):!1},i.prototype.onResourceDestroy=function(t){t.dispose()},i}(t.AnalyzerBase);t.ImageAnalyzer=e,__reflect(e.prototype,"RES.ImageAnalyzer")}(RES||(RES={}));var RES;!function(t){var e=function(){function e(){this.keyMap={},this.groupDic={},t.configInstance=this}return e.prototype.getGroupByName=function(t){var e=new Array;if(!this.groupDic[t])return e;for(var i=this.groupDic[t],r=i.length,n=0;r>n;n++){var o=i[n];e.push(this.parseResourceItem(o))}return e},e.prototype.getRawGroupByName=function(t){return this.groupDic[t]?this.groupDic[t]:[]},e.prototype.createGroup=function(t,e,i){if(void 0===i&&(i=!1),!i&&this.groupDic[t]||!e||0==e.length)return!1;for(var r=this.groupDic,n=[],o=e.length,a=0;o>a;a++){var s=e[a],l=r[s];if(l)for(var h=l.length,u=0;h>u;u++){var c=l[u];-1==n.indexOf(c)&&n.push(c)}else{var c=this.keyMap[s];c?-1==n.indexOf(c)&&n.push(c):egret.$warn(3200,s)}}return 0==n.length?!1:(this.groupDic[t]=n,!0)},e.prototype.parseConfig=function(t,e){if(t){var i=t.resources;if(i)for(var r=i.length,n=0;r>n;n++){var o=i[n],a=o.url;a&&-1==a.indexOf("://")&&(o.url=e+a),this.addItemToKeyMap(o)}var s=t.groups;if(s)for(var l=s.length,n=0;l>n;n++){for(var h=s[n],u=[],c=h.keys.split(","),p=c.length,d=0;p>d;d++){var f=c[d].trim(),o=this.keyMap[f];o&&-1==u.indexOf(o)&&u.push(o)}this.groupDic[h.name]=u}}},e.prototype.addSubkey=function(t,e){var i=this.keyMap[e];i&&!this.keyMap[t]&&(this.keyMap[t]=i)},e.prototype.addItemToKeyMap=function(t){if(this.keyMap[t.name]||(this.keyMap[t.name]=t),t.hasOwnProperty("subkeys")){var e=t.subkeys.split(",");t.subkeys=e;for(var i=e.length,r=0;i>r;r++){var n=e[r];null==this.keyMap[n]&&(this.keyMap[n]=t)}}},e.prototype.getName=function(t){var e=this.keyMap[t];return e?e.name:""},e.prototype.getType=function(t){var e=this.keyMap[t];return e?e.type:""},e.prototype.getRawResourceItem=function(t){return this.keyMap[t]},e.prototype.getResourceItem=function(t){var e=this.keyMap[t];return e?this.parseResourceItem(e):null},e.prototype.parseResourceItem=function(e){var i=new t.ResourceItem(e.name,e.url,e.type);return i.data=e,i},e}();t.ResourceConfig=e,__reflect(e.prototype,"RES.ResourceConfig")}(RES||(RES={}));var RES;!function(t){var e;!function(e){var i=function(){function t(){this._versionInfo={},this._versionPath="",this._localFileArr=[]}return t.prototype.fetchVersion=function(t){return void t.onSuccess(null)},t.prototype.getList=function(t,e,i){void 0===i&&(i="");var r=egret.PromiseObject.create();r.onSuccessFunc=function(e){t(e)},r.onErrorFunc=function(){console.error("list files error")},"assets"==e?egret_native.Game.listResource(i,r):egret_native.Game.listUpdate(i,r)},t.prototype.getChangeList=function(){var t=[],e=this._localFileArr;for(var i in this._versionInfo)e.indexOf(this.getVirtualUrl(i))<0&&t.push({url:this.getVirtualUrl(i),size:this._versionInfo[i].s});return t},t.prototype.getVirtualUrl=function(t){return t},t.prototype.getLocalData=function(t){if(egret_native.readUpdateFileSync&&egret_native.readResourceFileSync){var e=egret_native.readUpdateFileSync(t);if(null!=e)return JSON.parse(e);if(e=egret_native.readResourceFileSync(t),null!=e)return JSON.parse(e)}return null},t}();e.NativeVersionController=i,__reflect(i.prototype,"RES.native.NativeVersionController",["RES.VersionController","RES.IVersionController"]),egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE&&(t.VersionController=i)}(e=t["native"]||(t["native"]={}))}(RES||(RES={}));var RES;!function(t){var e;!function(e){var i=function(t){function e(){var e=t.call(this)||this;return e._versionInfo={},e}return __extends(e,t),e.prototype.fetchVersion=function(t){t.onSuccess(null)},e.prototype.getChangeList=function(){return[]},e.prototype.getVirtualUrl=function(t){return t},e}(egret.EventDispatcher);e.Html5VersionController=i,__reflect(i.prototype,"RES.web.Html5VersionController",["RES.VersionController","RES.IVersionController"]),egret.Capabilities.runtimeType==egret.RuntimeType.WEB&&(t.VersionController=i)}(e=t.web||(t.web={}))}(RES||(RES={}));var RES;!function(t){function e(t,e){x.registerAnalyzer(t,e)}function i(t){return x.$getAnalyzerByType(t)}function r(t){x.$registerVersionController(t)}function n(){return x.vcs}function o(t,e,i){void 0===e&&(e=""),void 0===i&&(i="json"),x.loadConfig(t,e,i)}function a(t,e){void 0===e&&(e=0),x.loadGroup(t,e)}function s(t){return x.isGroupLoaded(t)}function l(t){return x.getGroupByName(t)}function h(t,e,i){return void 0===i&&(i=!1),x.createGroup(t,e,i)}function u(t){return x.hasRes(t)}function c(t,e){void 0===e&&(e=""),x.parseConfig(t,e)}function p(t){return x.getRes(t)}function d(t,e,i){x.getResAsync(t,e,i)}function f(t,e,i,r){void 0===r&&(r=""),x.getResByUrl(t,e,i,r)}function g(t,e){return x.destroyRes(t,e)}function y(t){x.setMaxLoadingThread(t)}function v(t){x.setMaxRetryTimes(t)}function m(t,e,i,r,n){void 0===r&&(r=!1),void 0===n&&(n=0),x.addEventListener(t,e,i,r,n)}function _(t,e,i,r){void 0===r&&(r=!1),x.removeEventListener(t,e,i,r)}function b(t){return x.vcs?x.vcs.getVirtualUrl(t):t}t.registerAnalyzer=e,t.getAnalyzer=i,t.registerVersionController=r,t.getVersionController=n,t.loadConfig=o,t.loadGroup=a,t.isGroupLoaded=s,t.getGroupByName=l,t.createGroup=h,t.hasRes=u,t.parseConfig=c,t.getRes=p,t.getResAsync=d,t.getResByUrl=f,t.destroyRes=g,t.setMaxLoadingThread=y,t.setMaxRetryTimes=v,t.addEventListener=m,t.removeEventListener=_,t.$getVirtualUrl=b;var T=function(e){function i(){var t=e.call(this)||this;return t.analyzerDic={},t.analyzerClassMap={},t.configItemList=[],t.callLaterFlag=!1,t.configComplete=!1,t.loadedGroups=[],t.groupNameList=[],t.asyncDic={},t._loadedUrlTypes={},t.init(),t}return __extends(i,e),i.prototype.$getAnalyzerByType=function(t){var e=this.analyzerDic[t];if(!e){var i=this.analyzerClassMap[t];if(!i)return egret.$error(3203,t),null;e=this.analyzerDic[t]=new i}return e},i.prototype.registerAnalyzer=function(t,e){this.analyzerClassMap[t]=e},i.prototype.$registerVersionController=function(t){this.vcs=t},i.prototype.init=function(){this.vcs=new t.VersionController;var e=this.analyzerClassMap;e[t.ResourceItem.TYPE_BIN]=t.BinAnalyzer,e[t.ResourceItem.TYPE_IMAGE]=t.ImageAnalyzer,e[t.ResourceItem.TYPE_TEXT]=t.TextAnalyzer,e[t.ResourceItem.TYPE_JSON]=t.JsonAnalyzer,e[t.ResourceItem.TYPE_SHEET]=t.SheetAnalyzer,e[t.ResourceItem.TYPE_FONT]=t.FontAnalyzer,e[t.ResourceItem.TYPE_SOUND]=t.SoundAnalyzer,e[t.ResourceItem.TYPE_XML]=t.XMLAnalyzer,this.resConfig=new t.ResourceConfig,this.resLoader=new t.ResourceLoader,this.resLoader.callBack=this.onResourceItemComp,this.resLoader.resInstance=this,this.resLoader.addEventListener(t.ResourceEvent.GROUP_COMPLETE,this.onGroupComp,this),this.resLoader.addEventListener(t.ResourceEvent.GROUP_LOAD_ERROR,this.onGroupError,this)},i.prototype.loadConfig=function(t,e,i){void 0===i&&(i="json");var r={url:t,resourceRoot:e,type:i};this.configItemList.push(r),this.callLaterFlag||(egret.callLater(this.startLoadConfig,this),this.callLaterFlag=!0)},i.prototype.startLoadConfig=function(){var e=this;this.callLaterFlag=!1;var r=this.configItemList;this.configItemList=[],this.loadingConfigList=r;for(var n=r.length,o=[],a=0;n>a;a++){var s=r[a],l=new t.ResourceItem(s.url,s.url,s.type);o.push(l)}var h={onSuccess:function(){e.resLoader.loadGroup(o,i.GROUP_CONFIG,Number.MAX_VALUE)},onFail:function(){t.ResourceEvent.dispatchResourceEvent(e,t.ResourceEvent.CONFIG_LOAD_ERROR)}};this.vcs?this.vcs.fetchVersion(h):this.resLoader.loadGroup(o,i.GROUP_CONFIG,Number.MAX_VALUE)},i.prototype.isGroupLoaded=function(t){return-1!=this.loadedGroups.indexOf(t)},i.prototype.getGroupByName=function(t){return this.resConfig.getGroupByName(t)},i.prototype.loadGroup=function(e,i){if(void 0===i&&(i=0),-1!=this.loadedGroups.indexOf(e))return void t.ResourceEvent.dispatchResourceEvent(this,t.ResourceEvent.GROUP_COMPLETE,e);if(!this.resLoader.isGroupInLoading(e))if(this.configComplete){var r=this.resConfig.getGroupByName(e);this.resLoader.loadGroup(r,e,i)}else this.groupNameList.push({name:e,priority:i})},i.prototype.createGroup=function(t,e,i){if(void 0===i&&(i=!1),i){var r=this.loadedGroups.indexOf(t);-1!=r&&this.loadedGroups.splice(r,1)}return this.resConfig.createGroup(t,e,i)},i.prototype.onGroupComp=function(e){if(e.groupName==i.GROUP_CONFIG){for(var r=this.loadingConfigList.length,n=0;r>n;n++){var o=this.loadingConfigList[n],a=this.$getAnalyzerByType(o.type),s=a.getRes(o.url);a.destroyRes(o.url),this.resConfig.parseConfig(s,o.resourceRoot)}this.configComplete=!0,this.loadingConfigList=null,t.ResourceEvent.dispatchResourceEvent(this,t.ResourceEvent.CONFIG_COMPLETE),this.loadDelayGroups()}else this.loadedGroups.push(e.groupName),this.dispatchEvent(e)},i.prototype.loadDelayGroups=function(){var t=this.groupNameList;this.groupNameList=[];for(var e=t.length,i=0;e>i;i++){var r=t[i];this.loadGroup(r.name,r.priority)}},i.prototype.onGroupError=function(e){e.groupName==i.GROUP_CONFIG?(this.loadingConfigList=null,t.ResourceEvent.dispatchResourceEvent(this,t.ResourceEvent.CONFIG_LOAD_ERROR)):this.dispatchEvent(e)},i.prototype.hasRes=function(e){var i=this.resConfig.getType(e);if(""==i){var r=t.AnalyzerBase.getStringTail(e);if(i=this.resConfig.getType(r),""==i)return!1}return!0},i.prototype.parseConfig=function(t,e){this.resConfig.parseConfig(t,e),this.configComplete||this.loadingConfigList||(this.configComplete=!0,this.loadDelayGroups())},i.prototype.getRes=function(e){var i=this.resConfig.getType(e);if(""==i){var r=t.AnalyzerBase.getStringPrefix(e);if(i=this.resConfig.getType(r),""==i)return null}var n=this.$getAnalyzerByType(i);return n.getRes(e)},i.prototype.getResAsync=function(e,i,r){var n=this.resConfig.getType(e),o=this.resConfig.getName(e);if(""==n&&(o=t.AnalyzerBase.getStringPrefix(e),n=this.resConfig.getType(o),""==n))return void egret.$callAsync(i,r);var a=this.$getAnalyzerByType(n),s=a.getRes(e);if(s)return void egret.$callAsync(i,r,s,e);var l={key:e,compFunc:i,thisObject:r};if(this.asyncDic[o])this.asyncDic[o].push(l);else{this.asyncDic[o]=[l];var h=this.resConfig.getResourceItem(o);this.resLoader.loadItem(h)}},i.prototype.getResByUrl=function(e,i,r,n){if(void 0===n&&(n=""),!e)return void egret.$callAsync(i,r);n||(n=this.getTypeByUrl(e)),null!=this._loadedUrlTypes[e]&&this._loadedUrlTypes[e]!=n&&egret.$warn(3202),this._loadedUrlTypes[e]=n;var o=this.$getAnalyzerByType(n),a=e,s=o.getRes(a);if(s)return void egret.$callAsync(i,r,s,e);var l={key:a,compFunc:i,thisObject:r};if(this.asyncDic[a])this.asyncDic[a].push(l);else{this.asyncDic[a]=[l];var h=new t.ResourceItem(a,e,n);this.resLoader.loadItem(h)}},i.prototype.getTypeByUrl=function(e){var i=e.substr(e.lastIndexOf(".")+1);i&&(i=i.toLowerCase());var r;switch(i){case t.ResourceItem.TYPE_XML:case t.ResourceItem.TYPE_JSON:case t.ResourceItem.TYPE_SHEET:r=i;break;case"png":case"jpg":case"gif":case"jpeg":case"bmp":r=t.ResourceItem.TYPE_IMAGE;break;case"fnt":r=t.ResourceItem.TYPE_FONT;break;case"txt":r=t.ResourceItem.TYPE_TEXT;break;case"mp3":case"ogg":case"mpeg":case"wav":case"m4a":case"mp4":case"aiff":case"wma":case"mid":r=t.ResourceItem.TYPE_SOUND;break;default:r=t.ResourceItem.TYPE_BIN}return r},i.prototype.onResourceItemComp=function(t){var e=this.asyncDic[t.name];delete this.asyncDic[t.name];for(var i=this.$getAnalyzerByType(t.type),r=e.length,n=0;r>n;n++){var o=e[n],a=i.getRes(o.key);o.compFunc.call(o.thisObject,a,o.key)}},i.prototype.destroyRes=function(t,e){void 0===e&&(e=!0);var i=this.resConfig.getRawGroupByName(t);if(i&&i.length>0){var r=this.loadedGroups.indexOf(t);-1!=r&&this.loadedGroups.splice(r,1);for(var n=i.length,o=0;n>o;o++){var a=i[o];if(!e&&this.isResInLoadedGroup(a.name));else{a.loaded=!1;var s=this.$getAnalyzerByType(a.type);s.destroyRes(a.name),this.removeLoadedGroupsByItemName(a.name)}}return!0}var l=this.resConfig.getType(t);if(""==l){if(l=this._loadedUrlTypes[t],null==l||""==l)return!1;delete this._loadedUrlTypes[t];
var h=this.$getAnalyzerByType(l);return h.destroyRes(t),!0}var a=this.resConfig.getRawResourceItem(t);a.loaded=!1;var s=this.$getAnalyzerByType(l),u=s.destroyRes(t);return this.removeLoadedGroupsByItemName(a.name),u},i.prototype.removeLoadedGroupsByItemName=function(t){for(var e=this.loadedGroups,i=e.length,r=0;i>r;r++)for(var n=this.resConfig.getRawGroupByName(e[r]),o=n.length,a=0;o>a;a++){var s=n[a];if(s.name==t){e.splice(r,1),r--,i=e.length;break}}},i.prototype.isResInLoadedGroup=function(t){for(var e=this.loadedGroups,i=e.length,r=0;i>r;r++)for(var n=this.resConfig.getRawGroupByName(e[r]),o=n.length,a=0;o>a;a++){var s=n[a];if(s.name==t)return!0}return!1},i.prototype.setMaxLoadingThread=function(t){1>t&&(t=1),this.resLoader.thread=t},i.prototype.setMaxRetryTimes=function(t){t=Math.max(t,0),this.resLoader.maxRetryTimes=t},i}(egret.EventDispatcher);T.GROUP_CONFIG="RES__CONFIG",__reflect(T.prototype,"Resource");var x=new T}(RES||(RES={}));var RES;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.sheetMap={},t.recyclerIamge=[],t._dataFormat=egret.HttpResponseType.TEXT,t}return __extends(i,e),i.prototype.onLoadFinish=function(t){var e=t.target,i=this.resItemDic[e.$hashCode];delete this.resItemDic[e.hashCode];var r=i.item,n=i.func;if(r.loaded=t.type==egret.Event.COMPLETE,r.loaded)if(e instanceof egret.HttpRequest){r.loaded=!1;var o=this.analyzeConfig(r,e.response);if(o)return this.loadImage(o,i),void this.recycler.push(e)}else this.analyzeBitmap(r,e.data);e instanceof egret.HttpRequest?this.recycler.push(e):this.recyclerIamge.push(e),n.call(i.thisObject,r)},i.prototype.analyzeConfig=function(t,e){var i,r=t.name,n="";try{var o=e;i=JSON.parse(o)}catch(a){egret.$warn(1017,t.url,e)}if(i)if(this.sheetMap[r]=i,i.file)n=this.getRelativePath(t.url,i.file);else{var s=t.url.split("?"),l=s[0].split("/");l[l.length-1]=l[l.length-1].split(".")[0]+".png",n="";for(var h=0;h<l.length;h++)n+=l[h]+(h<l.length-1?"/":"");2==s.length&&(n+=s[2])}return n},i.prototype.analyzeBitmap=function(t,e){var i=t.name;if(!this.fileDic[i]&&e){var r=this.sheetMap[i];delete this.sheetMap[i];var n=t.data&&t.data.subkeys?"":i,o=this.parseAnimation(e,r,n);this.fileDic[i]=o}},i.prototype.getRelativePath=function(t,e){t=t.split("\\").join("/");var i=t.lastIndexOf("/");return t=-1!=i?t.substring(0,i+1)+e:e},i.prototype.parseAnimation=function(t,e){for(var i,r=Object.keys(e.mc),n=e.mc[r[0]].frames,o=n.length,a=[],s=0;o>s;s++){i=e.res[n[s].res];var l=new egret.Texture;l._bitmapData=t,l.$initData(i.x,i.y,i.w,i.h,n[s].x,n[s].y,n[s].sourceW,n[s].sourceH,t.width,t.height)}return a},i.prototype.destroyRes=function(t){var e=this.fileDic[t];return e?(delete this.fileDic[t],!0):!1},i.prototype.loadImage=function(e,i){var r=this.getImageLoader();this.resItemDic[r.hashCode]=i,r.load(t.$getVirtualUrl(e))},i.prototype.getImageLoader=function(){var t=this.recyclerIamge.pop();return t||(t=new egret.ImageLoader,t.addEventListener(egret.Event.COMPLETE,this.onLoadFinish,this),t.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadFinish,this)),t},i}(t.BinAnalyzer);t.AnimationAnalyzer=e,__reflect(e.prototype,"RES.AnimationAnalyzer")}(RES||(RES={}));var egret;!function(t){t.$locale_strings=t.$locale_strings||{},t.$locale_strings.en_US=t.$locale_strings.en_US||{};var e=t.$locale_strings.en_US;e[3200]="RES.createGroup() passed in non-existed key value in configuration: {0}",e[3201]='RES loaded non-existed or empty resource group:"{0}"',e[3202]="Do not use the different types of ways to load the same material!",e[3203]="Can't find the analyzer of the specified file type:{0}。 Please register the specified analyzer in the initialization of the project first,then start the resource loading process。"}(egret||(egret={}));var egret;!function(t){t.$locale_strings=t.$locale_strings||{},t.$locale_strings.zh_CN=t.$locale_strings.zh_CN||{};var e=t.$locale_strings.zh_CN;e[3200]="RES.createGroup()传入了配置中不存在的键值: {0}",e[3201]='RES加载了不存在或空的资源组:"{0}"',e[3202]="请不要使用不同的类型方式来加载同一个素材！",e[3203]="找不到指定文件类型的解析器:{0}。 请先在项目初始化里注册指定文件类型的解析器，再启动资源加载。"}(egret||(egret={}));var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},eui;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.targetLevel=Number.POSITIVE_INFINITY,e.invalidatePropertiesFlag=!1,e.invalidateClientPropertiesFlag=!1,e.invalidatePropertiesQueue=new i,e.invalidateSizeFlag=!1,e.invalidateClientSizeFlag=!1,e.invalidateSizeQueue=new i,e.invalidateDisplayListFlag=!1,e.invalidateDisplayListQueue=new i,e.eventDisplay=new egret.Bitmap,e.listenersAttached=!1,e}return __extends(e,t),e.prototype.invalidateProperties=function(t){this.invalidatePropertiesFlag||(this.invalidatePropertiesFlag=!0,this.listenersAttached||this.attachListeners()),this.targetLevel<=t.$nestLevel&&(this.invalidateClientPropertiesFlag=!0),this.invalidatePropertiesQueue.insert(t)},e.prototype.validateProperties=function(){for(var t=this.invalidatePropertiesQueue,e=t.shift();e;)e.$stage&&e.validateProperties(),e=t.shift();t.isEmpty()&&(this.invalidatePropertiesFlag=!1)},e.prototype.invalidateSize=function(t){this.invalidateSizeFlag||(this.invalidateSizeFlag=!0,this.listenersAttached||this.attachListeners()),this.targetLevel<=t.$nestLevel&&(this.invalidateClientSizeFlag=!0),this.invalidateSizeQueue.insert(t)},e.prototype.validateSize=function(){for(var t=this.invalidateSizeQueue,e=t.pop();e;)e.$stage&&e.validateSize(),e=t.pop();t.isEmpty()&&(this.invalidateSizeFlag=!1)},e.prototype.invalidateDisplayList=function(t){this.invalidateDisplayListFlag||(this.invalidateDisplayListFlag=!0,this.listenersAttached||this.attachListeners()),this.invalidateDisplayListQueue.insert(t)},e.prototype.validateDisplayList=function(){for(var t=this.invalidateDisplayListQueue,e=t.shift();e;)e.$stage&&e.validateDisplayList(),e=t.shift();t.isEmpty()&&(this.invalidateDisplayListFlag=!1)},e.prototype.attachListeners=function(){this.eventDisplay.addEventListener(egret.Event.ENTER_FRAME,this.doPhasedInstantiationCallBack,this),this.eventDisplay.addEventListener(egret.Event.RENDER,this.doPhasedInstantiationCallBack,this),egret.sys.$invalidateRenderFlag=!0,this.listenersAttached=!0},e.prototype.doPhasedInstantiationCallBack=function(){this.eventDisplay.removeEventListener(egret.Event.ENTER_FRAME,this.doPhasedInstantiationCallBack,this),this.eventDisplay.removeEventListener(egret.Event.RENDER,this.doPhasedInstantiationCallBack,this),this.doPhasedInstantiation()},e.prototype.doPhasedInstantiation=function(){this.invalidatePropertiesFlag&&this.validateProperties(),this.invalidateSizeFlag&&this.validateSize(),this.invalidateDisplayListFlag&&this.validateDisplayList(),this.invalidatePropertiesFlag||this.invalidateSizeFlag||this.invalidateDisplayListFlag?this.attachListeners():this.listenersAttached=!1},e.prototype.validateClient=function(t){var e,i=!1,r=this.targetLevel;this.targetLevel===Number.POSITIVE_INFINITY&&(this.targetLevel=t.$nestLevel);for(var n=this.invalidatePropertiesQueue,o=this.invalidateSizeQueue,a=this.invalidateDisplayListQueue;!i;){for(i=!0,e=n.removeSmallestChild(t);e;)e.$stage&&e.validateProperties(),e=n.removeSmallestChild(t);for(n.isEmpty()&&(this.invalidatePropertiesFlag=!1),this.invalidateClientPropertiesFlag=!1,e=o.removeLargestChild(t);e;){if(e.$stage&&e.validateSize(),this.invalidateClientPropertiesFlag&&(e=n.removeSmallestChild(t))){n.insert(e),i=!1;break}e=o.removeLargestChild(t)}for(o.isEmpty()&&(this.invalidateSizeFlag=!1),this.invalidateClientPropertiesFlag=!1,this.invalidateClientSizeFlag=!1,e=a.removeSmallestChild(t);e;){if(e.$stage&&e.validateDisplayList(),this.invalidateClientPropertiesFlag&&(e=n.removeSmallestChild(t))){n.insert(e),i=!1;break}if(this.invalidateClientSizeFlag&&(e=o.removeLargestChild(t))){o.insert(e),i=!1;break}e=a.removeSmallestChild(t)}a.isEmpty()&&(this.invalidateDisplayListFlag=!1)}r===Number.POSITIVE_INFINITY&&(this.targetLevel=Number.POSITIVE_INFINITY)},e}(egret.EventDispatcher);t.Validator=e,__reflect(e.prototype,"eui.sys.Validator");var i=function(){function t(){this.depthBins={},this.minDepth=0,this.maxDepth=-1}return t.prototype.insert=function(t){var e=t.$nestLevel;this.maxDepth<this.minDepth?this.minDepth=this.maxDepth=e:(e<this.minDepth&&(this.minDepth=e),e>this.maxDepth&&(this.maxDepth=e));var i=this.depthBins[e];i||(i=this.depthBins[e]=new r),i.insert(t)},t.prototype.pop=function(){var t,e=this.minDepth;if(e<=this.maxDepth){for(var i=this.depthBins[this.maxDepth];!i||0===i.length;){if(this.maxDepth--,this.maxDepth<e)return null;i=this.depthBins[this.maxDepth]}for(t=i.pop();!(i&&0!=i.length||(this.maxDepth--,this.maxDepth<e));)i=this.depthBins[this.maxDepth]}return t},t.prototype.shift=function(){var t,e=this.maxDepth;if(this.minDepth<=e){for(var i=this.depthBins[this.minDepth];!i||0===i.length;){if(this.minDepth++,this.minDepth>e)return null;i=this.depthBins[this.minDepth]}for(t=i.pop();!(i&&0!=i.length||(this.minDepth++,this.minDepth>e));)i=this.depthBins[this.minDepth]}return t},t.prototype.removeLargestChild=function(t){for(var e=t.$hashCode,i=t.$nestLevel,r=this.maxDepth,n=i;r>=n;){var o=this.depthBins[r];if(o&&o.length>0){if(r===i){if(o.map[e])return o.remove(t),t}else{if(!egret.is(t,"egret.DisplayObjectContainer"))break;for(var a=o.items,s=o.length,l=0;s>l;l++){var h=a[l];if(t.contains(h))return o.remove(h),h}}r--}else if(r==this.maxDepth&&this.maxDepth--,r--,n>r)break}return null},t.prototype.removeSmallestChild=function(t){for(var e=t.$nestLevel,i=e,r=this.maxDepth,n=t.$hashCode;r>=i;){var o=this.depthBins[i];if(o&&o.length>0){if(i===e){if(o.map[n])return o.remove(t),t}else{if(!egret.is(t,"egret.DisplayObjectContainer"))break;for(var a=o.items,s=o.length,l=0;s>l;l++){var h=a[l];if(t.contains(h))return o.remove(h),h}}i++}else if(i==this.minDepth&&this.minDepth++,i++,i>r)break}return null},t.prototype.isEmpty=function(){return this.minDepth>this.maxDepth},t}();__reflect(i.prototype,"DepthQueue");var r=function(){function t(){this.map={},this.items=[],this.length=0}return t.prototype.insert=function(t){var e=t.$hashCode;this.map[e]||(this.map[e]=!0,this.length++,this.items.push(t))},t.prototype.pop=function(){var t=this.items.pop();return t&&(this.length--,0===this.length?this.map={}:this.map[t.$hashCode]=!1),t},t.prototype.remove=function(t){var e=this.items.indexOf(t);e>=0&&(this.items.splice(e,1),this.length--,0===this.length?this.map={}:this.map[t.$hashCode]=!1)},t}();__reflect(r.prototype,"DepthBin")}(e=t.sys||(t.sys={}))}(eui||(eui={}));var eui;!function(t){function e(t,e,i,r){t||egret.$error(1003,"classDefinition"),t.prototype||egret.$error(1012,"classDefinition"),e||egret.$error(1003,"property"),i||egret.$error(1003,"type");var n=t.prototype;n.__meta__=n.__meta__||{},n.__meta__[e]=i,r&&(n.__defaultProperty__=e)}t.registerProperty=e}(eui||(eui={}));var eui;!function(t){var e;!function(e){function i(t){return 1===t.a&&0===t.b&&0===t.c&&1===t.d}function r(t,e){if("function"!=typeof t[e])return!1;var i=t[e].toString(),r=i.indexOf("{"),n=i.lastIndexOf("}");return i=i.substring(r+1,n),""==i.trim()}function n(t,e){for(var i in e)"prototype"!=i&&e.hasOwnProperty(i)&&(t[i]=e[i]);for(var n=t.prototype,o=e.prototype,a=Object.keys(o),s=a.length,l=0;s>l;l++){var h=a[l];if("__meta__"!=h&&(!n.hasOwnProperty(h)||r(n,h))){var u=Object.getOwnPropertyDescriptor(o,h);Object.defineProperty(n,h,u)}}}function o(e,i,r){n(e,l);var o=e.prototype;o.$super=i.prototype,t.registerProperty(e,"left","Percentage"),t.registerProperty(e,"right","Percentage"),t.registerProperty(e,"top","Percentage"),t.registerProperty(e,"bottom","Percentage"),t.registerProperty(e,"horizontalCenter","Percentage"),t.registerProperty(e,"verticalCenter","Percentage"),r&&(o.$childAdded=function(){this.invalidateSize(),this.invalidateDisplayList()},o.$childRemoved=function(){this.invalidateSize(),this.invalidateDisplayList()}),egret.$markReadOnly(e,"explicitWidth"),egret.$markReadOnly(e,"explicitHeight"),Object.defineProperty(o,"preferredWidth",{get:function(){var t=egret.$TempRectangle;return this.getPreferredBounds(t),t.width},enumerable:!0,configurable:!0}),Object.defineProperty(o,"preferredHeight",{get:function(){var t=egret.$TempRectangle;return this.getPreferredBounds(t),t.height},enumerable:!0,configurable:!0}),Object.defineProperty(o,"preferredX",{get:function(){var t=egret.$TempRectangle;return this.getPreferredBounds(t),t.x},enumerable:!0,configurable:!0}),Object.defineProperty(o,"preferredY",{get:function(){var t=egret.$TempRectangle;return this.getPreferredBounds(t),t.y},enumerable:!0,configurable:!0}),Object.defineProperty(o,"layoutBoundsX",{get:function(){var t=egret.$TempRectangle;return this.getLayoutBounds(t),t.x},enumerable:!0,configurable:!0}),Object.defineProperty(o,"layoutBoundsY",{get:function(){var t=egret.$TempRectangle;return this.getLayoutBounds(t),t.y},enumerable:!0,configurable:!0}),Object.defineProperty(o,"layoutBoundsWidth",{get:function(){var t=egret.$TempRectangle;return this.getLayoutBounds(t),t.width},enumerable:!0,configurable:!0}),Object.defineProperty(o,"layoutBoundsHeight",{get:function(){var t=egret.$TempRectangle;return this.getLayoutBounds(t),t.height},enumerable:!0,configurable:!0}),Object.defineProperty(o,"measuredWidth",{get:function(){return this.$UIComponent[16]},enumerable:!0,configurable:!0}),Object.defineProperty(o,"measuredHeight",{get:function(){return this.$UIComponent[17]},enumerable:!0,configurable:!0}),Object.defineProperty(o,"layoutWidthExplicitlySet",{get:function(){return this.$UIComponent[27]},enumerable:!0,configurable:!0}),Object.defineProperty(o,"layoutHeightExplicitlySet",{get:function(){return this.$UIComponent[28]},enumerable:!0,configurable:!0}),Object.defineProperty(o,"invalidatePropertiesFlag",{get:function(){return this.$UIComponent[24]},enumerable:!0,configurable:!0}),Object.defineProperty(o,"invalidateSizeFlag",{get:function(){return this.$UIComponent[25]},enumerable:!0,configurable:!0}),Object.defineProperty(o,"invalidateDisplayListFlag",{get:function(){return this.$UIComponent[26]},enumerable:!0,configurable:!0})}var a="eui.UIComponent",s=new e.Validator,l=function(r){function n(){var t=r.call(this)||this;return t.initializeUIValues(),t}return __extends(n,r),n.prototype.initializeUIValues=function(){this.$UIComponent={0:0/0,1:0/0,2:0/0,3:0/0,4:0/0,5:0/0,6:0/0,7:0/0,8:0/0,9:0/0,10:0,11:0,12:0,13:1e5,14:0,15:1e5,16:0,17:0,18:0/0,19:0/0,20:0,21:0,22:0,23:0,24:!0,25:!0,26:!0,27:!1,28:!1,29:!1},this.$includeInLayout=!0,this.$touchEnabled=!0},n.prototype.createChildren=function(){},n.prototype.childrenCreated=function(){},n.prototype.commitProperties=function(){var e=this.$UIComponent;(e[22]!=e[10]||e[23]!=e[11])&&(this.dispatchEventWith(egret.Event.RESIZE),e[22]=e[10],e[23]=e[11]),(e[20]!=this.$getX()||e[21]!=this.$getY())&&(t.UIEvent.dispatchUIEvent(this,t.UIEvent.MOVE),e[20]=this.$getX(),e[21]=this.$getY())},n.prototype.measure=function(){},n.prototype.updateDisplayList=function(){},Object.defineProperty(n.prototype,"includeInLayout",{get:function(){return this.$includeInLayout},set:function(t){t=!!t,this.$includeInLayout!==t&&(this.$includeInLayout=!0,this.invalidateParentLayout(),this.$includeInLayout=t)},enumerable:!0,configurable:!0}),n.prototype.$onAddToStage=function(e,i){this.$super.$onAddToStage.call(this,e,i),this.checkInvalidateFlag();var r=this.$UIComponent;r[29]||(r[29]=!0,this.createChildren(),this.childrenCreated(),t.UIEvent.dispatchUIEvent(this,t.UIEvent.CREATION_COMPLETE))},n.prototype.checkInvalidateFlag=function(){var t=this.$UIComponent;t[24]&&s.invalidateProperties(this),t[25]&&s.invalidateSize(this),t[26]&&s.invalidateDisplayList(this)},Object.defineProperty(n.prototype,"left",{get:function(){return this.$UIComponent[0]},set:function(t){t=t&&"number"!=typeof t?t.toString().trim():+t;var e=this.$UIComponent;e[0]!==t&&(e[0]=t,this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"right",{get:function(){return this.$UIComponent[1]},set:function(t){t=t&&"number"!=typeof t?t.toString().trim():+t;var e=this.$UIComponent;e[1]!==t&&(e[1]=t,this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.$UIComponent[2]},set:function(t){t=t&&"number"!=typeof t?t.toString().trim():+t;var e=this.$UIComponent;e[2]!==t&&(e[2]=t,this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottom",{get:function(){return this.$UIComponent[3]},set:function(t){t=t&&"number"!=typeof t?t.toString().trim():+t;var e=this.$UIComponent;e[3]!=t&&(e[3]=t,this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"horizontalCenter",{get:function(){return this.$UIComponent[4]},set:function(t){t=t&&"number"!=typeof t?t.toString().trim():+t;var e=this.$UIComponent;e[4]!==t&&(e[4]=t,this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"verticalCenter",{get:function(){return this.$UIComponent[5]},set:function(t){t=t&&"number"!=typeof t?t.toString().trim():+t;var e=this.$UIComponent;e[5]!==t&&(e[5]=t,this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"percentWidth",{get:function(){return this.$UIComponent[6]},set:function(t){t=+t;var e=this.$UIComponent;e[6]!==t&&(e[6]=t,this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"percentHeight",{get:function(){return this.$UIComponent[7]},set:function(t){t=+t;var e=this.$UIComponent;e[7]!==t&&(e[7]=t,this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"explicitWidth",{get:function(){return this.$UIComponent[8]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"explicitHeight",{get:function(){return this.$UIComponent[9]},enumerable:!0,configurable:!0}),n.prototype.$getWidth=function(){return this.validateSizeNow(),this.$UIComponent[10]},n.prototype.$setWidth=function(t){t=+t;var e=this.$UIComponent;return 0>t||e[10]===t&&e[8]===t?!1:(e[8]=t,isNaN(t)&&this.invalidateSize(),this.invalidateProperties(),this.invalidateDisplayList(),this.invalidateParentLayout(),!0)},n.prototype.validateSizeNow=function(){this.validateSize(!0),this.updateFinalSize()},n.prototype.$getHeight=function(){return this.validateSizeNow(),this.$UIComponent[11]},n.prototype.$setHeight=function(t){t=+t;var e=this.$UIComponent;return 0>t||e[11]===t&&e[9]===t?!1:(e[9]=t,isNaN(t)&&this.invalidateSize(),this.invalidateProperties(),this.invalidateDisplayList(),this.invalidateParentLayout(),!0)},Object.defineProperty(n.prototype,"minWidth",{get:function(){return this.$UIComponent[12]},set:function(t){t=+t||0;var e=this.$UIComponent;0>t||e[12]===t||(e[12]=t,this.invalidateSize(),this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxWidth",{get:function(){return this.$UIComponent[13]},set:function(t){t=+t||0;var e=this.$UIComponent;0>t||e[13]===t||(e[13]=t,this.invalidateSize(),this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"minHeight",{get:function(){return this.$UIComponent[14]},set:function(t){t=+t||0;var e=this.$UIComponent;0>t||e[14]===t||(e[14]=t,this.invalidateSize(),this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxHeight",{get:function(){return this.$UIComponent[15]},set:function(t){t=+t||0;var e=this.$UIComponent;0>t||e[15]===t||(e[15]=t,this.invalidateSize(),this.invalidateParentLayout())},enumerable:!0,configurable:!0}),n.prototype.setMeasuredSize=function(t,e){var i=this.$UIComponent;i[16]=Math.ceil(+t||0),i[17]=Math.ceil(+e||0)},n.prototype.setActualSize=function(t,e){var i=!1,r=this.$UIComponent;r[10]!==t&&(r[10]=t,i=!0),r[11]!==e&&(r[11]=e,i=!0),i&&(this.invalidateDisplayList(),this.dispatchEventWith(egret.Event.RESIZE))},n.prototype.$invalidateMatrix=function(){this.$super.$invalidateMatrix.call(this),this.invalidateParentLayout()},n.prototype.$setMatrix=function(t,e){return void 0===e&&(e=!0),this.$super.$setMatrix.call(this,t,e),this.invalidateParentLayout(),!0},n.prototype.$setAnchorOffsetX=function(t){return this.$super.$setAnchorOffsetX.call(this,t),this.invalidateParentLayout(),!0},n.prototype.$setAnchorOffsetY=function(t){return this.$super.$setAnchorOffsetY.call(this,t),this.invalidateParentLayout(),!0},n.prototype.$setX=function(t){var e=this.$super.$setX.call(this,t);return e&&(this.invalidateParentLayout(),this.invalidateProperties()),e},n.prototype.$setY=function(t){var e=this.$super.$setY.call(this,t);return e&&(this.invalidateParentLayout(),this.invalidateProperties()),e},n.prototype.invalidateProperties=function(){var t=this.$UIComponent;t[24]||(t[24]=!0,this.$stage&&s.invalidateProperties(this))},n.prototype.validateProperties=function(){var t=this.$UIComponent;t[24]&&(this.commitProperties(),t[24]=!1)},n.prototype.invalidateSize=function(){var t=this.$UIComponent;t[25]||(t[25]=!0,this.$stage&&s.invalidateSize(this))},n.prototype.validateSize=function(t){if(t){var e=this.$children;if(e)for(var i=e.length,r=0;i>r;r++){var n=e[r];egret.is(n,a)&&n.validateSize(!0)}}var o=this.$UIComponent;if(o[25]){var s=this.measureSizes();s&&(this.invalidateDisplayList(),this.invalidateParentLayout()),o[25]=!1}},n.prototype.measureSizes=function(){var t=!1,e=this.$UIComponent;if(!e[25])return t;(isNaN(e[8])||isNaN(e[9]))&&(this.measure(),e[16]<e[12]&&(e[16]=e[12]),e[16]>e[13]&&(e[16]=e[13]),e[17]<e[14]&&(e[17]=e[14]),e[17]>e[15]&&(e[17]=e[15]));var i=this.getPreferredUWidth(),r=this.getPreferredUHeight();return(i!==e[18]||r!==e[19])&&(e[18]=i,e[19]=r,t=!0),t},n.prototype.invalidateDisplayList=function(){var t=this.$UIComponent;t[26]||(t[26]=!0,this.$stage&&s.invalidateDisplayList(this))},n.prototype.validateDisplayList=function(){var t=this.$UIComponent;t[26]&&(this.updateFinalSize(),this.updateDisplayList(t[10],t[11]),t[26]=!1)},n.prototype.updateFinalSize=function(){var t=0,e=0,i=this.$UIComponent;t=i[27]?i[10]:isNaN(i[8])?i[16]:i[8],e=i[28]?i[11]:isNaN(i[9])?i[17]:i[9],this.setActualSize(t,e)},n.prototype.validateNow=function(){this.$stage&&s.validateClient(this)},n.prototype.invalidateParentLayout=function(){var t=this.$parent;t&&this.$includeInLayout&&egret.is(t,a)&&(t.invalidateSize(),t.invalidateDisplayList())},n.prototype.setLayoutBoundsSize=function(t,r){if(r=+r,t=+t,!(0>r||0>t)){var n,o,a=this.$UIComponent,s=a[13],l=a[15],h=Math.min(a[12],s),u=Math.min(a[14],l);isNaN(t)?(a[27]=!1,n=this.getPreferredUWidth()):(a[27]=!0,n=Math.max(h,Math.min(s,t))),isNaN(r)?(a[28]=!1,o=this.getPreferredUHeight()):(a[28]=!0,o=Math.max(u,Math.min(l,r)));var c=this.getAnchorMatrix();if(i(c))return void this.setActualSize(n,o);var p=e.MatrixUtil.fitBounds(t,r,c,a[8],a[9],this.getPreferredUWidth(),this.getPreferredUHeight(),h,u,s,l);p||(p=egret.Point.create(h,u)),this.setActualSize(p.x,p.y),egret.Point.release(p)}},n.prototype.setLayoutBoundsPosition=function(e,r){var n=this.$getMatrix();if(!i(n)||0!=this.anchorOffsetX||0!=this.anchorOffsetY){var o=egret.$TempRectangle;this.getLayoutBounds(o),e+=this.$getX()-o.x,r+=this.$getY()-o.y}var a=this.$super.$setX.call(this,e);(this.$super.$setY.call(this,r)||a)&&t.UIEvent.dispatchUIEvent(this,t.UIEvent.MOVE)},n.prototype.getLayoutBounds=function(t){var e,i=this.$UIComponent;e=i[27]?i[10]:isNaN(i[8])?i[16]:i[8];var r;r=i[28]?i[11]:isNaN(i[9])?i[17]:i[9],this.applyMatrix(t,e,r)},n.prototype.getPreferredUWidth=function(){var t=this.$UIComponent;return isNaN(t[8])?t[16]:t[8]},n.prototype.getPreferredUHeight=function(){var t=this.$UIComponent;return isNaN(t[9])?t[17]:t[9]},n.prototype.getPreferredBounds=function(t){var e=this.getPreferredUWidth(),i=this.getPreferredUHeight();this.applyMatrix(t,e,i)},n.prototype.applyMatrix=function(t,e,r){t.setTo(0,0,e,r);var n=this.getAnchorMatrix();i(n)?(t.x+=n.tx,t.y+=n.ty):n.$transformBounds(t)},n.prototype.getAnchorMatrix=function(){var t=this.$getMatrix(),e=this.anchorOffsetX,i=this.anchorOffsetY;if(0!=e||0!=i){var r=egret.$TempMatrix;return t.$preMultiplyInto(r.setTo(1,0,0,1,-e,-i),r),r}return t},n}(egret.DisplayObject);e.UIComponentImpl=l,__reflect(l.prototype,"eui.sys.UIComponentImpl",["eui.UIComponent"]),e.mixin=n,e.implementUIComponent=o}(e=t.sys||(t.sys={}))}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(t,i){void 0===i&&(i=[]);var r=e.call(this)||this;return r.name=t,r.overrides=i,r}return __extends(i,e),i.prototype.initialize=function(e,i){for(var r=this.overrides,n=r.length,o=0;n>o;o++){var a=r[o];if(a instanceof t.AddItems){var s=e[a.target];s&&s instanceof t.Image&&!s.$parent&&(i.addChild(s),i.removeChild(s))}}},i}(egret.HashObject);t.State=e,__reflect(e.prototype,"eui.State")}(eui||(eui={})),function(t){var e;!function(t){var e=function(){function t(){}return Object.defineProperty(t.prototype,"states",{get:function(){return this.$stateValues.states},set:function(t){t||(t=[]);var e=this.$stateValues;e.states=t;for(var i={},r=t.length,n=0;r>n;n++){var o=t[n];i[o.name]=o}e.statesMap=i,e.parent&&this.commitCurrentState()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentState",{get:function(){return this.$stateValues.currentState},set:function(t){var e=this.$stateValues;e.explicitState=t,e.currentState=t,this.commitCurrentState()},enumerable:!0,configurable:!0}),t.prototype.commitCurrentState=function(){var t=this.$stateValues;if(t.parent){var e=t.statesMap[t.currentState];if(!e){if(!(t.states.length>0))return;t.currentState=t.states[0].name}if(t.oldState!=t.currentState){var i=t.parent,r=t.statesMap[t.oldState];if(r)for(var n=r.overrides,o=n.length,a=0;o>a;a++)n[a].remove(this,i);if(t.oldState=t.currentState,r=t.statesMap[t.currentState])for(var n=r.overrides,s=n.length,a=0;s>a;a++)n[a].apply(this,i)}}},t.prototype.hasState=function(t){return!!this.$stateValues.statesMap[t]},t.prototype.initializeStates=function(t){this.$stateValues.intialized=!0;for(var e=this.states,i=e.length,r=0;i>r;r++)e[r].initialize(this,t)},t}();t.StateClient=e,__reflect(e.prototype,"eui.sys.StateClient");var i=function(){function t(){this.intialized=!1,this.statesMap={},this.states=[],this.oldState=null,this.explicitState=null,this.currentState=null,this.parent=null,this.stateIsDirty=!1}return t}();t.StateValues=i,__reflect(i.prototype,"eui.sys.StateValues")}(e=t.sys||(t.sys={}))}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.initializeUIValues(),t.$Component={0:null,1:null,2:"",3:!0,4:!1,5:!1,6:!0,7:!0,8:null},t.$touchEnabled=!0,t}return __extends(i,e),Object.defineProperty(i.prototype,"hostComponentKey",{get:function(){return this.$Component[0]},set:function(t){this.$Component[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"skinName",{get:function(){return this.$Component[1]},set:function(t){var e=this.$Component;if(e[5]=!0,e[1]!=t){if(t)e[1]=t;else{var i=egret.getImplementation("eui.Theme");if(i){var r=i.getSkinName(this);r&&(e[1]=r)}}this.$parseSkinName()}},enumerable:!0,configurable:!0}),i.prototype.$parseSkinName=function(){var t,e=this.skinName;if(e)if(e.prototype)t=new e;else if("string"==typeof e){var i=void 0,r=e.trim();if("<"==r.charAt(0))i=EXML.parse(r);else if(i=egret.getDefinitionByName(e),!i&&-1!=r.toLowerCase().indexOf(".exml"))return void EXML.load(e,this.onExmlLoaded,this,!0);i&&(t=new i)}else t=e;this.setSkin(t)},i.prototype.onExmlLoaded=function(t,e){if(this.skinName==e){var i=new t;this.setSkin(i)}},Object.defineProperty(i.prototype,"skin",{get:function(){return this.$Component[8]},enumerable:!0,configurable:!0}),i.prototype.setSkin=function(e){!e||e instanceof t.Skin||(e=null,egret.$error(2202));var i=this.$Component,r=i[8];if(r){for(var n=r.skinParts,o=n.length,a=0;o>a;a++){var s=n[a];this[s]&&this.setSkinPart(s,null)}var l=r.$elementsContent;if(l){o=l.length;for(var a=0;o>a;a++){var h=l[a];h.$parent==this&&this.removeChild(h)}}r.hostComponent=null}if(i[8]=e,e){for(var n=e.skinParts,u=n.length,a=0;u>a;a++){var s=n[a],c=e[s];c&&this.setSkinPart(s,c)}var l=e.$elementsContent;if(l)for(var a=l.length-1;a>=0;a--)this.addChildAt(l[a],0);e.hostComponent=this}this.invalidateSize(),this.invalidateDisplayList(),this.dispatchEventWith(egret.Event.COMPLETE)},i.prototype.setSkinPart=function(t,e){var i=this[t];i&&this.partRemoved(t,i),this[t]=e,e&&this.partAdded(t,e)},i.prototype.partAdded=function(){},i.prototype.partRemoved=function(){},i.prototype.$setTouchChildren=function(t){t=!!t;var i=this.$Component;return i[6]=t,i[3]?(i[6]=t,e.prototype.$setTouchChildren.call(this,t)):!0},i.prototype.$setTouchEnabled=function(t){t=!!t;var i=this.$Component;return i[7]=t,i[3]?e.prototype.$setTouchEnabled.call(this,t):!0},Object.defineProperty(i.prototype,"enabled",{get:function(){return this.$Component[3]},set:function(t){t=!!t,this.$setEnabled(t)},enumerable:!0,configurable:!0}),i.prototype.$setEnabled=function(t){var e=this.$Component;return t===e[3]?!1:(e[3]=t,t?(this.$touchEnabled=e[7],this.$touchChildren=e[6]):(this.$touchEnabled=!1,this.$touchChildren=!1),this.invalidateState(),!0)},Object.defineProperty(i.prototype,"currentState",{get:function(){var t=this.$Component;return t[2]?t[2]:this.getCurrentState()},set:function(t){var e=this.$Component;t!=e[2]&&(e[2]=t,this.invalidateState())},enumerable:!0,configurable:!0}),i.prototype.invalidateState=function(){var t=this.$Component;t[4]||(t[4]=!0,this.invalidateProperties())},i.prototype.getCurrentState=function(){return""},i.prototype.createChildren=function(){var t=this.$Component;if(!t[1]){var e=egret.getImplementation("eui.Theme");if(e){var i=e.getSkinName(this);i&&(t[1]=i,this.$parseSkinName())}}},i.prototype.childrenCreated=function(){},i.prototype.commitProperties=function(){t.sys.UIComponentImpl.prototype.commitProperties.call(this);var e=this.$Component;e[4]&&(e[4]=!1,e[8]&&(e[8].currentState=this.currentState))},i.prototype.measure=function(){t.sys.measure(this);var e=this.$Component[8];if(e){var i=this.$UIComponent;isNaN(e.width)?(i[16]<e.minWidth&&(i[16]=e.minWidth),i[16]>e.maxWidth&&(i[16]=e.maxWidth)):i[16]=e.width,isNaN(e.height)?(i[17]<e.minHeight&&(i[17]=e.minHeight),i[17]>e.maxHeight&&(i[17]=e.maxHeight)):i[17]=e.height}},i.prototype.updateDisplayList=function(e,i){t.sys.updateDisplayList(this,e,i)},i.prototype.invalidateParentLayout=function(){},i.prototype.setMeasuredSize=function(){},i.prototype.invalidateProperties=function(){},i.prototype.validateProperties=function(){},i.prototype.invalidateSize=function(){},i.prototype.validateSize=function(){},i.prototype.invalidateDisplayList=function(){},i.prototype.validateDisplayList=function(){},i.prototype.validateNow=function(){},i.prototype.setLayoutBoundsSize=function(){},i.prototype.setLayoutBoundsPosition=function(){},i.prototype.getLayoutBounds=function(){},i.prototype.getPreferredBounds=function(){},i}(egret.DisplayObjectContainer);t.Component=e,__reflect(e.prototype,"eui.Component",["eui.UIComponent"]),t.registerProperty(e,"skinName","Class"),t.sys.implementUIComponent(e,egret.DisplayObjectContainer,!0),egret.$markReadOnly(e,"skin")}(eui||(eui={}));var eui;!function(t){function e(t,e){if(t||egret.$error(1003,"instance"),e||egret.$error(1003,"property"),t.hasOwnProperty(i))t[i].push(e);else{var r=[e];t[i]&&(r=t[i].concat(r)),t[i]=r}}var i="__bindables__";t.registerBindable=e}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.$layout=null,i.$stateValues=new t.sys.StateValues,i.initializeUIValues(),i.$Group={0:0,1:0,2:0,3:0,4:!1,5:!1},i.$stateValues.parent=i,i}return __extends(i,e),Object.defineProperty(i.prototype,"elementsContent",{set:function(t){if(t)for(var e=t.length,i=0;e>i;i++)this.addChild(t[i])
},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"layout",{get:function(){return this.$layout},set:function(t){this.$setLayout(t)},enumerable:!0,configurable:!0}),i.prototype.$setLayout=function(t){return this.$layout==t?!1:(this.$layout&&(this.$layout.target=null),this.$layout=t,t&&(t.target=this),this.invalidateSize(),this.invalidateDisplayList(),!0)},Object.defineProperty(i.prototype,"contentWidth",{get:function(){return this.$Group[0]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"contentHeight",{get:function(){return this.$Group[1]},enumerable:!0,configurable:!0}),i.prototype.setContentSize=function(e,i){e=Math.ceil(+e||0),i=Math.ceil(+i||0);var r=this.$Group,n=r[0]!==e,o=r[1]!==i;(n||o)&&(r[0]=e,r[1]=i,n&&t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"contentWidth"),o&&t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"contentHeight"))},Object.defineProperty(i.prototype,"scrollEnabled",{get:function(){return this.$Group[4]},set:function(t){t=!!t;var e=this.$Group;t!==e[4]&&(e[4]=t,this.updateScrollRect())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scrollH",{get:function(){return this.$Group[2]},set:function(e){e=+e||0;var i=this.$Group;e!==i[2]&&(i[2]=e,this.updateScrollRect()&&this.$layout&&this.$layout.scrollPositionChanged(),t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"scrollH"))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scrollV",{get:function(){return this.$Group[3]},set:function(e){e=+e||0;var i=this.$Group;e!=i[3]&&(i[3]=e,this.updateScrollRect()&&this.$layout&&this.$layout.scrollPositionChanged(),t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"scrollV"))},enumerable:!0,configurable:!0}),i.prototype.updateScrollRect=function(){var t=this.$Group,e=t[4];if(e){var i=this.$UIComponent;this.scrollRect=egret.$TempRectangle.setTo(t[2],t[3],i[10],i[11])}else this.$scrollRect&&(this.scrollRect=null);return e},Object.defineProperty(i.prototype,"numElements",{get:function(){return this.$children.length},enumerable:!0,configurable:!0}),i.prototype.getElementAt=function(t){return this.$children[t]},i.prototype.getVirtualElementAt=function(t){return this.getElementAt(t)},i.prototype.setVirtualElementIndicesInView=function(){},Object.defineProperty(i.prototype,"touchThrough",{get:function(){return this.$Group[5]},set:function(t){this.$Group[5]=!!t},enumerable:!0,configurable:!0}),i.prototype.$hitTest=function(t,i){var r=e.prototype.$hitTest.call(this,t,i);if(r||this.$Group[5])return r;if(!this.$visible||!this.touchEnabled)return null;var n=this.globalToLocal(t,i,egret.$TempPoint),o=this.$UIComponent,a=egret.$TempRectangle.setTo(0,0,o[10],o[11]),s=this.$scrollRect;return s&&(a.x=s.x,a.y=s.y),a.contains(n.x,n.y)?this:null},i.prototype.invalidateState=function(){var t=this.$stateValues;t.stateIsDirty||(t.stateIsDirty=!0,this.invalidateProperties())},i.prototype.getCurrentState=function(){return""},i.prototype.createChildren=function(){this.$layout||this.$setLayout(new t.BasicLayout),this.initializeStates(this.$stage)},i.prototype.childrenCreated=function(){},i.prototype.commitProperties=function(){t.sys.UIComponentImpl.prototype.commitProperties.call(this);var e=this.$stateValues;e.stateIsDirty&&(e.stateIsDirty=!1,e.explicitState||(e.currentState=this.getCurrentState(),this.commitCurrentState()))},i.prototype.measure=function(){return this.$layout?void this.$layout.measure():void this.setMeasuredSize(0,0)},i.prototype.updateDisplayList=function(t,e){this.$layout&&this.$layout.updateDisplayList(t,e),this.updateScrollRect()},i.prototype.invalidateParentLayout=function(){},i.prototype.setMeasuredSize=function(){},i.prototype.invalidateProperties=function(){},i.prototype.validateProperties=function(){},i.prototype.invalidateSize=function(){},i.prototype.validateSize=function(){},i.prototype.invalidateDisplayList=function(){},i.prototype.validateDisplayList=function(){},i.prototype.validateNow=function(){},i.prototype.setLayoutBoundsSize=function(){},i.prototype.setLayoutBoundsPosition=function(){},i.prototype.getLayoutBounds=function(){},i.prototype.getPreferredBounds=function(){},i}(egret.DisplayObjectContainer);t.Group=e,__reflect(e.prototype,"eui.Group",["eui.IViewport","eui.UIComponent"]),t.sys.implementUIComponent(e,egret.DisplayObjectContainer,!0),t.sys.mixin(e,t.sys.StateClient),t.registerProperty(e,"elementsContent","Array",!0),t.registerProperty(e,"states","State[]"),egret.$markReadOnly(e,"contentWidth"),egret.$markReadOnly(e,"contentHeight"),egret.$markReadOnly(e,"numElements")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.$target=null,e.$useVirtualLayout=!1,e.$typicalWidth=71,e.$typicalHeight=22,e}return __extends(e,t),Object.defineProperty(e.prototype,"target",{get:function(){return this.$target},set:function(t){this.$target!==t&&(this.$target=t,this.clearVirtualLayoutCache())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useVirtualLayout",{get:function(){return this.$useVirtualLayout},set:function(t){t=!!t,this.$useVirtualLayout!=t&&(this.$useVirtualLayout=t,this.dispatchEventWith("useVirtualLayoutChanged"),this.$useVirtualLayout&&!t&&this.clearVirtualLayoutCache(),this.target&&this.target.invalidateDisplayList())},enumerable:!0,configurable:!0}),e.prototype.setTypicalSize=function(t,e){t=+t||71,e=+e||22,(t!==this.$typicalWidth||e!==this.$typicalHeight)&&(this.$typicalWidth=t,this.$typicalHeight=e,this.$target&&this.$target.invalidateSize())},e.prototype.scrollPositionChanged=function(){},e.prototype.clearVirtualLayoutCache=function(){},e.prototype.elementAdded=function(){},e.prototype.elementRemoved=function(){},e.prototype.getElementIndicesInView=function(){return null},e.prototype.measure=function(){},e.prototype.updateDisplayList=function(){},e}(egret.EventDispatcher);t.LayoutBase=e,__reflect(e.prototype,"eui.LayoutBase")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.labelDisplay=null,e._label="",e.iconDisplay=null,e._icon=null,e.touchCaptured=!1,e.touchChildren=!1,e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.onTouchBegin,e),e}return __extends(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return this._label},set:function(t){this._label=t,this.labelDisplay&&(this.labelDisplay.text=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return this._icon},set:function(t){this._icon=t,this.iconDisplay&&(this.iconDisplay.source=t)},enumerable:!0,configurable:!0}),e.prototype.onTouchCancle=function(t){var e=t.$currentTarget;e.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),e.removeEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.touchCaptured=!1,this.invalidateState()},e.prototype.onTouchBegin=function(t){this.$stage.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),this.$stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.touchCaptured=!0,this.invalidateState(),t.updateAfterEvent()},e.prototype.onStageTouchEnd=function(t){var e=t.$currentTarget;e.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),e.removeEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.contains(t.target)&&this.buttonReleased(),this.touchCaptured=!1,this.invalidateState()},e.prototype.getCurrentState=function(){return this.enabled?this.touchCaptured?"down":"up":"disabled"},e.prototype.partAdded=function(t,e){e===this.labelDisplay?this.labelDisplay.text=this._label:e==this.iconDisplay&&(this.iconDisplay.source=this._icon)},e.prototype.buttonReleased=function(){},e}(t.Component);t.Button=e,__reflect(e.prototype,"eui.Button")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.$Range={0:100,1:!1,2:0,3:!1,4:0,5:0,6:!1,7:1,8:!1,9:!1},t}return __extends(i,e),Object.defineProperty(i.prototype,"maximum",{get:function(){return this.$Range[0]},set:function(t){t=+t||0;var e=this.$Range;t!==e[0]&&(e[0]=t,e[1]=!0,this.invalidateProperties(),this.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"minimum",{get:function(){return this.$Range[2]},set:function(t){t=+t||0;var e=this.$Range;t!==e[2]&&(e[2]=t,e[3]=!0,this.invalidateProperties(),this.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"value",{get:function(){var t=this.$Range;return t[6]?t[5]:t[4]},set:function(t){t=+t||0,this.$setValue(t)},enumerable:!0,configurable:!0}),i.prototype.$setValue=function(t){if(t===this.value)return!1;var e=this.$Range;return e[5]=t,e[6]=!0,this.invalidateProperties(),!0},Object.defineProperty(i.prototype,"snapInterval",{get:function(){return this.$Range[7]},set:function(t){var e=this.$Range;e[9]=!0,t=+t||0,t!==e[7]&&(isNaN(t)?(e[7]=1,e[9]=!1):e[7]=t,e[8]=!0,this.invalidateProperties())},enumerable:!0,configurable:!0}),i.prototype.commitProperties=function(){e.prototype.commitProperties.call(this);var t=this.$Range;if(t[2]>t[0]&&(t[1]?t[0]=t[2]:t[2]=t[0]),t[6]||t[1]||t[3]||t[8]){var i=t[6]?t[5]:t[4];t[6]=!1,t[1]=!1,t[3]=!1,t[8]=!1,this.setValue(this.nearestValidValue(i,t[7]))}},i.prototype.nearestValidSize=function(t){var e=this.snapInterval;if(0==e)return t;var i=Math.round(t/e)*e;return Math.abs(i)<e?e:i},i.prototype.nearestValidValue=function(t,e){var i=this.$Range;if(0==e)return Math.max(i[2],Math.min(i[0],t));var r=i[0]-i[2],n=1;if(t-=i[2],e!=Math.round(e)){var o=(1+e).toString().split(".");n=Math.pow(10,o[1].length),r*=n,t=Math.round(t*n),e=Math.round(e*n)}var a=Math.max(0,Math.floor(t/e)*e),s=Math.min(r,Math.floor((t+e)/e)*e),l=t-a>=(s-a)/2?s:a;return l/n+i[2]},i.prototype.setValue=function(e){var i=this.$Range;i[4]!==e&&(i[4]=i[0]>i[2]?Math.min(i[0],Math.max(i[2],e)):e,i[6]=!1,this.invalidateDisplayList(),t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"value"))},i.prototype.updateDisplayList=function(t,i){e.prototype.updateDisplayList.call(this,t,i),this.updateSkinDisplayList()},i.prototype.updateSkinDisplayList=function(){},i}(t.Component);t.Range=e,__reflect(e.prototype,"eui.Range"),t.registerBindable(e.prototype,"value")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.$dataProviderChanged=!1,t.$dataProvider=null,t.$indexToRenderer=[],t.$DataGroup={0:!0,1:!1,2:{},3:{},4:!1,5:!1,6:null,7:null,8:!1,9:null,10:!1,11:!1,12:null,13:null,14:!1},t}return __extends(i,e),Object.defineProperty(i.prototype,"useVirtualLayout",{get:function(){return this.$layout?this.$layout.$useVirtualLayout:this.$DataGroup[0]},set:function(t){t=!!t;var e=this.$DataGroup;t!==e[0]&&(e[0]=t,this.$layout&&(this.$layout.useVirtualLayout=t))},enumerable:!0,configurable:!0}),i.prototype.$setLayout=function(t){if(t==this.$layout)return!1;this.$layout&&(this.$layout.setTypicalSize(0,0),this.$layout.removeEventListener("useVirtualLayoutChanged",this.onUseVirtualLayoutChanged,this)),this.$layout&&t&&this.$layout.$useVirtualLayout!=t.$useVirtualLayout&&this.onUseVirtualLayoutChanged();var i=e.prototype.$setLayout.call(this,t);if(t){var r=this.$DataGroup[9];r&&t.setTypicalSize(r.width,r.height),t.useVirtualLayout=this.$DataGroup[0],t.addEventListener("useVirtualLayoutChanged",this.onUseVirtualLayoutChanged,this)}return i},i.prototype.onUseVirtualLayoutChanged=function(){var t=this.$DataGroup;t[1]=!0,t[10]=!0,this.removeDataProviderListener(),this.invalidateProperties()},i.prototype.setVirtualElementIndicesInView=function(t,e){if(this.$layout&&this.$layout.$useVirtualLayout)for(var i=this.$indexToRenderer,r=Object.keys(i),n=r.length,o=0;n>o;o++){var a=+r[o];(t>a||a>e)&&this.freeRendererByIndex(a)}},i.prototype.getElementAt=function(t){return this.$indexToRenderer[t]},i.prototype.getVirtualElementAt=function(t){if(t=0|+t,0>t||t>=this.$dataProvider.length)return null;var e=this.$indexToRenderer[t];if(!e){var i=this.$dataProvider.getItemAt(t);e=this.createVirtualRenderer(i),this.$indexToRenderer[t]=e,this.updateRenderer(e,t,i);var r=this.$DataGroup;r[4]&&(e.validateNow(),r[4]=!1,this.rendererAdded(e,t,i))}return e},i.prototype.freeRendererByIndex=function(t){var e=this.$indexToRenderer[t];e&&(delete this.$indexToRenderer[t],this.doFreeRenderer(e))},i.prototype.doFreeRenderer=function(t){var e=this.$DataGroup,i=e[2][t.$hashCode],r=i.$hashCode;e[3][r]||(e[3][r]=[]),e[3][r].push(t),t.visible=!1},i.prototype.invalidateSize=function(){this.$DataGroup[4]||e.prototype.invalidateSize.call(this)},i.prototype.createVirtualRenderer=function(t){var e,i=this.itemToRendererClass(t),r=i.$hashCode,n=this.$DataGroup,o=n[3];return o[r]&&o[r].length>0?(e=o[r].pop(),e.visible=!0,this.invalidateDisplayList(),e):(n[4]=!0,this.createOneRenderer(i))},i.prototype.createOneRenderer=function(t){var e=new t,i=this.$DataGroup;return i[2][e.$hashCode]=t,egret.is(e,"eui.IItemRenderer")?(i[13]&&this.setItemRenderSkinName(e,i[13]),this.addChild(e),e):null},i.prototype.setItemRenderSkinName=function(e,i){if(e&&e instanceof t.Component){var r=e;r.$Component[5]||(r.skinName=i,r.$Component[5]=!1)}},Object.defineProperty(i.prototype,"dataProvider",{get:function(){return this.$dataProvider},set:function(t){this.$setDataProvider(t)},enumerable:!0,configurable:!0}),i.prototype.$setDataProvider=function(t){return this.$dataProvider==t||t&&!t.getItemAt?!1:(this.removeDataProviderListener(),this.$dataProvider=t,this.$dataProviderChanged=!0,this.$DataGroup[10]=!0,this.invalidateProperties(),this.invalidateSize(),this.invalidateDisplayList(),!0)},i.prototype.removeDataProviderListener=function(){this.$dataProvider&&this.$dataProvider.removeEventListener(t.CollectionEvent.COLLECTION_CHANGE,this.onCollectionChange,this)},i.prototype.onCollectionChange=function(e){switch(e.kind){case t.CollectionEventKind.ADD:this.itemAddedHandler(e.items,e.location);break;case t.CollectionEventKind.REMOVE:this.itemRemovedHandler(e.items,e.location);break;case t.CollectionEventKind.UPDATE:case t.CollectionEventKind.REPLACE:this.itemUpdatedHandler(e.items[0],e.location);break;case t.CollectionEventKind.RESET:case t.CollectionEventKind.REFRESH:if(this.$layout&&this.$layout.$useVirtualLayout)for(var i=this.$indexToRenderer,r=Object.keys(i),n=r.length,o=n-1;o>=0;o--){var a=+r[o];this.freeRendererByIndex(a)}this.$dataProviderChanged=!0,this.invalidateProperties()}this.invalidateSize(),this.invalidateDisplayList()},i.prototype.itemAddedHandler=function(t,e){for(var i=t.length,r=0;i>r;r++)this.itemAdded(t[r],e+r);this.resetRenderersIndices()},i.prototype.itemRemovedHandler=function(t,e){for(var i=t.length,r=i-1;r>=0;r--)this.itemRemoved(t[r],e+r);this.resetRenderersIndices()},i.prototype.itemAdded=function(t,e){if(this.$layout&&this.$layout.elementAdded(e),this.$layout&&this.$layout.$useVirtualLayout)return void this.$indexToRenderer.splice(e,0,null);var i=this.createVirtualRenderer(t);if(this.$indexToRenderer.splice(e,0,i),i){this.updateRenderer(i,e,t);var r=this.$DataGroup;r[4]&&(r[4]=!1,this.rendererAdded(i,e,t))}},i.prototype.itemRemoved=function(t,e){this.$layout&&this.$layout.elementRemoved(e);var i=this.$indexToRenderer[e];this.$indexToRenderer.length>e&&this.$indexToRenderer.splice(e,1),i&&(this.$layout&&this.$layout.$useVirtualLayout?this.doFreeRenderer(i):(this.rendererRemoved(i,e,t),this.removeChild(i)))},i.prototype.resetRenderersIndices=function(){var t=this.$indexToRenderer;if(0!=t.length)if(this.$layout&&this.$layout.$useVirtualLayout)for(var e=Object.keys(t),i=e.length,r=0;i>r;r++){var n=+e[r];this.resetRendererItemIndex(n)}else for(var o=t.length,n=0;o>n;n++)this.resetRendererItemIndex(n)},i.prototype.itemUpdatedHandler=function(t,e){if(!this.$DataGroup[11]){var i=this.$indexToRenderer[e];i&&this.updateRenderer(i,e,t)}},i.prototype.resetRendererItemIndex=function(t){var e=this.$indexToRenderer[t];e&&(e.itemIndex=t)},Object.defineProperty(i.prototype,"itemRenderer",{get:function(){return this.$DataGroup[6]},set:function(t){var e=this.$DataGroup;e[6]!=t&&(e[6]=t,e[5]=!0,e[8]=!0,e[10]=!0,this.removeDataProviderListener(),this.invalidateProperties())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"itemRendererSkinName",{get:function(){return this.$DataGroup[13]},set:function(t){var e=this.$DataGroup;e[13]!=t&&(e[13]=t,this.$UIComponent[29]&&(e[14]=!0,this.invalidateProperties()))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"itemRendererFunction",{get:function(){return this.$DataGroup[7]},set:function(t){var e=this.$DataGroup;e[7]!=t&&(e[7]=t,e[5]=!0,e[8]=!0,this.removeDataProviderListener(),this.invalidateProperties())},enumerable:!0,configurable:!0}),i.prototype.itemToRendererClass=function(e){var i,r=this.$DataGroup;return r[7]&&(i=r[7](e)),i||(i=r[6]),i||(i=t.ItemRenderer),i.$hashCode||(i.$hashCode=egret.$hashCount++),i},i.prototype.createChildren=function(){if(!this.$layout){var i=new t.VerticalLayout;i.gap=0,i.horizontalAlign=t.JustifyAlign.CONTENT_JUSTIFY,this.$setLayout(i)}e.prototype.createChildren.call(this)},i.prototype.commitProperties=function(){var i=this.$DataGroup;if((i[5]||this.$dataProviderChanged||i[1])&&(this.removeAllRenderers(),this.$layout&&this.$layout.clearVirtualLayoutCache(),this.setTypicalLayoutRect(null),i[1]=!1,i[5]=!1,this.$dataProvider&&this.$dataProvider.addEventListener(t.CollectionEvent.COLLECTION_CHANGE,this.onCollectionChange,this),this.$layout&&this.$layout.$useVirtualLayout?(this.invalidateSize(),this.invalidateDisplayList()):this.createRenderers(),this.$dataProviderChanged&&(this.$dataProviderChanged=!1,this.scrollV=this.scrollH=0)),e.prototype.commitProperties.call(this),i[8]&&(i[8]=!1,this.$dataProvider&&this.$dataProvider.length>0&&(i[12]=this.$dataProvider.getItemAt(0),this.measureRendererSize())),i[14]){i[14]=!1;for(var r=i[13],n=this.$indexToRenderer,o=Object.keys(n),a=o.length,s=0;a>s;s++){var l=o[s];this.setItemRenderSkinName(n[l],r)}var h=i[3];o=Object.keys(h),a=o.length;for(var s=0;a>s;s++)for(var u=o[s],c=h[u],p=c.length,d=0;p>d;d++)this.setItemRenderSkinName(c[d],r)}},i.prototype.measure=function(){this.$layout&&this.$layout.$useVirtualLayout&&this.ensureTypicalLayoutElement(),e.prototype.measure.call(this)},i.prototype.updateDisplayList=function(t,i){var r=this.$layout&&this.$layout.$useVirtualLayout;r&&this.ensureTypicalLayoutElement(),e.prototype.updateDisplayList.call(this,t,i);var n=this.$DataGroup;if(r){var o=n[9];if(o){var a=this.$indexToRenderer[0];if(a){var s=egret.$TempRectangle;a.getPreferredBounds(s),(s.width!=o.width||s.height!=o.height)&&(n[9]=null)}}}},i.prototype.ensureTypicalLayoutElement=function(){this.$DataGroup[9]||this.$dataProvider&&this.$dataProvider.length>0&&(this.$DataGroup[12]=this.$dataProvider.getItemAt(0),this.measureRendererSize())},i.prototype.measureRendererSize=function(){var t=this.$DataGroup;if(!t[12])return void this.setTypicalLayoutRect(null);var e=this.createVirtualRenderer(t[12]);if(!e)return void this.setTypicalLayoutRect(null);this.updateRenderer(e,0,t[12]),e.validateNow();var i=egret.$TempRectangle;e.getPreferredBounds(i);var r=new egret.Rectangle(0,0,i.width,i.height);this.$layout&&this.$layout.$useVirtualLayout?(t[4]&&this.rendererAdded(e,0,t[12]),this.doFreeRenderer(e)):this.removeChild(e),this.setTypicalLayoutRect(r),t[4]=!1},i.prototype.setTypicalLayoutRect=function(t){this.$DataGroup[9]=t,this.$layout&&(t?this.$layout.setTypicalSize(t.width,t.height):this.$layout.setTypicalSize(0,0))},i.prototype.removeAllRenderers=function(){for(var t=this.$indexToRenderer,e=Object.keys(t),i=e.length,r=0;i>r;r++){var n=e[r],o=t[n];o&&(this.rendererRemoved(o,o.itemIndex,o.data),this.removeChild(o))}this.$indexToRenderer=[];var a=this.$DataGroup;if(a[10]){for(var s=a[3],l=Object.keys(s),h=l.length,r=0;h>r;r++)for(var u=l[r],c=s[u],p=c.length,d=0;p>d;d++){var o=c[d];this.rendererRemoved(o,o.itemIndex,o.data),this.removeChild(o)}a[3]={},a[2]={},a[10]=!1}},i.prototype.createRenderers=function(){if(this.$dataProvider)for(var t=0,e=this.$dataProvider.length,i=0;e>i;i++){var r=this.$dataProvider.getItemAt(i),n=this.itemToRendererClass(r),o=this.createOneRenderer(n);o&&(this.$indexToRenderer[t]=o,this.updateRenderer(o,t,r),this.rendererAdded(o,t,r),t++)}},i.prototype.updateRenderer=function(t,e,i){var r=this.$DataGroup;return r[11]=!0,t.itemIndex=e,t.data=i,r[11]=!1,t},Object.defineProperty(i.prototype,"numElements",{get:function(){return this.$dataProvider?this.$dataProvider.length:0},enumerable:!0,configurable:!0}),i.prototype.rendererAdded=function(){},i.prototype.rendererRemoved=function(){},i}(t.Group);t.DataGroup=e,__reflect(e.prototype,"eui.DataGroup"),t.registerProperty(e,"itemRenderer","Class"),t.registerProperty(e,"itemRendererSkinName","Class"),t.registerProperty(e,"dataProvider","eui.ICollection",!0),egret.$markReadOnly(e,"numElements")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.$ListBase={0:!1,1:!1,2:-2,3:-1,4:!1,5:void 0,6:!1,7:null,8:!1},t}return __extends(i,e),Object.defineProperty(i.prototype,"requireSelection",{get:function(){return this.$ListBase[0]},set:function(t){t=!!t;var e=this.$ListBase;t!==e[0]&&(e[0]=t,t&&(e[1]=!0,this.invalidateProperties()))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectedIndex",{get:function(){return this.$getSelectedIndex()},set:function(t){t=0|+t,this.setSelectedIndex(t,!1)},enumerable:!0,configurable:!0}),i.prototype.$getSelectedIndex=function(){var t=this.$ListBase;return t[2]!=i.NO_PROPOSED_SELECTION?t[2]:t[3]},i.prototype.setSelectedIndex=function(t,e){if(t!=this.selectedIndex){var i=this.$ListBase;e&&(i[4]=i[4]||e),i[2]=t,this.invalidateProperties()}},Object.defineProperty(i.prototype,"selectedItem",{get:function(){var t=this.$ListBase;if(void 0!==t[5])return t[5];var e=this.$getSelectedIndex();return e!=i.NO_SELECTION&&null!=this.$dataProvider&&this.$dataProvider.length>e?this.$dataProvider.getItemAt(e):void 0},set:function(t){this.setSelectedItem(t,!1)},enumerable:!0,configurable:!0}),i.prototype.setSelectedItem=function(t,e){if(void 0===e&&(e=!1),this.selectedItem!==t){var i=this.$ListBase;e&&(i[4]=i[4]||e),i[5]=t,this.invalidateProperties()}},i.prototype.commitProperties=function(){var r=this.$dataProviderChanged;e.prototype.commitProperties.call(this);var n=this.$ListBase,o=this.$getSelectedIndex(),a=this.$dataProvider;r&&(o>=0&&a&&o<a.length?this.itemSelected(o,!0):this.requireSelection?n[2]=0:this.setSelectedIndex(-1,!1)),n[1]&&(n[1]=!1,n[0]&&o==i.NO_SELECTION&&a&&a.length>0&&(n[2]=0)),void 0!==n[5]&&(n[2]=a?a.getItemIndex(n[5]):i.NO_SELECTION,n[5]=void 0);var s=!1;n[2]!=i.NO_PROPOSED_SELECTION&&(s=this.commitSelection()),n[6]&&(n[6]=!1,s||t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"selectedIndex"))},i.prototype.updateRenderer=function(t,i,r){return this.itemSelected(i,this.$isItemIndexSelected(i)),e.prototype.updateRenderer.call(this,t,i,r)},i.prototype.itemSelected=function(t,e){var i=this.$indexToRenderer[t];i&&(i.selected=e)},i.prototype.$isItemIndexSelected=function(t){return t==this.selectedIndex},i.prototype.commitSelection=function(e){void 0===e&&(e=!0);var r=this.$dataProvider,n=this.$ListBase,o=r?r.length-1:-1,a=n[3],s=n[2];if(s<i.NO_SELECTION&&(s=i.NO_SELECTION),s>o&&(s=o),n[0]&&s==i.NO_SELECTION&&r&&r.length>0)return n[2]=i.NO_PROPOSED_SELECTION,n[4]=!1,!1;if(n[4]){var l=this.dispatchEventWith(egret.Event.CHANGING,!1,!0,!0);if(!l)return this.itemSelected(n[2],!1),n[2]=i.NO_PROPOSED_SELECTION,n[4]=!1,!1}return n[3]=s,n[2]=i.NO_PROPOSED_SELECTION,a!=i.NO_SELECTION&&this.itemSelected(a,!1),n[3]!=i.NO_SELECTION&&this.itemSelected(n[3],!0),e&&(n[4]&&(this.dispatchEventWith(egret.Event.CHANGE),n[4]=!1),t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"selectedIndex"),t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"selectedItem")),!0},i.prototype.adjustSelection=function(t,e){void 0===e&&(e=!1);var r=this.$ListBase;r[2]!=i.NO_PROPOSED_SELECTION?r[2]=t:r[3]=t,r[6]=!0,this.invalidateProperties()},i.prototype.itemAdded=function(t,r){e.prototype.itemAdded.call(this,t,r);var n=this.$getSelectedIndex();n==i.NO_SELECTION?this.$ListBase[0]&&this.adjustSelection(r,!0):n>=r&&this.adjustSelection(n+1,!0)},i.prototype.itemRemoved=function(t,r){if(e.prototype.itemRemoved.call(this,t,r),this.selectedIndex!=i.NO_SELECTION){var n=this.$getSelectedIndex();r==n?this.requireSelection&&this.$dataProvider&&this.$dataProvider.length>0?0==r?(this.$ListBase[2]=0,this.invalidateProperties()):this.setSelectedIndex(0,!1):this.adjustSelection(-1,!1):n>r&&this.adjustSelection(n-1,!1)}},i.prototype.onCollectionChange=function(r){e.prototype.onCollectionChange.call(this,r),r.kind==t.CollectionEventKind.RESET?0==this.$dataProvider.length&&this.setSelectedIndex(i.NO_SELECTION,!1):r.kind==t.CollectionEventKind.REFRESH&&this.dataProviderRefreshed()},i.prototype.dataProviderRefreshed=function(){this.setSelectedIndex(i.NO_SELECTION,!1)},i.prototype.rendererAdded=function(t){t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onRendererTouchBegin,this),t.addEventListener(egret.TouchEvent.TOUCH_END,this.onRendererTouchEnd,this),t.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onRendererTouchCancle,this)},i.prototype.rendererRemoved=function(t){t.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onRendererTouchBegin,this),t.removeEventListener(egret.TouchEvent.TOUCH_END,this.onRendererTouchEnd,this),t.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onRendererTouchCancle,this)},i.prototype.onRendererTouchBegin=function(t){var e=this.$ListBase;t.$isDefaultPrevented||(e[8]=!1,e[7]=t.$currentTarget,this.$stage.addEventListener(egret.TouchEvent.TOUCH_END,this.stage_touchEndHandler,this))},i.prototype.onRendererTouchCancle=function(){var t=this.$ListBase;t[7]=null,t[8]=!0,this.$stage&&this.$stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.stage_touchEndHandler,this)},i.prototype.onRendererTouchEnd=function(e){var i=this.$ListBase,r=e.$currentTarget,n=i[7];r==n&&(i[8]||(this.setSelectedIndex(r.itemIndex,!0),t.ItemTapEvent.dispatchItemTapEvent(this,t.ItemTapEvent.ITEM_TAP,r)),i[8]=!1)},i.prototype.stage_touchEndHandler=function(t){var e=t.$currentTarget;e.removeEventListener(egret.TouchEvent.TOUCH_END,this.stage_touchEndHandler,this),this.$ListBase[7]=null},i}(t.DataGroup);e.NO_SELECTION=-1,e.NO_PROPOSED_SELECTION=-2,t.ListBase=e,__reflect(e.prototype,"eui.ListBase"),t.registerBindable(e.prototype,"selectedIndex"),t.registerBindable(e.prototype,"selectedItem")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=e.apply(this,arguments)||this;return t.$selected=!1,t.$autoSelected=!0,t}return __extends(i,e),Object.defineProperty(i.prototype,"selected",{get:function(){return this.$selected},set:function(t){this.$setSelected(t)},enumerable:!0,configurable:!0}),i.prototype.$setSelected=function(e){return e=!!e,e===this.$selected?!1:(this.$selected=e,this.invalidateState(),t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"selected"),!0)},i.prototype.getCurrentState=function(){var t=e.prototype.getCurrentState.call(this);if(this.$selected){var i=t+"AndSelected",r=this.skin;return r&&r.hasState(i)?i:"disabled"==t?"disabled":"down"}return t},i.prototype.buttonReleased=function(){this.$autoSelected&&(this.selected=!this.$selected,this.dispatchEventWith(egret.Event.CHANGE))},i}(t.Button);t.ToggleButton=e,__reflect(e.prototype,"eui.ToggleButton"),t.registerBindable(e.prototype,"selected")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.thumb=null,t.$viewport=null,t.autoVisibility=!0,t}return __extends(i,e),Object.defineProperty(i.prototype,"viewport",{get:function(){return this.$viewport},set:function(e){if(e!=this.$viewport){var i=this.$viewport;i&&(i.removeEventListener(t.PropertyEvent.PROPERTY_CHANGE,this.onPropertyChanged,this),i.removeEventListener(egret.Event.RESIZE,this.onViewportResize,this)),this.$viewport=e,e&&(e.addEventListener(t.PropertyEvent.PROPERTY_CHANGE,this.onPropertyChanged,this),e.addEventListener(egret.Event.RESIZE,this.onViewportResize,this)),this.invalidateDisplayList()}},enumerable:!0,configurable:!0}),i.prototype.onViewportResize=function(){this.invalidateDisplayList()},i.prototype.onPropertyChanged=function(){},i}(t.Component);t.ScrollBarBase=e,__reflect(e.prototype,"eui.ScrollBarBase")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.trackHighlight=null,t.thumb=null,t.track=null,t.$SliderBase={0:0,1:0,2:0,3:0,4:null,5:null,6:300,7:0,8:0,9:!0},t.maximum=10,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.onTouchBegin,t),t}return __extends(i,e),Object.defineProperty(i.prototype,"slideDuration",{get:function(){return this.$SliderBase[6]},set:function(t){this.$SliderBase[6]=+t||0},enumerable:!0,configurable:!0}),i.prototype.pointToValue=function(){return this.minimum},Object.defineProperty(i.prototype,"liveDragging",{get:function(){return this.$SliderBase[9]},set:function(t){this.$SliderBase[9]=!!t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pendingValue",{get:function(){return this.$SliderBase[7]},set:function(t){t=+t||0;var e=this.$SliderBase;t!==e[7]&&(e[7]=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),i.prototype.setValue=function(t){this.$SliderBase[7]=t,e.prototype.setValue.call(this,t)},i.prototype.partAdded=function(t,i){e.prototype.partAdded.call(this,t,i),i==this.thumb?(this.thumb.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onThumbTouchBegin,this),this.thumb.addEventListener(egret.Event.RESIZE,this.onTrackOrThumbResize,this)):i==this.track?(this.track.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTrackTouchBegin,this),this.track.addEventListener(egret.Event.RESIZE,this.onTrackOrThumbResize,this)):i===this.trackHighlight&&(this.trackHighlight.touchEnabled=!1,egret.is(this.trackHighlight,"egret.DisplayObjectContainer")&&(this.trackHighlight.touchChildren=!1))},i.prototype.partRemoved=function(t,i){e.prototype.partRemoved.call(this,t,i),i==this.thumb?(this.thumb.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onThumbTouchBegin,this),this.thumb.removeEventListener(egret.Event.RESIZE,this.onTrackOrThumbResize,this)):i==this.track&&(this.track.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTrackTouchBegin,this),this.track.removeEventListener(egret.Event.RESIZE,this.onTrackOrThumbResize,this))},i.prototype.onTrackOrThumbResize=function(){this.updateSkinDisplayList()},i.prototype.onThumbTouchBegin=function(e){var i=this.$SliderBase;i[5]&&i[5].isPlaying&&this.stopAnimation();var r=this.$stage;r.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onStageTouchMove,this),r.addEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this);var n=this.thumb.globalToLocal(e.stageX,e.stageY,egret.$TempPoint);i[0]=n.x,i[1]=n.y,t.UIEvent.dispatchUIEvent(this,t.UIEvent.CHANGE_START)},i.prototype.onStageTouchMove=function(t){var e=this.$SliderBase;e[2]=t.$stageX,e[3]=t.$stageY;var i=this.track;if(i){var r=i.globalToLocal(e[2],e[3],egret.$TempPoint),n=this.pointToValue(r.x-e[0],r.y-e[1]);n=this.nearestValidValue(n,this.snapInterval),this.updateWhenTouchMove(n),t.updateAfterEvent()}},i.prototype.updateWhenTouchMove=function(t){t!=this.$SliderBase[7]&&(this.liveDragging?(this.setValue(t),this.dispatchEventWith(egret.Event.CHANGE)):this.pendingValue=t)},i.prototype.onStageTouchEnd=function(e){var i=e.$currentTarget;i.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onStageTouchMove,this),i.removeEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),t.UIEvent.dispatchUIEvent(this,t.UIEvent.CHANGE_END);var r=this.$SliderBase;this.liveDragging||this.value==r[7]||(this.setValue(r[7]),this.dispatchEventWith(egret.Event.CHANGE))
},i.prototype.onTouchBegin=function(t){this.$stage.addEventListener(egret.TouchEvent.TOUCH_END,this.stageTouchEndHandler,this),this.$SliderBase[4]=t.$target},i.prototype.stageTouchEndHandler=function(t){var e=t.$target,i=this.$SliderBase;t.$currentTarget.removeEventListener(egret.TouchEvent.TOUCH_END,this.stageTouchEndHandler,this),i[4]!=e&&this.contains(e)&&egret.TouchEvent.dispatchTouchEvent(this,egret.TouchEvent.TOUCH_TAP,!0,!0,t.$stageX,t.$stageY,t.touchPointID),i[4]=null},i.prototype.$animationUpdateHandler=function(t){this.pendingValue=t.currentValue},i.prototype.animationEndHandler=function(){this.setValue(this.$SliderBase[8]),this.dispatchEventWith(egret.Event.CHANGE),t.UIEvent.dispatchUIEvent(this,t.UIEvent.CHANGE_END)},i.prototype.stopAnimation=function(){this.$SliderBase[5].stop(),this.setValue(this.nearestValidValue(this.pendingValue,this.snapInterval)),this.dispatchEventWith(egret.Event.CHANGE),t.UIEvent.dispatchUIEvent(this,t.UIEvent.CHANGE_END)},i.prototype.onTrackTouchBegin=function(e){var i=this.thumb?this.thumb.width:0,r=this.thumb?this.thumb.height:0,n=e.$stageX-i/2,o=e.$stageY-r/2,a=this.track.globalToLocal(n,o,egret.$TempPoint),s=this.$Range,l=this.pointToValue(a.x,a.y);l=this.nearestValidValue(l,s[7]);var h=this.$SliderBase;if(l!=h[7])if(0!=h[6]){h[5]||(h[5]=new t.sys.Animation(this.$animationUpdateHandler,this),h[5].endFunction=this.animationEndHandler);var u=h[5];u.isPlaying&&this.stopAnimation(),h[8]=l,u.duration=h[6]*(Math.abs(h[7]-h[8])/(s[0]-s[2])),u.from=h[7],u.to=h[8],t.UIEvent.dispatchUIEvent(this,t.UIEvent.CHANGE_START),u.play()}else this.setValue(l),this.dispatchEventWith(egret.Event.CHANGE)},i}(t.Range);t.SliderBase=e,__reflect(e.prototype,"eui.SliderBase")}(eui||(eui={}));var eui;!function(eui){var sys;!function(sys){function getRepeatedIds(t){var e=[];return this.repeatedIdMap={},this.getIds(t,e),e}function getIds(t,e){if(t.namespace!=sys.NS_W&&t.attributes.id){var i=t.attributes.id;this.repeatedIdMap[i]?e.push(toXMLString(t)):this.repeatedIdMap[i]=!0}var r=t.children;if(r)for(var n=r.length,o=0;n>o;o++){var a=r[o];1!==a.nodeType||this.isInnerClass(a)||this.getIds(a,e)}}function toXMLString(t){if(!t)return"";for(var e="  at <"+t.name,i=t.attributes,r=Object.keys(i),n=r.length,o=0;n>o;o++){var a=r[o],s=i[a];("id"!=a||"__"!=s.substring(0,2))&&(e+=" "+a+'="'+s+'"')}return e+=0==t.children.length?"/>":">"}function checkDeclarations(t,e){if(t){var i=t.children;if(i)for(var r=i.length,n=0;r>n;n++){var o=i[n];1==o.nodeType&&(o.attributes.includeIn&&e.push(toXMLString(o)),o.attributes.excludeFrom&&e.push(toXMLString(o)),checkDeclarations(o,e))}}}function getPropertyStr(t){var e=toXMLString(t.parent),i=toXMLString(t).substring(5);return e+"\n      	"+i}var exmlParserPool=[],parsedClasses={},innerClassCount=1,HOST_COMPONENT="hostComponent",SKIN_CLASS="eui.Skin",DECLARATIONS="Declarations",RECTANGLE="egret.Rectangle",TYPE_CLASS="Class",TYPE_ARRAY="Array",TYPE_PERCENTAGE="Percentage",TYPE_STATE="State[]",SKIN_NAME="skinName",ELEMENTS_CONTENT="elementsContent",basicTypes=[TYPE_ARRAY,"boolean","string","number"],wingKeys=["id","locked","includeIn","excludeFrom"],htmlEntities=[["<","&lt;"],[">","&gt;"],["&","&amp;"],['"',"&quot;"],["'","&apos;"]],jsKeyWords=["null","NaN","undefined","true","false"],EXMLParser=function(){function EXMLParser(){this.delayAssignmentDic={},this.repeatedIdMap={},this.getRepeatedIds=getRepeatedIds,this.getIds=getIds,this.checkDeclarations=checkDeclarations}return EXMLParser.prototype.$parseCode=function(codeText,classStr){var className=classStr?classStr:"$exmlClass"+innerClassCount++,clazz=eval(codeText),hasClass=!0;if(hasClass&&clazz){egret.registerClass(clazz,className);for(var paths=className.split("."),length_15=paths.length,definition=__global,i=0;length_15-1>i;i++){var path=paths[i];definition=definition[path]||(definition[path]={})}definition[paths[length_15-1]]?parsedClasses[className]||egret.$warn(2101,className,codeText):(parsedClasses[className]=!0,definition[paths[length_15-1]]=clazz)}return clazz},EXMLParser.prototype.parse=function(text){text||egret.$error(1003,"text");var xmlData=null;try{xmlData=egret.XML.parse(text)}catch(e){egret.$error(2002,text+"\n"+e.message)}var hasClass=!1,className="";xmlData.attributes["class"]?(className=xmlData.attributes["class"],delete xmlData.attributes["class"],hasClass=!!className):className="$exmlClass"+innerClassCount++;var exClass=this.parseClass(xmlData,className),code=exClass.toCode(),clazz=null;try{clazz=eval(code)}catch(e){return egret.log(code),null}if(hasClass&&clazz){egret.registerClass(clazz,className);for(var paths=className.split("."),length_16=paths.length,definition=__global,i=0;length_16-1>i;i++){var path=paths[i];definition=definition[path]||(definition[path]={})}definition[paths[length_16-1]]?parsedClasses[className]||egret.$warn(2101,className,toXMLString(xmlData)):(parsedClasses[className]=!0,definition[paths[length_16-1]]=clazz)}return clazz},EXMLParser.prototype.parseClass=function(t,e){sys.exmlConfig||(sys.exmlConfig=new sys.EXMLConfig),this.currentXML=t,this.currentClassName=e,this.delayAssignmentDic={},this.idDic={},this.stateCode=[],this.stateNames=[],this.skinParts=[],this.bindings=[],this.declarations=null,this.currentClass=new sys.EXClass,this.stateIds=[];var i=e.lastIndexOf(".");this.currentClass.className=-1!=i?e.substring(i+1):e,this.startCompile();var r=this.currentClass;return this.currentClass=null,r},EXMLParser.prototype.startCompile=function(){var t=this.getRepeatedIds(this.currentXML);t.length>0&&egret.$error(2004,this.currentClassName,t.join("\n"));var e=this.getClassNameOfNode(this.currentXML);this.isSkinClass=e==SKIN_CLASS,this.currentClass.superClass=e,this.getStateNames();var i=this.currentXML.children;if(i)for(var r=i.length,n=0;r>n;n++){var o=i[n];if(1===o.nodeType&&o.namespace==sys.NS_W&&o.localName==DECLARATIONS){this.declarations=o;break}}var a=[];return this.checkDeclarations(this.declarations,a),a.length>0&&egret.$error(2020,this.currentClassName,a.join("\n")),this.currentXML.namespace?(this.addIds(this.currentXML.children),void this.createConstructFunc()):void egret.$error(2017,this.currentClassName,toXMLString(this.currentXML))},EXMLParser.prototype.addIds=function(t){if(t)for(var e=t.length,i=0;e>i;i++){var r=t[i];if(1==r.nodeType)if(r.namespace){if(!this.isInnerClass(r)&&(this.addIds(r.children),r.namespace!=sys.NS_W&&r.localName))if(this.isProperty(r)){var n=r.localName,o=n.indexOf("."),a=r.children;if(-1==o||!a||0==a.length)continue;var s=a[0];this.stateIds.push(s.attributes.id)}else if(1===r.nodeType){var l=r.attributes.id;if(l){var h=new RegExp("^[a-zA-Z_$]{1}[a-z0-9A-Z_$]*");null==l.match(h)&&egret.$warn(2022,l),-1==this.skinParts.indexOf(l)&&this.skinParts.push(l),this.createVarForNode(r),this.isStateNode(r)&&this.stateIds.push(l)}else this.createIdForNode(r),this.isStateNode(r)&&this.stateIds.push(r.attributes.id)}}else egret.$error(2017,this.currentClassName,toXMLString(r))}},EXMLParser.prototype.isInnerClass=function(t){if(t.hasOwnProperty("isInnerClass"))return t.isInnerClass;var e="Skin"==t.localName&&t.namespace==sys.NS_S;if(!e)if(this.isProperty(t))e=!1;else{var i=void 0,r=t.parent;if(this.isProperty(r)){i=r.localName;var n=i.indexOf(".");-1!=n&&(i.substring(n+1),i=i.substring(0,n)),r=r.parent}else i=sys.exmlConfig.getDefaultPropById(r.localName,r.namespace);var o=sys.exmlConfig.getClassNameById(r.localName,r.namespace);e=sys.exmlConfig.getPropertyType(i,o)==TYPE_CLASS}return t.isInnerClass=e,e},EXMLParser.prototype.containsState=function(t){var e=t.attributes;if(e.includeIn||e.excludeFrom)return!0;for(var i=Object.keys(e),r=i.length,n=0;r>n;n++){var o=i[n];if(-1!=o.indexOf("."))return!0}return!1},EXMLParser.prototype.createIdForNode=function(t){var e=this.getNodeId(t);this.idDic[e]?this.idDic[e]++:this.idDic[e]=1,e+=this.idDic[e],t.attributes.id=e},EXMLParser.prototype.getNodeId=function(t){return t.attributes.id?t.attributes.id:"_"+t.localName},EXMLParser.prototype.createVarForNode=function(t){var e=this.getClassNameOfNode(t);""!=e&&(this.currentClass.getVariableByName(t.attributes.id)||this.currentClass.addVariable(new sys.EXVariable(t.attributes.id)))},EXMLParser.prototype.createFuncForNode=function(t){var e=t.localName,i=this.isBasicTypeData(e);if(i)return this.createBasicTypeForNode(t);var r=this.getClassNameOfNode(t),n=new sys.EXFunction,o="_i",a=t.attributes.id;n.name=a+o,this.currentClass.addFunction(n);var s=new sys.EXCodeBlock;n.codeBlock=s;var l="t";"Object"==e?s.addVar(l,"{}"):s.addVar(l,"new "+r+"()");var h=!!this.currentClass.getVariableByName(a);h&&s.addAssignment("this."+a,l),this.addAttributesToCodeBlock(s,l,t),this.initlizeChildNode(t,s,l);var u=this.delayAssignmentDic[a];if(u)for(var c=u.length,p=0;c>p;p++){var d=u[p];s.concat(d)}return s.addReturn(l),"this."+n.name+"()"},EXMLParser.prototype.isBasicTypeData=function(t){return-1!=basicTypes.indexOf(t)},EXMLParser.prototype.createBasicTypeForNode=function(t){var e=t.localName,i="",r=this.currentClass.getVariableByName(t.attributes.id),n=t.children,o="";if(n&&n.length>0){var a=n[0];3==a.nodeType&&(o=a.text.trim())}switch(e){case TYPE_ARRAY:var s=[];if(n)for(var l=n.length,h=0;l>h;h++){var u=n[h];1==u.nodeType&&s.push(this.createFuncForNode(u))}i="["+s.join(",")+"]";break;case"boolean":i="false"!=o&&o?"true":"false";break;case"number":i=o,-1!=i.indexOf("%")&&(i=i.substring(0,i.length-1));break;case"string":i=this.formatString(o)}return r&&(r.defaultValue=i),i},EXMLParser.prototype.addAttributesToCodeBlock=function(t,e,i){var r,n,o=i.attributes,a=Object.keys(o);a.sort();var s=a.indexOf("style");s>0&&(a.splice(s,1),a.unshift("style"));for(var l=a.length,h=0;l>h;h++)if(r=a[h],this.isNormalKey(r)&&(n=o[r],r=this.formatKey(r,n),n=this.formatValue(r,n,i))){if(this.currentClass.getVariableByName(n)){var u="this.",c=o.id,p=u+c+" = t;";this.currentClass.getVariableByName(c)||this.createVarForNode(i),t.containsCodeLine(p)||t.addCodeLineAt(p,1);var d=new sys.EXCodeBlock;"this"==e?d.addAssignment(e,u+n,r):(d.startIf(u+c),d.addAssignment(u+c,u+n,r),d.endBlock()),this.delayAssignmentDic[n]||(this.delayAssignmentDic[n]=[]),this.delayAssignmentDic[n].push(d),n=u+n}t.addAssignment(e,n,r)}},EXMLParser.prototype.initlizeChildNode=function(t,e,i){var r=t.children;if(r&&0!=r.length){for(var n,o=sys.exmlConfig.getClassNameById(t.localName,t.namespace),a=[],s=r.length,l=[],h=0;s>h;h++){var u=r[h];if(1==u.nodeType&&u.namespace!=sys.NS_W)if(this.isInnerClass(u)){if("Skin"==u.localName){var c=this.parseInnerClass(u),p=sys.exmlConfig.getPropertyType(SKIN_NAME,o);p?e.addAssignment(i,c,SKIN_NAME):egret.$error(2005,this.currentClassName,SKIN_NAME,getPropertyStr(u))}}else{var d=u.localName;if(this.isProperty(u)){if(!this.isNormalKey(d))continue;var p=sys.exmlConfig.getPropertyType(u.localName,o);if(!p){egret.$error(2005,this.currentClassName,u.localName,getPropertyStr(u));continue}if(!u.children||0==u.children.length){egret.$warn(2102,this.currentClassName,getPropertyStr(u));continue}n=getPropertyStr(u),this.addChildrenToProp(u.children,p,d,e,i,n,l,t)}else a.push(u)}}if(0!=a.length){var f=sys.exmlConfig.getDefaultPropById(t.localName,t.namespace),g=sys.exmlConfig.getPropertyType(f,o);return n=getPropertyStr(a[0]),f&&g?void this.addChildrenToProp(a,g,f,e,i,n,l,t):void egret.$error(2012,this.currentClassName,n)}}},EXMLParser.prototype.parseInnerClass=function(t){var e=exmlParserPool.pop();e||(e=new EXMLParser);var i=this.currentClass.className+"$"+t.localName+innerClassCount++,r=e.parseClass(t,i);return this.currentClass.addInnerClass(r),exmlParserPool.push(e),i},EXMLParser.prototype.addChildrenToProp=function(t,e,i,r,n,o,a,s){var l="",h=t.length;if(h>1){if(e!=TYPE_ARRAY)return void egret.$error(2011,this.currentClassName,i,o);for(var u=[],c=0;h>c;c++){var p=t[c];1==p.nodeType&&(l=this.createFuncForNode(p),this.getClassNameOfNode(p),this.isStateNode(p)||u.push(l))}l="["+u.join(",")+"]"}else{var d=t[0];if(e==TYPE_ARRAY)if(d.localName==TYPE_ARRAY){var u=[];if(d.children)for(var f=d.children.length,g=0;f>g;g++){var p=d.children[g];1==p.nodeType&&(l=this.createFuncForNode(p),this.getClassNameOfNode(p),this.isStateNode(p)||u.push(l))}l="["+u.join(",")+"]"}else l=this.createFuncForNode(d),this.getClassNameOfNode(d),l=this.isStateNode(d)?"[]":"["+l+"]";else if(1==d.nodeType)if(e==TYPE_CLASS){if(h>1)return void egret.$error(2011,this.currentClassName,i,o);l=this.parseInnerClass(t[0])}else this.getClassNameOfNode(d),l=this.createFuncForNode(d);else l=this.formatValue(i,d.text,s)}""!=l&&(-1==l.indexOf("()")&&(i=this.formatKey(i,l)),-1==a.indexOf(i)?a.push(i):egret.$warn(2103,this.currentClassName,i,o),r.addAssignment(n,l,i))},EXMLParser.prototype.isProperty=function(t){if(t.hasOwnProperty("isProperty"))return t.isProperty;var e,i=t.localName;if(i&&1===t.nodeType&&t.parent&&!this.isBasicTypeData(i)){var r=t.parent,n=i.indexOf(".");-1!=n&&(i=i.substr(0,n));var o=sys.exmlConfig.getClassNameById(r.localName,r.namespace);e=!!sys.exmlConfig.getPropertyType(i,o)}else e=!1;return t.isProperty=e,e},EXMLParser.prototype.isNormalKey=function(t){return t&&-1==t.indexOf(".")&&-1==t.indexOf(":")&&-1==wingKeys.indexOf(t)?!0:!1},EXMLParser.prototype.formatKey=function(t,e){return-1!=e.indexOf("%")&&("height"==t?t="percentHeight":"width"==t&&(t="percentWidth")),t},EXMLParser.prototype.formatValue=function(t,e,i){e||(e="");var r=e;e=e.trim();var n=this.getClassNameOfNode(i),o=sys.exmlConfig.getPropertyType(t,n);o||egret.$error(2005,this.currentClassName,t,toXMLString(i));var a=this.formatBinding(t,e,i);if(a){this.checkIdForState(i);var s="this";i!==this.currentXML&&(s+="."+i.attributes.id),this.bindings.push(new sys.EXBinding(s,t,a.templates,a.chainIndex)),e=""}else if(o==RECTANGLE){var l=e.split(",");(4!=l.length||isNaN(parseInt(l[0]))||isNaN(parseInt(l[1]))||isNaN(parseInt(l[2]))||isNaN(parseInt(l[3])))&&egret.$error(2016,this.currentClassName,toXMLString(i)),e="new "+RECTANGLE+"("+e+")"}else if(o==TYPE_PERCENTAGE)-1!=e.indexOf("%")&&(e=this.formatString(e));else switch(o){case TYPE_CLASS:t==SKIN_NAME&&(e=this.formatString(r));break;case"number":0==e.indexOf("#")?(isNaN(e.substring(1))&&egret.$warn(2021,this.currentClassName,t,e),e="0x"+e.substring(1)):-1!=e.indexOf("%")?(isNaN(e.substr(0,e.length-1))&&egret.$warn(2021,this.currentClassName,t,e),e=parseFloat(e.substr(0,e.length-1)).toString()):isNaN(e)&&egret.$warn(2021,this.currentClassName,t,e);break;case"boolean":e="false"!=e&&e?"true":"false";break;case"string":case"any":e=this.formatString(r);break;default:egret.$error(2008,this.currentClassName,"string",t+":"+o,toXMLString(i))}return e},EXMLParser.prototype.formatString=function(t){return t=this.unescapeHTMLEntity(t),t=t.split("\n").join("\\n"),t=t.split("\r").join("\\n"),t=t.split('"').join('\\"'),t='"'+t+'"'},EXMLParser.prototype.formatBinding=function(t,e){if(!e)return null;if(e=e.trim(),"{"!=e.charAt(0)||"}"!=e.charAt(e.length-1))return null;e=e.substring(1,e.length-1).trim();for(var i=-1==e.indexOf("+")?[e]:this.parseTemplates(e),r=[],n=i.length,o=0;n>o;o++){var a=i[o].trim();if(a){var s=a.charAt(0);if(!("'"==s||'"'==s||s>="0"&&"9">=s||"-"==s||-1==a.indexOf(".")&&-1!=jsKeyWords.indexOf(a))){0==a.indexOf("this.")&&(a=a.substring(5));var l=a.split(".")[0];l!=HOST_COMPONENT&&-1==this.skinParts.indexOf(l)&&(a=HOST_COMPONENT+"."+a),i[o]='"'+a+'"',r.push(o)}}else i.splice(o,1),o--,n--}return{templates:i,chainIndex:r}},EXMLParser.prototype.parseTemplates=function(t){if(-1==t.indexOf("'"))return t.split("+");var e=!1,i="";for(t=t.split("\\'").join("0");t.length>0;){var r=t.indexOf("'");if(-1==r){i+=t;break}i+=t.substring(0,r+1),t=t.substring(r+1),r=t.indexOf("'"),-1==r&&(r=t.length-1,e=!0);var n=t.substring(0,r+1);i+=n.split("+").join("1"),t=t.substring(r+1)}t=i.split("0").join("\\'"),e&&(t+="'");for(var o=t.split("+"),a=o.length,s=0;a>s;s++)o[s]=o[s].split("1").join("+");return o},EXMLParser.prototype.unescapeHTMLEntity=function(t){if(!t)return"";for(var e=htmlEntities.length,i=0;e>i;i++){var r=htmlEntities[i],n=r[0],o=r[1];t=t.split(o).join(n)}return t},EXMLParser.prototype.createConstructFunc=function(){var t=new sys.EXCodeBlock;t.addEmptyLine();var e="this";if(this.addAttributesToCodeBlock(t,e,this.currentXML),this.declarations){var i=this.declarations.children;if(i&&i.length>0)for(var r=i.length,n=0;r>n;n++){var o=i[n];if(1==o.nodeType){var a=this.createFuncForNode(o);a&&t.addCodeLine(a+";")}}}this.initlizeChildNode(this.currentXML,t,e);var s,l,h=this.stateIds;if(h.length>0){l=h.length;for(var n=0;l>n;n++)s=h[n],t.addCodeLine("this."+s+"_i();");t.addEmptyLine()}var u=this.skinParts,c="[]";if(l=u.length,l>0){for(var n=0;l>n;n++)u[n]='"'+u[n]+'"';c="["+u.join(",")+"]"}var p=new sys.EXFunction;p.name="skinParts",p.isGet=!0;var d=new sys.EXCodeBlock;d.addReturn(c),p.codeBlock=d,this.currentClass.addFunction(p),this.currentXML.attributes.id="",this.createStates(this.currentXML);for(var f,g=this.currentXML,y=(this.getClassNameOfNode(g),g.attributes),v=Object.keys(y),m=v.length,_=0;m>_;_++){var b=v[_],T=y[b],x=b.indexOf(".");if(-1!=x){var E=b.substring(0,x);E=this.formatKey(E,T);var $=this.formatValue(E,T,g);if(!$)continue;var S=b.substr(x+1);f=this.getStateByName(S,g);var C=f.length;if(C>0)for(var n=0;C>n;n++){var w=f[n];w.addOverride(new sys.EXSetProperty("",E,$))}}}var O=this.stateCode;if(l=O.length,l>0){var P="	";t.addCodeLine("this.states = [");for(var D=!0,n=0;l>n;n++){var w=O[n];D?D=!1:t.addCodeLine(P+",");for(var L=w.toCode().split("\n"),R=0;R<L.length;){var I=L[R];I&&t.addCodeLine(P+I),R++}}t.addCodeLine("];")}var M=this.bindings;if(l=M.length,l>0){t.addEmptyLine();for(var n=0;l>n;n++){var A=M[n];t.addCodeLine(A.toCode())}}this.currentClass.constructCode=t},EXMLParser.prototype.isStateNode=function(t){var e=t.attributes;return e.hasOwnProperty("includeIn")||e.hasOwnProperty("excludeFrom")},EXMLParser.prototype.getStateNames=function(){var t=this.currentXML,e=sys.exmlConfig.getClassNameById(t.localName,t.namespace),i=sys.exmlConfig.getPropertyType("states",e);if(i==TYPE_STATE){var r=t.attributes.states;r&&delete t.attributes.states;var n,o,a=this.stateNames,s=t.children;if(s)for(var l=s.length,h=0;l>h;h++)if(o=s[h],1==o.nodeType&&"states"==o.localName){o.namespace=sys.NS_W,n=o.children;break}if(n||r)if(n&&0==n.length&&egret.$warn(2102,this.currentClassName,getPropertyStr(o)),n&&r&&egret.$warn(2103,this.currentClassName,"states",getPropertyStr(o)),r)for(var u=r.split(","),c=u.length,h=0;c>h;h++){var p=u[h].trim();p&&(-1==a.indexOf(p)&&a.push(p),this.stateCode.push(new sys.EXState(p)))}else for(var d=n.length,h=0;d>h;h++){var f=n[h];if(1==f.nodeType){var g=[],y=f.attributes;if(y.stateGroups)for(var v=y.stateGroups.split(","),m=v.length,_=0;m>_;_++){var b=v[_].trim();b&&(-1==a.indexOf(b)&&a.push(b),g.push(b))}var p=y.name;-1==a.indexOf(p)&&a.push(p),this.stateCode.push(new sys.EXState(p,g))}}}},EXMLParser.prototype.createStates=function(t){var e=t.children;if(e)for(var i=e.length,r=0;i>r;r++){var n=e[r];if(1==n.nodeType&&!this.isInnerClass(n)&&(this.createStates(n),n.namespace!=sys.NS_W&&n.localName))if(this.isProperty(n)){var o=n.localName,a=o.indexOf("."),s=n.children;if(-1==a||!s||0==s.length)continue;var l=o.substring(a+1);o=o.substring(0,a);var h=this.getClassNameOfNode(t),u=sys.exmlConfig.getPropertyType(o,h);u==TYPE_ARRAY&&egret.$error(2013,this.currentClassName,getPropertyStr(n)),s.length>1&&egret.$error(2011,this.currentClassName,o,getPropertyStr(n));var c=s[0],p=void 0;1==c.nodeType?(this.createFuncForNode(c),this.checkIdForState(c),p="this."+c.attributes.id):p=this.formatValue(o,c.text,t);var d=this.getStateByName(l,n),f=d.length;if(f>0)for(var g=0;f>g;g++){var y=d[g];y.addOverride(new sys.EXSetProperty(t.attributes.id,o,p))}}else if(this.containsState(n)){var v=n.attributes,m=v.id;this.getClassNameOfNode(n),this.checkIdForState(n);var l=void 0,d=void 0,y=void 0;if(this.isStateNode(n)){var _="",b=n.parent;b.localName==TYPE_ARRAY&&(b=b.parent),b&&b.parent&&this.isProperty(b)&&(b=b.parent),b&&b!=this.currentXML&&(_=b.attributes.id,this.checkIdForState(b));var T=this.findNearNodeId(n),x=[];if(v.includeIn)x=v.includeIn.split(",");else{for(var E=v.excludeFrom.split(","),$=E.length,g=0;$>g;g++){var S=E[g];this.getStateByName(S,n)}$=this.stateCode.length;for(var g=0;$>g;g++)y=this.stateCode[g],-1==E.indexOf(y.name)&&x.push(y.name)}for(var C=x.length,w=0;C>w;w++)if(l=x[w],d=this.getStateByName(l,n),d.length>0)for(var f=d.length,g=0;f>g;g++)y=d[g],y.addOverride(new sys.EXAddItems(m,_,T.position,T.relativeTo))}for(var O=Object.keys(v),P=O.length,D=0;P>D;D++){var L=O[D],p=v[L],a=L.indexOf(".");if(-1!=a){var R=L.substring(0,a);R=this.formatKey(R,p);var I=this.formatBinding(R,p,n);if(!I&&(p=this.formatValue(R,p,n),!p))continue;l=L.substr(a+1),d=this.getStateByName(l,n);var f=d.length;if(f>0)for(var g=0;f>g;g++)y=d[g],y.addOverride(I?new sys.EXSetStateProperty(m,R,I.templates,I.chainIndex):new sys.EXSetProperty(m,R,p))}}}}},EXMLParser.prototype.checkIdForState=function(t){if(t&&!this.currentClass.getVariableByName(t.attributes.id)){this.createVarForNode(t);var e=t.attributes.id,i=e+"_i",r=this.currentClass.getFuncByName(i);if(r){var n="this."+e+" = t;",o=r.codeBlock;o&&(o.containsCodeLine(n)||o.addCodeLineAt(n,1))}}},EXMLParser.prototype.getStateByName=function(t,e){for(var i=[],r=this.stateCode,n=r.length,o=0;n>o;o++){var a=r[o];if(a.name==t)-1==i.indexOf(a)&&i.push(a);else if(a.stateGroups.length>0){for(var s=!1,l=a.stateGroups.length,h=0;l>h;h++){var u=a.stateGroups[h];if(u==t){s=!0;break}}s&&-1==i.indexOf(a)&&i.push(a)}}return 0==i.length&&egret.$error(2006,this.currentClassName,t,toXMLString(e)),i},EXMLParser.prototype.findNearNodeId=function(t){for(var e,i,r,n=t.parent,o="",a=-1,s=!1,l=n.children,h=l.length,u=0;h>u;u++){var c=l[u];this.isProperty(c)||(c==t?(s=!0,a=u):!s||r||this.isStateNode(c)||(r=c),s||this.isStateNode(c)||(i=c))}return 0==a?(e=0,{position:e,relativeTo:o}):a==h-1?(e=1,{position:e,relativeTo:o}):r&&(e=2,o=r.attributes.id)?(this.checkIdForState(r),{position:e,relativeTo:o}):{position:1,relativeTo:o}},EXMLParser.prototype.getClassNameOfNode=function(t){var e=sys.exmlConfig.getClassNameById(t.localName,t.namespace);return e||egret.$error(2003,this.currentClassName,toXMLString(t)),e},EXMLParser}();sys.EXMLParser=EXMLParser,__reflect(EXMLParser.prototype,"eui.sys.EXMLParser")}(sys=eui.sys||(eui.sys={}))}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){var e=t.apply(this,arguments)||this;return e.$horizontalAlign="left",e.$verticalAlign="top",e.$gap=6,e.$paddingLeft=0,e.$paddingRight=0,e.$paddingTop=0,e.$paddingBottom=0,e.elementSizeTable=[],e.startIndex=-1,e.endIndex=-1,e.indexInViewCalculated=!1,e.maxElementSize=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"horizontalAlign",{get:function(){return this.$horizontalAlign},set:function(t){this.$horizontalAlign!=t&&(this.$horizontalAlign=t,this.$target&&this.$target.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"verticalAlign",{get:function(){return this.$verticalAlign},set:function(t){this.$verticalAlign!=t&&(this.$verticalAlign=t,this.$target&&this.$target.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gap",{get:function(){return this.$gap},set:function(t){t=+t||0,this.$gap!==t&&(this.$gap=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingLeft",{get:function(){return this.$paddingLeft},set:function(t){t=+t||0,this.$paddingLeft!==t&&(this.$paddingLeft=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingRight",{get:function(){return this.$paddingRight},set:function(t){t=+t||0,this.$paddingRight!==t&&(this.$paddingRight=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingTop",{get:function(){return this.$paddingTop},set:function(t){t=+t||0,this.$paddingTop!==t&&(this.$paddingTop=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingBottom",{get:function(){return this.$paddingBottom},set:function(t){t=+t||0,this.$paddingBottom!==t&&(this.$paddingBottom=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),e.prototype.invalidateTargetLayout=function(){var t=this.$target;t&&(t.invalidateSize(),t.invalidateDisplayList())},e.prototype.measure=function(){this.$target&&(this.$useVirtualLayout?this.measureVirtual():this.measureReal())},e.prototype.measureReal=function(){},e.prototype.measureVirtual=function(){},e.prototype.updateDisplayList=function(t,e){var i=this.$target;return i?0==i.numElements?void i.setContentSize(Math.ceil(this.$paddingLeft+this.$paddingRight),Math.ceil(this.$paddingTop+this.$paddingBottom)):void(this.$useVirtualLayout?this.updateDisplayListVirtual(t,e):this.updateDisplayListReal(t,e)):void 0},e.prototype.getStartPosition=function(){return 0},e.prototype.getElementSize=function(){return 0},e.prototype.getElementTotalSize=function(){return 0},e.prototype.elementRemoved=function(e){this.$useVirtualLayout&&(t.prototype.elementRemoved.call(this,e),this.elementSizeTable.splice(e,1))},e.prototype.clearVirtualLayoutCache=function(){this.$useVirtualLayout&&(this.elementSizeTable=[],this.maxElementSize=0)},e.prototype.findIndexAt=function(t,e,i){var r=.5*(e+i)|0,n=this.getStartPosition(r),o=this.getElementSize(r);return t>=n&&t<n+o+this.$gap?r:e==i?-1:n>t?this.findIndexAt(t,e,Math.max(e,r-1)):this.findIndexAt(t,Math.min(r+1,i),i)},e.prototype.scrollPositionChanged=function(){if(t.prototype.scrollPositionChanged.call(this),this.$useVirtualLayout){var e=this.getIndexInView();e&&(this.indexInViewCalculated=!0,this.target.invalidateDisplayList())}},e.prototype.getIndexInView=function(){return!1},e.prototype.updateDisplayListVirtual=function(){},e.prototype.updateDisplayListReal=function(){},e.prototype.flexChildrenProportionally=function(t,e,i,r){var n,o=r.length;do{n=!0;var a=e-t*i/100;a>0?e-=a:a=0;for(var s=e/i,l=0;o>l;l++){var h=r[l],u=h.percent*s;if(u<h.min){var c=h.min;h.size=c,r[l]=r[--o],r[o]=h,i-=h.percent,a>=c?a-=c:(e-=c-a,a=0),n=!1;break}if(u>h.max){var p=h.max;h.size=p,r[l]=r[--o],r[o]=h,i-=h.percent,a>=p?a-=p:(e-=p-a,a=0),n=!1;break}h.size=u}}while(!n)},e}(t.LayoutBase);t.LinearLayoutBase=e,__reflect(e.prototype,"eui.LinearLayoutBase")}(eui||(eui={})),function(t){var e;!function(t){var e=function(){function t(){this.layoutElement=null,this.size=0,this.percent=0/0,this.min=0/0,this.max=0/0}return t}();t.ChildInfo=e,__reflect(e.prototype,"eui.sys.ChildInfo")}(e=t.sys||(t.sys={}))}(eui||(eui={}));var eui;!function(t){var e=[],i={},r={},n=function(){function t(){}return t.prototype.getAsset=function(t,n,o){var a=i[t];if(a)return void a.push([n,o]);var s=e.pop();s||(s=new egret.ImageLoader),i[t]=[[n,o]],r[s.$hashCode]=t,s.addEventListener(egret.Event.COMPLETE,this.onLoadFinish,this),s.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadFinish,this),s.load(t)},t.prototype.onLoadFinish=function(t){var n=t.currentTarget;n.removeEventListener(egret.Event.COMPLETE,this.onLoadFinish,this),n.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadFinish,this);var o;t.$type==egret.Event.COMPLETE&&(o=new egret.Texture,o._setBitmapData(n.data),n.data=null),e.push(n);var a=r[n.$hashCode];delete r[n.$hashCode];var s=i[a];delete i[a];for(var l=s.length,h=0;l>h;h++){var u=s[h];u[0].call(u[1],o,a)}},t}();t.DefaultAssetAdapter=n,__reflect(n.prototype,"eui.DefaultAssetAdapter",["eui.IAssetAdapter"])}(eui||(eui={}));var eui;!function(t){var e=t.sys.UIComponentImpl,i=function(i){function r(t){var e=i.call(this)||this;return e.$createChildrenCalled=!1,e.$fontChanged=!1,e._widthConstraint=0/0,e.initializeUIValues(),e.text=t,e}return __extends(r,i),r.prototype.$invalidateContentBounds=function(){i.prototype.$invalidateContentBounds.call(this),this.invalidateSize()},r.prototype.$setWidth=function(t){var r=i.prototype.$setWidth.call(this,t),n=e.prototype.$setWidth.call(this,t);return r&&n},r.prototype.$setHeight=function(t){var r=i.prototype.$setHeight.call(this,t),n=e.prototype.$setHeight.call(this,t);return r&&n},r.prototype.$setText=function(e){var r=i.prototype.$setText.call(this,e);return t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"text"),r},r.prototype.$setFont=function(t){return this.$BitmapText,this.$font==t?!1:(this.$font=t,this.$createChildrenCalled?this.$parseFont():this.$fontChanged=!0,this.$BitmapText[6]=!0,!0)},r.prototype.$parseFont=function(){if(this.$fontChanged=!1,this.$font&&"string"==typeof this.$font){var e=egret.getImplementation("eui.IAssetAdapter");e||(e=new t.DefaultAssetAdapter),e.getAsset(this.$font,this.$onFontChanged,this)}else this.$setFontData(this.$font)},r.prototype.$onFontChanged=function(t,e){e===this.$font&&this.$setFontData(t)},r.prototype.$setFontData=function(t){return t==this.$BitmapText[5]?!1:(this.$BitmapText[5]=t,this.$invalidateContentBounds(),!0)},r.prototype.createChildren=function(){this.$fontChanged&&this.$parseFont(),this.$createChildrenCalled=!0},r.prototype.childrenCreated=function(){},r.prototype.commitProperties=function(){},r.prototype.measure=function(){var t=this.$UIComponent,e=this.$BitmapText,r=e[0],n=0/0;isNaN(this._widthConstraint)?isNaN(t[8])?1e5!=t[13]&&(n=t[13]):n=t[8]:(n=this._widthConstraint,this._widthConstraint=0/0),i.prototype.$setWidth.call(this,n),this.setMeasuredSize(this.textWidth,this.textHeight),i.prototype.$setWidth.call(this,r)},r.prototype.updateDisplayList=function(t,e){i.prototype.$setWidth.call(this,t),i.prototype.$setHeight.call(this,e)},r.prototype.invalidateParentLayout=function(){},r.prototype.setMeasuredSize=function(){},r.prototype.invalidateProperties=function(){},r.prototype.validateProperties=function(){},r.prototype.invalidateSize=function(){},r.prototype.validateSize=function(){},r.prototype.invalidateDisplayList=function(){},r.prototype.validateDisplayList=function(){},r.prototype.validateNow=function(){},r.prototype.setLayoutBoundsSize=function(t,i){if(e.prototype.setLayoutBoundsSize.call(this,t,i),!isNaN(t)&&t!==this._widthConstraint&&0!=t){var r=this.$UIComponent;isNaN(r[9])&&t!=r[16]&&(this._widthConstraint=t,this.invalidateSize())}},r.prototype.setLayoutBoundsPosition=function(){},r.prototype.getLayoutBounds=function(){},r.prototype.getPreferredBounds=function(){},r}(egret.BitmapText);t.BitmapLabel=i,__reflect(i.prototype,"eui.BitmapLabel",["eui.UIComponent","eui.IDisplayText"]),t.sys.implementUIComponent(i,egret.BitmapText),t.registerBindable(i.prototype,"text")}(eui||(eui={}));var eui;!function(t){var e=new t.DefaultAssetAdapter,i=function(i){function r(t){var e=i.call(this)||this;return e.sourceChanged=!1,e._source=null,e.initializeUIValues(),t&&(e.source=t),e}return __extends(r,i),Object.defineProperty(r.prototype,"scale9Grid",{get:function(){return this.$scale9Grid},set:function(t){this.$scale9Grid=t,this.$invalidateContentBounds(),this.invalidateDisplayList()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fillMode",{get:function(){return this.$fillMode},set:function(t){t!=this.$fillMode&&(this.$fillMode=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),r.prototype.$setFillMode=function(t){var e=i.prototype.$setFillMode.call(this,t);return this.invalidateDisplayList(),e},Object.defineProperty(r.prototype,"source",{get:function(){return this._source},set:function(t){t!=this._source&&(this._source=t,this.$stage?this.parseSource():(this.sourceChanged=!0,this.invalidateProperties()))},enumerable:!0,configurable:!0}),r.prototype.$setBitmapData=function(t){if(t==this.$Bitmap[0])return!1;var e=i.prototype.$setBitmapData.call(this,t);return this.sourceChanged=!1,this.invalidateSize(),this.invalidateDisplayList(),e},r.prototype.parseSource=function(){this.sourceChanged=!1;var t=this._source;if(t&&"string"==typeof t){var i=egret.getImplementation("eui.IAssetAdapter");i||(i=e),i.getAsset(this._source,this.contentChanged,this)}else this.$setBitmapData(t)
},r.prototype.contentChanged=function(t,e){e===this._source&&egret.is(t,"egret.Texture")&&(this.$setBitmapData(t),t?this.dispatchEventWith(egret.Event.COMPLETE):egret.$warn(2301,e))},r.prototype.$measureContentBounds=function(t){var e=(this.$Bitmap,this.$Bitmap[0]);if(e){var i=this.$UIComponent,r=i[10],n=i[11];if(isNaN(r)||isNaN(n))return void t.setEmpty();"clip"==this.$fillMode&&(r>e.$getTextureWidth()&&(r=e.$getTextureWidth()),n>e.$getTextureHeight()&&(n=e.$getTextureHeight())),t.setTo(0,0,r,n)}else t.setEmpty()},r.prototype.$render=function(){var t=this.$Bitmap[0];if(t){var e=this.$UIComponent,i=e[10],r=e[11];if(0!==i&&0!==r){var n=this.$Bitmap;egret.sys.BitmapNode.$updateTextureData(this.$renderNode,n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9],i,r,n[13],n[14],this.scale9Grid||n[0].scale9Grid,this.$fillMode,n[10])}}},r.prototype.createChildren=function(){this.sourceChanged&&this.parseSource()},r.prototype.childrenCreated=function(){},r.prototype.commitProperties=function(){t.sys.UIComponentImpl.prototype.commitProperties.call(this),this.sourceChanged&&this.parseSource()},r.prototype.measure=function(){var t=this.$Bitmap[0];t?this.setMeasuredSize(t.$getTextureWidth(),t.$getTextureHeight()):this.setMeasuredSize(0,0)},r.prototype.updateDisplayList=function(){this.$invalidateContentBounds()},r.prototype.invalidateParentLayout=function(){},r.prototype.setMeasuredSize=function(){},r.prototype.invalidateProperties=function(){},r.prototype.validateProperties=function(){},r.prototype.invalidateSize=function(){},r.prototype.validateSize=function(){},r.prototype.invalidateDisplayList=function(){},r.prototype.validateDisplayList=function(){},r.prototype.validateNow=function(){},r.prototype.setLayoutBoundsSize=function(){},r.prototype.setLayoutBoundsPosition=function(){},r.prototype.getLayoutBounds=function(){},r.prototype.getPreferredBounds=function(){},r}(egret.Bitmap);t.Image=i,__reflect(i.prototype,"eui.Image",["eui.UIComponent"]),t.sys.implementUIComponent(i,egret.Bitmap),t.registerProperty(i,"scale9Grid","egret.Rectangle")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t._data=null,t._selected=!1,t.itemIndex=-1,t.touchCaptured=!1,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.onTouchBegin,t),t}return __extends(i,e),Object.defineProperty(i.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e,t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"data"),this.dataChanged()},enumerable:!0,configurable:!0}),i.prototype.dataChanged=function(){},Object.defineProperty(i.prototype,"selected",{get:function(){return this._selected},set:function(t){this._selected!=t&&(this._selected=t,this.invalidateState())},enumerable:!0,configurable:!0}),i.prototype.onTouchCancle=function(t){this.touchCaptured=!1;var e=t.$currentTarget;e.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),e.removeEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.invalidateState()},i.prototype.onTouchBegin=function(t){this.$stage.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),this.$stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.touchCaptured=!0,this.invalidateState(),t.updateAfterEvent()},i.prototype.onStageTouchEnd=function(t){var e=t.$currentTarget;e.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),e.removeEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.touchCaptured=!1,this.invalidateState()},i.prototype.getCurrentState=function(){var t="up";if(this.touchCaptured&&(t="down"),this._selected){var e=t+"AndSelected",i=this.skin;return i&&i.hasState(e)?e:"disabled"==t?"disabled":"down"}return t},i}(t.Component);t.ItemRenderer=e,__reflect(e.prototype,"eui.ItemRenderer",["eui.IItemRenderer"]),t.registerBindable(e.prototype,"data")}(eui||(eui={}));var eui;!function(t){var e=t.sys.UIComponentImpl,i=function(i){function r(t){var e=i.call(this)||this;return e.$styleList=["fontFamily","size","bold","italic","textAlign","verticalAlign","lineSpacing","textColor","wordWrap","displayAsPassword","strokeColor","stroke","maxChars","multiline","border","borderColor","background","backgroundColor"],e.$revertStyle={},e.$style=null,e._widthConstraint=0/0,e.initializeUIValues(),e.text=t,e}return __extends(r,i),Object.defineProperty(r.prototype,"style",{get:function(){return this.$style},set:function(t){this.$setStyle(t)},enumerable:!0,configurable:!0}),r.prototype.$setStyle=function(t){if(this.$style!=t){this.$style=t;var e=egret.getImplementation("eui.Theme");if(e){for(var i in this.$revertStyle)this[i]=this.$revertStyle[i];if(this.$revertStyle={},null==t)return;for(var r=t.split(","),n=0;n<r.length;n++){var o=e.$getStyleConfig(r[n]);if(o)for(var i in o)if(-1!=this.$styleList.indexOf(i)){var a=this[i];this[i]=o[i],this.$revertStyle[i]=a}}}}},r.prototype.$setFontFamily=function(t){return delete this.$revertStyle.fontFanily,i.prototype.$setFontFamily.call(this,t)},r.prototype.$setSize=function(t){return delete this.$revertStyle.size,i.prototype.$setSize.call(this,t)},r.prototype.$setBold=function(t){return delete this.$revertStyle.bold,i.prototype.$setBold.call(this,t)},r.prototype.$setItalic=function(t){return delete this.$revertStyle.italic,i.prototype.$setItalic.call(this,t)},r.prototype.$setTextAlign=function(t){return delete this.$revertStyle.textAlign,i.prototype.$setTextAlign.call(this,t)},r.prototype.$setVerticalAlign=function(t){return delete this.$revertStyle.verticalAlign,i.prototype.$setVerticalAlign.call(this,t)},r.prototype.$setLineSpacing=function(t){return delete this.$revertStyle.lineSpacing,i.prototype.$setLineSpacing.call(this,t)},r.prototype.$setTextColor=function(t){return delete this.$revertStyle.textColor,i.prototype.$setTextColor.call(this,t)},r.prototype.$setWordWrap=function(t){delete this.$revertStyle.wordWrap,i.prototype.$setWordWrap.call(this,t)},r.prototype.$setDisplayAsPassword=function(t){return delete this.$revertStyle.displayAsPassword,i.prototype.$setDisplayAsPassword.call(this,t)},r.prototype.$setStrokeColor=function(t){return delete this.$revertStyle.strokeColor,i.prototype.$setStrokeColor.call(this,t)},r.prototype.$setStroke=function(t){return delete this.$revertStyle.stroke,i.prototype.$setStroke.call(this,t)},r.prototype.$setMaxChars=function(t){return delete this.$revertStyle.maxChars,i.prototype.$setMaxChars.call(this,t)},r.prototype.$setMultiline=function(t){return delete this.$revertStyle.multiline,i.prototype.$setMultiline.call(this,t)},r.prototype.$setBorder=function(t){delete this.$revertStyle.border,i.prototype.$setBorder.call(this,t)},r.prototype.$setBorderColor=function(t){delete this.$revertStyle.borderColor,i.prototype.$setBorderColor.call(this,t)},r.prototype.$setBackground=function(t){delete this.$revertStyle.background,i.prototype.$setBackground.call(this,t)},r.prototype.$setBackgroundColor=function(t){delete this.$revertStyle.backgroundColor,i.prototype.$setBackgroundColor.call(this,t)},r.prototype.$invalidateContentBounds=function(){i.prototype.$invalidateContentBounds.call(this),this.invalidateSize()},r.prototype.$setWidth=function(t){var r=i.prototype.$setWidth.call(this,t),n=e.prototype.$setWidth.call(this,t);return r&&n},r.prototype.$setHeight=function(t){var r=i.prototype.$setHeight.call(this,t),n=e.prototype.$setHeight.call(this,t);return r&&n},r.prototype.$setText=function(e){var r=i.prototype.$setText.call(this,e);return t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"text"),r},r.prototype.createChildren=function(){},r.prototype.childrenCreated=function(){},r.prototype.commitProperties=function(){},r.prototype.measure=function(){var t=this.$UIComponent,e=this.$TextField,r=e[3],n=0/0;isNaN(this._widthConstraint)?isNaN(t[8])?1e5!=t[13]&&(n=t[13]):n=t[8]:(n=this._widthConstraint,this._widthConstraint=0/0),i.prototype.$setWidth.call(this,n),this.setMeasuredSize(this.textWidth,this.textHeight),i.prototype.$setWidth.call(this,r)},r.prototype.updateDisplayList=function(t,e){i.prototype.$setWidth.call(this,t),i.prototype.$setHeight.call(this,e)},r.prototype.invalidateParentLayout=function(){},r.prototype.setMeasuredSize=function(){},r.prototype.invalidateProperties=function(){},r.prototype.validateProperties=function(){},r.prototype.invalidateSize=function(){},r.prototype.validateSize=function(){},r.prototype.invalidateDisplayList=function(){},r.prototype.validateDisplayList=function(){},r.prototype.validateNow=function(){},r.prototype.setLayoutBoundsSize=function(t,i){if(e.prototype.setLayoutBoundsSize.call(this,t,i),isNaN(t)||t===this._widthConstraint||0==t)return void(this._widthConstraint=t);this._widthConstraint=t;var r=this.$UIComponent;isNaN(r[9])&&t!=r[16]&&this.invalidateSize()},r.prototype.setLayoutBoundsPosition=function(){},r.prototype.getLayoutBounds=function(){},r.prototype.getPreferredBounds=function(){},r}(egret.TextField);t.Label=i,__reflect(i.prototype,"eui.Label",["eui.UIComponent","eui.IDisplayText"]),t.sys.implementUIComponent(i,egret.TextField),t.registerBindable(i.prototype,"text")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=e.apply(this,arguments)||this;return t.allowMultipleSelection=!1,t._selectedIndices=[],t.isValidIndex=function(e){return t.$dataProvider&&e>=0&&e<t.$dataProvider.length&&e%1==0},t}return __extends(i,e),Object.defineProperty(i.prototype,"selectedIndices",{get:function(){return this._proposedSelectedIndices?this._proposedSelectedIndices:this._selectedIndices},set:function(t){this.setSelectedIndices(t,!1)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectedIndex",{get:function(){return this._proposedSelectedIndices?this._proposedSelectedIndices.length>0?this._proposedSelectedIndices[0]:-1:this.$getSelectedIndex()},set:function(t){this.setSelectedIndex(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectedItems",{get:function(){var t=[],e=this.selectedIndices;if(e)for(var i=e.length,r=0;i>r;r++)t[r]=this.$dataProvider.getItemAt(e[r]);return t},set:function(t){var e=[];if(t)for(var i=t.length,r=0;i>r;r++){var n=this.$dataProvider.getItemIndex(t[r]);if(-1!=n&&e.splice(0,0,n),-1==n){e=[];break}}this.setSelectedIndices(e,!1)},enumerable:!0,configurable:!0}),i.prototype.setSelectedIndices=function(t,e){var i=this.$ListBase;e&&(i[4]=i[4]||e),this._proposedSelectedIndices=t?t:[],this.invalidateProperties()},i.prototype.commitProperties=function(){e.prototype.commitProperties.call(this),this._proposedSelectedIndices&&this.commitSelection()},i.prototype.commitSelection=function(i){void 0===i&&(i=!0);var r=this.$ListBase,n=r[3];if(this._proposedSelectedIndices){if(this._proposedSelectedIndices=this._proposedSelectedIndices.filter(this.isValidIndex),!this.allowMultipleSelection&&this._proposedSelectedIndices.length>0){var o=[];o.push(this._proposedSelectedIndices[0]),this._proposedSelectedIndices=o}r[2]=this._proposedSelectedIndices.length>0?this._proposedSelectedIndices[0]:-1}var a=e.prototype.commitSelection.call(this,!1);if(!a)return this._proposedSelectedIndices=null,!1;var s=this.$getSelectedIndex();return s>t.ListBase.NO_SELECTION&&(this._proposedSelectedIndices?-1==this._proposedSelectedIndices.indexOf(s)&&this._proposedSelectedIndices.push(s):this._proposedSelectedIndices=[s]),this._proposedSelectedIndices&&(-1!=this._proposedSelectedIndices.indexOf(n)&&this.itemSelected(n,!0),this.commitMultipleSelection()),i&&a&&(r[4]&&(this.dispatchEventWith(egret.Event.CHANGE),r[4]=!1),t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"selectedIndex"),t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"selectedItem")),a},i.prototype.commitMultipleSelection=function(){var t,e,i=[],r=[],n=this._selectedIndices,o=this._proposedSelectedIndices;if(n.length>0&&o.length>0){for(e=o.length,t=0;e>t;t++)-1==n.indexOf(o[t])&&r.push(o[t]);for(e=n.length,t=0;e>t;t++)-1==o.indexOf(n[t])&&i.push(n[t])}else n.length>0?i=n:o.length>0&&(r=o);if(this._selectedIndices=o,i.length>0)for(e=i.length,t=0;e>t;t++)this.itemSelected(i[t],!1);if(r.length>0)for(e=r.length,t=0;e>t;t++)this.itemSelected(r[t],!0);this._proposedSelectedIndices=null},i.prototype.$isItemIndexSelected=function(t){return this.allowMultipleSelection?-1!=this._selectedIndices.indexOf(t):e.prototype.$isItemIndexSelected.call(this,t)},i.prototype.dataProviderRefreshed=function(){this.allowMultipleSelection||e.prototype.dataProviderRefreshed.call(this)},i.prototype.calculateSelectedIndices=function(t){var e=[],i=this._selectedIndices,r=i.length;if(r>0){if(1==r&&i[0]==t)return this.$ListBase[0]?(e.splice(0,0,i[0]),e):e;for(var n=!1,o=0;r>o;o++)i[o]==t?n=!0:i[o]!=t&&e.splice(0,0,i[o]);return n||e.splice(0,0,t),e}return e.splice(0,0,t),e},i.prototype.onRendererTouchEnd=function(i){if(this.allowMultipleSelection){var r=i.currentTarget,n=this.$ListBase[7];if(r!=n)return;this.setSelectedIndices(this.calculateSelectedIndices(r.itemIndex),!0),t.ItemTapEvent.dispatchItemTapEvent(this,t.ItemTapEvent.ITEM_TAP,r)}else e.prototype.onRendererTouchEnd.call(this,i)},i}(t.ListBase);t.List=e,__reflect(e.prototype,"eui.List")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.closeButton=null,t.moveArea=null,t.titleDisplay=null,t._title="",t.offsetPointX=0,t.offsetPointY=0,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.onWindowTouchBegin,t,!1,100),t}return __extends(i,e),i.prototype.onWindowTouchBegin=function(){this.$parent.addChild(this)},Object.defineProperty(i.prototype,"elementsContent",{set:function(t){if(t)for(var e=t.length,i=0;e>i;i++)this.addChild(t[i])},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"title",{get:function(){return this._title},set:function(t){this._title=t,this.titleDisplay&&(this.titleDisplay.text=this.title)},enumerable:!0,configurable:!0}),i.prototype.partAdded=function(t,i){e.prototype.partAdded.call(this,t,i),i==this.titleDisplay?this.titleDisplay.text=this._title:i==this.moveArea?this.moveArea.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this):i==this.closeButton&&this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseButtonClick,this)},i.prototype.partRemoved=function(t,i){e.prototype.partRemoved.call(this,t,i),i==this.moveArea?this.moveArea.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this):i==this.closeButton&&this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseButtonClick,this)},i.prototype.onCloseButtonClick=function(){t.UIEvent.dispatchUIEvent(this,t.UIEvent.CLOSING,!0,!0)&&this.close()},i.prototype.close=function(){this.$parent&&this.$parent.removeChild(this)},i.prototype.onTouchBegin=function(t){this.$includeInLayout=!1,this.offsetPointX=this.x-t.$stageX,this.offsetPointY=this.y-t.$stageY,this.$stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.$stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this)},i.prototype.onTouchMove=function(t){this.x=t.$stageX+this.offsetPointX,this.y=t.$stageY+this.offsetPointY},i.prototype.onTouchEnd=function(){this.$stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.$stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this)},i}(t.Component);t.Panel=e,__reflect(e.prototype,"eui.Panel"),t.registerProperty(e,"elementsContent","Array",!0)}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.thumb=null,i.labelDisplay=null,i._labelFunction=null,i._slideDuration=500,i._direction=t.Direction.LTR,i.slideToValue=0,i.animationValue=0,i.thumbInitX=0,i.thumbInitY=0,i.animation=new t.sys.Animation(i.animationUpdateHandler,i),i}return __extends(i,e),Object.defineProperty(i.prototype,"labelFunction",{get:function(){return this._labelFunction},set:function(t){this._labelFunction!=t&&(this._labelFunction=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),i.prototype.valueToLabel=function(t,e){return null!=this.labelFunction?this._labelFunction(t,e):t+" / "+e},Object.defineProperty(i.prototype,"slideDuration",{get:function(){return this._slideDuration},set:function(t){t=0|+t,this._slideDuration!==t&&(this._slideDuration=t,this.animation.isPlaying&&(this.animation.stop(),this.setValue(this.slideToValue)))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"direction",{get:function(){return this._direction},set:function(t){this._direction!=t&&(this.thumb&&(this.thumb.x=this.thumbInitX),this.thumb&&(this.thumb.y=this.thumbInitY),this._direction=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),i.prototype.$setValue=function(t){if(this.value===t)return!1;var i=this.$Range,r=e.prototype.$setValue.call(this,t);if(this._slideDuration>0&&this.$stage){this.validateProperties();var n=this.animation;if(n.isPlaying&&(this.animationValue=this.slideToValue,this.invalidateDisplayList(),n.stop()),this.slideToValue=this.nearestValidValue(t,i[7]),this.slideToValue===this.animationValue)return r;var o=this._slideDuration*(Math.abs(this.animationValue-this.slideToValue)/(i[0]-i[2]));n.duration=o===1/0?0:o,n.from=this.animationValue,n.to=this.slideToValue,n.play()}else this.animationValue=this.value;return r},i.prototype.animationUpdateHandler=function(t){var e=this.$Range,i=this.nearestValidValue(t.currentValue,e[7]);this.animationValue=Math.min(e[0],Math.max(e[2],i)),this.invalidateDisplayList()},i.prototype.partAdded=function(t,i){e.prototype.partAdded.call(this,t,i),i===this.thumb&&(this.thumb.x&&(this.thumbInitX=this.thumb.x),this.thumb.y&&(this.thumbInitY=this.thumb.y),this.thumb.addEventListener(egret.Event.RESIZE,this.onThumbResize,this))},i.prototype.partRemoved=function(t,i){e.prototype.partRemoved.call(this,t,i),i===this.thumb&&this.thumb.removeEventListener(egret.Event.RESIZE,this.onThumbResize,this)},i.prototype.onThumbResize=function(){this.updateSkinDisplayList()},i.prototype.updateSkinDisplayList=function(){var e=this.animation.isPlaying?this.animationValue:this.value,i=this.maximum,r=this.thumb;if(r){var n=r.width,o=r.height,a=Math.round(e/i*n);(0>a||a===1/0)&&(a=0);var s=Math.round(e/i*o);(0>s||s===1/0)&&(s=0);var l=r.$scrollRect;l||(l=egret.$TempRectangle),l.setTo(0,0,n,o);var h=r.x-l.x,u=r.y-l.y;switch(this._direction){case t.Direction.LTR:l.width=a,r.x=h;break;case t.Direction.RTL:l.width=a,l.x=n-a,r.x=l.x;break;case t.Direction.TTB:l.height=s,r.y=u;break;case t.Direction.BTT:l.height=s,l.y=o-s,r.y=l.y}r.scrollRect=l}this.labelDisplay&&(this.labelDisplay.text=this.valueToLabel(e,i))},i}(t.Range);t.ProgressBar=e,__reflect(e.prototype,"eui.ProgressBar")}(eui||(eui={}));var eui;!function(t){var e={},i=function(i){function r(){var t=i.call(this)||this;return t.$indexNumber=0,t.$radioButtonGroup=null,t._group=null,t.groupChanged=!1,t._groupName="radioGroup",t._value=null,t.groupName="radioGroup",t}return __extends(r,i),Object.defineProperty(r.prototype,"enabled",{get:function(){return this.$Component[3]?!this.$radioButtonGroup||this.$radioButtonGroup.$enabled:!1},set:function(t){this.$setEnabled(t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"group",{get:function(){if(!this._group&&this._groupName){var i=e[this._groupName];i||(i=new t.RadioButtonGroup,i.$name=this._groupName,e[this._groupName]=i),this._group=i}return this._group},set:function(t){this._group!=t&&(this.$radioButtonGroup&&this.$radioButtonGroup.$removeInstance(this,!1),this._group=t,this._groupName=t?this.group.$name:"radioGroup",this.groupChanged=!0,this.invalidateProperties(),this.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"groupName",{get:function(){return this._groupName},set:function(t){t&&""!=t&&(this._groupName=t,this.$radioButtonGroup&&this.$radioButtonGroup.$removeInstance(this,!1),this._group=null,this.groupChanged=!0,this.invalidateProperties(),this.invalidateDisplayList())},enumerable:!0,configurable:!0}),r.prototype.$setSelected=function(t){var e=i.prototype.$setSelected.call(this,t);return this.invalidateDisplayList(),e},Object.defineProperty(r.prototype,"value",{get:function(){return this._value},set:function(e){this._value!=e&&(this._value=e,this.$selected&&this.group&&t.PropertyEvent.dispatchPropertyEvent(this.group,t.PropertyEvent.PROPERTY_CHANGE,"selectedValue"))},enumerable:!0,configurable:!0}),r.prototype.commitProperties=function(){this.groupChanged&&(this.addToGroup(),this.groupChanged=!1),i.prototype.commitProperties.call(this)},r.prototype.updateDisplayList=function(t,e){i.prototype.updateDisplayList.call(this,t,e),this.group&&(this.$selected?this._group.$setSelection(this,!1):this.group.selection==this&&this._group.$setSelection(null,!1))},r.prototype.buttonReleased=function(){this.enabled&&!this.selected&&(this.$radioButtonGroup||this.addToGroup(),i.prototype.buttonReleased.call(this),this.group.$setSelection(this,!0))},r.prototype.addToGroup=function(){var t=this.group;return t&&t.$addInstance(this),t},r}(t.ToggleButton);t.RadioButton=i,__reflect(i.prototype,"eui.RadioButton")}(eui||(eui={}));var eui;!function(t){function e(t,i){var r=t.parent,n=i.parent;if(!r||!n)return 0;var o=t.$nestLevel,a=i.$nestLevel,s=0,l=0;return r==n&&(s=r.getChildIndex(t),l=n.getChildIndex(i)),o>a||s>l?1:a>o||l>s?-1:t==i?0:e(r,n)}var i=0,r=function(r){function n(){var t=r.call(this)||this;return t.$name=null,t.radioButtons=[],t.$enabled=!0,t._selectedValue=null,t._selection=null,t.$name="_radioButtonGroup"+i++,t}return __extends(n,r),n.prototype.getRadioButtonAt=function(t){return this.radioButtons[t]},Object.defineProperty(n.prototype,"enabled",{get:function(){return this.$enabled},set:function(t){if(t=!!t,this.$enabled!==t){this.$enabled=t;for(var e=this.radioButtons,i=e.length,r=0;i>r;r++)e[r].invalidateState()}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"numRadioButtons",{get:function(){return this.radioButtons.length},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectedValue",{get:function(){return this.selection?null!=this.selection.value?this.selection.value:this.selection.label:null},set:function(e){if(this._selectedValue=e,null==e)return void this.$setSelection(null,!1);for(var i=this.numRadioButtons,r=0;i>r;r++){var n=this.radioButtons[r];if(n.value==e||n.label==e){this.changeSelection(r,!1),this._selectedValue=null,t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"selectedValue");break}}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selection",{get:function(){return this._selection},set:function(t){this._selection!=t&&this.$setSelection(t,!1)},enumerable:!0,configurable:!0}),n.prototype.$addInstance=function(t){t.addEventListener(egret.Event.REMOVED,this.removedHandler,this);var i=this.radioButtons;i.push(t),i.sort(e);for(var r=i.length,n=0;r>n;n++)i[n].$indexNumber=n;this._selectedValue&&(this.selectedValue=this._selectedValue),1==t.selected&&(this.selection=t),t.$radioButtonGroup=this,t.invalidateState()},n.prototype.$removeInstance=function(t,e){if(t)for(var i=!1,r=this.radioButtons,n=r.length,o=0;n>o;o++){var a=r[o];i?a.$indexNumber=a.$indexNumber-1:a==t&&(e&&t.addEventListener(egret.Event.ADDED,this.addedHandler,this),t==this._selection&&(this._selection=null),t.$radioButtonGroup=null,t.invalidateState(),this.radioButtons.splice(o,1),i=!0,o--,n--)}},n.prototype.$setSelection=function(e,i){if(this._selection==e)return!1;if(e){for(var r=this.numRadioButtons,n=0;r>n;n++)if(e==this.getRadioButtonAt(n)){this.changeSelection(n,i);break}}else this._selection&&(this._selection.selected=!1,this._selection=null,i&&this.dispatchEventWith(egret.Event.CHANGE));return t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"selectedValue"),!0},n.prototype.changeSelection=function(t,e){var i=this.getRadioButtonAt(t);i&&i!=this._selection&&(this._selection&&(this._selection.selected=!1),this._selection=i,this._selection.selected=!0,e&&this.dispatchEventWith(egret.Event.CHANGE))},n.prototype.addedHandler=function(t){var e=t.target;e&&(e.removeEventListener(egret.Event.ADDED,this.addedHandler,this),this.$addInstance(e))},n.prototype.removedHandler=function(t){var e=t.target;e&&(e.removeEventListener(egret.Event.REMOVED,this.removedHandler,this),this.$removeInstance(e,!0))},n}(egret.EventDispatcher);t.RadioButtonGroup=r,__reflect(r.prototype,"eui.RadioButtonGroup"),t.registerBindable(r.prototype,"selectedValue"),egret.$markReadOnly(r,"numRadioButtons")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(e,i,r){var n=t.call(this)||this;return n.$fillColor=0,n.$fillAlpha=1,n.$strokeColor=4473924,n.$strokeAlpha=1,n.$strokeWeight=0,n.$ellipseWidth=0,n.$ellipseHeight=0,n.touchChildren=!1,n.$graphics=new egret.Graphics,n.$graphics.$setTarget(n),n.width=e,n.height=i,n.fillColor=r,n}return __extends(e,t),Object.defineProperty(e.prototype,"graphics",{get:function(){return this.$graphics},enumerable:!0,configurable:!0}),e.prototype.$measureContentBounds=function(t){this.$graphics&&t.setTo(0,0,this.width,this.height)},Object.defineProperty(e.prototype,"fillColor",{get:function(){return this.$fillColor},set:function(t){void 0!=t&&this.$fillColor!=t&&(this.$fillColor=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillAlpha",{get:function(){return this.$fillAlpha},set:function(t){this.$fillAlpha!=t&&(this.$fillAlpha=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strokeColor",{get:function(){return this.$strokeColor},set:function(t){this.$strokeColor!=t&&(this.$strokeColor=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strokeAlpha",{get:function(){return this.$strokeAlpha},set:function(t){this.$strokeAlpha!=t&&(this.$strokeAlpha=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strokeWeight",{get:function(){return this.$strokeWeight},set:function(t){this.$strokeWeight!=t&&(this.$strokeWeight=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ellipseWidth",{get:function(){return this.$ellipseWidth},set:function(t){this.$ellipseWidth!=t&&(this.$ellipseWidth=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ellipseHeight",{get:function(){return this.$ellipseHeight},set:function(t){this.$ellipseHeight!=t&&(this.$ellipseHeight=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),e.prototype.updateDisplayList=function(t,e){var i=this.graphics;i.clear(),this.$strokeWeight>0&&(i.beginFill(this.$fillColor,0),i.lineStyle(this.$strokeWeight,this.$strokeColor,this.$strokeAlpha,!0,"normal","square","miter"),0==this.$ellipseWidth&&0==this.$ellipseHeight?i.drawRect(this.$strokeWeight/2,this.$strokeWeight/2,t-this.$strokeWeight,e-this.$strokeWeight):i.drawRoundRect(this.$strokeWeight/2,this.$strokeWeight/2,t-this.$strokeWeight,e-this.$strokeWeight,this.$ellipseWidth,this.$ellipseHeight),i.endFill()),i.beginFill(this.$fillColor,this.$fillAlpha),i.lineStyle(this.$strokeWeight,this.$strokeColor,0,!0,"normal","square","miter"),0==this.$ellipseWidth&&0==this.$ellipseHeight?i.drawRect(this.$strokeWeight,this.$strokeWeight,t-2*this.$strokeWeight,e-2*this.$strokeWeight):i.drawRoundRect(this.$strokeWeight,this.$strokeWeight,t-2*this.$strokeWeight,e-2*this.$strokeWeight,this.$ellipseWidth,this.$ellipseHeight),i.endFill(),this.$invalidateContentBounds()},e}(t.Component);t.Rect=e,__reflect(e.prototype,"eui.Rect")}(eui||(eui={}));var eui;!function(t){var e,i=function(i){function r(){var e=i.call(this)||this;e.$bounces=!0,e.horizontalScrollBar=null,e.verticalScrollBar=null;var r=new t.sys.TouchScroll(e.horizontalUpdateHandler,e.horizontalEndHandler,e),n=new t.sys.TouchScroll(e.verticalUpdateHandler,e.verticalEndHanlder,e);return e.$Scroller={0:"auto",1:"auto",2:null,3:0,4:0,5:!1,6:!1,7:!1,8:r,9:n,10:null,11:!1,12:!1},e}return __extends(r,i),Object.defineProperty(r.prototype,"bounces",{get:function(){return this.$bounces},set:function(t){this.$bounces=!!t;var e=this.$Scroller[8];e&&(e.$bounces=this.$bounces);var i=this.$Scroller[9];i&&(i.$bounces=this.$bounces)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"throwSpeed",{get:function(){return this.$Scroller[8].$scrollFactor},set:function(t){t=+t,0>t&&(t=0),this.$Scroller[8].$scrollFactor=t,this.$Scroller[9].$scrollFactor=t},enumerable:!0,configurable:!0}),r.prototype.$getThrowInfo=function(i,r){return e?(e.currentPos=i,e.toPos=r):e=new t.ScrollerThrowEvent(t.ScrollerThrowEvent.THROW,!1,!1,i,r),e},Object.defineProperty(r.prototype,"scrollPolicyV",{get:function(){return this.$Scroller[0]},set:function(t){var e=this.$Scroller;e[0]!=t&&(e[0]=t,this.checkScrollPolicy())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scrollPolicyH",{get:function(){return this.$Scroller[1]},set:function(t){var e=this.$Scroller;e[1]!=t&&(e[1]=t,this.checkScrollPolicy())},enumerable:!0,configurable:!0}),r.prototype.stopAnimation=function(){var e=this.$Scroller,i=e[9],r=e[8];i.animation.isPlaying?t.UIEvent.dispatchUIEvent(this,t.UIEvent.CHANGE_END):r.animation.isPlaying&&t.UIEvent.dispatchUIEvent(this,t.UIEvent.CHANGE_END),i.stop(),r.stop();var n=this.verticalScrollBar,o=this.horizontalScrollBar;n&&n.autoVisibility&&(n.visible=!1),o&&o.autoVisibility&&(o.visible=!1)},Object.defineProperty(r.prototype,"viewport",{get:function(){return this.$Scroller[10]},set:function(t){var e=this.$Scroller;t!=e[10]&&(this.uninstallViewport(),e[10]=t,e[11]=!1,this.installViewport())},enumerable:!0,configurable:!0}),r.prototype.installViewport=function(){var t=this.viewport;t&&(this.addChildAt(t,0),t.scrollEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBeginCapture,this,!0),t.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEndCapture,this,!0),t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapCapture,this,!0),t.addEventListener(egret.Event.REMOVED,this.onViewPortRemove,this)),this.horizontalScrollBar&&(this.horizontalScrollBar.viewport=t),this.verticalScrollBar&&(this.verticalScrollBar.viewport=t)},r.prototype.uninstallViewport=function(){this.horizontalScrollBar&&(this.horizontalScrollBar.viewport=null),this.verticalScrollBar&&(this.verticalScrollBar.viewport=null);var t=this.viewport;t&&(t.scrollEnabled=!1,t.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBeginCapture,this,!0),t.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEndCapture,this,!0),t.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapCapture,this,!0),t.removeEventListener(egret.Event.REMOVED,this.onViewPortRemove,this),0==this.$Scroller[11]&&this.removeChild(t))},r.prototype.onViewPortRemove=function(t){t.target==this.viewport&&(this.$Scroller[11]=!0,this.viewport=null)},r.prototype.setSkin=function(t){i.prototype.setSkin.call(this,t);var e=this.viewport;e&&this.addChildAt(e,0)},r.prototype.onTouchBeginCapture=function(t){this.$Scroller[12]=!1;var e=this.checkScrollPolicy();e&&this.onTouchBegin(t)},r.prototype.onTouchEndCapture=function(t){this.$Scroller[12]&&(t.stopPropagation(),this.onTouchEnd(t))},r.prototype.onTouchTapCapture=function(t){this.$Scroller[12]&&t.stopPropagation()},r.prototype.checkScrollPolicy=function(){var t=this.$Scroller,e=t[10];if(!e)return!1;var i,r=e.$UIComponent;switch(t[1]){case"auto":i=e.contentWidth>r[10]||0!==e.scrollH?!0:!1;break;case"on":i=!0;break;case"off":i=!1}t[6]=i;var n;switch(t[0]){case"auto":n=e.contentHeight>r[11]||0!==e.scrollV?!0:!1;break;case"on":n=!0;break;case"off":n=!1}return t[7]=n,i||n},r.prototype.onTouchBegin=function(t){if(!t.isDefaultPrevented()&&this.checkScrollPolicy()){this.downTarget=t.target;var e=this.$Scroller;this.stopAnimation(),e[3]=t.$stageX,e[4]=t.$stageY,e[6]&&e[8].start(t.$stageX),e[7]&&e[9].start(t.$stageY);
var i=this.$stage;this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),i.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this,!0),this.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancel,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveListeners,this)}},r.prototype.onTouchMove=function(e){if(!e.isDefaultPrevented()){var i=this.$Scroller;if(!i[5]){var n=void 0;n=Math.abs(i[3]-e.$stageX)<r.scrollThreshold?!1:!0;var o=void 0;if(o=Math.abs(i[4]-e.$stageY)<r.scrollThreshold?!1:!0,!n&&!o)return;if(!o&&n&&"off"==i[1])return;if(!n&&o&&"off"==i[0])return;i[12]=!0,i[5]=!0,this.dispatchCancelEvent(e);var a=this.horizontalScrollBar,s=this.verticalScrollBar;a&&a.autoVisibility&&i[6]&&(a.visible=!0),s&&s.autoVisibility&&i[7]&&(s.visible=!0),i[2]&&i[2].reset(),t.UIEvent.dispatchUIEvent(this,t.UIEvent.CHANGE_START),this.$stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this)}e.preventDefault();var l=i[10],h=l.$UIComponent;i[6]&&i[8].update(e.$stageX,l.contentWidth-h[10],l.scrollH),i[7]&&i[9].update(e.$stageY,l.contentHeight-h[11],l.scrollV)}},r.prototype.onTouchCancel=function(){this.$Scroller[5]||this.onRemoveListeners()},r.prototype.dispatchCancelEvent=function(t){var e=this.$Scroller[10];if(e){for(var i=new egret.TouchEvent(egret.TouchEvent.TOUCH_CANCEL,t.bubbles,t.cancelable),r=this.downTarget,n=this.$getPropagationList(r),o=n.length,a=.5*n.length,s=-1,l=0;o>l;l++)if(n[l]===e){s=l;break}n.splice(0,s+1),a-=s+1,this.$dispatchPropagationEvent(i,n,a),egret.Event.release(i)}},r.prototype.onTouchEnd=function(){var t=this.$Scroller;t[5]=!1,this.onRemoveListeners();var e=t[10],i=e.$UIComponent;t[8].isStarted()&&t[8].finish(e.scrollH,e.contentWidth-i[10]),t[9].isStarted()&&t[9].finish(e.scrollV,e.contentHeight-i[11])},r.prototype.onRemoveListeners=function(){var t=this.$stage;this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),t.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this,!0),t.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancel,!0),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveListeners,this)},r.prototype.horizontalUpdateHandler=function(t){this.$Scroller[10].scrollH=t,this.dispatchEventWith(egret.Event.CHANGE)},r.prototype.verticalUpdateHandler=function(t){this.$Scroller[10].scrollV=t,this.dispatchEventWith(egret.Event.CHANGE)},r.prototype.horizontalEndHandler=function(){this.$Scroller[9].isPlaying()||this.onChangeEnd()},r.prototype.verticalEndHanlder=function(){this.$Scroller[8].isPlaying()||this.onChangeEnd()},r.prototype.onChangeEnd=function(){var e=this.$Scroller,i=this.horizontalScrollBar,r=this.verticalScrollBar;(i&&i.visible||r&&r.visible)&&(e[2]||(e[2]=new egret.Timer(200,1),e[2].addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.onAutoHideTimer,this)),e[2].reset(),e[2].start()),t.UIEvent.dispatchUIEvent(this,t.UIEvent.CHANGE_END)},r.prototype.onAutoHideTimer=function(){var t=this.horizontalScrollBar,e=this.verticalScrollBar;t&&t.autoVisibility&&(t.visible=!1),e&&e.autoVisibility&&(e.visible=!1)},r.prototype.updateDisplayList=function(t,e){i.prototype.updateDisplayList.call(this,t,e);var r=this.viewport;r&&(r.setLayoutBoundsSize(t,e),r.setLayoutBoundsPosition(0,0))},r.prototype.partAdded=function(t,e){i.prototype.partAdded.call(this,t,e),e==this.horizontalScrollBar?(this.horizontalScrollBar.touchChildren=!1,this.horizontalScrollBar.touchEnabled=!1,this.horizontalScrollBar.viewport=this.viewport,this.horizontalScrollBar.autoVisibility&&(this.horizontalScrollBar.visible=!1)):e==this.verticalScrollBar&&(this.verticalScrollBar.touchChildren=!1,this.verticalScrollBar.touchEnabled=!1,this.verticalScrollBar.viewport=this.viewport,this.verticalScrollBar.autoVisibility&&(this.verticalScrollBar.visible=!1))},r}(t.Component);i.scrollThreshold=5,t.Scroller=i,__reflect(i.prototype,"eui.Scroller"),t.registerProperty(i,"viewport","eui.IViewport",!0)}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var i=e.apply(this,arguments)||this;return i.maxWidth=1e5,i.minWidth=0,i.maxHeight=1e5,i.minHeight=0,i.width=0/0,i.height=0/0,i.$elementsContent=[],i._hostComponent=null,i.$stateValues=new t.sys.StateValues,i}return __extends(i,e),Object.defineProperty(i.prototype,"elementsContent",{set:function(t){this.$elementsContent=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"hostComponent",{get:function(){return this._hostComponent},set:function(e){if(this._hostComponent!=e){this._hostComponent&&this._hostComponent.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddedToStage,this),this._hostComponent=e;var i=this.$stateValues;i.parent=e,e&&(this.commitCurrentState(),this.$stateValues.intialized||(e.$stage?this.initializeStates(e.$stage):e.once(egret.Event.ADDED_TO_STAGE,this.onAddedToStage,this))),t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"hostComponent")}},enumerable:!0,configurable:!0}),i.prototype.onAddedToStage=function(){this.initializeStates(this._hostComponent.$stage)},i}(egret.EventDispatcher);t.Skin=e,__reflect(e.prototype,"eui.Skin"),t.sys.mixin(e,t.sys.StateClient),t.registerProperty(e,"elementsContent","Array",!0),t.registerProperty(e,"states","State[]"),t.registerBindable(e.prototype,"hostComponent")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.indexBeingUpdated=!1,t.requireSelection=!0,t.useVirtualLayout=!1,t}return __extends(i,e),i.prototype.createChildren=function(){if(!this.$layout){var i=new t.HorizontalLayout;i.gap=0,i.horizontalAlign=t.JustifyAlign.JUSTIFY,i.verticalAlign=t.JustifyAlign.CONTENT_JUSTIFY,this.$setLayout(i)}e.prototype.createChildren.call(this)},i.prototype.$setDataProvider=function(i){var r=this.$dataProvider;return r&&r instanceof t.ViewStack&&(r.removeEventListener(t.PropertyEvent.PROPERTY_CHANGE,this.onViewStackIndexChange,this),this.removeEventListener(egret.Event.CHANGE,this.onIndexChanged,this)),i&&i instanceof t.ViewStack&&(i.addEventListener(t.PropertyEvent.PROPERTY_CHANGE,this.onViewStackIndexChange,this),this.addEventListener(egret.Event.CHANGE,this.onIndexChanged,this)),e.prototype.$setDataProvider.call(this,i)},i.prototype.onIndexChanged=function(){this.indexBeingUpdated=!0,this.$dataProvider.selectedIndex=this.selectedIndex,this.indexBeingUpdated=!1},i.prototype.onViewStackIndexChange=function(t){"selectedIndex"!=t.property||this.indexBeingUpdated||this.setSelectedIndex(this.$dataProvider.selectedIndex,!1)},i}(t.ListBase);t.TabBar=e,__reflect(e.prototype,"eui.TabBar")}(eui||(eui={}));var eui;!function(t){var e=egret.FocusEvent,i=function(i){function r(){var t=i.call(this)||this;return t.isFocus=!1,t.$TextInput={0:null,1:null,2:null,3:null,4:null,5:null,6:"",7:null,8:egret.TextFieldInputType.TEXT},t}return __extends(r,i),Object.defineProperty(r.prototype,"prompt",{get:function(){return this.promptDisplay?this.promptDisplay.text:this.$TextInput[0]},set:function(t){this.$TextInput[0]=t,this.promptDisplay&&(this.promptDisplay.text=t),this.invalidateProperties(),this.invalidateState()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"displayAsPassword",{get:function(){if(this.textDisplay)return this.textDisplay.displayAsPassword;var t=this.$TextInput[1];return t?t:!1},set:function(t){this.$TextInput[1]=t,this.textDisplay&&(this.textDisplay.displayAsPassword=t),this.invalidateProperties()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"inputType",{get:function(){return this.textDisplay?this.textDisplay.inputType:this.$TextInput[8]},set:function(t){this.$TextInput[8]=t,this.textDisplay&&(this.textDisplay.inputType=t),this.invalidateProperties()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"textColor",{get:function(){return this.textDisplay?this.textDisplay.textColor:this.$TextInput[2]},set:function(t){this.$TextInput[2]=t,this.textDisplay&&(this.textDisplay.textColor=t),this.invalidateProperties()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxChars",{get:function(){if(this.textDisplay)return this.textDisplay.maxChars;var t=this.$TextInput[3];return t?t:0},set:function(t){this.$TextInput[3]=t,this.textDisplay&&(this.textDisplay.maxChars=t),this.invalidateProperties()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxWidth",{get:function(){if(this.textDisplay)return this.textDisplay.maxWidth;var t=this.$TextInput[4];return t?t:1e5},set:function(t){this.$TextInput[4]=t,this.textDisplay&&(this.textDisplay.maxWidth=t),this.invalidateProperties()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxHeight",{get:function(){this.textDisplay;var t=this.$TextInput[5];return t?t:1e5},set:function(t){this.$TextInput[5]=t,this.textDisplay&&(this.textDisplay.maxHeight=t),this.invalidateProperties()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"text",{get:function(){return this.textDisplay?this.textDisplay.text:this.$TextInput[6]},set:function(t){this.$TextInput[6]=t,this.textDisplay&&(this.textDisplay.text=t),this.invalidateProperties(),this.invalidateState()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"restrict",{get:function(){return this.textDisplay?this.textDisplay.restrict:this.$TextInput[7]},set:function(t){this.$TextInput[7]=t,this.textDisplay&&(this.textDisplay.restrict=t),this.invalidateProperties()},enumerable:!0,configurable:!0}),r.prototype.focusInHandler=function(){this.isFocus=!0,this.invalidateState()},r.prototype.focusOutHandler=function(){this.isFocus=!1,this.invalidateState()},r.prototype.getCurrentState=function(){var t=this.skin;return!this.prompt||this.isFocus||this.text?this.enabled?"normal":"disabled":this.enabled&&t.hasState("normalWithPrompt")?"normalWithPrompt":!this.enabled&&t.hasState("disabledWithPrompt")?"disabledWithPrompt":void 0},r.prototype.partAdded=function(r,n){i.prototype.partAdded.call(this,r,n);var o=this.$TextInput;n==this.textDisplay?(this.textDisplayAdded(),this.textDisplay instanceof t.EditableText&&(this.textDisplay.addEventListener(e.FOCUS_IN,this.focusInHandler,this),this.textDisplay.addEventListener(e.FOCUS_OUT,this.focusOutHandler,this))):n==this.promptDisplay&&o[0]&&(this.promptDisplay.text=o[0])},r.prototype.partRemoved=function(r,n){i.prototype.partRemoved.call(this,r,n),n==this.textDisplay?(this.textDisplayRemoved(),this.textDisplay instanceof t.EditableText&&(this.textDisplay.removeEventListener(e.FOCUS_IN,this.focusInHandler,this),this.textDisplay.removeEventListener(e.FOCUS_OUT,this.focusOutHandler,this))):n==this.promptDisplay&&(this.$TextInput[0]=this.promptDisplay.text)},r.prototype.textDisplayAdded=function(){var t=this.$TextInput;t[1]&&(this.textDisplay.displayAsPassword=t[1]),t[2]&&(this.textDisplay.textColor=t[2]),t[3]&&(this.textDisplay.maxChars=t[3]),t[4]&&(this.textDisplay.maxWidth=t[4]),t[5]&&(this.textDisplay.maxHeight=t[5]),t[6]&&(this.textDisplay.text=t[6]),t[7]&&(this.textDisplay.restrict=t[7]),t[8]&&(this.textDisplay.inputType=t[8])},r.prototype.textDisplayRemoved=function(){var t=this.$TextInput;t[1]=this.textDisplay.displayAsPassword,t[2]=this.textDisplay.textColor,t[3]=this.textDisplay.maxChars,t[4]=this.textDisplay.maxWidth,t[5]=this.textDisplay.maxHeight,t[6]=this.textDisplay.text,t[7]=this.textDisplay.restrict,t[8]=this.textDisplay.inputType},r}(t.Component);t.TextInput=i,__reflect(i.prototype,"eui.TextInput")}(eui||(eui={}));var eui;!function(t){function e(e){for(var i=e[0],r=i instanceof t.Watcher?i.getValue():i,n=e.length,o=1;n>o;o++){var a=e[o];a instanceof t.Watcher&&(a=a.getValue()),r+=a}return r}var i=function(){function i(){}return i.bindProperty=function(e,i,r,n){var o=t.Watcher.watch(e,i,null,null);if(o){var a=function(t){r[n]=t};o.setHandler(a,null),a(o.getValue())}return o},i.bindHandler=function(e,i,r,n){var o=t.Watcher.watch(e,i,r,n);return o&&r.call(n,o.getValue()),o},i.$bindProperties=function(r,n,o,a,s){if(1==n.length&&1==o.length)return i.bindProperty(r,n[0].split("."),a,s);for(var l,h=function(){a[s]=e(n)},u=o.length,c=0;u>c;c++){var p=o[c],d=n[p].split(".");l=t.Watcher.watch(r,d,null,null),l&&(n[p]=l,l.setHandler(h,null))}return h(),l},i}();t.Binding=i,__reflect(i.prototype,"eui.Binding")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(t.ToggleButton);t.ToggleSwitch=e,__reflect(e.prototype,"eui.ToggleSwitch")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e.addEventListener(egret.Event.REMOVED_FROM_STAGE,e.onRemoveFromStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(){this.$stage.addEventListener(egret.Event.RESIZE,this.onResize,this),this.onResize()},e.prototype.onRemoveFromStage=function(){this.$stage.removeEventListener(egret.Event.RESIZE,this.onResize,this)},e.prototype.onResize=function(){var t=this.$stage;this.$setWidth(t.$stageWidth),this.$setHeight(t.$stageHeight)},e}(t.Group);t.UILayer=e,__reflect(e.prototype,"eui.UILayer")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){return t.apply(this,arguments)||this}return __extends(e,t),e.prototype.updateDisplayList=function(e,i){t.prototype.updateDisplayList.call(this,e,i);var r=this.thumb,n=this.$viewport;if(r&&n){var o=egret.$TempRectangle;r.getPreferredBounds(o);var a=o.height,s=o.x,l=n.scrollV,h=n.contentHeight,u=n.height;if(0>=l){var c=a*(1- -l/(.5*u));c=Math.max(5,Math.round(c)),r.setLayoutBoundsSize(0/0,c),r.setLayoutBoundsPosition(s,0)}else if(l>=h-u){var c=a*(1-(l-h+u)/(.5*u));c=Math.max(5,Math.round(c)),r.setLayoutBoundsSize(0/0,c),r.setLayoutBoundsPosition(s,i-c)}else{var p=(i-a)*l/(h-u);r.setLayoutBoundsSize(0/0,0/0),r.setLayoutBoundsPosition(s,p)}}},e.prototype.onPropertyChanged=function(t){switch(t.property){case"scrollV":case"contentHeight":this.invalidateDisplayList()}},e}(t.ScrollBarBase);t.VScrollBar=e,__reflect(e.prototype,"eui.VScrollBar")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.pointToValue=function(t,e){if(!this.thumb||!this.track)return 0;var i=this.$Range,r=i[0]-i[2],n=this.getThumbRange();return i[2]+(0!=n?(n-e)/n*r:0)},e.prototype.getThumbRange=function(){var t=egret.$TempRectangle;this.track.getLayoutBounds(t);var e=t.height;return this.thumb.getLayoutBounds(t),e-t.height},e.prototype.updateSkinDisplayList=function(){if(this.thumb&&this.track){var t=this.$Range,e=this.getThumbRange(),i=t[0]-t[2],r=i>0?e-(this.pendingValue-t[2])/i*e:0,n=this.track.localToGlobal(0,r,egret.$TempPoint),o=n.x,a=n.y,s=this.thumb.$parent.globalToLocal(o,a,egret.$TempPoint).y,l=egret.$TempRectangle,h=l.height;if(this.thumb.getLayoutBounds(l),this.thumb.setLayoutBoundsPosition(l.x,Math.round(s)),this.trackHighlight){var u=this.trackHighlight.$parent.globalToLocal(o,a,egret.$TempPoint).y;this.trackHighlight.y=Math.round(u+h),this.trackHighlight.height=Math.round(e-u)}}},e}(t.SliderBase);t.VSlider=e,__reflect(e.prototype,"eui.VSlider")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i._selectedChild=null,i.proposedSelectedIndex=t.ListBase.NO_PROPOSED_SELECTION,i._selectedIndex=-1,i}return __extends(i,e),Object.defineProperty(i.prototype,"layout",{get:function(){return this.$layout},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectedChild",{get:function(){var t=this.selectedIndex;return t>=0&&t<this.numChildren?this.getChildAt(t):null},set:function(t){var e=this.getChildIndex(t);e>=0&&e<this.numChildren&&this.setSelectedIndex(e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectedIndex",{get:function(){return this.proposedSelectedIndex!=t.ListBase.NO_PROPOSED_SELECTION?this.proposedSelectedIndex:this._selectedIndex},set:function(t){t=0|+t,this.setSelectedIndex(t)},enumerable:!0,configurable:!0}),i.prototype.setSelectedIndex=function(e){e!=this.selectedIndex&&(this.proposedSelectedIndex=e,this.invalidateProperties(),t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"selectedIndex"))},i.prototype.$childAdded=function(i,r){e.prototype.$childAdded.call(this,i,r),this.showOrHide(i,!1);var n=this.selectedIndex;-1==n?this.setSelectedIndex(r):r<=this.selectedIndex&&this.$stage&&this.setSelectedIndex(n+1),t.CollectionEvent.dispatchCollectionEvent(this,t.CollectionEvent.COLLECTION_CHANGE,t.CollectionEventKind.ADD,r,-1,[i.name])},i.prototype.$childRemoved=function(i,r){e.prototype.$childRemoved.call(this,i,r),this.showOrHide(i,!0);var n=this.selectedIndex;r==n?this.numChildren>0?0==r?(this.proposedSelectedIndex=0,this.invalidateProperties()):this.setSelectedIndex(0):this.setSelectedIndex(-1):n>r&&this.setSelectedIndex(n-1),t.CollectionEvent.dispatchCollectionEvent(this,t.CollectionEvent.COLLECTION_CHANGE,t.CollectionEventKind.REMOVE,r,-1,[i.name])},i.prototype.commitProperties=function(){e.prototype.commitProperties.call(this),this.proposedSelectedIndex!=t.ListBase.NO_PROPOSED_SELECTION&&(this.commitSelection(this.proposedSelectedIndex),this.proposedSelectedIndex=t.ListBase.NO_PROPOSED_SELECTION)},i.prototype.commitSelection=function(t){t>=0&&t<this.numChildren?(this._selectedIndex=t,this._selectedChild&&this.showOrHide(this._selectedChild,!1),this._selectedChild=this.getElementAt(this._selectedIndex),this.showOrHide(this._selectedChild,!0)):(this._selectedChild=null,this._selectedIndex=-1),this.invalidateSize(),this.invalidateDisplayList()},i.prototype.showOrHide=function(t,e){egret.is(t,"eui.UIComponent")&&(t.includeInLayout=e),t.visible=e},Object.defineProperty(i.prototype,"length",{get:function(){return this.$children.length},enumerable:!0,configurable:!0}),i.prototype.getItemAt=function(t){var e=this.$children[t];return e?e.name:""},i.prototype.getItemIndex=function(t){for(var e=this.$children,i=e.length,r=0;i>r;r++)if(e[r].name==t)return r;return-1},i}(t.Group);t.ViewStack=e,__reflect(e.prototype,"eui.ViewStack",["eui.ICollection","egret.IEventDispatcher"]),t.registerBindable(e.prototype,"selectedIndex"),egret.$markReadOnly(e,"length"),egret.$markReadOnly(e,"layout")}(eui||(eui={}));var eui;!function(t){var e;!function(t){function e(t){return-.5*(Math.cos(Math.PI*t)-1)}var i=function(){function t(t,i){this.easerFunction=e,this.isPlaying=!1,this.duration=500,this.currentValue=0,this.from=0,this.to=0,this.startTime=0,this.endFunction=null,this.updateFunction=t,this.thisObject=i}return t.prototype.play=function(){this.stop(),this.start()},t.prototype.start=function(){this.isPlaying=!1,this.currentValue=0,this.startTime=egret.getTimer(),this.doInterval(this.startTime),egret.startTick(this.doInterval,this)},t.prototype.stop=function(){this.isPlaying=!1,this.startTime=0,egret.stopTick(this.doInterval,this)},t.prototype.doInterval=function(t){var e=t-this.startTime;this.isPlaying||(this.isPlaying=!0);var i=this.duration,r=0==i?1:Math.min(e,i)/i;this.easerFunction&&(r=this.easerFunction(r)),this.currentValue=this.from+(this.to-this.from)*r,this.updateFunction&&this.updateFunction.call(this.thisObject,this);var n=e>=i;return n&&this.stop(),n&&this.endFunction&&this.endFunction.call(this.thisObject,this),!0},t}();t.Animation=i,__reflect(i.prototype,"eui.sys.Animation")}(e=t.sys||(t.sys={}))}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(t.ToggleButton);t.CheckBox=e,__reflect(e.prototype,"eui.CheckBox")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i._source=t?t:[],i}return __extends(i,e),Object.defineProperty(i.prototype,"source",{get:function(){return this._source},set:function(e){e||(e=[]),this._source=e,this.dispatchCoEvent(t.CollectionEventKind.RESET)},enumerable:!0,configurable:!0}),i.prototype.refresh=function(){this.dispatchCoEvent(t.CollectionEventKind.REFRESH)},Object.defineProperty(i.prototype,"length",{get:function(){return this._source.length},enumerable:!0,configurable:!0}),i.prototype.addItem=function(e){this._source.push(e),this.dispatchCoEvent(t.CollectionEventKind.ADD,this._source.length-1,-1,[e])},i.prototype.addItemAt=function(e,i){(0>i||i>this._source.length)&&egret.$error(1007),this._source.splice(i,0,e),this.dispatchCoEvent(t.CollectionEventKind.ADD,i,-1,[e])},i.prototype.getItemAt=function(t){return this._source[t]},i.prototype.getItemIndex=function(t){for(var e=this._source.length,i=0;e>i;i++)if(this._source[i]===t)return i;return-1},i.prototype.itemUpdated=function(e){var i=this.getItemIndex(e);-1!=i&&this.dispatchCoEvent(t.CollectionEventKind.UPDATE,i,-1,[e])},i.prototype.removeAll=function(){var e=this._source.concat();this._source=[],this.dispatchCoEvent(t.CollectionEventKind.REMOVE,0,-1,e)},i.prototype.removeItemAt=function(e){if(0>e||e>=this._source.length)return void egret.$error(1007);var i=this._source.splice(e,1)[0];return this.dispatchCoEvent(t.CollectionEventKind.REMOVE,e,-1,[i]),i},i.prototype.replaceItemAt=function(e,i){if(0>i||i>=this._source.length)return void egret.$error(1007);var r=this._source.splice(i,1,e)[0];return this.dispatchCoEvent(t.CollectionEventKind.REPLACE,i,-1,[e],[r]),r},i.prototype.replaceAll=function(t){t||(t=[]);for(var e=t.length,i=this._source.length,r=e;i>r;r++)this.removeItemAt(e);for(var r=0;e>r;r++)r>=i?this.addItemAt(t[r],r):this.replaceItemAt(t[r],r);this._source=t},i.prototype.dispatchCoEvent=function(e,i,r,n,o){t.CollectionEvent.dispatchCollectionEvent(this,t.CollectionEvent.COLLECTION_CHANGE,e,i,r,n,o)},i}(egret.EventDispatcher);t.ArrayCollection=e,__reflect(e.prototype,"eui.ArrayCollection",["eui.ICollection","egret.IEventDispatcher"]),t.registerProperty(e,"source","Array",!0),egret.$markReadOnly(e,"length")}(eui||(eui={}));var eui;!function(t){var e=t.sys.UIComponentImpl,i=function(i){function r(){var t=i.call(this)||this;return t._widthConstraint=0/0,t.$isShowPrompt=!1,t.$promptColor=6710886,t.$isFocusIn=!1,t.initializeUIValues(),t.type=egret.TextFieldType.INPUT,t.$EditableText={0:null,1:16777215,2:!1},t}return __extends(r,i),r.prototype.$invalidateContentBounds=function(){i.prototype.$invalidateContentBounds.call(this),this.invalidateSize()},r.prototype.$setWidth=function(t){var r=i.prototype.$setWidth.call(this,t),n=e.prototype.$setWidth.call(this,t);return r&&n},r.prototype.$setHeight=function(t){var r=i.prototype.$setHeight.call(this,t),n=e.prototype.$setHeight.call(this,t);return r&&n},r.prototype.$getText=function(){var t=i.prototype.$getText.call(this);return t==this.$EditableText[0]&&(t=""),t},r.prototype.$setText=function(e){var r=this.$EditableText[0];(r!=e||null==r)&&(this.$isShowPrompt=!1,this.textColor=this.$EditableText[1],this.displayAsPassword=this.$EditableText[2]),this.$isFocusIn||(""==e||null==e)&&(e=r,this.$isShowPrompt=!0,i.prototype.$setTextColor.call(this,this.$promptColor),i.prototype.$setDisplayAsPassword.call(this,!1));var n=i.prototype.$setText.call(this,e);return t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"text"),n},r.prototype.$onAddToStage=function(e,i){t.sys.UIComponentImpl.prototype.$onAddToStage.call(this,e,i),this.addEventListener(egret.FocusEvent.FOCUS_IN,this.onfocusIn,this),this.addEventListener(egret.FocusEvent.FOCUS_OUT,this.onfocusOut,this)},r.prototype.$onRemoveFromStage=function(){t.sys.UIComponentImpl.prototype.$onRemoveFromStage.call(this),this.removeEventListener(egret.FocusEvent.FOCUS_IN,this.onfocusIn,this),this.removeEventListener(egret.FocusEvent.FOCUS_OUT,this.onfocusOut,this)},Object.defineProperty(r.prototype,"prompt",{get:function(){return this.$EditableText[0]},set:function(t){var e=this.$EditableText,i=e[0];if(i!=t){e[0]=t;var r=this.text;r&&r!=i||this.showPromptText()}},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"promptColor",{get:function(){return this.$promptColor},set:function(t){if(t=0|+t,this.$promptColor!=t){this.$promptColor=t;var e=this.text;e&&e!=this.$EditableText[0]||this.showPromptText()}},enumerable:!0,configurable:!0}),r.prototype.onfocusOut=function(){this.$isFocusIn=!1,this.text||this.showPromptText()},r.prototype.onfocusIn=function(){this.$isFocusIn=!0,this.$isShowPrompt=!1,this.displayAsPassword=this.$EditableText[2];var t=this.$EditableText,e=this.text;e&&e!=t[0]||(this.textColor=t[1],this.text="")},r.prototype.showPromptText=function(){var t=this.$EditableText;this.$isShowPrompt=!0,i.prototype.$setTextColor.call(this,this.$promptColor),i.prototype.$setDisplayAsPassword.call(this,!1),this.text=t[0]},r.prototype.$setTextColor=function(t){return t=0|+t,this.$EditableText[1]=t,this.$isShowPrompt||i.prototype.$setTextColor.call(this,t),!0},r.prototype.$setDisplayAsPassword=function(t){return this.$EditableText[2]=t,this.$isShowPrompt||i.prototype.$setDisplayAsPassword.call(this,t),!0},r.prototype.createChildren=function(){this.onfocusOut()},r.prototype.childrenCreated=function(){},r.prototype.commitProperties=function(){},r.prototype.measure=function(){var t=this.$UIComponent,e=this.$TextField,r=e[3],n=0/0;isNaN(this._widthConstraint)?isNaN(t[8])?1e5!=t[13]&&(n=t[13]):n=t[8]:(n=this._widthConstraint,this._widthConstraint=0/0),i.prototype.$setWidth.call(this,n),this.setMeasuredSize(this.textWidth,this.textHeight),i.prototype.$setWidth.call(this,r)},r.prototype.updateDisplayList=function(t,e){i.prototype.$setWidth.call(this,t),i.prototype.$setHeight.call(this,e)},r.prototype.invalidateParentLayout=function(){},r.prototype.setMeasuredSize=function(){},r.prototype.invalidateProperties=function(){},r.prototype.validateProperties=function(){},r.prototype.invalidateSize=function(){},r.prototype.validateSize=function(){},r.prototype.invalidateDisplayList=function(){},r.prototype.validateDisplayList=function(){},r.prototype.validateNow=function(){},r.prototype.setLayoutBoundsSize=function(t,i){if(e.prototype.setLayoutBoundsSize.call(this,t,i),!isNaN(t)&&t!==this._widthConstraint&&0!=t){var r=this.$UIComponent;isNaN(r[9])&&t!=r[16]&&(this._widthConstraint=t,this.invalidateSize())}},r.prototype.setLayoutBoundsPosition=function(){},r.prototype.getLayoutBounds=function(){},r.prototype.getPreferredBounds=function(){},r}(egret.TextField);t.EditableText=i,__reflect(i.prototype,"eui.EditableText",["eui.UIComponent","eui.IDisplayText"]),t.sys.implementUIComponent(i,egret.TextField),t.registerBindable(i.prototype,"text")}(eui||(eui={}));var eui;!function(t){function e(t,i){var r=Object.getOwnPropertyDescriptor(t,i);if(r)return r;var n=Object.getPrototypeOf(t);return n?e(n,i):null}function i(t,e){for(var i=t[r],n=i.length,o=0;n>o;o+=2){var a=i[o],s=i[o+1];a.call(s,e)}}var r="__listeners__",n="__bindables__",o=0,a=function(){function a(t,e,i,r){this.isExecuting=!1,this.property=t,this.handler=e,this.next=r,this.thisObject=i}return a.watch=function(t,e,i,r){if(e||egret.$error(1003,"chain"),e.length>0){var n=e.shift(),o=a.watch(null,e,i,r),s=new a(n,i,r,o);return s.reset(t),s}return null},a.checkBindable=function(a,s){var l=a[n];if(l&&-1!=l.indexOf(s))return!0;var h=egret.is(a,"egret.IEventDispatcher");h||a[r]||(a[r]=[]);var u=e(a,s);if(u&&u.set&&u.get){var c=u.set;u.set=function(e){this[s]!=e&&(c.call(this,e),h?t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,s):i(this,s))}}else{if(u&&(u.get||u.set))return!1;o++;var p="_"+o+s;a[p]=u?u.value:null,u={enumerable:!0,configurable:!0},u.get=function(){return this[p]},u.set=function(e){this[p]!=e&&(this[p]=e,h?t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,s):i(this,s))}}Object.defineProperty(a,s,u),t.registerBindable(a,s)},a.prototype.unwatch=function(){this.reset(null),this.handler=null,this.next&&(this.next.handler=null)},a.prototype.getValue=function(){return this.next?this.next.getValue():this.getHostPropertyValue()},a.prototype.setHandler=function(t,e){this.handler=t,this.thisObject=e,this.next&&this.next.setHandler(t,e)},a.prototype.reset=function(e){var i=this.host;if(i)if(egret.is(i,"egret.IEventDispatcher"))i.removeEventListener(t.PropertyEvent.PROPERTY_CHANGE,this.wrapHandler,this);else{var n=i[r],o=n.indexOf(this);n.splice(o-1,2)}if(this.host=e,e)if(a.checkBindable(e,this.property),egret.is(e,"egret.IEventDispatcher"))e.addEventListener(t.PropertyEvent.PROPERTY_CHANGE,this.wrapHandler,this,!1,100);else{var n=e[r];n.push(this.onPropertyChange),n.push(this)}this.next&&this.next.reset(this.getHostPropertyValue())},a.prototype.getHostPropertyValue=function(){return this.host?this.host[this.property]:null},a.prototype.wrapHandler=function(t){this.onPropertyChange(t.property)},a.prototype.onPropertyChange=function(t){if(t==this.property&&!this.isExecuting)try{this.isExecuting=!0,this.next&&this.next.reset(this.getHostPropertyValue()),this.handler.call(this.thisObject,this.getValue())}finally{this.isExecuting=!1}},a}();t.Watcher=a,__reflect(a.prototype,"eui.Watcher")}(eui||(eui={}));var eui;!function(t){var e;!function(t){function e(t){var e=t-1;return e*e*e+1}var i=4,r=[1,1.33,1.66,2],n=2.33,o=.02,a=.998,s=.95,l=Math.log(a),h=function(){function h(i,r,n){this.$scrollFactor=1,this.previousTime=0,this.velocity=0,this.previousVelocity=[],this.currentPosition=0,this.previousPosition=0,this.currentScrollPos=0,this.maxScrollPos=0,this.offsetPoint=0,this.$bounces=!0,this.started=!0,i||egret.$error(1003,"updateFunction"),this.updateFunction=i,this.endFunction=r,this.target=n,this.animation=new t.Animation(this.onScrollingUpdate,this),this.animation.endFunction=this.finishScrolling,this.animation.easerFunction=e}return h.prototype.isPlaying=function(){return this.animation.isPlaying},h.prototype.stop=function(){this.animation.stop(),egret.stopTick(this.onTick,this),this.started=!1},h.prototype.isStarted=function(){return this.started},h.prototype.start=function(t){this.started=!0,this.velocity=0,this.previousVelocity.length=0,this.previousTime=egret.getTimer(),this.previousPosition=this.currentPosition=t,this.offsetPoint=t,egret.startTick(this.onTick,this)},h.prototype.update=function(t,e,i){e=Math.max(e,0),this.currentPosition=t,this.maxScrollPos=e;var r=this.offsetPoint-t,n=r+i;this.offsetPoint=t,0>n&&(this.$bounces?n-=.5*r:n=0),n>e&&(this.$bounces?n-=.5*r:n=e),this.currentScrollPos=n,this.updateFunction.call(this.target,n)},h.prototype.finish=function(t,e){egret.stopTick(this.onTick,this),this.started=!1;for(var i=this.velocity*n,h=this.previousVelocity,u=h.length,c=n,p=0;u>p;p++){var d=r[p];i+=h[0]*d,c+=d}var f=i/c,g=Math.abs(f),y=0,v=0;if(g>o)if(v=t+(f-o)/l*2*this.$scrollFactor,0>v||v>e)for(v=t;Math.abs(f)>o;)v-=f,f*=0>v||v>e?a*s:a,y++;else y=Math.log(o/g)/l;else v=t;if(this.target.$getThrowInfo){var m=this.target.$getThrowInfo(t,v);v=m.toPos}y>0?(this.$bounces||(0>v?v=0:v>e&&(v=e)),this.throwTo(v,y)):this.finishScrolling()},h.prototype.onTick=function(t){var e=t-this.previousTime;if(e>10){var r=this.previousVelocity;r.length>=i&&r.shift(),this.velocity=(this.currentPosition-this.previousPosition)/e,r.push(this.velocity),this.previousTime=t,this.previousPosition=this.currentPosition}return!0},h.prototype.finishScrolling=function(){var t=this.currentScrollPos,e=this.maxScrollPos,i=t;0>t&&(i=0),t>e&&(i=e),this.throwTo(i,300)},h.prototype.throwTo=function(t,e){void 0===e&&(e=500);var i=this.currentScrollPos;if(i==t)return void this.endFunction.call(this.target);var r=this.animation;r.duration=e,r.from=i,r.to=t,r.play()},h.prototype.onScrollingUpdate=function(t){this.currentScrollPos=t.currentValue,this.updateFunction.call(this.target,t.currentValue)},h}();t.TouchScroll=h,__reflect(h.prototype,"eui.sys.TouchScroll")}(e=t.sys||(t.sys={}))}(eui||(eui={}));var eui;!function(t){var e=function(){function t(){}return t}();e.LTR="ltr",e.RTL="rtl",e.TTB="ttb",e.BTT="btt",t.Direction=e,__reflect(e.prototype,"eui.Direction")}(eui||(eui={}));var eui;!function(t){var e=function(){function t(){}return t
}();e.AUTO="auto",e.OFF="off",e.ON="on",t.ScrollPolicy=e,__reflect(e.prototype,"eui.ScrollPolicy")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(t,i){var r=e.call(this)||this;return r.delayList=[],r.skinMap={},r.$styles={},r.initialized=!t,i&&egret.registerImplementation("eui.Theme",r),r.$configURL=t,r.load(t),r}return __extends(i,e),i.prototype.load=function(e){var i=egret.getImplementation("eui.IThemeAdapter");i||(i=new t.DefaultThemeAdapter),i.getTheme(e,this.onConfigLoaded,this.onConfigLoaded,this)},i.prototype.onConfigLoaded=function(t){var e;if(t)try{e=JSON.parse(t)}catch(i){egret.$error(3e3)}else egret.$error(3e3,this.$configURL);if(e&&e.skins)for(var r=this.skinMap,n=e.skins,o=Object.keys(n),a=o.length,s=0;a>s;s++){var l=o[s];r[l]||this.mapSkin(l,n[l])}e.styles&&(this.$styles=e.styles),e.exmls&&0!=e.exmls.length?e.exmls[0].gjs?(e.exmls.forEach(function(t){return EXML.$parseURLContentAsJs(t.path,t.gjs,t.className)}),this.onLoaded()):e.exmls[0].content?(e.exmls.forEach(function(t){return EXML.$parseURLContent(t.path,t.content)}),this.onLoaded()):EXML.$loadAll(e.exmls,this.onLoaded,this,!0):this.onLoaded()},i.prototype.onLoaded=function(){this.initialized=!0,this.handleDelayList(),this.dispatchEventWith(egret.Event.COMPLETE)},i.prototype.handleDelayList=function(){for(var t=this.delayList,e=t.length,i=0;e>i;i++){var r=t[i];if(!r.$Component[5]){var n=this.getSkinName(r);n&&(r.$Component[1]=n,r.$parseSkinName())}}t.length=0},i.prototype.getSkinName=function(t){if(!this.initialized)return-1==this.delayList.indexOf(t)&&this.delayList.push(t),"";var e=this.skinMap,i=e[t.hostComponentKey];return i||(i=this.findSkinName(t)),i},i.prototype.findSkinName=function(t){if(!t)return"";var e=t.__class__;if(void 0===e)return"";var i=this.skinMap[e];return i||"eui.Component"==e?i:this.findSkinName(Object.getPrototypeOf(t))},i.prototype.mapSkin=function(t,e){t||egret.$error(1003,"hostComponentKey"),e||egret.$error(1003,"skinName"),this.skinMap[t]=e},i.prototype.$getStyleConfig=function(t){return this.$styles[t]},i}(egret.EventDispatcher);t.Theme=e,__reflect(e.prototype,"eui.Theme")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(e,i,r,n,o,a,s,l){var h=t.call(this,e,i,r)||this;return h.$initTo(n,o,a,s,l),h}return __extends(e,t),e.prototype.$initTo=function(t,e,i,r,n){this.kind=t,this.location=0|+e,this.oldLocation=0|+i,this.items=r||[],this.oldItems=n||[]},e.prototype.clean=function(){t.prototype.clean.call(this),this.items=this.oldItems=null},e.dispatchCollectionEvent=function(t,i,r,n,o,a,s){if(!t.hasEventListener(i))return!0;var l=egret.Event.create(e,i);l.$initTo(r,n,o,a,s);var h=t.dispatchEvent(l);return egret.Event.release(l),h},e}(egret.Event);e.COLLECTION_CHANGE="collectionChange",t.CollectionEvent=e,__reflect(e.prototype,"eui.CollectionEvent")}(eui||(eui={}));var eui;!function(t){var e=function(){function t(){}return t}();e.ADD="add",e.REFRESH="refresh",e.REMOVE="remove",e.REPLACE="replace",e.RESET="reset",e.UPDATE="update",t.CollectionEventKind=e,__reflect(e.prototype,"eui.CollectionEventKind")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){var e=t.apply(this,arguments)||this;return e.item=null,e.itemRenderer=null,e.itemIndex=-1,e}return __extends(e,t),e.prototype.clean=function(){t.prototype.clean.call(this),this.item=this.itemRenderer=null},e.dispatchItemTapEvent=function(t,i,r){if(!t.hasEventListener(i))return!0;var n=egret.Event.create(e,i);n.item=r.data,n.itemIndex=r.itemIndex,n.itemRenderer=r;var o=t.dispatchEvent(n);return egret.Event.release(n),o},e}(egret.Event);e.ITEM_TAP="itemTap",t.ItemTapEvent=e,__reflect(e.prototype,"eui.ItemTapEvent")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(e,i,r,n){var o=t.call(this,e,i,r)||this;return o.property=n,o}return __extends(e,t),e.dispatchPropertyEvent=function(t,i,r){if(!t.hasEventListener(i))return!0;var n=egret.Event.create(e,i);n.property=r;var o=t.dispatchEvent(n);return egret.Event.release(n),o},e}(egret.Event);e.PROPERTY_CHANGE="propertyChange",t.PropertyEvent=e,__reflect(e.prototype,"eui.PropertyEvent")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(e,i,r,n,o){var a=t.call(this,e,i,r)||this;return n=+n,o=+o,a.currentPos=n,a.toPos=o,a}return __extends(e,t),e}(egret.Event);e.THROW="throw",t.ScrollerThrowEvent=e,__reflect(e.prototype,"eui.ScrollerThrowEvent")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return __extends(e,t),e.dispatchUIEvent=function(t,i,r,n){if(!t.hasEventListener(i))return!0;var o=egret.Event.create(e,i,r,n),a=t.dispatchEvent(o);return egret.Event.release(o),a},e}(egret.Event);e.CREATION_COMPLETE="creationComplete",e.CHANGE_END="changeEnd",e.CHANGE_START="changeStart",e.CLOSING="closing",e.MOVE="move",t.UIEvent=e,__reflect(e.prototype,"eui.UIEvent")}(eui||(eui={}));var eui;!function(t){var e;!function(t){var e="eui.State",i="eui.AddItems",r="eui.SetProperty",n="eui.SetStateProperty",o="eui.Binding.$bindProperties",a=function(){function t(){this.indent=0}return t.prototype.toCode=function(){return""},t.prototype.getIndent=function(t){void 0===t&&(t=this.indent);for(var e="",i=0;t>i;i++)e+="	";return e},t}();t.CodeBase=a,__reflect(a.prototype,"eui.sys.CodeBase");var s=function(t){function e(){var e=t.apply(this,arguments)||this;return e.className="",e.superClass="",e.innerClassBlock=[],e.variableBlock=[],e.functionBlock=[],e}return __extends(e,t),e.prototype.addInnerClass=function(t){-1==this.innerClassBlock.indexOf(t)&&this.innerClassBlock.push(t)},e.prototype.addVariable=function(t){-1==this.variableBlock.indexOf(t)&&this.variableBlock.push(t)},e.prototype.getVariableByName=function(t){for(var e=this.variableBlock,i=e.length,r=0;i>r;r++){var n=e[r];if(n.name==t)return n}return null},e.prototype.addFunction=function(t){-1==this.functionBlock.indexOf(t)&&this.functionBlock.push(t)},e.prototype.getFuncByName=function(t){for(var e=this.functionBlock,i=e.length,r=0;i>r;r++){var n=e[r];if(n.name==t)return n}return null},e.prototype.toCode=function(){var t=this.indent,e=this.getIndent(t),i=this.getIndent(t+1),r=this.getIndent(t+2),n=e+"(function (";n+=this.superClass?"_super) {\n"+i+"__extends("+this.className+", _super);\n":") {\n";for(var o=this.innerClassBlock,a=o.length,s=0;a>s;s++){var l=o[s];l.indent=t+1,n+=i+"var "+l.className+" = "+l.toCode()+"\n\n"}n+=i+"function "+this.className+"() {\n",this.superClass&&(n+=r+"_super.call(this);\n");var h=this.variableBlock;a=h.length;for(var s=0;a>s;s++){var u=h[s];u.defaultValue&&(n+=r+u.toCode()+"\n")}if(this.constructCode){var c=this.constructCode.toCode().split("\n");a=c.length;for(var s=0;a>s;s++){var p=c[s];n+=r+p+"\n"}}n+=i+"}\n",n+=i+"var _proto = "+this.className+".prototype;\n\n";var d=this.functionBlock;a=d.length;for(var s=0;a>s;s++){var f=d[s];f.indent=t+1,n+=f.toCode()+"\n"}return n+=i+"return "+this.className+";\n"+e,n+=this.superClass?"})("+this.superClass+");":"})();"},e}(a);t.EXClass=s,__reflect(s.prototype,"eui.sys.EXClass");var l=function(t){function e(){var e=t.apply(this,arguments)||this;return e.lines=[],e}return __extends(e,t),e.prototype.addVar=function(t,e){var i=e?" = "+e:"";this.addCodeLine("var "+t+i+";")},e.prototype.addAssignment=function(t,e,i){var r=i?"."+i:"";this.addCodeLine(t+r+" = "+e+";")},e.prototype.addReturn=function(t){this.addCodeLine("return "+t+";")},e.prototype.addEmptyLine=function(){this.addCodeLine("")},e.prototype.startIf=function(t){this.addCodeLine("if("+t+")"),this.startBlock()},e.prototype.startElse=function(){this.addCodeLine("else"),this.startBlock()},e.prototype.startElseIf=function(t){this.addCodeLine("else if("+t+")"),this.startBlock()},e.prototype.startBlock=function(){this.addCodeLine("{"),this.indent++},e.prototype.endBlock=function(){this.indent--,this.addCodeLine("}")},e.prototype.doFunction=function(t,e){var i=e.join(",");this.addCodeLine(t+"("+i+")")},e.prototype.addCodeLine=function(t){this.lines.push(this.getIndent()+t)},e.prototype.addCodeLineAt=function(t,e){this.lines.splice(e,0,this.getIndent()+t)},e.prototype.containsCodeLine=function(t){return-1!=this.lines.indexOf(t)},e.prototype.concat=function(t){this.lines=this.lines.concat(t.lines)},e.prototype.toCode=function(){return this.lines.join("\n")},e}(a);t.EXCodeBlock=l,__reflect(l.prototype,"eui.sys.EXCodeBlock");var h=function(t){function e(){var e=t.apply(this,arguments)||this;return e.codeBlock=null,e.isGet=!1,e.name="",e}return __extends(e,t),e.prototype.toCode=function(){var t,e=this.getIndent(),i=this.getIndent(this.indent+1),r=e;if(this.isGet?(t=this.getIndent(this.indent+2),r+='Object.defineProperty(_proto, "skinParts", {\n',r+=i+"get: function () {\n"):(t=i,r+="_proto."+this.name+" = function () {\n"),this.codeBlock)for(var n=this.codeBlock.toCode().split("\n"),o=n.length,a=0;o>a;a++){var s=n[a];r+=t+s+"\n"}return r+=this.isGet?i+"},\n"+i+"enumerable: true,\n"+i+"configurable: true\n"+e+"});":e+"};"},e}(a);t.EXFunction=h,__reflect(h.prototype,"eui.sys.EXFunction");var u=function(t){function e(e,i){var r=t.call(this)||this;return r.indent=2,r.name=e,r.defaultValue=i,r}return __extends(e,t),e.prototype.toCode=function(){return this.defaultValue?"this."+this.name+" = "+this.defaultValue+";":""},e}(a);t.EXVariable=u,__reflect(u.prototype,"eui.sys.EXVariable");var c=function(t){function i(e,i){var r=t.call(this)||this;return r.name="",r.stateGroups=[],r.addItems=[],r.setProperty=[],r.name=e,i&&(r.stateGroups=i),r}return __extends(i,t),i.prototype.addOverride=function(t){t instanceof p?this.addItems.push(t):this.setProperty.push(t)},i.prototype.toCode=function(){for(var t=this.getIndent(1),i="new "+e+' ("'+this.name+'",\n'+t+"[\n",r=0,n=!0,o=this.addItems.concat(this.setProperty);r<o.length;){n?n=!1:i+=",\n";for(var a=o[r],s=a.toCode().split("\n"),l=s.length,h=0;l>h;h++){var u=s[h];s[h]=t+t+u}i+=s.join("\n"),r++}return i+="\n"+t+"])"},i}(a);t.EXState=c,__reflect(c.prototype,"eui.sys.EXState");var p=function(t){function e(e,i,r,n){var o=t.call(this)||this;return o.target=e,o.property=i,o.position=r,o.relativeTo=n,o}return __extends(e,t),e.prototype.toCode=function(){var t="new "+i+'("'+this.target+'","'+this.property+'",'+this.position+',"'+this.relativeTo+'")';return t},e}(a);t.EXAddItems=p,__reflect(p.prototype,"eui.sys.EXAddItems");var d=function(t){function e(e,i,r){var n=t.call(this)||this;return n.target=e,n.name=i,n.value=r,n}return __extends(e,t),e.prototype.toCode=function(){return"new "+r+'("'+this.target+'","'+this.name+'",'+this.value+")"},e}(a);t.EXSetProperty=d,__reflect(d.prototype,"eui.sys.EXSetProperty");var f=function(t){function e(e,i,r,n){var o=t.call(this)||this;return e=e?"this."+e:"this",o.target=e,o.property=i,o.templates=r,o.chainIndex=n,o}return __extends(e,t),e.prototype.toCode=function(){var t=this.templates.join(","),e=this.chainIndex.join(",");return"new "+n+"(this, ["+t+"],["+e+"],"+this.target+',"'+this.property+'")'},e}(a);t.EXSetStateProperty=f,__reflect(f.prototype,"eui.sys.EXSetStateProperty");var g=function(t){function e(e,i,r,n){var o=t.call(this)||this;return o.target=e,o.property=i,o.templates=r,o.chainIndex=n,o}return __extends(e,t),e.prototype.toCode=function(){var t=this.templates.join(","),e=this.chainIndex.join(",");return o+"(this, ["+t+"],["+e+"],"+this.target+',"'+this.property+'")'},e}(a);t.EXBinding=g,__reflect(g.prototype,"eui.sys.EXBinding")}(e=t.sys||(t.sys={}))}(eui||(eui={}));var eui;!function(t){var e;!function(t){function e(t,e,i,r,o,a,s,l,h,u){var c;if(!isNaN(i)&&isNaN(r)){if(c=n(t,e,i,a,i,l,i,u))return c}else if(isNaN(i)&&!isNaN(r)&&(c=n(t,e,o,r,s,r,h,r)))return c;return c=n(t,e,o,a,s,l,h,u)}function i(t,e,i,n,o,a,s,l,h,u){var c;if(!isNaN(i)&&isNaN(n)){if(c=r(t,e,i,a,i,l,i,u))return c}else if(isNaN(i)&&!isNaN(n)&&(c=r(t,e,o,n,s,n,h,n)))return c;return c=r(t,e,o,a,s,l,h,u)}function r(t,e,i,r,n,a,l,h){var u=e.b,c=e.d;if(u>-1e-9&&1e-9>u&&(u=0),c>-1e-9&&1e-9>c&&(c=0),0==u&&0==c)return null;if(0==u&&0==c)return null;if(0==u)return egret.Point.create(i,t/Math.abs(c));if(0==c)return egret.Point.create(t/Math.abs(u),r);var p,d,f,g=u*c>=0?c:-c;if(0!=g&&i>0){var y=1/g;i=Math.max(n,Math.min(l,i)),d=i,f=(t-u*d)*y,f>=a&&h>=f&&u*d+g*f>=0&&(p=egret.Point.create(d,f)),f=(-t-u*d)*y,f>=a&&h>=f&&0>u*d+g*f&&(!p||s(p.x,p.y,e).width>s(d,f,e).width)&&(egret.Point.release(p),p=egret.Point.create(d,f))}if(0!=u&&r>0){var v=1/u;r=Math.max(a,Math.min(h,r)),f=r,d=(t-g*f)*v,d>=n&&l>=d&&u*d+g*f>=0&&(!p||s(p.x,p.y,e).width>s(d,f,e).width)&&(p=egret.Point.create(d,f)),d=(-t-g*f)*v,d>=n&&l>=d&&0>u*d+g*f&&(!p||s(p.x,p.y,e).width>s(d,f,e).width)&&(egret.Point.release(p),p=egret.Point.create(d,f))}if(p)return p;var m=e.a,_=e.c,b=m*_>=0?_:-_;return o(u,g,t,n,a,l,h,m,b)}function n(t,e,i,r,n,a,l,h){var u=e.a,c=e.c;if(u>-1e-9&&1e-9>u&&(u=0),c>-1e-9&&1e-9>c&&(c=0),0==u&&0==c)return null;if(0==u)return egret.Point.create(i,t/Math.abs(c));if(0==c)return egret.Point.create(t/Math.abs(u),r);var p,d,f,g=u*c>=0?c:-c;if(0!=g&&i>0){var y=1/g;i=Math.max(n,Math.min(l,i)),d=i,f=(t-u*d)*y,f>=a&&h>=f&&u*d+g*f>=0&&(p=egret.Point.create(d,f)),f=(-t-u*d)*y,f>=a&&h>=f&&0>u*d+g*f&&(!p||s(p.x,p.y,e).height>s(d,f,e).height)&&(egret.Point.release(p),p=egret.Point.create(d,f))}if(0!=u&&r>0){var v=1/u;r=Math.max(a,Math.min(h,r)),f=r,d=(t-g*f)*v,d>=n&&l>=d&&u*d+g*f>=0&&(!p||s(p.x,p.y,e).height>s(d,f,e).height)&&(egret.Point.release(p),p=egret.Point.create(d,f)),d=(-t-g*f)*v,d>=n&&l>=d&&0>u*d+g*f&&(!p||s(p.x,p.y,e).height>s(d,f,e).height)&&(egret.Point.release(p),p=egret.Point.create(d,f))}if(p)return p;var m=e.b,_=e.d,b=m*_>=0?_:-_;return o(u,g,t,n,a,l,h,m,b)}function o(t,e,i,r,n,o,a,s,l){if(0==t||0==e)return null;var h,u,c=(i-r*t)/e,p=(i-o*t)/e,d=Math.max(n,Math.min(c,p)),f=Math.min(a,Math.max(c,p)),g=s*e-t*l;return f>=d?(u=Math.abs(g)<1e-9?i/(t+e):s*i/g,u=Math.max(d,Math.min(u,f)),h=(i-e*u)/t,egret.Point.create(h,u)):(c=-(r*t+i)/e,p=-(o*t+i)/e,d=Math.max(n,Math.min(c,p)),f=Math.min(a,Math.max(c,p)),f>=d?(u=Math.abs(g)<1e-9?-i/(t+e):-s*i/g,u=Math.max(d,Math.min(u,f)),h=(-i-e*u)/t,egret.Point.create(h,u)):null)}function a(t,e,i,r,n,a,s){var h=i.a,u=i.b,c=i.c,p=i.d;if(h>-1e-9&&1e-9>h&&(h=0),u>-1e-9&&1e-9>u&&(u=0),c>-1e-9&&1e-9>c&&(c=0),p>-1e-9&&1e-9>p&&(p=0),0==u&&0==c)return 0==h||0==p?null:egret.Point.create(t/Math.abs(h),e/Math.abs(p));if(0==h&&0==p)return 0==u||0==c?null:egret.Point.create(e/Math.abs(u),t/Math.abs(c));var d=h*c>=0?c:-c,f=u*p>=0?p:-p,g=h*f-u*d;if(Math.abs(g)<1e-9)return 0==d||0==h||h==-d?null:Math.abs(h*e-u*t)>1e-9?null:o(h,d,t,r,r,a,s,u,f);var y=1/g;t*=y,e*=y;var v;return v=l(h,d,u,f,t,e),v&&r<=v.x&&v.x<=a&&n<=v.y&&v.y<=s&&h*v.x+d*v.x>=0&&u*v.x+f*v.y>=0?v:(v=l(h,d,u,f,t,-e),v&&r<=v.x&&v.x<=a&&n<=v.y&&v.y<=s&&h*v.x+d*v.x>=0&&u*v.x+f*v.y<0?v:(v=l(h,d,u,f,-t,e),v&&r<=v.x&&v.x<=a&&n<=v.y&&v.y<=s&&h*v.x+d*v.x<0&&u*v.x+f*v.y>=0?v:(v=l(h,d,u,f,-t,-e),v&&r<=v.x&&v.x<=a&&n<=v.y&&v.y<=s&&h*v.x+d*v.x<0&&u*v.x+f*v.y<0?v:(egret.Point.release(v),null))))}function s(t,e,i){var r=egret.$TempRectangle.setTo(0,0,t,e);return i.$transformBounds(r),r}function l(t,e,i,r,n,o){return egret.Point.create(r*n-e*o,t*o-i*n)}var h=.1,u=.1,c=function(){function t(){}return t.fitBounds=function(t,r,n,o,l,c,p,d,f,g,y){if(isNaN(t)&&isNaN(r))return egret.Point.create(c,p);var v,m=u>d?0:d-u,_=u>f?0:f-u,b=g+u,T=y+u;if(isNaN(t)||isNaN(r))return isNaN(t)?i(r,n,o,l,c,p,m,_,b,T):e(t,n,o,l,c,p,m,_,b,T);if(v=a(t,r,n,m,_,b,T),!v){var x=void 0;if(x=e(t,n,o,l,c,p,m,_,b,T)){var E=s(x.x,x.y,n).height;E-h>r&&(egret.Point.release(x),x=null)}var $=void 0;if($=i(r,n,o,l,c,p,m,_,b,T)){var S=s($.x,$.y,n).width;S-h>t&&(egret.Point.release($),$=null)}v=x&&$?x.x*x.y>$.x*$.y?x:$:x?x:$,egret.Point.release(x),egret.Point.release($)}return v},t}();t.MatrixUtil=c,__reflect(c.prototype,"eui.sys.MatrixUtil")}(e=t.sys||(t.sys={}))}(eui||(eui={}));var EXML;!function(t){function e(t){return l.parse(t)}function i(t,e,i,r){if(void 0===r&&(r=!1),t||egret.$error(1003,"url"),r&&t in u)return void(e&&e.call(i,u[t],t));var n=h[t];return n?void n.push([e,i]):(h[t]=[[e,i]],void s(t,a))}function r(t,e,i,r){if(void 0===r&&(r=!1),!t||0==t.length)return void(e&&e.call(i,[],t));var o=[];t.forEach(function(a){if(r&&a in u)return o[a]="",void o.push(a);var l=function(r,a){o[r]=a,o.push(r),o.length==t.length&&n(t,o,e,i)};s(a,l)})}function n(t,e,i,r){var n=[];t.forEach(function(t,i){if(t in u&&!e[t])return void(n[i]=u[t]);var r=e[t],o=a(t,r);n[i]=o}),i&&i.call(r,n,t)}function o(t,e,i){var r=null;if(e&&(r=l.$parseCode(e,i)),t){u[t]=r;var n=h[t];delete h[t];for(var o=n?n.length:0,a=0;o>a;a++){var s=n[a];s[0]&&s[1]&&s[0].call(s[1],r,t)}}return r}function a(t,i){var r=null;if(i&&(r=e(i)),t){u[t]=r;var n=h[t];delete h[t];for(var o=n?n.length:0,a=0;o>a;a++){var s=n[a];s[0]&&s[1]&&s[0].call(s[1],r,t)}}return r}function s(t,e){var i=t;-1==t.indexOf("://")&&(i=c+t);var r=function(i){i||(i=""),e(t,i)},n=egret.getImplementation("eui.IThemeAdapter");n||(n=new eui.DefaultThemeAdapter),n.getTheme(i,r,r,this)}var l=new eui.sys.EXMLParser,h={},u={},c="";Object.defineProperty(t,"prefixURL",{get:function(){return c},set:function(t){c=t},enumerable:!0,configurable:!0}),t.parse=e,t.load=i,t.$loadAll=r,t.$parseURLContentAsJs=o,t.$parseURLContent=a}(EXML||(EXML={}));var eui;!function(t){var e;!function(t){function e(t){return"[object Array]"===Object.prototype.toString.call(t)}function i(t){var e=egret.getDefinitionByName(t);return e?e.prototype:null}function r(t){if(!t)return null;var e;try{e=new t}catch(i){return egret.error(i),null}return e}t.NS_S="http://ns.egret.com/eui",t.NS_W="http://ns.egret.com/wing";var n=["Point","Matrix","Rectangle"],o=["Array","boolean","string","number"],a="eui.",s=0,l={},h=function(){function h(){}return h.prototype.$describe=function(t){if(!t)return null;var i=Object.getPrototypeOf(t);if(!i)return null;var n;if(i.hasOwnProperty("__hashCode__")&&(n=l[i.__hashCode__]))return n;var a=Object.getPrototypeOf(i);if(!a)return null;var h=r(a.constructor),u=this.$describe(h);if(u){var c=function(){};c.prototype=u,n=new c}else n={};n.__class__=i.constructor.name;for(var p=Object.keys(i).concat(Object.keys(t)),d=p.length,f=t.__meta__,g=0;d>g;g++){var y=p[g];if("constructor"!=y&&"_"!=y.charAt(0)&&"$"!=y.charAt(0)){var v=void 0;if(f&&f[y])v=f[y];else if(e(t[y]))v="Array";else{if(v=typeof t[y],"function"==v)continue;-1==o.indexOf(v)&&(v="any")}n[y]=v}}return Object.getPrototypeOf(a)&&(i.__hashCode__=s++,l[i.__hashCode__]=n),n},h.prototype.getClassNameById=function(e,r){if(r==t.NS_S){if("Object"==e)return e;if(-1!=n.indexOf(e))return"egret."+e}var s="";return-1!=o.indexOf(e)?e:(r==t.NS_W||(s=r&&r!=t.NS_S?r.substring(0,r.length-1)+e:a+e),i(s)||(s=""),s)},h.prototype.getDefaultPropById=function(t,e){var r,n=this.getClassNameById(t,e),o=i(n);return o&&(r=o.__defaultProperty__),r?r:""},h.prototype.getPropertyType=function(t,e){if("Object"==e)return"any";var n="",o=i(e);if(o){if(!o.hasOwnProperty("__hashCode__")){var a=egret.getDefinitionByName(e),s=r(a);if(!s)return egret.$warn(2104,e),n;this.$describe(s)}var h=l[o.__hashCode__];h&&(n=h[t])}return n},h}();t.EXMLConfig=h,__reflect(h.prototype,"eui.sys.EXMLConfig")}(e=t.sys||(t.sys={}))}(eui||(eui={}));var eui;!function(){egret.$locale_strings=egret.$locale_strings||{},egret.$locale_strings.en_US=egret.$locale_strings.en_US||{};var t=egret.$locale_strings.en_US;t[2001]="EXML parsing error {0}: EXML file can't be found ",t[2002]="EXML parsing error : invalid XML file:\n{0}",t[2003]="EXML parsing error {0}: the class definitions corresponding to nodes can't be found  \n {1}",t[2004]="EXML parsing error {0}: nodes cannot contain id property with the same name \n {1}",t[2005]="EXML parsing error {0}: property with the name of '{1}' does not exist on the node, or the property does not have a default value: \n {2}",t[2006]="EXML parsing error {0}: undefined view state name: '{1}' \n {2}",t[2007]="EXML parsing error {0}: only UIComponent objects within the container can use the includeIn and excludeFrom properties\n {1}",t[2008]="EXML parsing error {0}: fail to assign values of '{1}' class to property: '{2}' \n {3}",t[2009]="EXML parsing error {0}: only one ID can be referenced in the node property value '{}' label; and complex expression is not allowed to use \n {1}",t[2010]="EXML parsing error {0}: ID referenced by property: '{1}':  '{2}' does not exist \n {3}",t[2011]="EXML parsing error {0}: fail to assign more than one child nodes to the same property: '{1}' \n {2}",t[2012]="EXML parsing error {0}: no default property exists on the node; and you must explicitly declare the property name that the child node  is assigned to \n {1}",t[2013]="EXML parsing error {0}: view state grammar is not allowed to use on property nodes of Array class \n {1} ",t[2014]="EXML parsing error {0}: assigning the skin class itself to the node property is not allowed \n {1}",t[2015]="EXML parsing error {0}: class definition referenced by node: {1} does not exist \n {2}",t[2016]="EXML parsing error {0}: format error of 'scale9Grid' property value on the node: {1}",t[2017]="EXML parsing error {0}: namespace prefix missing on the node: {1}",t[2018]="EXML parsing error {0}: format error of 'skinName' property value on the node: {1}",t[2019]="EXML parsing error {0}: the container’s child item must be visible nodes: {1}",t[2020]="EXML parsing error {0}: for child nodes in w: Declarations, the includeIn and excludeFrom properties are not allowed to use \n {1}",t[2021]="Compile errors in {0}, the attribute name: {1}, the attribute value: {2}.",t[2022]="EXML parsing error: there contains illegal characters in the id `{0}`",t[2101]="EXML parsing warnning : fail to register the class property : {0},there is already a class with the same name in the global,please try to rename the class name for the exml. \n {1}",t[2102]="EXML parsing warnning {0}: no child node can be found on the property code \n {1}",t[2103]="EXML parsing warnning {0}: the same property '{1}' on the node is assigned multiple times \n {2}",t[2104]="EXML parsing warnning, Instantiate class {0} error，the parameters of its constructor method must be empty.",t[2201]="BasicLayout doesn't support virtualization.",t[2202]="parse skinName error，the parsing result of skinName must be a instance of eui.Skin.",t[2203]="Could not find the skin class '{0}'。",t[2301]="parse source failed，could not find asset from URL：{0} ."}(eui||(eui={}));var eui;!function(){egret.$locale_strings=egret.$locale_strings||{},egret.$locale_strings.zh_CN=egret.$locale_strings.zh_CN||{};var t=egret.$locale_strings.zh_CN;t[2001]="EXML解析错误 {0}: 找不到EXML文件",t[2002]="EXML解析错误: 不是有效的XML文件:\n{0}",t[2003]="EXML解析错误 {0}: 无法找到节点所对应的类定义\n{1}",t[2004]="EXML解析错误 {0}: 节点不能含有同名的id属性\n{1}",t[2005]="EXML解析错误 {0}: 节点上不存在名为'{1}'的属性，或者该属性没有初始值:\n{2}",t[2006]="EXML解析错误 {0}: 未定义的视图状态名称:'{1}'\n{2}",t[2007]="EXML解析错误 {0}: 只有处于容器内的 UIComponent 对象可以使用includeIn和excludeFrom属性\n{1}",t[2008]="EXML解析错误 {0}: 无法将'{1}'类型的值赋给属性:'{2}'\n{3}",t[2009]="EXML解析错误 {0}: 在节点属性值的‘{}’标签内只能引用一个ID，不允许使用复杂表达式\n{1}",t[2010]="EXML解析错误 {0}: 属性:'{1}'所引用的ID: '{2}'不存在\n{3}",t[2011]="EXML解析错误 {0}: 无法将多个子节点赋值给同一个属性:'{1}'\n{2}",t[2012]="EXML解析错误 {0}: 节点上不存在默认属性，必须显式声明子节点要赋值到的属性名\n{1}",t[2013]="EXML解析错误 {0}: 类型为Array的属性节点上不允许使用视图状态语法\n{1}",t[2014]="EXML解析错误 {0}: 不允许将皮肤类自身赋值给节点属性\n{1}",t[2015]="EXML解析错误 {0}: 节点引用的类定义:{1}不存在\n{2}",t[2016]="EXML解析错误 {0}: 节点上'scale9Grid'属性值的格式错误:{1}",t[2017]="EXML解析错误 {0}: 节点上缺少命名空间前缀:{1}",t[2018]="EXML解析错误 {0}: 节点上'skinName'属性值的格式错误:{1}",t[2019]="EXML解析错误 {0}: 容器的子项必须是可视节点:{1}",t[2020]="EXML解析错误 {0}: 在w:Declarations内的子节点，不允许使用includeIn和excludeFrom属性\n{1}",t[2021]="{0} 中存在编译错误，属性名 : {1}，属性值 : {2}",t[2022]="EXML解析错误: id `{0}` 中含有非法字符",t[2101]="EXML解析警告: 在EXML根节点上声明的 class 属性: {0} 注册失败，所对应的类已经存在，请尝试重命名要注册的类名。\n{1}",t[2102]="EXML解析警告 {0}: 在属性节点上找不到任何子节点\n{1}",t[2103]="EXML解析警告 {0}: 节点上的同一个属性'{1}'被多次赋值\n{2}",t[2104]="EXML解析警告，无法直接实例化自定义组件：{0} ，在EXML中使用的自定义组件必须要能直接被实例化，否则可能导致后续EXML解析报错。",t[2201]="BasicLayout 不支持虚拟化。",t[2202]="皮肤解析出错，属性 skinName 的值必须要能够解析为一个 eui.Skin 的实例。",t[2203]="找不到指定的皮肤类 '{0}'。",t[2301]="素材解析失败，找不到URL：{0} 所对应的资源。"}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.measure=function(){e.prototype.measure.call(this),t.sys.measure(this.$target)},i.prototype.updateDisplayList=function(i,r){e.prototype.updateDisplayList.call(this,i,r);var n=this.$target,o=t.sys.updateDisplayList(n,i,r);n.setContentSize(Math.ceil(o.x),Math.ceil(o.y))},i}(t.LayoutBase);t.BasicLayout=e,__reflect(e.prototype,"eui.BasicLayout"),Object.defineProperty(e.prototype,"useVirtualLayout",{get:function(){return this.$useVirtualLayout},set:function(){egret.$error(2201)},enumerable:!0,configurable:!0})}(eui||(eui={})),function(t){var e;!function(t){function e(t,e){if(!t||"number"==typeof t)return t;var i=t,r=i.indexOf("%");if(-1==r)return+i;var n=+i.substring(0,r);return.01*n*e}function i(t){if(t){for(var e=0,i=0,r=egret.$TempRectangle,o=t.numChildren,a=0;o>a;a++){var s=t.getChildAt(a);if(egret.is(s,n)&&s.$includeInLayout){var l=s.$UIComponent,h=+l[4],u=+l[5],c=+l[0],p=+l[1],d=+l[2],f=+l[3],g=void 0,y=void 0;s.getPreferredBounds(r),isNaN(c)||isNaN(p)?isNaN(h)?isNaN(c)&&isNaN(p)?g=r.x:(g=isNaN(c)?0:c,g+=isNaN(p)?0:p):g=2*Math.abs(h):g=c+p,isNaN(d)||isNaN(f)?isNaN(u)?isNaN(d)&&isNaN(f)?y=r.y:(y=isNaN(d)?0:d,y+=isNaN(f)?0:f):y=2*Math.abs(u):y=d+f;var v=r.width,m=r.height;e=Math.ceil(Math.max(e,g+v)),i=Math.ceil(Math.max(i,y+m))}}t.setMeasuredSize(e,i)}}function r(t,i,r){if(t){for(var o=t.numChildren,a=0,s=0,l=egret.$TempRectangle,h=0;o>h;h++){var u=t.getChildAt(h);if(egret.is(u,n)&&u.$includeInLayout){var c=u.$UIComponent,p=e(c[4],.5*i),d=e(c[5],.5*r),f=e(c[0],i),g=e(c[1],i),y=e(c[2],r),v=e(c[3],r),m=c[6],_=c[7],b=0/0,T=0/0;isNaN(f)||isNaN(g)?isNaN(m)||(b=Math.round(i*Math.min(.01*m,1))):b=i-g-f,isNaN(y)||isNaN(v)?isNaN(_)||(T=Math.round(r*Math.min(.01*_,1))):T=r-v-y,u.setLayoutBoundsSize(b,T),u.getLayoutBounds(l);var x=l.width,E=l.height,$=0/0,S=0/0;$=isNaN(p)?isNaN(f)?isNaN(g)?l.x:i-x-g:f:Math.round((i-x)/2+p),S=isNaN(d)?isNaN(y)?isNaN(v)?l.y:r-E-v:y:Math.round((r-E)/2+d),u.setLayoutBoundsPosition($,S),a=Math.max(a,$+x),s=Math.max(s,S+E)}}return egret.$TempPoint.setTo(a,s)}}var n="eui.UIComponent";t.measure=i,t.updateDisplayList=r}(e=t.sys||(t.sys={}))}(eui||(eui={}));var eui;!function(t){var e=function(){function t(){}return t}();e.LEFT="left",e.JUSTIFY_USING_GAP="justifyUsingGap",e.JUSTIFY_USING_WIDTH="justifyUsingWidth",t.ColumnAlign=e,__reflect(e.prototype,"eui.ColumnAlign")}(eui||(eui={}));var eui;!function(t){var e="eui.UIComponent",i=function(i){function r(){return i.apply(this,arguments)||this}return __extends(r,i),r.prototype.measureReal=function(){for(var t=this.$target,i=t.numElements,r=i,n=0,o=0,a=egret.$TempRectangle,s=0;i>s;s++){var l=t.getElementAt(s);egret.is(l,e)&&l.$includeInLayout?(l.getPreferredBounds(a),n+=a.width,o=Math.max(o,a.height)):r--}n+=(r-1)*this.$gap;var h=this.$paddingLeft+this.$paddingRight,u=this.$paddingTop+this.$paddingBottom;t.setMeasuredSize(n+h,o+u)},r.prototype.measureVirtual=function(){for(var t=this.$target,i=this.$typicalWidth,r=this.getElementTotalSize(),n=Math.max(this.maxElementSize,this.$typicalHeight),o=egret.$TempRectangle,a=this.endIndex,s=this.elementSizeTable,l=this.startIndex;a>l;l++){var h=t.getElementAt(l);egret.is(h,e)&&h.$includeInLayout&&(h.getPreferredBounds(o),r+=o.width,r-=isNaN(s[l])?i:s[l],n=Math.max(n,o.height))}var u=this.$paddingLeft+this.$paddingRight,c=this.$paddingTop+this.$paddingBottom;t.setMeasuredSize(r+u,n+c)},r.prototype.updateDisplayListReal=function(i,r){var n=this.$target,o=this.$paddingLeft,a=this.$paddingRight,s=this.$paddingTop,l=this.$paddingBottom,h=this.$gap,u=Math.max(0,i-o-a),c=Math.max(0,r-s-l),p=this.$horizontalAlign==t.JustifyAlign.JUSTIFY,d=this.$verticalAlign==t.JustifyAlign.JUSTIFY||this.$verticalAlign==t.JustifyAlign.CONTENT_JUSTIFY,f=0;d||(this.$verticalAlign==egret.VerticalAlign.MIDDLE?f=.5:this.$verticalAlign==egret.VerticalAlign.BOTTOM&&(f=1));var g,y,v,m=n.numElements,_=m,b=o,T=s,x=0,E=0,$=[],S=u,C=this.maxElementSize,w=egret.$TempRectangle;for(g=0;m>g;g++){var O=n.getElementAt(g);if(egret.is(O,e)&&O.$includeInLayout)if(O.getPreferredBounds(w),C=Math.max(C,w.height),p)x+=w.width;else{var P=O.$UIComponent;isNaN(P[6])?S-=w.width:(E+=P[6],v=new t.sys.ChildInfo,v.layoutElement=O,v.percent=P[6],v.min=P[12],v.max=P[13],$.push(v))}else _--}S-=h*(_-1),S=S>0?S:0;var D,L=u-x-h*(_-1),R=_,I={};if(p){if(0>L){for(D=S/_,g=0;m>g;g++)y=n.getElementAt(g),egret.is(y,e)&&y.$includeInLayout&&(y.getPreferredBounds(w),w.width<=D&&(S-=w.width,R--));S=S>0?S:0}}else if(E>0){this.flexChildrenProportionally(u,S,E,$);var M=0,A=$.length;for(g=0;A>g;g++){v=$[g];var B=Math.round(v.size+M);M+=v.size-B,I[v.layoutElement.$hashCode]=B,S-=B}S=S>0?S:0}this.$horizontalAlign==egret.HorizontalAlign.CENTER?b=o+.5*S:this.$horizontalAlign==egret.HorizontalAlign.RIGHT&&(b=o+S);var N=o,F=s,k=0,j=0,U=Math.ceil(c);this.$verticalAlign==t.JustifyAlign.CONTENT_JUSTIFY&&(U=Math.ceil(Math.max(c,C)));var H,V,X=0;for(g=0;m>g;g++){var G=0;if(y=n.getElementAt(g),egret.is(y,e)&&y.$includeInLayout){if(y.getPreferredBounds(w),H=0/0,p?(V=0/0,L>0?V=S*w.width/x:0>L&&w.width>D&&(V=S/R),isNaN(V)||(H=Math.round(V+X),X+=V-H)):H=I[y.$hashCode],d)T=s,y.setLayoutBoundsSize(H,U),y.getLayoutBounds(w);else{var z=0/0,P=y.$UIComponent;if(!isNaN(y.percentHeight)){var W=Math.min(100,P[7]);z=Math.round(c*W*.01)}y.setLayoutBoundsSize(H,z),y.getLayoutBounds(w),G=(c-w.height)*f,G=G>0?G:0,T=s+G}y.setLayoutBoundsPosition(Math.round(b),Math.round(T)),k=Math.ceil(w.width),j=Math.ceil(w.height),N=Math.max(N,b+k),F=Math.max(F,T+j),b+=k+h}}this.maxElementSize=C,n.setContentSize(N+a,F+l)},r.prototype.updateDisplayListVirtual=function(i,r){var n=this.$target;this.indexInViewCalculated?this.indexInViewCalculated=!1:this.getIndexInView();var o,a=this.$paddingRight,s=this.$paddingTop,l=this.$paddingBottom,h=this.$gap,u=n.numElements;if(-1==this.startIndex||-1==this.endIndex)return o=this.getStartPosition(u)-h+a,void n.setContentSize(o,n.contentHeight);var c=this.endIndex;n.setVirtualElementIndicesInView(this.startIndex,c);var p=this.$verticalAlign==t.JustifyAlign.JUSTIFY||this.$verticalAlign==t.JustifyAlign.CONTENT_JUSTIFY,d=this.$verticalAlign==t.JustifyAlign.CONTENT_JUSTIFY,f=0;p||(this.$verticalAlign==egret.VerticalAlign.MIDDLE?f=.5:this.$verticalAlign==egret.VerticalAlign.BOTTOM&&(f=1));var g,y=egret.$TempRectangle,v=Math.max(0,r-s-l),m=Math.ceil(v),_=this.$typicalHeight,b=this.$typicalWidth,T=this.maxElementSize,x=Math.max(_,this.maxElementSize);if(d){for(var E=this.startIndex;c>=E;E++)g=n.getVirtualElementAt(E),egret.is(g,e)&&g.$includeInLayout&&(g.getPreferredBounds(y),T=Math.max(T,y.height));m=Math.ceil(Math.max(v,T))}for(var $,S=0,C=0,w=0,O=!1,P=this.elementSizeTable,D=this.startIndex;c>=D;D++){var L=0;g=n.getVirtualElementAt(D),egret.is(g,e)&&g.$includeInLayout&&(g.getPreferredBounds(y),d||(T=Math.max(T,y.height)),p?(C=s,g.setLayoutBoundsSize(0/0,m),g.getLayoutBounds(y)):(g.getLayoutBounds(y),L=(v-y.height)*f,L=L>0?L:0,C=s+L),w=Math.max(w,y.height),O||($=isNaN(P[D])?b:P[D],$!=y.width&&(O=!0)),P[D]=y.width,S=this.getStartPosition(D),g.setLayoutBoundsPosition(Math.round(S),Math.round(C)))}w+=s+l,o=this.getStartPosition(u)-h+a,this.maxElementSize=T,n.setContentSize(o,w),(O||x<this.maxElementSize)&&n.invalidateSize()},r.prototype.getStartPosition=function(t){if(!this.$useVirtualLayout&&this.$target){var e=this.$target.getElementAt(t);if(e)return e.x}for(var i=this.$typicalWidth,r=this.$paddingLeft,n=this.$gap,o=this.elementSizeTable,a=0;t>a;a++){var s=o[a];isNaN(s)&&(s=i),r+=s+n}return r},r.prototype.getElementSize=function(t){if(this.$useVirtualLayout){var e=this.elementSizeTable[t];return isNaN(e)&&(e=this.$typicalWidth),e}return this.$target?this.$target.getElementAt(t).width:0},r.prototype.getElementTotalSize=function(){for(var t=this.$typicalWidth,e=this.$gap,i=0,r=this.$target.numElements,n=this.elementSizeTable,o=0;r>o;o++){var a=n[o];isNaN(a)&&(a=t),i+=a+e}return i-=e},r.prototype.elementAdded=function(t){this.useVirtualLayout&&(i.prototype.elementAdded.call(this,t),this.elementSizeTable.splice(t,0,this.$typicalWidth))
},r.prototype.getIndexInView=function(){var t=this.$target;if(!t||0==t.numElements)return this.startIndex=this.endIndex=-1,!1;var e=t.$UIComponent;if(e[10]<=0||e[11]<=0)return this.startIndex=this.endIndex=-1,!1;var i=t.numElements,r=this.getStartPosition(i-1)+this.elementSizeTable[i-1]+this.$paddingRight,n=t.scrollH;if(n>r-this.$paddingRight)return this.startIndex=-1,this.endIndex=-1,!1;var o=t.scrollH+e[10];if(o<this.$paddingLeft)return this.startIndex=-1,this.endIndex=-1,!1;var a=this.startIndex,s=this.endIndex;return this.startIndex=this.findIndexAt(n,0,i-1),-1==this.startIndex&&(this.startIndex=0),this.endIndex=this.findIndexAt(o,0,i-1),-1==this.endIndex&&(this.endIndex=i-1),a!=this.startIndex||s!=this.endIndex},r}(t.LinearLayoutBase);t.HorizontalLayout=i,__reflect(i.prototype,"eui.HorizontalLayout")}(eui||(eui={}));var eui;!function(t){var e=function(){function t(){}return t}();e.JUSTIFY="justify",e.CONTENT_JUSTIFY="contentJustify",t.JustifyAlign=e,__reflect(e.prototype,"eui.JustifyAlign")}(eui||(eui={}));var eui;!function(t){var e=function(){function t(){}return t}();e.TOP="top",e.JUSTIFY_USING_GAP="justifyUsingGap",e.JUSTIFY_USING_HEIGHT="justifyUsingHeight",t.RowAlign=e,__reflect(e.prototype,"eui.RowAlign")}(eui||(eui={}));var eui;!function(t){var e="eui.UIComponent",i=function(i){function r(){var e=i.call(this)||this;return e.explicitHorizontalGap=0/0,e._horizontalGap=6,e.explicitVerticalGap=0/0,e._verticalGap=6,e._columnCount=-1,e._requestedColumnCount=0,e._rowCount=-1,e._requestedRowCount=0,e.explicitColumnWidth=0/0,e._columnWidth=0/0,e.explicitRowHeight=0/0,e._rowHeight=0/0,e._paddingLeft=0,e._paddingRight=0,e._paddingTop=0,e._paddingBottom=0,e._horizontalAlign=t.JustifyAlign.JUSTIFY,e._verticalAlign=t.JustifyAlign.JUSTIFY,e._columnAlign=t.ColumnAlign.LEFT,e._rowAlign=t.RowAlign.TOP,e._orientation=t.TileOrientation.ROWS,e.maxElementWidth=0,e.maxElementHeight=0,e.startIndex=-1,e.endIndex=-1,e.indexInViewCalculated=!1,e}return __extends(r,i),Object.defineProperty(r.prototype,"horizontalGap",{get:function(){return this._horizontalGap},set:function(t){t=+t,t!==this._horizontalGap&&(this.explicitHorizontalGap=t,this._horizontalGap=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"verticalGap",{get:function(){return this._verticalGap},set:function(t){t=+t,t!==this._verticalGap&&(this.explicitVerticalGap=t,this._verticalGap=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"columnCount",{get:function(){return this._columnCount},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"requestedColumnCount",{get:function(){return this._requestedColumnCount},set:function(t){t=+t||0,this._requestedColumnCount!==t&&(this._requestedColumnCount=t,this._columnCount=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"rowCount",{get:function(){return this._rowCount},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"requestedRowCount",{get:function(){return this._requestedRowCount},set:function(t){t=+t||0,this._requestedRowCount!=t&&(this._requestedRowCount=t,this._rowCount=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"columnWidth",{get:function(){return this._columnWidth},set:function(t){t=+t,t!==this._columnWidth&&(this.explicitColumnWidth=t,this._columnWidth=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"rowHeight",{get:function(){return this._rowHeight},set:function(t){t=+t,t!==this._rowHeight&&(this.explicitRowHeight=t,this._rowHeight=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"paddingLeft",{get:function(){return this._paddingLeft},set:function(t){t=+t||0,this._paddingLeft!=t&&(this._paddingLeft=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"paddingRight",{get:function(){return this._paddingRight},set:function(t){t=+t||0,this._paddingRight!==t&&(this._paddingRight=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"paddingTop",{get:function(){return this._paddingTop},set:function(t){t=+t||0,this._paddingTop!=t&&(this._paddingTop=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"paddingBottom",{get:function(){return this._paddingBottom},set:function(t){t=+t||0,this._paddingBottom!==t&&(this._paddingBottom=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"horizontalAlign",{get:function(){return this._horizontalAlign},set:function(t){this._horizontalAlign!=t&&(this._horizontalAlign=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"verticalAlign",{get:function(){return this._verticalAlign},set:function(t){this._verticalAlign!=t&&(this._verticalAlign=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"columnAlign",{get:function(){return this._columnAlign},set:function(t){this._columnAlign!=t&&(this._columnAlign=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"rowAlign",{get:function(){return this._rowAlign},set:function(t){this._rowAlign!=t&&(this._rowAlign=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"orientation",{get:function(){return this._orientation},set:function(t){this._orientation!=t&&(this._orientation=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),r.prototype.invalidateTargetLayout=function(){var t=this.$target;t&&(t.invalidateSize(),t.invalidateDisplayList())},r.prototype.measure=function(){var t=this.$target;if(t){var e=this._columnCount,i=this._rowCount,r=this._columnWidth,n=this._rowHeight,o=0,a=0,s=t.$UIComponent;this.calculateRowAndColumn(s[8],s[9]);var l=this._requestedColumnCount>0?this._requestedColumnCount:this._columnCount,h=this._requestedRowCount>0?this._requestedRowCount:this._rowCount,u=isNaN(this._horizontalGap)?0:this._horizontalGap,c=isNaN(this._verticalGap)?0:this._verticalGap;l>0&&(o=l*(this._columnWidth+u)-u),h>0&&(a=h*(this._rowHeight+c)-c);var p=this._paddingLeft+this._paddingRight,d=this._paddingTop+this._paddingBottom;t.setMeasuredSize(o+p,a+d),this._columnCount=e,this._rowCount=i,this._columnWidth=r,this._rowHeight=n}},r.prototype.calculateRowAndColumn=function(i,r){var n=this.$target,o=isNaN(this._horizontalGap)?0:this._horizontalGap,a=isNaN(this._verticalGap)?0:this._verticalGap;this._rowCount=this._columnCount=-1;for(var s=n.numElements,l=s,h=0;l>h;h++){var u=n.getElementAt(h);!u||egret.is(u,e)&&u.$includeInLayout||s--}if(0==s)return void(this._rowCount=this._columnCount=0);(isNaN(this.explicitColumnWidth)||isNaN(this.explicitRowHeight))&&this.updateMaxElementSize(),this._columnWidth=isNaN(this.explicitColumnWidth)?this.maxElementWidth:this.explicitColumnWidth,this._rowHeight=isNaN(this.explicitRowHeight)?this.maxElementHeight:this.explicitRowHeight;var c=this._columnWidth+o;0>=c&&(c=1);var p=this._rowHeight+a;0>=p&&(p=1);var d=this._orientation==t.TileOrientation.COLUMNS,f=!isNaN(i),g=!isNaN(r),y=this._paddingLeft,v=this._paddingRight,m=this._paddingTop,_=this._paddingBottom;if(this._requestedColumnCount>0||this._requestedRowCount>0)this._requestedRowCount>0&&(this._rowCount=Math.min(this._requestedRowCount,s)),this._requestedColumnCount>0&&(this._columnCount=Math.min(this._requestedColumnCount,s));else if(f||g)if(!f||g&&d){var b=Math.max(0,r-m-_);this._rowCount=Math.floor((b+a)/p),this._rowCount=Math.max(1,Math.min(this._rowCount,s))}else{var T=Math.max(0,i-y-v);this._columnCount=Math.floor((T+o)/c),this._columnCount=Math.max(1,Math.min(this._columnCount,s))}else{var x=Math.sqrt(s*c*p);d?this._rowCount=Math.max(1,Math.round(x/p)):this._columnCount=Math.max(1,Math.round(x/c))}-1==this._rowCount&&(this._rowCount=Math.max(1,Math.ceil(s/this._columnCount))),-1==this._columnCount&&(this._columnCount=Math.max(1,Math.ceil(s/this._rowCount))),this._requestedColumnCount>0&&this._requestedRowCount>0&&(this._orientation==t.TileOrientation.ROWS?this._rowCount=Math.max(1,Math.ceil(s/this._requestedColumnCount)):this._columnCount=Math.max(1,Math.ceil(s/this._requestedRowCount)))},r.prototype.updateMaxElementSize=function(){this.$target&&(this.$useVirtualLayout?(this.maxElementWidth=Math.max(this.maxElementWidth,this.$typicalWidth),this.maxElementHeight=Math.max(this.maxElementHeight,this.$typicalHeight),this.doUpdateMaxElementSize(this.startIndex,this.endIndex)):this.doUpdateMaxElementSize(0,this.$target.numElements-1))},r.prototype.doUpdateMaxElementSize=function(t,i){var r=this.maxElementWidth,n=this.maxElementHeight,o=egret.$TempRectangle,a=this.$target;if(-1!=t&&-1!=i)for(var s=t;i>=s;s++){var l=a.getVirtualElementAt(s);egret.is(l,e)&&l.$includeInLayout&&(l.getPreferredBounds(o),r=Math.max(r,o.width),n=Math.max(n,o.height))}this.maxElementWidth=r,this.maxElementHeight=n},r.prototype.clearVirtualLayoutCache=function(){i.prototype.clearVirtualLayoutCache.call(this),this.maxElementWidth=0,this.maxElementHeight=0},r.prototype.scrollPositionChanged=function(){if(this.$useVirtualLayout){var t=this.getIndexInView();t&&(this.indexInViewCalculated=!0,this.$target.invalidateDisplayList())}},r.prototype.getIndexInView=function(){if(!this.$target||0==this.$target.numElements)return this.startIndex=this.endIndex=-1,!1;var e=this.$target,i=e.numElements;if(!this.$useVirtualLayout)return this.startIndex=0,this.endIndex=i-1,!1;var r=e.$UIComponent;if(0==r[10]||0==r[11])return this.startIndex=this.endIndex=-1,!1;var n=this.startIndex,o=this.endIndex,a=this._paddingLeft,s=this._paddingTop,l=isNaN(this._horizontalGap)?0:this._horizontalGap,h=isNaN(this._verticalGap)?0:this._verticalGap;if(this._orientation==t.TileOrientation.COLUMNS){var u=this._columnWidth+l;if(0>=u)return this.startIndex=0,this.endIndex=i-1,!1;var c=e.scrollH,p=c+r[10],d=Math.floor((c-a)/u);0>d&&(d=0);var f=Math.ceil((p-a)/u);0>f&&(f=0),this.startIndex=Math.min(i-1,Math.max(0,d*this._rowCount)),this.endIndex=Math.min(i-1,Math.max(0,f*this._rowCount-1))}else{var g=this._rowHeight+h;if(0>=g)return this.startIndex=0,this.endIndex=i-1,!1;var y=e.scrollV,v=y+r[11],m=Math.floor((y-s)/g);0>m&&(m=0);var _=Math.ceil((v-s)/g);0>_&&(_=0),this.startIndex=Math.min(i-1,Math.max(0,m*this._columnCount)),this.endIndex=Math.min(i-1,Math.max(0,_*this._columnCount-1))}return this.startIndex!=n||this.endIndex!=o},r.prototype.updateDisplayList=function(r,n){if(i.prototype.updateDisplayList.call(this,r,n),this.$target){var o=this.$target,a=this._paddingLeft,s=this._paddingRight,l=this._paddingTop,h=this._paddingBottom;if(this.indexInViewCalculated)this.indexInViewCalculated=!1;else{if(this.calculateRowAndColumn(r,n),0==this._rowCount||0==this._columnCount)return void o.setContentSize(a+s,l+h);this.adjustForJustify(r,n),this.getIndexInView()}if(this.$useVirtualLayout&&(this.calculateRowAndColumn(r,n),this.adjustForJustify(r,n)),-1==this.startIndex||-1==this.endIndex)return void o.setContentSize(0,0);var u=this.endIndex;o.setVirtualElementIndicesInView(this.startIndex,u);for(var c,p,d,f,g,y=this._orientation==t.TileOrientation.COLUMNS,v=this.startIndex,m=isNaN(this._horizontalGap)?0:this._horizontalGap,_=isNaN(this._verticalGap)?0:this._verticalGap,b=this._rowCount,T=this._columnCount,x=this._columnWidth,E=this._rowHeight,$=this.startIndex;u>=$;$++)c=this.$useVirtualLayout?this.target.getVirtualElementAt($):this.target.getElementAt($),egret.is(c,e)&&c.$includeInLayout&&(y?(f=Math.ceil((v+1)/b)-1,g=Math.ceil((v+1)%b)-1,-1==g&&(g=b-1)):(f=Math.ceil((v+1)%T)-1,-1==f&&(f=T-1),g=Math.ceil((v+1)/T)-1),p=f*(x+m)+a,d=g*(E+_)+l,this.sizeAndPositionElement(c,p,d,x,E),v++);var S=a+s,C=l+h,w=(x+m)*T-m,O=(E+_)*b-_;o.setContentSize(w+S,O+C)}},r.prototype.sizeAndPositionElement=function(e,i,r,n,o){var a=0/0,s=0/0,l=e.$UIComponent;this._horizontalAlign==t.JustifyAlign.JUSTIFY?a=n:isNaN(l[6])||(a=n*l[6]*.01),this._verticalAlign==t.JustifyAlign.JUSTIFY?s=o:isNaN(l[7])||(s=o*l[7]*.01),e.setLayoutBoundsSize(Math.round(a),Math.round(s));var h=i,u=egret.$TempRectangle;switch(e.getLayoutBounds(u),this._horizontalAlign){case egret.HorizontalAlign.RIGHT:h+=n-u.width;break;case egret.HorizontalAlign.CENTER:h=i+(n-u.width)/2}var c=r;switch(this._verticalAlign){case egret.VerticalAlign.BOTTOM:c+=o-u.height;break;case egret.VerticalAlign.MIDDLE:c+=(o-u.height)/2}e.setLayoutBoundsPosition(Math.round(h),Math.round(c))},r.prototype.adjustForJustify=function(e,i){var r=this._paddingLeft,n=this._paddingRight,o=this._paddingTop,a=this._paddingBottom,s=Math.max(0,e-r-n),l=Math.max(0,i-o-a);isNaN(this.explicitVerticalGap)||(this._verticalGap=this.explicitVerticalGap),isNaN(this.explicitHorizontalGap)||(this._horizontalGap=this.explicitHorizontalGap),this._verticalGap=isNaN(this._verticalGap)?0:this._verticalGap,this._horizontalGap=isNaN(this._horizontalGap)?0:this._horizontalGap;var h,u=l-this._rowHeight*this._rowCount,c=s-this._columnWidth*this._columnCount;u>0&&(this._rowAlign==t.RowAlign.JUSTIFY_USING_GAP?(h=Math.max(1,this._rowCount-1),this._verticalGap=u/h):this._rowAlign==t.RowAlign.JUSTIFY_USING_HEIGHT&&this._rowCount>0&&(this._rowHeight+=(u-(this._rowCount-1)*this._verticalGap)/this._rowCount)),c>0&&(this._columnAlign==t.ColumnAlign.JUSTIFY_USING_GAP?(h=Math.max(1,this._columnCount-1),this._horizontalGap=c/h):this._columnAlign==t.ColumnAlign.JUSTIFY_USING_WIDTH&&this._columnCount>0&&(this._columnWidth+=(c-(this._columnCount-1)*this._horizontalGap)/this._columnCount))},r}(t.LayoutBase);t.TileLayout=i,__reflect(i.prototype,"eui.TileLayout"),egret.$markReadOnly(i,"columnCount"),egret.$markReadOnly(i,"rowCount")}(eui||(eui={}));var eui;!function(t){var e=function(){function t(){}return t}();e.ROWS="rows",e.COLUMNS="columns",t.TileOrientation=e,__reflect(e.prototype,"eui.TileOrientation")}(eui||(eui={}));var eui;!function(t){var e="eui.UIComponent",i=function(i){function r(){return i.apply(this,arguments)||this}return __extends(r,i),r.prototype.measureReal=function(){for(var t=this.$target,i=t.numElements,r=i,n=0,o=0,a=egret.$TempRectangle,s=0;i>s;s++){var l=t.getElementAt(s);egret.is(l,e)&&l.$includeInLayout?(l.getPreferredBounds(a),o+=a.height,n=Math.max(n,a.width)):r--}o+=(r-1)*this.$gap;var h=this.$paddingLeft+this.$paddingRight,u=this.$paddingTop+this.$paddingBottom;t.setMeasuredSize(n+h,o+u)},r.prototype.measureVirtual=function(){for(var t=this.$target,i=this.$typicalHeight,r=this.getElementTotalSize(),n=Math.max(this.maxElementSize,this.$typicalWidth),o=egret.$TempRectangle,a=this.endIndex,s=this.elementSizeTable,l=this.startIndex;a>l;l++){var h=t.getElementAt(l);egret.is(h,e)&&h.$includeInLayout&&(h.getPreferredBounds(o),r+=o.height,r-=isNaN(s[l])?i:s[l],n=Math.max(n,o.width))}var u=this.$paddingLeft+this.$paddingRight,c=this.$paddingTop+this.$paddingBottom;t.setMeasuredSize(n+u,r+c)},r.prototype.updateDisplayListReal=function(i,r){var n=this.$target,o=this.$paddingLeft,a=this.$paddingRight,s=this.$paddingTop,l=this.$paddingBottom,h=this.$gap,u=Math.max(0,i-o-a),c=Math.max(0,r-s-l),p=this.$verticalAlign==t.JustifyAlign.JUSTIFY,d=this.$horizontalAlign==t.JustifyAlign.JUSTIFY||this.$horizontalAlign==t.JustifyAlign.CONTENT_JUSTIFY,f=0;d||(this.$horizontalAlign==egret.HorizontalAlign.CENTER?f=.5:this.$horizontalAlign==egret.HorizontalAlign.RIGHT&&(f=1));var g,y,v,m=n.numElements,_=m,b=o,T=s,x=0,E=0,$=[],S=c,C=this.maxElementSize,w=egret.$TempRectangle;for(g=0;m>g;g++){var O=n.getElementAt(g);if(egret.is(O,e)&&O.$includeInLayout)if(O.getPreferredBounds(w),C=Math.max(C,w.width),p)x+=w.height;else{var P=O.$UIComponent;isNaN(P[7])?S-=w.height:(E+=P[7],v=new t.sys.ChildInfo,v.layoutElement=O,v.percent=P[7],v.min=P[14],v.max=P[15],$.push(v))}else _--}S-=h*(_-1),S=S>0?S:0;var D,L=c-x-h*(_-1),R=_,I={};if(p){if(0>L){for(D=S/_,g=0;m>g;g++)y=n.getElementAt(g),egret.is(y,e)&&y.$includeInLayout&&(y.getPreferredBounds(w),w.height<=D&&(S-=w.height,R--));S=S>0?S:0}}else if(E>0){this.flexChildrenProportionally(c,S,E,$);var M=0,A=$.length;for(g=0;A>g;g++){v=$[g];var B=Math.round(v.size+M);M+=v.size-B,I[v.layoutElement.$hashCode]=B,S-=B}S=S>0?S:0}this.$verticalAlign==egret.VerticalAlign.MIDDLE?T=s+.5*S:this.$verticalAlign==egret.VerticalAlign.BOTTOM&&(T=s+S);var N=o,F=s,k=0,j=0,U=Math.ceil(u);this.$horizontalAlign==t.JustifyAlign.CONTENT_JUSTIFY&&(U=Math.ceil(Math.max(u,C)));var H,V,X=0;for(g=0;m>g;g++){var G=0;if(y=n.getElementAt(g),egret.is(y,e)&&y.$includeInLayout){if(y.getPreferredBounds(w),H=0/0,p?(V=0/0,L>0?V=S*w.height/x:0>L&&w.height>D&&(V=S/R),isNaN(V)||(H=Math.round(V+X),X+=V-H)):H=I[y.$hashCode],d)b=o,y.setLayoutBoundsSize(U,H),y.getLayoutBounds(w);else{var z=0/0,P=y.$UIComponent;if(!isNaN(P[6])){var W=Math.min(100,P[6]);z=Math.round(u*W*.01)}y.setLayoutBoundsSize(z,H),y.getLayoutBounds(w),G=(u-w.width)*f,G=G>0?G:0,b=o+G}y.setLayoutBoundsPosition(Math.round(b),Math.round(T)),k=Math.ceil(w.width),j=Math.ceil(w.height),N=Math.max(N,b+k),F=Math.max(F,T+j),T+=j+h}}this.maxElementSize=C,n.setContentSize(N+a,F+l)},r.prototype.updateDisplayListVirtual=function(i){var r=this.$target;this.indexInViewCalculated?this.indexInViewCalculated=!1:this.getIndexInView();var n,o=this.$paddingBottom,a=this.$paddingLeft,s=this.$paddingRight,l=this.$gap,h=r.numElements;if(-1==this.startIndex||-1==this.endIndex)return n=this.getStartPosition(h)-l+o,void r.setContentSize(r.contentWidth,n);var u=this.endIndex;r.setVirtualElementIndicesInView(this.startIndex,u);var c=this.$horizontalAlign==t.JustifyAlign.JUSTIFY||this.$horizontalAlign==t.JustifyAlign.CONTENT_JUSTIFY,p=this.$horizontalAlign==t.JustifyAlign.CONTENT_JUSTIFY,d=0;c||(this.$horizontalAlign==egret.HorizontalAlign.CENTER?d=.5:this.$horizontalAlign==egret.HorizontalAlign.RIGHT&&(d=1));var f,g=egret.$TempRectangle,y=Math.max(0,i-a-s),v=Math.ceil(y),m=this.$typicalHeight,_=this.$typicalWidth,b=this.maxElementSize,T=Math.max(_,this.maxElementSize);if(p){for(var x=this.startIndex;u>=x;x++)f=r.getVirtualElementAt(x),egret.is(f,e)&&f.$includeInLayout&&(f.getPreferredBounds(g),b=Math.max(b,g.width));v=Math.ceil(Math.max(y,b))}for(var E,$=0,S=0,C=0,w=!1,O=this.elementSizeTable,P=this.startIndex;u>=P;P++){var D=0;f=r.getVirtualElementAt(P),egret.is(f,e)&&f.$includeInLayout&&(f.getPreferredBounds(g),p||(b=Math.max(b,g.width)),c?($=a,f.setLayoutBoundsSize(v,0/0),f.getLayoutBounds(g)):(f.getLayoutBounds(g),D=(y-g.width)*d,D=D>0?D:0,$=a+D),C=Math.max(C,g.width),w||(E=isNaN(O[P])?m:O[P],E!=g.height&&(w=!0)),O[P]=g.height,S=this.getStartPosition(P),f.setLayoutBoundsPosition(Math.round($),Math.round(S)))}C+=a+s,n=this.getStartPosition(h)-l+o,this.maxElementSize=b,r.setContentSize(C,n),(w||T<this.maxElementSize)&&r.invalidateSize()},r.prototype.getStartPosition=function(t){if(!this.$useVirtualLayout&&this.$target){var e=this.$target.getElementAt(t);if(e)return e.y}for(var i=this.$typicalHeight,r=this.$paddingTop,n=this.$gap,o=this.elementSizeTable,a=0;t>a;a++){var s=o[a];isNaN(s)&&(s=i),r+=s+n}return r},r.prototype.getElementSize=function(t){if(this.$useVirtualLayout){var e=this.elementSizeTable[t];return isNaN(e)&&(e=this.$typicalHeight),e}return this.$target?this.$target.getElementAt(t).height:0},r.prototype.getElementTotalSize=function(){for(var t=this.$typicalHeight,e=this.$gap,i=0,r=this.$target.numElements,n=this.elementSizeTable,o=0;r>o;o++){var a=n[o];isNaN(a)&&(a=t),i+=a+e}return i-=e},r.prototype.elementAdded=function(t){this.$useVirtualLayout&&(i.prototype.elementAdded.call(this,t),this.elementSizeTable.splice(t,0,this.$typicalHeight))},r.prototype.getIndexInView=function(){var t=this.$target;if(!t||0==t.numElements)return this.startIndex=this.endIndex=-1,!1;var e=t.$UIComponent;if(0==e[10]||0==e[11])return this.startIndex=this.endIndex=-1,!1;var i=t.numElements,r=this.getStartPosition(i-1)+this.elementSizeTable[i-1]+this.$paddingBottom,n=t.scrollV;if(n>r-this.$paddingBottom)return this.startIndex=-1,this.endIndex=-1,!1;var o=t.scrollV+e[11];if(o<this.$paddingTop)return this.startIndex=-1,this.endIndex=-1,!1;var a=this.startIndex,s=this.endIndex;return this.startIndex=this.findIndexAt(n,0,i-1),-1==this.startIndex&&(this.startIndex=0),this.endIndex=this.findIndexAt(o,0,i-1),-1==this.endIndex&&(this.endIndex=i-1),a!=this.startIndex||s!=this.endIndex},r}(t.LinearLayoutBase);t.VerticalLayout=i,__reflect(i.prototype,"eui.VerticalLayout")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){return t.apply(this,arguments)||this}return __extends(e,t),e.prototype.updateDisplayList=function(e,i){t.prototype.updateDisplayList.call(this,e,i);var r=this.thumb,n=this.$viewport;if(r&&n){var o=egret.$TempRectangle;r.getPreferredBounds(o);var a=o.width,s=o.y,l=n.scrollH,h=n.contentWidth,u=n.width;if(0>=l){var c=a*(1- -l/(.5*u));c=Math.max(5,Math.round(c)),r.setLayoutBoundsSize(c,0/0),r.setLayoutBoundsPosition(0,s)}else if(l>=h-u){var c=a*(1-(l-h+u)/(.5*u));c=Math.max(5,Math.round(c)),r.setLayoutBoundsSize(c,0/0),r.setLayoutBoundsPosition(e-c,s)}else{var p=(e-a)*l/(h-u);r.setLayoutBoundsSize(0/0,0/0),r.setLayoutBoundsPosition(p,s)}}},e.prototype.onPropertyChanged=function(t){switch(t.property){case"scrollH":case"contentWidth":this.invalidateDisplayList()}},e}(t.ScrollBarBase);t.HScrollBar=e,__reflect(e.prototype,"eui.HScrollBar")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.pointToValue=function(t){if(!this.thumb||!this.track)return 0;var e=this.$Range,i=e[0]-e[2],r=this.getThumbRange();return e[2]+(0!=r?t/r*i:0)},e.prototype.getThumbRange=function(){var t=egret.$TempRectangle;this.track.getLayoutBounds(t);var e=t.width;return this.thumb.getLayoutBounds(t),e-t.width},e.prototype.updateSkinDisplayList=function(){if(this.thumb&&this.track){var t=this.$Range,e=this.getThumbRange(),i=t[0]-t[2],r=i>0?(this.pendingValue-t[2])/i*e:0,n=this.track.localToGlobal(r,0,egret.$TempPoint),o=n.x,a=n.y,s=this.thumb.$parent.globalToLocal(o,a,egret.$TempPoint).x,l=egret.$TempRectangle;if(this.thumb.getLayoutBounds(l),this.thumb.setLayoutBoundsPosition(Math.round(s),l.y),this.trackHighlight&&this.trackHighlight.$parent){var h=this.trackHighlight.$parent.globalToLocal(o,a,egret.$TempPoint).x-r;this.trackHighlight.x=Math.round(h),this.trackHighlight.width=Math.round(r)}}},e}(t.SliderBase);t.HSlider=e,__reflect(e.prototype,"eui.HSlider")}(eui||(eui={}));var eui;!function(t){var e=function(){function t(t,e,i,r){this.target=t,this.propertyName=e,this.position=i,this.relativeTo=r}return t.prototype.apply=function(t,e){var i,r=t[this.relativeTo],n=t[this.target],o=this.propertyName?t[this.propertyName]:e;if(n&&o){switch(this.position){case 0:i=0;break;case 1:i=-1;break;case 2:i=o.getChildIndex(r);break;case 3:i=o.getChildIndex(r)+1}-1==i&&(i=o.numChildren),egret.is(o,"eui.Component")&&o.$Component[8].$elementsContent.push(n),o.addChildAt(n,i)}},t.prototype.remove=function(t,e){var i=this.propertyName?t[this.propertyName]:e,r=t[this.target];if(r&&i&&(r.$parent===i&&i.removeChild(r),egret.is(i,"eui.Component"))){var n=i.$Component[8].$elementsContent,o=n.indexOf(r);o>-1&&n.splice(o,1)}},t}();t.AddItems=e,__reflect(e.prototype,"eui.AddItems",["eui.IOverride"])}(eui||(eui={}));var eui;!function(t){var e=function(){function t(t,e,i){this.target=t,this.name=e,this.value=i}return t.prototype.apply=function(t){var e=this.target?t[this.target]:t;e&&(this.oldValue=e[this.name],this.setPropertyValue(e,this.name,this.value,this.oldValue))},t.prototype.remove=function(t){var e=this.target?t[this.target]:t;e&&(this.setPropertyValue(e,this.name,this.oldValue,this.oldValue),this.oldValue=null)},t.prototype.setPropertyValue=function(t,e,i,r){t[e]=void 0===i||null===i?i:"number"==typeof r?+i:"boolean"==typeof r?this.toBoolean(i):i},t.prototype.toBoolean=function(t){return"string"==typeof t?"true"==t.toLowerCase():0!=t},t}();t.SetProperty=e,__reflect(e.prototype,"eui.SetProperty",["eui.IOverride"])}(eui||(eui={}));var eui;!function(t){var e=function(){function e(t,e,i,r,n){this.host=t,this.templates=e,this.chainIndex=i,this.target=r,this.prop=n}return e.prototype.apply=function(){if(this.target){var e=this.target[this.prop];this.oldValue&&this.setPropertyValue(this.target,this.prop,this.oldValue,this.oldValue),e&&(this.oldValue=e),t.Binding.$bindProperties(this.host,this.templates.concat(),this.chainIndex.concat(),this.target,this.prop)}},e.prototype.remove=function(){if(this.target){var t=this.oldValue;this.target[this.prop]&&(this.oldValue=this.target[this.prop]),t&&this.setPropertyValue(this.target,this.prop,t,t)}},e.prototype.setPropertyValue=function(t,e,i,r){t[e]=void 0===i||null===i?i:"number"==typeof r?+i:"boolean"==typeof r?this.toBoolean(i):i},e.prototype.toBoolean=function(t){return"string"==typeof t?"true"==t.toLowerCase():0!=t},e}();t.SetStateProperty=e,__reflect(e.prototype,"eui.SetStateProperty",["eui.IOverride"])}(eui||(eui={}));var eui;!function(t){var e=function(){function t(){}return t.prototype.getTheme=function(t,e,i,r){function n(t){var i=t.target;e.call(r,i.response)}function o(){i.call(r)}var a=new egret.HttpRequest;a.addEventListener(egret.Event.COMPLETE,n,r),a.addEventListener(egret.IOErrorEvent.IO_ERROR,o,r),a.responseType=egret.HttpResponseType.TEXT,a.open(t),a.send()},t}();t.DefaultThemeAdapter=e,__reflect(e.prototype,"eui.DefaultThemeAdapter",["eui.IThemeAdapter"])}(eui||(eui={}));var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},egret;!function(){}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(r,n){void 0===r&&(r=""),void 0===n&&(n=0);var o=e.call(this)||this;return o._writeMessage="",o._readMessage="",o._connected=!1,o._connecting=!1,o._isReadySend=!1,o._bytesWrite=!1,o._type=i.TYPE_STRING,o._connected=!1,o._writeMessage="",o._readMessage="",o.socket=new t.ISocket,o.socket.addCallBacks(o.onConnect,o.onClose,o.onSocketData,o.onError,o),o}return __extends(i,e),i.prototype.connect=function(t,e){this._connecting||this._connected||(this._connecting=!0,this.socket.connect(t,e))},i.prototype.connectByUrl=function(t){this._connecting||this._connected||(this._connecting=!0,this.socket.connectByUrl(t))},i.prototype.close=function(){this._connected&&this.socket.close()},i.prototype.onConnect=function(){this._connected=!0,this._connecting=!1,this.dispatchEventWith(t.Event.CONNECT)},i.prototype.onClose=function(){this._connected=!1,this.dispatchEventWith(t.Event.CLOSE)},i.prototype.onError=function(){this._connecting&&(this._connecting=!1),this.dispatchEventWith(t.IOErrorEvent.IO_ERROR)},i.prototype.onSocketData=function(e){"string"==typeof e?this._readMessage+=e:this._readByte._writeUint8Array(new Uint8Array(e)),t.ProgressEvent.dispatchProgressEvent(this,t.ProgressEvent.SOCKET_DATA)},i.prototype.flush=function(){return this._connected?(this._writeMessage&&(this.socket.send(this._writeMessage),this._writeMessage=""),this._bytesWrite&&(this.socket.send(this._writeByte.buffer),this._bytesWrite=!1,this._writeByte.clear()),void(this._isReadySend=!1)):void t.$warn(3101)},i.prototype.writeUTF=function(e){return this._connected?(this._type==i.TYPE_BINARY?(this._bytesWrite=!0,this._writeByte.writeUTF(e)):this._writeMessage+=e,void this.flush()):void t.$warn(3101)},i.prototype.readUTF=function(){var t;return this._type==i.TYPE_BINARY?(this._readByte.position=0,t=this._readByte.readUTF(),this._readByte.clear()):(t=this._readMessage,this._readMessage=""),t},i.prototype.writeBytes=function(e,i,r){return void 0===i&&(i=0),void 0===r&&(r=0),this._connected?this._writeByte?(this._bytesWrite=!0,this._writeByte.writeBytes(e,i,r),void this.flush()):void t.$warn(3102):void t.$warn(3101)},i.prototype.readBytes=function(e,i,r){return void 0===i&&(i=0),void 0===r&&(r=0),this._readByte?(this._readByte.position=0,this._readByte.readBytes(e,i,r),void this._readByte.clear()):void t.$warn(3102)},Object.defineProperty(i.prototype,"connected",{get:function(){return this._connected},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"type",{get:function(){return this._type},set:function(e){this._type=e,e!=i.TYPE_BINARY||this._writeByte||(this._readByte=new t.ByteArray,this._writeByte=new t.ByteArray)},enumerable:!0,configurable:!0}),i}(t.EventDispatcher);e.TYPE_STRING="webSocketTypeString",e.TYPE_BINARY="webSocketTypeBinary",t.WebSocket=e,__reflect(e.prototype,"egret.WebSocket")}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(){function t(){this.host="",this.port=0}return t.prototype.addCallBacks=function(t,e,i,r,n){this.onConnect=t,this.onClose=e,this.onSocketData=i,this.onError=r,this.thisObject=n},t.prototype.connect=function(t,e){this.host=t,this.port=e;var i="ws://"+this.host+":"+this.port;this.socket=new __global.egret_native.WebSocket(i),this._bindEvent()},t.prototype.connectByUrl=function(t){this.socket=new __global.egret_native.WebSocket(t),this._bindEvent()},t.prototype._bindEvent=function(){var t=this,e=this.socket;e.onOpen=function(){t.onConnect&&t.onConnect.call(t.thisObject)},e.onClose=function(){t.onClose&&t.onClose.call(t.thisObject)},e.onError=function(){t.onError&&t.onError.call(t.thisObject)},e.onMessage=function(e){t.onSocketData&&t.onSocketData.call(t.thisObject,e)}},t.prototype.send=function(t){this.socket.send(t)},t.prototype.close=function(){this.socket.close()},t}();e.NativeSocket=i,__reflect(i.prototype,"egret.native.NativeSocket",["egret.ISocket"]),t.Capabilities.runtimeType==t.RuntimeType.NATIVE&&(t.ISocket=i)}(e=t["native"]||(t["native"]={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(){function e(){this.host="",this.port=0,window.WebSocket||t.$error(3100)}return e.prototype.addCallBacks=function(t,e,i,r,n){this.onConnect=t,this.onClose=e,this.onSocketData=i,this.onError=r,this.thisObject=n},e.prototype.connect=function(t,e){this.host=t,this.port=e;var i="ws://"+this.host+":"+this.port;this.socket=new window.WebSocket(i),this.socket.binaryType="arraybuffer",this._bindEvent()},e.prototype.connectByUrl=function(t){this.socket=new window.WebSocket(t),this.socket.binaryType="arraybuffer",this._bindEvent()},e.prototype._bindEvent=function(){var t=this,e=this.socket;e.onopen=function(){t.onConnect&&t.onConnect.call(t.thisObject)},e.onclose=function(){t.onClose&&t.onClose.call(t.thisObject)},e.onerror=function(){t.onError&&t.onError.call(t.thisObject)},e.onmessage=function(e){t.onSocketData&&t.onSocketData.call(t.thisObject,e.data)}},e.prototype.send=function(t){this.socket.send(t)},e.prototype.close=function(){this.socket.close()},e}();e.HTML5WebSocket=i,__reflect(i.prototype,"egret.web.HTML5WebSocket",["egret.ISocket"]),t.Capabilities.runtimeType==t.RuntimeType.WEB&&(t.ISocket=i)}(e=t.web||(t.web={}))}(egret||(egret={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},dragonBones;!function(t){var e=function(){function t(){this.hashCode=t._hashCode++}return t._returnObject=function(e){var i=String(e.constructor),r=null==t._maxCountMap[i]?t._defaultMaxCount:t._maxCountMap[i],n=t._poolsMap[i]=t._poolsMap[i]||[];if(n.length<r){if(!(n.indexOf(e)<0))throw new Error;n.push(e)}},t.setMaxCount=function(e,i){if((0>i||i!=i)&&(i=0),e){var r=String(e);t._maxCountMap[r]=i;var n=t._poolsMap[r];n&&n.length>i&&(n.length=i)}else{t._defaultMaxCount=i;for(var r in t._poolsMap)if(null!=t._maxCountMap[r]){t._maxCountMap[r]=i;var n=t._poolsMap[r];n.length>i&&(n.length=i)}}},t.clearPool=function(e){if(void 0===e&&(e=null),e){var i=t._poolsMap[String(e)];
i&&i.length&&(i.length=0)}else for(var r in t._poolsMap){var i=t._poolsMap[r];i.length=0}},t.borrowObject=function(e){var i=t._poolsMap[String(e)];if(i&&i.length)return i.pop();var r=new e;return r._onClear(),r},t.prototype.returnToPool=function(){this._onClear(),t._returnObject(this)},t._hashCode=0,t._defaultMaxCount=5e3,t._maxCountMap={},t._poolsMap={},t}();t.BaseObject=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){}return t.hasArmature=function(e){return t._armatures.indexOf(e)>=0},t.addArmature=function(e){e&&t._armatures.indexOf(e)<0&&t._armatures.push(e)},t.removeArmature=function(e){if(e){var i=t._armatures.indexOf(e);i>=0&&t._armatures.splice(i,1)}},t.PI_D=2*Math.PI,t.PI_H=Math.PI/2,t.PI_Q=Math.PI/4,t.ANGLE_TO_RADIAN=Math.PI/180,t.RADIAN_TO_ANGLE=180/Math.PI,t.SECOND_TO_MILLISECOND=1e3,t.NO_TWEEN=100,t.VERSION="4.7.2",t.debug=!1,t.debugDraw=!1,t._armatures=[],t}();t.DragonBones=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this)}return __extends(e,t),e.toString=function(){return"[class dragonBones.EventObject]"},e.prototype._onClear=function(){this.type=null,this.name=null,this.data=null,this.armature=null,this.bone=null,this.slot=null,this.animationState=null,this.frame=null,this.userData=null},e.START="start",e.LOOP_COMPLETE="loopComplete",e.COMPLETE="complete",e.FADE_IN="fadeIn",e.FADE_IN_COMPLETE="fadeInComplete",e.FADE_OUT="fadeOut",e.FADE_OUT_COMPLETE="fadeOutComplete",e.FRAME_EVENT="frameEvent",e.SOUND_EVENT="soundEvent",e}(t.BaseObject);t.EventObject=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y},t.prototype.clear=function(){this.x=this.y=0},t}();t.Point=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=i,this.height=r}return t.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},t.prototype.clear=function(){this.x=this.y=0,this.width=this.height=0},t}();t.Rectangle=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e,i,r,n,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),void 0===n&&(n=1),void 0===o&&(o=1),this.x=t,this.y=e,this.skewX=i,this.skewY=r,this.scaleX=n,this.scaleY=o}return t.normalizeRadian=function(t){return t=(t+Math.PI)%(2*Math.PI),t+=t>0?-Math.PI:Math.PI},t.prototype.toString=function(){return"[object dragonBones.Transform] x:"+this.x+" y:"+this.y+" skewX:"+180*this.skewX/Math.PI+" skewY:"+180*this.skewY/Math.PI+" scaleX:"+this.scaleX+" scaleY:"+this.scaleY},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.skewX=t.skewX,this.skewY=t.skewY,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this},t.prototype.identity=function(){return this.x=this.y=this.skewX=this.skewY=0,this.scaleX=this.scaleY=1,this},t.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.skewX+=t.skewX,this.skewY+=t.skewY,this.scaleX*=t.scaleX,this.scaleY*=t.scaleY,this},t.prototype.minus=function(e){return this.x-=e.x,this.y-=e.y,this.skewX=t.normalizeRadian(this.skewX-e.skewX),this.skewY=t.normalizeRadian(this.skewY-e.skewY),this.scaleX/=e.scaleX,this.scaleY/=e.scaleY,this},t.prototype.fromMatrix=function(t){var e=.25*Math.PI,i=this.scaleX,r=this.scaleY;return this.x=t.tx,this.y=t.ty,this.skewX=Math.atan(-t.c/t.d),this.skewY=Math.atan(t.b/t.a),this.skewX!=this.skewX&&(this.skewX=0),this.skewY!=this.skewY&&(this.skewY=0),this.scaleY=this.skewX>-e&&this.skewX<e?t.d/Math.cos(this.skewX):-t.c/Math.sin(this.skewX),this.scaleX=this.skewY>-e&&this.skewY<e?t.a/Math.cos(this.skewY):t.b/Math.sin(this.skewY),i>=0&&this.scaleX<0&&(this.scaleX=-this.scaleX,this.skewY=this.skewY-Math.PI),r>=0&&this.scaleY<0&&(this.scaleY=-this.scaleY,this.skewX=this.skewX-Math.PI),this},t.prototype.toMatrix=function(t){return t.a=this.scaleX*Math.cos(this.skewY),t.b=this.scaleX*Math.sin(this.skewY),t.c=-this.scaleY*Math.sin(this.skewX),t.d=this.scaleY*Math.cos(this.skewX),t.tx=this.x,t.ty=this.y,this},Object.defineProperty(t.prototype,"rotation",{get:function(){return this.skewY},set:function(t){var e=t-this.skewY;this.skewX+=e,this.skewY+=e},enumerable:!0,configurable:!0}),t}();t.Transform=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e,i,r,n,o,a,s){void 0===t&&(t=1),void 0===e&&(e=1),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===s&&(s=0),this.alphaMultiplier=t,this.redMultiplier=e,this.greenMultiplier=i,this.blueMultiplier=r,this.alphaOffset=n,this.redOffset=o,this.greenOffset=a,this.blueOffset=s}return t.prototype.copyFrom=function(t){this.alphaMultiplier=t.alphaMultiplier,this.redMultiplier=t.redMultiplier,this.greenMultiplier=t.greenMultiplier,this.blueMultiplier=t.blueMultiplier,this.alphaOffset=t.alphaOffset,this.redOffset=t.redOffset,this.redOffset=t.redOffset,this.greenOffset=t.blueOffset},t.prototype.identity=function(){this.alphaMultiplier=this.redMultiplier=this.greenMultiplier=this.blueMultiplier=1,this.alphaOffset=this.redOffset=this.greenOffset=this.blueOffset=0},t}();t.ColorTransform=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e,i,r,n,o){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===o&&(o=0),this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=o}return t.prototype.toString=function(){return"[object dragonBones.Matrix] a:"+this.a+" b:"+this.b+" c:"+this.c+" d:"+this.d+" tx:"+this.tx+" ty:"+this.ty},t.prototype.copyFrom=function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty},t.prototype.identity=function(){this.a=this.d=1,this.b=this.c=0,this.tx=this.ty=0},t.prototype.concat=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,o=this.tx,a=this.ty,s=t.a,l=t.b,h=t.c,u=t.d,c=t.tx,p=t.ty;this.a=e*s+i*h,this.b=e*l+i*u,this.c=r*s+n*h,this.d=r*l+n*u,this.tx=s*o+h*a+c,this.ty=u*a+l*o+p},t.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,o=this.ty,a=t*r-e*i;this.a=r/a,this.b=-e/a,this.c=-i/a,this.d=t/a,this.tx=(i*o-r*n)/a,this.ty=-(t*o-e*n)/a},t.prototype.transformPoint=function(t,e,i,r){void 0===r&&(r=!1),i.x=this.a*t+this.c*e,i.y=this.b*t+this.d*e,r||(i.x+=this.tx,i.y+=this.ty)},t}();t.Matrix=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this),this.armatures={},this._armatureNames=[]}return __extends(e,t),e.toString=function(){return"[class dragonBones.DragonBonesData]"},e.prototype._onClear=function(){for(var t in this.armatures)this.armatures[t].returnToPool(),delete this.armatures[t];this.autoSearch=!1,this.frameRate=0,this.name=null,this._armatureNames.length=0},e.prototype.getArmature=function(t){return this.armatures[t]},e.prototype.addArmature=function(t){if(!t||!t.name||this.armatures[t.name])throw new Error;this.armatures[t.name]=t,this._armatureNames.push(t.name),t.parent=this},Object.defineProperty(e.prototype,"armatureNames",{get:function(){return this._armatureNames},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.returnToPool()},e}(t.BaseObject);t.DragonBonesData=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this),this.data=[]}return __extends(e,t),e.toString=function(){return"[class dragonBones.ActionData]"},e.prototype._onClear=function(){this.type=0,this.bone=null,this.slot=null,this.data.length=0},e}(t.BaseObject);t.ActionData=e;var i=function(t){function e(){t.call(this)}return __extends(e,t),e.toString=function(){return"[class dragonBones.EventData]"},e.prototype._onClear=function(){this.type=10,this.name=null,this.data=null,this.bone=null,this.slot=null},e}(t.BaseObject);t.EventData=i;var r=function(t){function e(){t.call(this)}return __extends(e,t),e.prototype._onClear=function(){this.position=0,this.duration=0,this.prev=null,this.next=null},e}(t.BaseObject);t.FrameData=r;var n=function(e){function i(){e.call(this)}return __extends(i,e),i._getCurvePoint=function(t,e,i,r,n,o,a,s,l,h){var u=1-l,c=u*u,p=l*l,d=u*c,f=3*l*c,g=3*u*p,y=l*p;h.x=d*t+f*i+g*n+y*a,h.y=d*e+f*r+g*o+y*s},i.samplingEasingCurve=function(e,r){for(var n=e.length,o=new t.Point,a=-2,s=0,l=r.length;l>s;++s){for(var h=(s+1)/(l+1);(n>a+6?e[a+6]:1)<h;)a+=6;for(var u=a>=0&&n>a+6,c=u?e[a]:0,p=u?e[a+1]:0,d=e[a+2],f=e[a+3],g=e[a+4],y=e[a+5],v=u?e[a+6]:1,m=u?e[a+7]:1,_=0,b=1;b-_>.01;){var T=(b+_)/2;i._getCurvePoint(c,p,d,f,g,y,v,m,T,o),h-o.x>0?_=T:b=T}r[s]=o.y}},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.tweenEasing=0,this.curve=null},i}(r);t.TweenFrameData=n;var o=function(t){function e(){t.call(this),this.actions=[],this.events=[]}return __extends(e,t),e.toString=function(){return"[class dragonBones.AnimationFrameData]"},e.prototype._onClear=function(){t.prototype._onClear.call(this);for(var e=0,i=this.actions.length;i>e;++e)this.actions[e].returnToPool();for(var e=0,i=this.events.length;i>e;++e)this.events[e].returnToPool();this.actions.length=0,this.events.length=0},e}(r);t.AnimationFrameData=o;var a=function(t){function e(){t.call(this),this.zOrder=[]}return __extends(e,t),e.prototype._onClear=function(){t.prototype._onClear.call(this),this.zOrder.length=0},e}(r);t.ZOrderFrameData=a;var s=function(e){function i(){e.call(this),this.transform=new t.Transform}return __extends(i,e),i.toString=function(){return"[class dragonBones.BoneFrameData]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.tweenScale=!1,this.tweenRotate=0,this.transform.identity()},i}(n);t.BoneFrameData=s;var l=function(e){function i(){e.call(this)}return __extends(i,e),i.generateColor=function(){return new t.ColorTransform},i.toString=function(){return"[class dragonBones.SlotFrameData]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.displayIndex=0,this.color=null},i.DEFAULT_COLOR=new t.ColorTransform,i}(n);t.SlotFrameData=l;var h=function(t){function e(){t.call(this),this.tweens=[],this.keys=[]}return __extends(e,t),e.toString=function(){return"[class dragonBones.ExtensionFrameData]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.type=0,this.tweens.length=0,this.keys.length=0},e}(n);t.ExtensionFrameData=h}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this),this.frames=[]}return __extends(e,t),e.toString=function(){return"[class dragonBones.TimelineData]"},e.prototype._onClear=function(){for(var t=null,e=0,i=this.frames.length;i>e;++e){var r=this.frames[e];t&&r!=t&&t.returnToPool(),t=r}this.scale=1,this.offset=0,this.frames.length=0},e}(t.BaseObject);t.TimelineData=e;var i=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.toString=function(){return"[class dragonBones.ZOrderTimelineData]"},e}(e);t.ZOrderTimelineData=i;var r=function(e){function i(){e.call(this),this.originalTransform=new t.Transform,this.cachedFrames=[]}return __extends(i,e),i.cacheFrame=function(e,i,r){var n=e[i]=new t.Matrix;return n.copyFrom(r),n},i.toString=function(){return"[class dragonBones.BoneTimelineData]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.bone=null,this.originalTransform.identity(),this.cachedFrames.length=0},i.prototype.cacheFrames=function(t){this.cachedFrames.length=0,this.cachedFrames.length=t},i}(e);t.BoneTimelineData=r;var n=function(e){function i(){e.call(this),this.cachedFrames=[]}return __extends(i,e),i.cacheFrame=function(e,i,r){var n=e[i]=new t.Matrix;return n.copyFrom(r),n},i.toString=function(){return"[class dragonBones.SlotTimelineData]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.slot=null,this.cachedFrames.length=0},i.prototype.cacheFrames=function(t){this.cachedFrames.length=0,this.cachedFrames.length=t},i}(e);t.SlotTimelineData=n;var o=function(t){function e(){t.call(this)}return __extends(e,t),e.toString=function(){return"[class dragonBones.FFDTimelineData]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.displayIndex=0,this.skin=null,this.slot=null},e}(e);t.FFDTimelineData=o}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this),this.aabb=new t.Rectangle,this.bones={},this.slots={},this.skins={},this.animations={},this.actions=[],this._sortedBones=[],this._sortedSlots=[],this._bonesChildren={}}return __extends(i,e),i._onSortSlots=function(t,e){return t.zOrder>e.zOrder?1:-1},i.toString=function(){return"[class dragonBones.ArmatureData]"},i.prototype._onClear=function(){for(var t in this.bones)this.bones[t].returnToPool(),delete this.bones[t];for(var t in this.slots)this.slots[t].returnToPool(),delete this.slots[t];for(var t in this.skins)this.skins[t].returnToPool(),delete this.skins[t];for(var t in this.animations)this.animations[t].returnToPool(),delete this.animations[t];for(var t=0,e=this.actions.length;e>t;++t)this.actions[t].returnToPool();this.frameRate=0,this.type=0,this.name=null,this.parent=null,this.userData=null,this.aabb.clear(),this.actions.length=0,this.cacheFrameRate=0,this.scale=1;for(var t in this._bonesChildren)delete this._bonesChildren[t];this._boneDirty=!1,this._slotDirty=!1,this._defaultSkin=null,this._defaultAnimation=null,this._sortedBones.length=0,this._sortedSlots.length=0},i.prototype._sortBones=function(){var t=this._sortedBones.length;if(!(1>t)){var e=this._sortedBones.concat(),i=0,r=0;for(this._sortedBones.length=0;t>r;){var n=e[i++];i>=t&&(i=0),this._sortedBones.indexOf(n)>=0||n.parent&&this._sortedBones.indexOf(n.parent)<0||n.ik&&this._sortedBones.indexOf(n.ik)<0||(n.ik&&n.chain>0&&n.chainIndex==n.chain?this._sortedBones.splice(this._sortedBones.indexOf(n.parent)+1,0,n):this._sortedBones.push(n),r++)}}},i.prototype._sortSlots=function(){this._sortedSlots.sort(i._onSortSlots)},i.prototype.cacheFrames=function(t){if(this.cacheFrameRate!=t){this.cacheFrameRate=t;var e=this.cacheFrameRate/this.frameRate;for(var i in this.animations)this.animations[i].cacheFrames(e)}},i.prototype.addBone=function(t,e){if(!t||!t.name||this.bones[t.name])throw new Error;if(e){var i=this.getBone(e);i?t.parent=i:(this._bonesChildren[e]=this._bonesChildren[e]||[]).push(t)}var r=this._bonesChildren[t.name];if(r){for(var n=0,o=r.length;o>n;++n)r[n].parent=t;delete this._bonesChildren[t.name]}this.bones[t.name]=t,this._sortedBones.push(t),this._boneDirty=!0},i.prototype.addSlot=function(t){if(!t||!t.name||this.slots[t.name])throw new Error;this.slots[t.name]=t,this._sortedSlots.push(t),this._slotDirty=!0},i.prototype.addSkin=function(t){if(!t||!t.name||this.skins[t.name])throw new Error;this.skins[t.name]=t,this._defaultSkin||(this._defaultSkin=t)},i.prototype.addAnimation=function(t){if(!t||!t.name||this.animations[t.name])throw new Error;this.animations[t.name]=t,this._defaultAnimation||(this._defaultAnimation=t)},i.prototype.getBone=function(t){return this.bones[t]},i.prototype.getSlot=function(t){return this.slots[t]},i.prototype.getSkin=function(t){return t?this.skins[t]:this._defaultSkin},i.prototype.getAnimation=function(t){return t?this.animations[t]:this._defaultAnimation},Object.defineProperty(i.prototype,"sortedBones",{get:function(){return this._boneDirty&&(this._boneDirty=!1,this._sortBones()),this._sortedBones},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"sortedSlots",{get:function(){return this._slotDirty&&(this._slotDirty=!1,this._sortSlots()),this._sortedSlots},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"defaultSkin",{get:function(){return this._defaultSkin},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"defaultAnimation",{get:function(){return this._defaultAnimation},enumerable:!0,configurable:!0}),i}(t.BaseObject);t.ArmatureData=e;var i=function(e){function i(){e.call(this),this.transform=new t.Transform}return __extends(i,e),i.toString=function(){return"[class dragonBones.BoneData]"},i.prototype._onClear=function(){this.inheritTranslation=!1,this.inheritRotation=!1,this.inheritScale=!1,this.bendPositive=!1,this.chain=0,this.chainIndex=0,this.weight=0,this.length=0,this.name=null,this.parent=null,this.ik=null,this.transform.identity()},i}(t.BaseObject);t.BoneData=i;var r=function(e){function i(){e.call(this),this.actions=[]}return __extends(i,e),i.generateColor=function(){return new t.ColorTransform},i.toString=function(){return"[class dragonBones.SlotData]"},i.prototype._onClear=function(){for(var t=0,e=this.actions.length;e>t;++t)this.actions[t].returnToPool();this.displayIndex=0,this.zOrder=0,this.blendMode=0,this.name=null,this.parent=null,this.color=null,this.actions.length=0},i.DEFAULT_COLOR=new t.ColorTransform,i}(t.BaseObject);t.SlotData=r;var n=function(t){function e(){t.call(this),this.slots={}}return __extends(e,t),e.toString=function(){return"[class dragonBones.SkinData]"},e.prototype._onClear=function(){for(var t in this.slots)this.slots[t].returnToPool(),delete this.slots[t];this.name=null},e.prototype.addSlot=function(t){if(!t||!t.slot||this.slots[t.slot.name])throw new Error;this.slots[t.slot.name]=t},e.prototype.getSlot=function(t){return this.slots[t]},e}(t.BaseObject);t.SkinData=n;var o=function(t){function e(){t.call(this),this.displays=[]}return __extends(e,t),e.toString=function(){return"[class dragonBones.SlotDisplayDataSet]"},e.prototype._onClear=function(){for(var t=0,e=this.displays.length;e>t;++t)this.displays[t].returnToPool();this.slot=null,this.displays.length=0},e}(t.BaseObject);t.SlotDisplayDataSet=o;var a=function(e){function i(){e.call(this),this.pivot=new t.Point,this.transform=new t.Transform}return __extends(i,e),i.toString=function(){return"[class dragonBones.DisplayData]"},i.prototype._onClear=function(){this.mesh&&this.mesh.returnToPool(),this.area&&this.area.returnToPool(),this.isRelativePivot=!1,this.type=0,this.name=null,this.texture=null,this.armature=null,this.mesh=null,this.area=null,this.pivot.clear(),this.transform.identity()},i}(t.BaseObject);t.DisplayData=a;var s=function(e){function i(){e.call(this),this.slotPose=new t.Matrix,this.uvs=[],this.vertices=[],this.vertexIndices=[],this.boneIndices=[],this.weights=[],this.boneVertices=[],this.bones=[],this.inverseBindPose=[]}return __extends(i,e),i.toString=function(){return"[class dragonBones.MeshData]"},i.prototype._onClear=function(){this.skinned=!1,this.slotPose.identity(),this.uvs.length=0,this.vertices.length=0,this.vertexIndices.length=0,this.boneIndices.length=0,this.weights.length=0,this.boneVertices.length=0,this.bones.length=0,this.inverseBindPose.length=0},i}(t.BaseObject);t.MeshData=s;var l=function(t){function e(){t.call(this),this.width=0,this.height=0,this.vertices=[]}return __extends(e,t),e.toString=function(){return"[class dragonBones.AreaData]"},e.prototype._onClear=function(){this.type=0,this.width=0,this.height=0,this.vertices.length=0},e}(t.BaseObject);t.AreaData=l}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this),this.boneTimelines={},this.slotTimelines={},this.ffdTimelines={},this.cachedFrames=[]}return __extends(e,t),e.toString=function(){return"[class dragonBones.AnimationData]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.zOrderTimeline&&this.zOrderTimeline.returnToPool();for(var e in this.boneTimelines)this.boneTimelines[e].returnToPool(),delete this.boneTimelines[e];for(var e in this.slotTimelines)this.slotTimelines[e].returnToPool(),delete this.slotTimelines[e];for(var e in this.ffdTimelines){for(var i in this.ffdTimelines[e])for(var r in this.ffdTimelines[e][i])this.ffdTimelines[e][i][r].returnToPool();delete this.ffdTimelines[e]}this.hasAsynchronyTimeline=!1,this.frameCount=0,this.playTimes=0,this.position=0,this.duration=0,this.fadeInTime=0,this.cacheTimeToFrameScale=0,this.name=null,this.animation=null,this.zOrderTimeline=null,this.cachedFrames.length=0},e.prototype.cacheFrames=function(t){if(!this.animation){var e=Math.max(Math.floor((this.frameCount+1)*this.scale*t),1);this.cacheTimeToFrameScale=e/(this.duration+1e-6),this.cachedFrames.length=0,this.cachedFrames.length=e;for(var i in this.boneTimelines)this.boneTimelines[i].cacheFrames(e);for(var i in this.slotTimelines)this.slotTimelines[i].cacheFrames(e)}},e.prototype.addBoneTimeline=function(t){if(!t||!t.bone||this.boneTimelines[t.bone.name])throw new Error;this.boneTimelines[t.bone.name]=t},e.prototype.addSlotTimeline=function(t){if(!t||!t.slot||this.slotTimelines[t.slot.name])throw new Error;this.slotTimelines[t.slot.name]=t},e.prototype.addFFDTimeline=function(t){if(!(t&&t.skin&&t.slot))throw new Error;var e=this.ffdTimelines[t.skin.name]=this.ffdTimelines[t.skin.name]||{},i=e[t.slot.slot.name]=e[t.slot.slot.name]||{};if(i[t.displayIndex])throw new Error;i[t.displayIndex]=t},e.prototype.getBoneTimeline=function(t){return this.boneTimelines[t]},e.prototype.getSlotTimeline=function(t){return this.slotTimelines[t]},e.prototype.getFFDTimeline=function(t,e,i){var r=this.ffdTimelines[t];if(r){var n=r[e];if(n)return n[i]}return null},e}(t.TimelineData);t.AnimationData=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this),this._animations={},this._animationNames=[],this._animationStates=[]}return __extends(i,e),i._sortAnimationState=function(t,e){return t.layer>e.layer?-1:1},i.toString=function(){return"[class dragonBones.Animation]"},i.prototype._onClear=function(){for(var t in this._animations)delete this._animations[t];for(var t=0,e=this._animationStates.length;e>t;++t)this._animationStates[t].returnToPool();this.timeScale=1,this._animationStateDirty=!1,this._armature=null,this._isPlaying=!1,this._time=0,this._duration=0,this._lastAnimationState=null,this._animationNames.length=0,this._animationStates.length=0},i.prototype._fadeOut=function(t,e,i,r,n){var o=0,a=this._animationStates.length,s=null;switch(r){case 1:for(;a>o;++o)s=this._animationStates[o],s.layer==e&&s.fadeOut(t,n);break;case 2:for(;a>o;++o)s=this._animationStates[o],s.group==i&&s.fadeOut(t,n);break;case 4:for(;a>o;++o)s=this._animationStates[o],0==t?s.returnToPool():s.fadeOut(t,n);0==t&&(this._animationStates.length=0);break;case 3:for(;a>o;++o)s=this._animationStates[o],s.layer==e&&s.group==i&&s.fadeOut(t,n);break;case 0:}},i.prototype._updateFFDTimelineStates=function(){for(var t=0,e=this._animationStates.length;e>t;++t)this._animationStates[t]._updateFFDTimelineStates()},i.prototype._advanceTime=function(t){var e=this;if(e._isPlaying){0>t&&(t=-t);var i=e._animationStates.length;if(1==i){var r=e._animationStates[0];r._fadeState>0&&r._fadeProgress<=0?(r.returnToPool(),e._animationStates.length=0,e._animationStateDirty=!0,e._lastAnimationState=null):r._advanceTime(t,1,0)}else if(i>1)for(var n=e._animationStates[0]._layer,o=1,a=0,s=1,l=0,h=0;i>l;++l){var r=e._animationStates[l];r._fadeState>0&&r._fadeProgress<=0?(h++,r.returnToPool(),e._animationStateDirty=!0,e._lastAnimationState==r&&(e._lastAnimationState=l-h>=0?e._animationStates[l-h]:null)):(h>0&&(e._animationStates[l-h]=r),n!=r._layer&&(n=r._layer,a>=o?o=0:o-=a,a=0),r._advanceTime(t,o,s),r._weightResult>0&&(a+=r._weightResult,s++)),l==i-1&&h>0&&(e._animationStates.length-=h)}}},i.prototype.reset=function(){for(var t=0,e=this._animationStates.length;e>t;++t)this._animationStates[t].returnToPool();this._isPlaying=!1,this._lastAnimationState=null,this._animationStates.length=0},i.prototype.stop=function(t){if(void 0===t&&(t=null),t){var e=this.getState(t);e&&e.stop()}else this._isPlaying=!1},i.prototype.play=function(t,e){void 0===t&&(t=null),void 0===e&&(e=-1);var i=null;if(t)i=this.fadeIn(t,0,e,0,null,4);else if(this._lastAnimationState)this._isPlaying&&(this._lastAnimationState.isPlaying||this._lastAnimationState.isCompleted)?i=this.fadeIn(this._lastAnimationState.name,0,e,0,null,4):(this._isPlaying=!0,this._lastAnimationState.play());else{var r=this._armature.armatureData.defaultAnimation;r&&(i=this.fadeIn(r.name,0,e,0,null,4))}return i},i.prototype.fadeIn=function(e,r,n,o,a,s,l,h,u,c){void 0===r&&(r=-1),void 0===n&&(n=-1),void 0===o&&(o=0),void 0===a&&(a=null),void 0===s&&(s=3),void 0===l&&(l=!1),void 0===h&&(h=!0),void 0===u&&(u=!0),void 0===c&&(c=!0);var p=this._animations[e];if(!p)return this._time=0,this._duration=0,console.warn("Non-existent animation.","DragonBones: "+this._armature.armatureData.parent.name,"Armature: "+this._armature.name,"Animation: "+e),null;this._isPlaying=!0,this._time!=this._time&&(this._time=0),this._duration!=this._duration&&(this._duration=0),(r!=r||0>r)&&(r=this._lastAnimationState?p.fadeInTime:0),0>n&&(n=p.playTimes),this._fadeOut(r,o,a,s,u);var d=this._duration>0?0:this._time,f=this._duration>0?this._time:p.position,g=this._duration>0?this._duration:p.duration;this._lastAnimationState=t.BaseObject.borrowObject(t.AnimationState),this._lastAnimationState._layer=o,this._lastAnimationState._group=a,this._lastAnimationState.additiveBlending=l,this._lastAnimationState.displayControl=h,this._lastAnimationState._fadeIn(this._armature,p.animation||p,e,n,f,g,d,1/p.scale,r,c),this._animationStates.push(this._lastAnimationState),this._animationStateDirty=!0,this._time=0,this._duration=0,this._armature._cacheFrameIndex=-1,this._animationStates.length>1&&this._animationStates.sort(i._sortAnimationState);for(var y=this._armature.getSlots(),v=0,m=y.length;m>v;++v){var _=y[v];if(_.inheritAnimation){var b=_.childArmature;b&&b.animation.hasAnimation(e)&&!b.animation.getState(e)&&b.animation.fadeIn(e)}}return 0>=r&&this._armature.advanceTime(0),this._lastAnimationState},i.prototype.gotoAndPlayByTime=function(t,e,i,r){void 0===e&&(e=0),void 0===i&&(i=-1),void 0===r&&(r=0);var n=this._animations[t];return n&&(this._time=e,this._duration=r-e,this._duration<0?this._duration=0:this._duration>n.duration-this._time&&(this._duration=n.duration-this._time)),this.fadeIn(t,0,i,0,null,4)},i.prototype.gotoAndPlayByFrame=function(t,e,i,r){void 0===e&&(e=0),void 0===i&&(i=-1),void 0===r&&(r=0);var n=this._animations[t];return n&&(this._time=n.duration*e/n.frameCount,this._duration<0?this._duration=0:this._duration>n.duration-this._time&&(this._duration=n.duration-this._time)),this.fadeIn(t,0,i,0,null,4)},i.prototype.gotoAndPlayByProgress=function(t,e,i,r){void 0===e&&(e=0),void 0===i&&(i=-1),void 0===r&&(r=0);var n=this._animations[t];return n&&(this._time=n.duration*(e>0?e:0),this._duration<0?this._duration=0:this._duration>n.duration-this._time&&(this._duration=n.duration-this._time)),this.fadeIn(t,0,i,0,null,4)},i.prototype.gotoAndStopByTime=function(t,e){void 0===e&&(e=0);var i=this.gotoAndPlayByTime(t,e,1);return i&&i.stop(),i},i.prototype.gotoAndStopByFrame=function(t,e){void 0===e&&(e=0);var i=this.gotoAndPlayByFrame(t,e,1);return i&&i.stop(),i},i.prototype.gotoAndStopByProgress=function(t,e){void 0===e&&(e=0);var i=this.gotoAndPlayByProgress(t,e,1);return i&&i.stop(),i},i.prototype.getState=function(t){for(var e=0,i=this._animationStates.length;i>e;++e){var r=this._animationStates[e];if(r.name==t)return r}return null},i.prototype.hasAnimation=function(t){return null!=this._animations[t]},Object.defineProperty(i.prototype,"isPlaying",{get:function(){return this._animationStates.length>1?this._isPlaying&&!this.isCompleted:this._lastAnimationState?this._isPlaying&&this._lastAnimationState.isPlaying:this._isPlaying},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isCompleted",{get:function(){if(this._lastAnimationState){if(!this._lastAnimationState.isCompleted)return!1;for(var t=0,e=this._animationStates.length;e>t;++t)if(!this._animationStates[t].isCompleted)return!1;return!0}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lastAnimationName",{get:function(){return this._lastAnimationState?this._lastAnimationState.name:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lastAnimationState",{get:function(){return this._lastAnimationState},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationNames",{get:function(){return this._animationNames},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animations",{get:function(){return this._animations},set:function(t){if(this._animations!=t){for(var e in this._animations)delete this._animations[e];if(this._animationNames.length=0,t)for(var e in t)this._animations[e]=t[e],this._animationNames.push(e)}},enumerable:!0,configurable:!0}),i.prototype.gotoAndPlay=function(t,e,i,r,n,o,a,s,l){void 0===e&&(e=-1),void 0===i&&(i=-1),void 0===r&&(r=-1),void 0===n&&(n=0),void 0===o&&(o=null),void 0===a&&(a=3),void 0===s&&(s=!0),void 0===l&&(l=!0);var h=this.fadeIn(t,e,r,n,o,a,!1,!0,s,l);return h&&i&&i>0&&(h.timeScale=h.totalTime/i),h},i.prototype.gotoAndStop=function(t,e){return void 0===e&&(e=0),this.gotoAndStopByTime(t,e)},Object.defineProperty(i.prototype,"animationList",{get:function(){return this._animationNames},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationDataList",{get:function(){for(var t=[],e=0,i=this._animationNames.length;i>e;++e)t.push(this._animations[this._animationNames[e]]);return t},enumerable:!0,configurable:!0}),i}(t.BaseObject);t.Animation=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this),this._boneMask=[],this._boneTimelines=[],this._slotTimelines=[],this._ffdTimelines=[],this.autoTween=!1}return __extends(i,e),i.toString=function(){return"[class dragonBones.AnimationState]"},i.prototype._onClear=function(){for(var t=0,e=this._boneTimelines.length;e>t;++t)this._boneTimelines[t].returnToPool();for(var t=0,e=this._slotTimelines.length;e>t;++t)this._slotTimelines[t].returnToPool();for(var t=0,e=this._ffdTimelines.length;e>t;++t)this._ffdTimelines[t].returnToPool();this._timeline&&this._timeline.returnToPool(),this._zOrderTimeline&&this._zOrderTimeline.returnToPool(),this.displayControl=!0,this.additiveBlending=!1,this.actionEnabled=!1,this.playTimes=1,this.timeScale=1,this.weight=1,this.autoFadeOutTime=-1,this.fadeTotalTime=0,this._onFadeInComplete=!1,this._fadeState=0,this._layer=0,this._position=0,this._duration=0,this._weightResult=0,this._fadeProgress=0,this._group=null,this._timeline=null,this._isPlaying=!0,this._isPausePlayhead=!1,this._fadeTime=0,this._time=0,this._name=null,this._armature=null,this._animationData=null,this._zOrderTimeline=null,this._boneMask.length=0,this._boneTimelines.length=0,this._slotTimelines.length=0,this._ffdTimelines.length=0},i.prototype._updateTimelineStates=function(){var e=this._time;this._animationData.hasAsynchronyTimeline||(e=this._timeline._currentTime);for(var i={},r={},n=0,o=this._boneTimelines.length;o>n;++n){var a=this._boneTimelines[n];i[a.bone.name]=a}for(var s=this._armature.getBones(),n=0,o=s.length;o>n;++n){var l=s[n],h=l.name,u=this._animationData.getBoneTimeline(h);if(u&&this.containsBoneMask(h)){var a=i[h];a?delete i[h]:(a=t.BaseObject.borrowObject(t.BoneTimelineState),a.bone=l,a.fadeIn(this._armature,this,u,e),this._boneTimelines.push(a))}}for(var n in i){var a=i[n];a.bone.invalidUpdate(),this._boneTimelines.splice(this._boneTimelines.indexOf(a),1),a.returnToPool()}for(var n=0,o=this._slotTimelines.length;o>n;++n){var c=this._slotTimelines[n];r[c.slot.name]=c}for(var p=this._armature.getSlots(),n=0,o=p.length;o>n;++n){var d=p[n],f=d.name,g=d.parent.name,y=this._animationData.getSlotTimeline(f);if(y&&this.containsBoneMask(g)&&this._fadeState<=0){var c=r[f];c?delete r[f]:(c=t.BaseObject.borrowObject(t.SlotTimelineState),c.slot=d,c.fadeIn(this._armature,this,y,e),this._slotTimelines.push(c))}}for(var n in r){var c=r[n];this._slotTimelines.splice(this._slotTimelines.indexOf(c),1),c.returnToPool()}this._updateFFDTimelineStates()},i.prototype._advanceFadeTime=function(e){var i=this;
0>e&&(e=-e),i._fadeTime+=e;var r=0;if(r=i._fadeTime>=i.fadeTotalTime?i._fadeState>0?0:1:i._fadeTime>0?i._fadeState>0?1-i._fadeTime/i.fadeTotalTime:i._fadeTime/i.fadeTotalTime:i._fadeState>0?1:0,i._fadeProgress!=r){i._fadeProgress=r;var n=i._armature._display;if(i._fadeTime<=e)if(i._fadeState>0){if(n.hasEvent(t.EventObject.FADE_OUT)){var o=t.BaseObject.borrowObject(t.EventObject);o.animationState=this,i._armature._bufferEvent(o,t.EventObject.FADE_OUT)}}else if(n.hasEvent(t.EventObject.FADE_IN)){var a=t.BaseObject.borrowObject(t.EventObject);a.animationState=this,i._armature._bufferEvent(a,t.EventObject.FADE_IN)}if(i._fadeTime>=i.fadeTotalTime)if(i._fadeState>0){if(n.hasEvent(t.EventObject.FADE_OUT_COMPLETE)){var s=t.BaseObject.borrowObject(t.EventObject);s.animationState=this,i._armature._bufferEvent(s,t.EventObject.FADE_OUT_COMPLETE)}}else if(i._onFadeInComplete=!0,i._isPausePlayhead=!1,i._fadeState=0,n.hasEvent(t.EventObject.FADE_IN_COMPLETE)){var l=t.BaseObject.borrowObject(t.EventObject);l.animationState=this,i._armature._bufferEvent(l,t.EventObject.FADE_IN_COMPLETE)}}},i.prototype._isDisabled=function(t){return!(this.displayControl&&(!t.displayController||t.displayController==this._name||t.displayController==this._group))},i.prototype._fadeIn=function(e,r,n,o,a,s,l,h,u,c){this._armature=e,this._animationData=r,this._name=n,this.actionEnabled=i.stateActionEnabled,this.playTimes=o,this.timeScale=h,this.fadeTotalTime=u,this._fadeState=-1,this._position=a,this._duration=s,this._time=l,this._isPausePlayhead=c,this.fadeTotalTime<=0&&(this._fadeProgress=.999999),this._timeline=t.BaseObject.borrowObject(t.AnimationTimelineState),this._timeline.fadeIn(this._armature,this,this._animationData,this._time),this._animationData.zOrderTimeline&&(this._zOrderTimeline=t.BaseObject.borrowObject(t.ZOrderTimelineState),this._zOrderTimeline.fadeIn(this._armature,this,this._animationData.zOrderTimeline,this._time)),this._updateTimelineStates()},i.prototype._updateFFDTimelineStates=function(){var e=this._time;this._animationData.hasAsynchronyTimeline||(e=this._timeline._currentTime);for(var i={},r=0,n=this._ffdTimelines.length;n>r;++r){var o=this._ffdTimelines[r];i[o.slot.name]=o}for(var a=this._armature.getSlots(),r=0,n=a.length;n>r;++r){var s=a[r],l=s.name,h=s.parent.name;if(s._meshData){var u=s.displayIndex,c=u<s._displayDataSet.displays.length?s._displayDataSet.displays[u].mesh:null;if(s._meshData==c){var p=this._animationData.getFFDTimeline(this._armature._skinData.name,l,u);if(p&&this.containsBoneMask(h)){var o=i[l];o&&o._timeline==p?delete i[l]:(o=t.BaseObject.borrowObject(t.FFDTimelineState),o.slot=s,o.fadeIn(this._armature,this,p,e),this._ffdTimelines.push(o))}else{for(var d=0,f=s._ffdVertices.length;f>d;++d)s._ffdVertices[d]=0;s._ffdDirty=!0}}}}for(var r in i){var o=i[r];this._ffdTimelines.splice(this._ffdTimelines.indexOf(o),1),o.returnToPool()}},i.prototype._advanceTime=function(t,e,i){var r=this;if(r._onFadeInComplete=!1,0!=r._fadeState&&r._advanceFadeTime(t),t*=r.timeScale,0!=t&&r._isPlaying&&!r._isPausePlayhead&&(r._time+=t),r._weightResult=r.weight*r._fadeProgress*e,0!=r._weightResult){var n=r._fadeProgress>=1&&0==i&&r._armature.cacheFrameRate>0,o=r._animationData.cacheTimeToFrameScale,a=!0,s=!0,l=2*o;if(l=n?Math.floor(r._time*l)/l:r._time,r._timeline.update(l),r._animationData.hasAsynchronyTimeline||(l=r._timeline._currentTime),r._zOrderTimeline&&r._zOrderTimeline.update(l),n){var h=Math.floor(r._timeline._currentTime*o);if(r._armature._cacheFrameIndex==h)a=!1,s=!1;else{if(r._armature._cacheFrameIndex=h,r._armature._animation._animationStateDirty){r._armature._animation._animationStateDirty=!1;for(var u=0,c=r._boneTimelines.length;c>u;++u){var p=r._boneTimelines[u];p.bone._cacheFrames=p._timeline.cachedFrames}for(var u=0,c=r._slotTimelines.length;c>u;++u){var d=r._slotTimelines[u];d.slot._cacheFrames=d._timeline.cachedFrames}}r._animationData.cachedFrames[h]?s=!1:r._animationData.cachedFrames[h]=!0}}else r._armature._cacheFrameIndex=-1;if(a){if(s)for(var u=0,c=r._boneTimelines.length;c>u;++u)r._boneTimelines[u].update(l);for(var u=0,c=r._slotTimelines.length;c>u;++u)r._slotTimelines[u].update(l);for(var u=0,c=r._ffdTimelines.length;c>u;++u)r._ffdTimelines[u].update(l)}}r.autoFadeOutTime>=0&&r._fadeProgress>=1&&r._timeline._isCompleted&&r.fadeOut(r.autoFadeOutTime)},i.prototype.play=function(){this._isPlaying=!0},i.prototype.stop=function(){this._isPlaying=!1},i.prototype.fadeOut=function(t,e){if(void 0===e&&(e=!0),(0>t||t!=t)&&(t=0),this._isPausePlayhead=e,this._fadeState>0){if(t>t-this._fadeTime)return}else{this._fadeState=1,(0>=t||this._fadeProgress<=0)&&(this._fadeProgress=1e-6);for(var i=0,r=this._boneTimelines.length;r>i;++i)this._boneTimelines[i].fadeOut();for(var i=0,r=this._slotTimelines.length;r>i;++i)this._slotTimelines[i].fadeOut()}this.displayControl=!1,this.fadeTotalTime=this._fadeProgress>1e-6?t/this._fadeProgress:0,this._fadeTime=this.fadeTotalTime*(1-this._fadeProgress)},i.prototype.containsBoneMask=function(t){return!this._boneMask.length||this._boneMask.indexOf(t)>=0},i.prototype.addBoneMask=function(t,e){void 0===e&&(e=!0);var i=this._armature.getBone(t);if(i){if(this._boneMask.indexOf(t)<0&&this._animationData.getBoneTimeline(t)&&this._boneMask.push(t),e)for(var r=this._armature.getBones(),n=0,o=r.length;o>n;++n){var a=r[n],s=a.name;this._boneMask.indexOf(s)<0&&this._animationData.getBoneTimeline(s)&&i.contains(a)&&this._boneMask.push(s)}this._updateTimelineStates()}},i.prototype.removeBoneMask=function(t,e){void 0===e&&(e=!0);var i=this._boneMask.indexOf(t);if(i>=0&&this._boneMask.splice(i,1),e){var r=this._armature.getBone(t);if(r)for(var n=this._armature.getBones(),o=0,a=n.length;a>o;++o){var s=n[o],l=s.name,h=this._boneMask.indexOf(l);h>=0&&r.contains(s)&&this._boneMask.splice(h,1)}}this._updateTimelineStates()},i.prototype.removeAllBoneMask=function(){this._boneMask.length=0,this._updateTimelineStates()},Object.defineProperty(i.prototype,"layer",{get:function(){return this._layer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"group",{get:function(){return this._group},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationData",{get:function(){return this._animationData},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isCompleted",{get:function(){return this._timeline._isCompleted},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isPlaying",{get:function(){return this._isPlaying&&!this._timeline._isCompleted},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentPlayTimes",{get:function(){return this._timeline._currentPlayTimes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"totalTime",{get:function(){return this._duration},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentTime",{get:function(){return this._timeline._currentTime},set:function(t){(0>t||t!=t)&&(t=0);var e=this._timeline._currentPlayTimes-(this._timeline._isCompleted?1:0);if(t=t%this._duration+e*this._duration,this._time!=t){this._time=t,this._timeline.setCurrentTime(this._time),this._zOrderTimeline&&(this._zOrderTimeline._isCompleted=!1);for(var i=0,r=this._boneTimelines.length;r>i;++i)this._boneTimelines[i]._isCompleted=!1;for(var i=0,r=this._slotTimelines.length;r>i;++i)this._slotTimelines[i]._isCompleted=!1;for(var i=0,r=this._ffdTimelines.length;r>i;++i)this._ffdTimelines[i]._isCompleted=!1}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"clip",{get:function(){return this._animationData},enumerable:!0,configurable:!0}),i.stateActionEnabled=!0,i}(t.BaseObject);t.AnimationState=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this)}return __extends(e,t),e.prototype._onClear=function(){this._isCompleted=!1,this._currentPlayTimes=0,this._currentTime=-1,this._timeline=null,this._isReverse=!1,this._hasAsynchronyTimeline=!1,this._frameRate=0,this._keyFrameCount=0,this._frameCount=0,this._position=0,this._duration=0,this._animationDutation=0,this._timeScale=1,this._timeOffset=0,this._currentFrame=null,this._armature=null,this._animationState=null},e.prototype._onUpdateFrame=function(){},e.prototype._onArriveAtFrame=function(){},e.prototype._setCurrentTime=function(t){var e=this,i=0;if(1==e._keyFrameCount&&this!=e._animationState._timeline)e._isCompleted=e._animationState._fadeState>=0,i=1;else if(e._hasAsynchronyTimeline){var r=e._animationState.playTimes,n=r*e._duration;t*=e._timeScale,0!=e._timeOffset&&(t+=e._timeOffset*e._animationDutation),r>0&&(t>=n||-n>=t)?(e._isCompleted=!0,i=r,t=0>t?0:e._duration):(e._isCompleted=!1,0>t?(i=Math.floor(-t/e._duration),t=e._duration- -t%e._duration):(i=Math.floor(t/e._duration),t%=e._duration),r>0&&i>r&&(i=r)),t+=e._position}else e._isCompleted=e._animationState._timeline._isCompleted,i=e._animationState._timeline._currentPlayTimes;return e._currentTime!=t&&(e._isReverse=e._currentTime>t&&e._currentPlayTimes==i,e._currentTime=t,e._currentPlayTimes=i,e._animationState._onFadeInComplete&&(e._currentFrame=null),!0)},e.prototype.fadeIn=function(t,e,i){this._armature=t,this._animationState=e,this._timeline=i;var r=this==this._animationState._timeline;this._hasAsynchronyTimeline=r||this._animationState.animationData.hasAsynchronyTimeline,this._frameRate=this._armature.armatureData.frameRate,this._keyFrameCount=this._timeline.frames.length,this._frameCount=this._animationState.animationData.frameCount,this._position=this._animationState._position,this._duration=this._animationState._duration,this._animationDutation=this._animationState.animationData.duration,this._timeScale=r?1:1/this._timeline.scale,this._timeOffset=r?0:this._timeline.offset},e.prototype.fadeOut=function(){},e.prototype.update=function(t){var e=this;if(!e._isCompleted&&e._setCurrentTime(t)){var i=e._keyFrameCount>1?Math.floor(e._currentTime*e._frameRate):0,r=e._timeline.frames[i];e._currentFrame!=r&&(e._currentFrame=r,e._onArriveAtFrame(!0)),e._onUpdateFrame(!0)}},e}(t.BaseObject);t.TimelineState=e;var i=function(e){function i(){e.call(this)}return __extends(i,e),i._getEasingValue=function(t,e){if(0>=t)return 0;if(t>=1)return 1;var i=1;if(e>2)return t;if(e>1)i=.5*(1-Math.cos(t*Math.PI)),e-=1;else if(e>0)i=1-Math.pow(1-t,2);else if(e>=-1)e*=-1,i=Math.pow(t,2);else{if(!(e>=-2))return t;e*=-1,i=Math.acos(1-2*t)/Math.PI,e-=1}return(i-t)*e+t},i._getEasingCurveValue=function(t,e){if(0>=t)return 0;if(t>=1)return 1;var i=e.length+1,r=Math.floor(t*i),n=0==r?0:e[r-1],o=r==i-1?1:e[r];return n+(o-n)*(t-r/i)},i.prototype._onClear=function(){e.prototype._onClear.call(this),this._tweenProgress=0,this._tweenEasing=t.DragonBones.NO_TWEEN,this._curve=null},i.prototype._onArriveAtFrame=function(){var e=this;e._tweenEasing=e._currentFrame.tweenEasing,e._curve=e._currentFrame.curve,(e._keyFrameCount<=1||e._currentFrame.next==e._timeline.frames[0]&&(e._tweenEasing!=t.DragonBones.NO_TWEEN||e._curve)&&e._animationState.playTimes>0&&e._animationState.currentPlayTimes==e._animationState.playTimes-1)&&(e._tweenEasing=t.DragonBones.NO_TWEEN,e._curve=null)},i.prototype._onUpdateFrame=function(){var e=this;e._tweenEasing!=t.DragonBones.NO_TWEEN?(e._tweenProgress=(e._currentTime-e._currentFrame.position+e._position)/e._currentFrame.duration,0!=e._tweenEasing&&(e._tweenProgress=i._getEasingValue(e._tweenProgress,e._tweenEasing))):e._curve?(e._tweenProgress=(e._currentTime-e._currentFrame.position+e._position)/e._currentFrame.duration,e._tweenProgress=i._getEasingCurveValue(e._tweenProgress,e._curve)):e._tweenProgress=0},i.prototype._updateExtensionKeyFrame=function(t,e,i){var r=0;if(t.type==e.type)for(var n=0,o=t.tweens.length;o>n;++n){var a=e.tweens[n]-t.tweens[n];i.tweens[n]=a,a>0&&(r=2)}if(0==r){i.type!=t.type&&(r=1,i.type=t.type),i.tweens.length!=t.tweens.length&&(r=1,i.tweens.length=t.tweens.length),i.keys.length!=t.keys.length&&(r=1,i.keys.length=t.keys.length);for(var n=0,o=t.keys.length;o>n;++n){var s=t.keys[n];i.keys[n]!=s&&(r=1,i.keys[n]=s)}}return r},i}(e);t.TweenTimelineState=i}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this)}return __extends(i,e),i.toString=function(){return"[class dragonBones.AnimationTimelineState]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this._isStarted=!1},i.prototype._onCrossFrame=function(e){var i=this;if(!(i._animationState._fadeState<0)){if(i._animationState.actionEnabled)for(var r=e.actions,n=0,o=r.length;o>n;++n)i._armature._bufferAction(r[n]);for(var a=i._armature._display,s=e.events,n=0,o=s.length;o>n;++n){var l=s[n],h="";switch(l.type){case 10:h=t.EventObject.FRAME_EVENT;break;case 11:h=t.EventObject.SOUND_EVENT}if((11==l.type?i._armature._eventManager:a).hasEvent(h)){var u=t.BaseObject.borrowObject(t.EventObject);u.animationState=i._animationState,u.frame=e,l.bone&&(u.bone=i._armature.getBone(l.bone.name)),l.slot&&(u.slot=i._armature.getSlot(l.slot.name)),u.name=l.name,u.data=l.data,i._armature._bufferEvent(u,h)}}}},i.prototype.fadeIn=function(t,i,r,n){e.prototype.fadeIn.call(this,t,i,r,n),this._currentTime=n},i.prototype.update=function(e){var i=this,r=i._currentTime,n=i._currentPlayTimes;if(!i._isCompleted&&i._setCurrentTime(e)){var o=i._armature._display;if(!i._isStarted&&(i._isStarted=!0,o.hasEvent(t.EventObject.START))){var a=t.BaseObject.borrowObject(t.EventObject);a.animationState=i._animationState,i._armature._bufferEvent(a,t.EventObject.START)}if(i._keyFrameCount>0){var s=i._keyFrameCount>1?Math.floor(i._currentTime*i._frameRate):0,l=i._timeline.frames[s];if(i._currentFrame!=l)if(i._keyFrameCount>1){var h=i._currentFrame;if(i._currentFrame=l,!h){var u=Math.floor(r*i._frameRate);h=i._timeline.frames[u],i._isReverse||(r<=h.position||n!=i._currentPlayTimes)&&(h=h.prev)}if(i._isReverse)for(;h!=l;)i._onCrossFrame(h),h=h.prev;else for(;h!=l;)h=h.next,i._onCrossFrame(h)}else i._currentFrame=l,i._onCrossFrame(i._currentFrame)}if(n!=i._currentPlayTimes){if(o.hasEvent(t.EventObject.LOOP_COMPLETE)){var a=t.BaseObject.borrowObject(t.EventObject);a.animationState=i._animationState,i._armature._bufferEvent(a,t.EventObject.LOOP_COMPLETE)}if(i._isCompleted&&o.hasEvent(t.EventObject.COMPLETE)){var a=t.BaseObject.borrowObject(t.EventObject);a.animationState=i._animationState,i._armature._bufferEvent(a,t.EventObject.COMPLETE)}i._currentFrame=null}}},i.prototype.setCurrentTime=function(t){this._setCurrentTime(t),this._currentFrame=null},i}(t.TimelineState);t.AnimationTimelineState=e;var i=function(t){function e(){t.call(this)}return __extends(e,t),e.toString=function(){return"[class dragonBones.ZOrderTimelineState]"},e.prototype._onArriveAtFrame=function(e){var i=this;t.prototype._onArriveAtFrame.call(this,e),i._armature._sortZOrder(i._currentFrame.zOrder)},e}(t.TimelineState);t.ZOrderTimelineState=i;var r=function(e){function i(){e.call(this),this._transform=new t.Transform,this._currentTransform=new t.Transform,this._durationTransform=new t.Transform}return __extends(i,e),i.toString=function(){return"[class dragonBones.BoneTimelineState]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.bone=null,this._tweenTransform=0,this._tweenRotate=0,this._tweenScale=0,this._boneTransform=null,this._originalTransform=null,this._transform.identity(),this._currentTransform.identity(),this._durationTransform.identity()},i.prototype._onArriveAtFrame=function(i){var r=this;if(e.prototype._onArriveAtFrame.call(this,i),r._currentTransform.copyFrom(r._currentFrame.transform),r._tweenTransform=1,r._tweenRotate=1,r._tweenScale=1,r._keyFrameCount>1&&(r._tweenEasing!=t.DragonBones.NO_TWEEN||r._curve)){var n=r._currentFrame.next,o=n.transform;r._durationTransform.x=o.x-r._currentTransform.x,r._durationTransform.y=o.y-r._currentTransform.y,0==r._durationTransform.x&&0==r._durationTransform.y||(r._tweenTransform=2);var a=r._currentFrame.tweenRotate;if(a==a){if(a)if(a>0?o.skewY>=r._currentTransform.skewY:o.skewY<=r._currentTransform.skewY){var s=a>0?a-1:a+1;r._durationTransform.skewX=o.skewX-r._currentTransform.skewX+t.DragonBones.PI_D*s,r._durationTransform.skewY=o.skewY-r._currentTransform.skewY+t.DragonBones.PI_D*s}else r._durationTransform.skewX=o.skewX-r._currentTransform.skewX+t.DragonBones.PI_D*a,r._durationTransform.skewY=o.skewY-r._currentTransform.skewY+t.DragonBones.PI_D*a;else r._durationTransform.skewX=t.Transform.normalizeRadian(o.skewX-r._currentTransform.skewX),r._durationTransform.skewY=t.Transform.normalizeRadian(o.skewY-r._currentTransform.skewY);0==r._durationTransform.skewX&&0==r._durationTransform.skewY||(r._tweenRotate=2)}else r._durationTransform.skewX=0,r._durationTransform.skewY=0;r._currentFrame.tweenScale?(r._durationTransform.scaleX=o.scaleX-r._currentTransform.scaleX,r._durationTransform.scaleY=o.scaleY-r._currentTransform.scaleY,0==r._durationTransform.scaleX&&0==r._durationTransform.scaleY||(r._tweenScale=2)):(r._durationTransform.scaleX=0,r._durationTransform.scaleY=0)}else r._durationTransform.x=0,r._durationTransform.y=0,r._durationTransform.skewX=0,r._durationTransform.skewY=0,r._durationTransform.scaleX=0,r._durationTransform.scaleY=0},i.prototype._onUpdateFrame=function(t){var i=this;if(i._tweenTransform||i._tweenRotate||i._tweenScale){e.prototype._onUpdateFrame.call(this,t);var r=0;i._tweenTransform&&(1==i._tweenTransform?(i._tweenTransform=0,r=0):r=i._tweenProgress,i._animationState.additiveBlending?(i._transform.x=i._currentTransform.x+i._durationTransform.x*r,i._transform.y=i._currentTransform.y+i._durationTransform.y*r):(i._transform.x=i._originalTransform.x+i._currentTransform.x+i._durationTransform.x*r,i._transform.y=i._originalTransform.y+i._currentTransform.y+i._durationTransform.y*r)),i._tweenRotate&&(1==i._tweenRotate?(i._tweenRotate=0,r=0):r=i._tweenProgress,i._animationState.additiveBlending?(i._transform.skewX=i._currentTransform.skewX+i._durationTransform.skewX*r,i._transform.skewY=i._currentTransform.skewY+i._durationTransform.skewY*r):(i._transform.skewX=i._originalTransform.skewX+i._currentTransform.skewX+i._durationTransform.skewX*r,i._transform.skewY=i._originalTransform.skewY+i._currentTransform.skewY+i._durationTransform.skewY*r)),i._tweenScale&&(1==i._tweenScale?(i._tweenScale=0,r=0):r=i._tweenProgress,i._animationState.additiveBlending?(i._transform.scaleX=i._currentTransform.scaleX+i._durationTransform.scaleX*r,i._transform.scaleY=i._currentTransform.scaleY+i._durationTransform.scaleY*r):(i._transform.scaleX=i._originalTransform.scaleX*(i._currentTransform.scaleX+i._durationTransform.scaleX*r),i._transform.scaleY=i._originalTransform.scaleY*(i._currentTransform.scaleY+i._durationTransform.scaleY*r))),i.bone.invalidUpdate()}},i.prototype.fadeIn=function(t,i,r,n){e.prototype.fadeIn.call(this,t,i,r,n),this._originalTransform=this._timeline.originalTransform,this._boneTransform=this.bone._animationPose},i.prototype.fadeOut=function(){this._transform.skewX=t.Transform.normalizeRadian(this._transform.skewX),this._transform.skewY=t.Transform.normalizeRadian(this._transform.skewY)},i.prototype.update=function(t){var i=this;e.prototype.update.call(this,t);var r=i._animationState._weightResult;r>0&&(0==i.bone._blendIndex?(i._boneTransform.x=i._transform.x*r,i._boneTransform.y=i._transform.y*r,i._boneTransform.skewX=i._transform.skewX*r,i._boneTransform.skewY=i._transform.skewY*r,i._boneTransform.scaleX=(i._transform.scaleX-1)*r+1,i._boneTransform.scaleY=(i._transform.scaleY-1)*r+1):(i._boneTransform.x+=i._transform.x*r,i._boneTransform.y+=i._transform.y*r,i._boneTransform.skewX+=i._transform.skewX*r,i._boneTransform.skewY+=i._transform.skewY*r,i._boneTransform.scaleX+=(i._transform.scaleX-1)*r,i._boneTransform.scaleY+=(i._transform.scaleY-1)*r),i.bone._blendIndex++,0!=i._animationState._fadeState&&i.bone.invalidUpdate())},i}(t.TweenTimelineState);t.BoneTimelineState=r;var n=function(e){function i(){e.call(this),this._color=new t.ColorTransform,this._durationColor=new t.ColorTransform}return __extends(i,e),i.toString=function(){return"[class dragonBones.SlotTimelineState]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.slot=null,this._colorDirty=!1,this._tweenColor=0,this._slotColor=null,this._color.identity(),this._durationColor.identity()},i.prototype._onArriveAtFrame=function(i){var r=this;if(e.prototype._onArriveAtFrame.call(this,i),r._animationState._isDisabled(r.slot))return r._tweenEasing=t.DragonBones.NO_TWEEN,r._curve=null,void(r._tweenColor=0);r._animationState._fadeState>=0&&(r.slot._setDisplayIndex(r._currentFrame.displayIndex),r.slot._updateMeshData(!0)),r._tweenColor=0;var n=r._currentFrame.color;if(r._keyFrameCount>1&&(r._tweenEasing!=t.DragonBones.NO_TWEEN||r._curve)){var o=r._currentFrame.next,a=o.color;n!=a&&o.displayIndex>=0&&(r._durationColor.alphaMultiplier=a.alphaMultiplier-n.alphaMultiplier,r._durationColor.redMultiplier=a.redMultiplier-n.redMultiplier,r._durationColor.greenMultiplier=a.greenMultiplier-n.greenMultiplier,r._durationColor.blueMultiplier=a.blueMultiplier-n.blueMultiplier,r._durationColor.alphaOffset=a.alphaOffset-n.alphaOffset,r._durationColor.redOffset=a.redOffset-n.redOffset,r._durationColor.greenOffset=a.greenOffset-n.greenOffset,r._durationColor.blueOffset=a.blueOffset-n.blueOffset,0==r._durationColor.alphaMultiplier&&0==r._durationColor.redMultiplier&&0==r._durationColor.greenMultiplier&&0==r._durationColor.blueMultiplier&&0==r._durationColor.alphaOffset&&0==r._durationColor.redOffset&&0==r._durationColor.greenOffset&&0==r._durationColor.blueOffset||(r._tweenColor=2))}0==r._tweenColor&&(r._slotColor.alphaMultiplier==n.alphaMultiplier&&r._slotColor.redMultiplier==n.redMultiplier&&r._slotColor.greenMultiplier==n.greenMultiplier&&r._slotColor.blueMultiplier==n.blueMultiplier&&r._slotColor.alphaOffset==n.alphaOffset&&r._slotColor.redOffset==n.redOffset&&r._slotColor.greenOffset==n.greenOffset&&r._slotColor.blueOffset==n.blueOffset||(r._tweenColor=1))},i.prototype._onUpdateFrame=function(t){var i=this;e.prototype._onUpdateFrame.call(this,t);var r=0;if(i._tweenColor){1==i._tweenColor?(i._tweenColor=0,r=0):r=i._tweenProgress;var n=i._currentFrame.color;i._color.alphaMultiplier=n.alphaMultiplier+i._durationColor.alphaMultiplier*r,i._color.redMultiplier=n.redMultiplier+i._durationColor.redMultiplier*r,i._color.greenMultiplier=n.greenMultiplier+i._durationColor.greenMultiplier*r,i._color.blueMultiplier=n.blueMultiplier+i._durationColor.blueMultiplier*r,i._color.alphaOffset=n.alphaOffset+i._durationColor.alphaOffset*r,i._color.redOffset=n.redOffset+i._durationColor.redOffset*r,i._color.greenOffset=n.greenOffset+i._durationColor.greenOffset*r,i._color.blueOffset=n.blueOffset+i._durationColor.blueOffset*r,i._colorDirty=!0}},i.prototype.fadeIn=function(t,i,r,n){e.prototype.fadeIn.call(this,t,i,r,n),this._slotColor=this.slot._colorTransform},i.prototype.fadeOut=function(){this._tweenColor=0},i.prototype.update=function(t){var i=this;if(e.prototype.update.call(this,t),0!=i._tweenColor||i._colorDirty){var r=i._animationState._weightResult;if(r>0)if(0!=i._animationState._fadeState){var n=Math.pow(i._animationState._fadeProgress,4);i._slotColor.alphaMultiplier+=(i._color.alphaMultiplier-i._slotColor.alphaMultiplier)*n,i._slotColor.redMultiplier+=(i._color.redMultiplier-i._slotColor.redMultiplier)*n,i._slotColor.greenMultiplier+=(i._color.greenMultiplier-i._slotColor.greenMultiplier)*n,i._slotColor.blueMultiplier+=(i._color.blueMultiplier-i._slotColor.blueMultiplier)*n,i._slotColor.alphaOffset+=(i._color.alphaOffset-i._slotColor.alphaOffset)*n,i._slotColor.redOffset+=(i._color.redOffset-i._slotColor.redOffset)*n,i._slotColor.greenOffset+=(i._color.greenOffset-i._slotColor.greenOffset)*n,i._slotColor.blueOffset+=(i._color.blueOffset-i._slotColor.blueOffset)*n,i.slot._colorDirty=!0}else i._colorDirty&&(i._colorDirty=!1,i._slotColor.alphaMultiplier=i._color.alphaMultiplier,i._slotColor.redMultiplier=i._color.redMultiplier,i._slotColor.greenMultiplier=i._color.greenMultiplier,i._slotColor.blueMultiplier=i._color.blueMultiplier,i._slotColor.alphaOffset=i._color.alphaOffset,i._slotColor.redOffset=i._color.redOffset,i._slotColor.greenOffset=i._color.greenOffset,i._slotColor.blueOffset=i._color.blueOffset,i.slot._colorDirty=!0)}},i}(t.TweenTimelineState);t.SlotTimelineState=n;var o=function(e){function i(){e.call(this),this._ffdVertices=[]}return __extends(i,e),i.toString=function(){return"[class dragonBones.FFDTimelineState]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.slot=null,this._tweenFFD=0,this._slotFFDVertices=null,this._durationFFDFrame&&(this._durationFFDFrame.returnToPool(),this._durationFFDFrame=null),this._ffdVertices.length=0},i.prototype._onArriveAtFrame=function(i){var r=this;if(e.prototype._onArriveAtFrame.call(this,i),r._tweenFFD=0,(r._tweenEasing!=t.DragonBones.NO_TWEEN||r._curve)&&(r._tweenFFD=r._updateExtensionKeyFrame(r._currentFrame,r._currentFrame.next,r._durationFFDFrame)),0==r._tweenFFD)for(var n=r._currentFrame.tweens,o=0,a=n.length;a>o;++o)if(r._slotFFDVertices[o]!=n[o]){r._tweenFFD=1;break}},i.prototype._onUpdateFrame=function(t){var i=this;e.prototype._onUpdateFrame.call(this,t);var r=0;if(0!=i._tweenFFD){1==i._tweenFFD?(i._tweenFFD=0,r=0):r=i._tweenProgress;for(var n=i._currentFrame.tweens,o=i._durationFFDFrame.tweens,a=0,s=n.length;s>a;++a)i._ffdVertices[a]=n[a]+o[a]*r;i.slot._ffdDirty=!0}},i.prototype.fadeIn=function(i,r,n,o){e.prototype.fadeIn.call(this,i,r,n,o),this._slotFFDVertices=this.slot._ffdVertices,this._durationFFDFrame=t.BaseObject.borrowObject(t.ExtensionFrameData),this._durationFFDFrame.tweens.length=this._slotFFDVertices.length,this._ffdVertices.length=this._slotFFDVertices.length;for(var a=0,s=this._durationFFDFrame.tweens.length;s>a;++a)this._durationFFDFrame.tweens[a]=0;for(var a=0,s=this._ffdVertices.length;s>a;++a)this._ffdVertices[a]=0},i.prototype.update=function(t){var i=this;e.prototype.update.call(this,t);var r=i._animationState._weightResult;if(r>0){if(0==i.slot._blendIndex)for(var n=0,o=i._ffdVertices.length;o>n;++n)i._slotFFDVertices[n]=i._ffdVertices[n]*r;else for(var n=0,o=i._ffdVertices.length;o>n;++n)i._slotFFDVertices[n]+=i._ffdVertices[n]*r;i.slot._blendIndex++,0!=i._animationState._fadeState&&(i.slot._ffdDirty=!0)}},i}(t.TweenTimelineState);t.FFDTimelineState=o}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this.time=(new Date).getTime()/t.DragonBones.SECOND_TO_MILLISECOND,this.timeScale=1,this._animatebles=[]}return Object.defineProperty(e,"clock",{get:function(){return e._clock||(e._clock=new e),e._clock},enumerable:!0,configurable:!0}),e.prototype.advanceTime=function(e){if(e!=e&&(e=0),0>e&&(e=(new Date).getTime()/t.DragonBones.SECOND_TO_MILLISECOND-this.time),e*=this.timeScale,0>e?this.time-=e:this.time+=e,e){for(var i=0,r=0,n=this._animatebles.length;n>i;++i){var o=this._animatebles[i];o?(r>0&&(this._animatebles[i-r]=o,this._animatebles[i]=null),o.advanceTime(e)):r++}if(r>0){for(n=this._animatebles.length;n>i;++i){var o=this._animatebles[i];o?this._animatebles[i-r]=o:r++}this._animatebles.length-=r}}},e.prototype.contains=function(t){return this._animatebles.indexOf(t)>=0},e.prototype.add=function(e){e&&this._animatebles.indexOf(e)<0&&(this._animatebles.push(e),t.DragonBones.debug&&e instanceof t.Armature&&t.DragonBones.addArmature(e))},e.prototype.remove=function(e){var i=this._animatebles.indexOf(e);i>=0&&(this._animatebles[i]=null,t.DragonBones.debug&&e instanceof t.Armature&&t.DragonBones.removeArmature(e))},e.prototype.clear=function(){for(var t=0,e=this._animatebles.length;e>t;++t)this._animatebles[t]=null},e._clock=null,e}();t.WorldClock=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this),this._bones=[],this._slots=[],this._actions=[],this._events=[],this.enableCache=!1}return __extends(i,e),i.toString=function(){return"[class dragonBones.Armature]"},i._onSortSlots=function(t,e){return t._zOrder>e._zOrder?1:-1},i.prototype._onClear=function(){for(var t=0,e=this._bones.length;e>t;++t)this._bones[t].returnToPool();for(var t=0,e=this._slots.length;e>t;++t)this._slots[t].returnToPool();for(var t=0,e=this._events.length;e>t;++t)this._events[t].returnToPool();this._animation&&this._animation.returnToPool(),this._display&&this._display._onClear(),this.userData=null,this._cacheFrameIndex=-1,this._armatureData=null,this._skinData=null,this._animation=null,this._display=null,this._parent=null,this._eventManager=null,this._delayDispose=!1,this._lockDispose=!1,this._bonesDirty=!1,this._slotsDirty=!1,this._replacedTexture=null,this._bones.length=0,this._slots.length=0,this._actions.length=0,this._events.length=0},i.prototype._sortBones=function(){var t=this._bones.length;if(!(0>=t)){var e=this._bones.concat(),i=0,r=0;for(this._bones.length=0;t>r;){var n=e[i++];i>=t&&(i=0),this._bones.indexOf(n)>=0||n.parent&&this._bones.indexOf(n.parent)<0||n.ik&&this._bones.indexOf(n.ik)<0||(n.ik&&n.ikChain>0&&n.ikChainIndex==n.ikChain?this._bones.splice(this._bones.indexOf(n.parent)+1,0,n):this._bones.push(n),r++)}}},i.prototype._sortSlots=function(){this._slots.sort(i._onSortSlots)},i.prototype._doAction=function(t){switch(t.type){case 0:this._animation.play(t.data[0],t.data[1]);break;case 1:this._animation.stop(t.data[0]);break;case 2:this._animation.gotoAndPlayByTime(t.data[0],t.data[1],t.data[2]);break;case 3:this._animation.gotoAndStopByTime(t.data[0],t.data[1]);break;case 4:this._animation.fadeIn(t.data[0],t.data[1],t.data[2]);break;case 5:}},i.prototype._addBoneToBoneList=function(t){this._bones.indexOf(t)<0&&(this._bonesDirty=!0,this._bones.push(t))},i.prototype._removeBoneFromBoneList=function(t){var e=this._bones.indexOf(t);e>=0&&this._bones.splice(e,1)},i.prototype._addSlotToSlotList=function(t){this._slots.indexOf(t)<0&&(this._slotsDirty=!0,this._slots.push(t))},i.prototype._removeSlotFromSlotList=function(t){var e=this._slots.indexOf(t);e>=0&&this._slots.splice(e,1)},i.prototype._sortZOrder=function(t){for(var e=this._armatureData.sortedSlots,i=t.length<1,r=0,n=e.length;n>r;++r){var o=i?r:t[r],a=e[o],s=this.getSlot(a.name);s&&s._setZorder(r)}this._slotsDirty=!0},i.prototype._bufferAction=function(t){this._actions.push(t)},i.prototype._bufferEvent=function(t,e){t.type=e,t.armature=this,this._events.push(t)},i.prototype.dispose=function(){this._delayDispose=!0,!this._lockDispose&&this._animation&&this.returnToPool()},i.prototype.advanceTime=function(e){var i=this;if(!i._animation)throw new Error("The armature has been disposed.");var r=e*i._animation.timeScale;i._animation._advanceTime(r),i._bonesDirty&&(i._bonesDirty=!1,i._sortBones()),i._slotsDirty&&(i._slotsDirty=!1,i._sortSlots());for(var n=0,o=i._bones.length;o>n;++n)i._bones[n]._update(i._cacheFrameIndex);for(var n=0,o=i._slots.length;o>n;++n){var a=i._slots[n];a._update(i._cacheFrameIndex);var s=a._childArmature;s&&s.advanceTime(a.inheritAnimation?r:e)}if(t.DragonBones.debugDraw&&i._display._debugDraw(),!i._lockDispose){if(i._lockDispose=!0,i._events.length>0){for(var n=0,o=i._events.length;o>n;++n){var l=i._events[n];l.type==t.EventObject.SOUND_EVENT?this._eventManager._dispatchEvent(l):i._display._dispatchEvent(l),l.returnToPool()}i._events.length=0}if(i._actions.length>0){for(var n=0,o=i._actions.length;o>n;++n){var h=i._actions[n];if(h.slot){var a=i.getSlot(h.slot.name);if(a){var s=a._childArmature;s&&s._doAction(h)}}else if(h.bone)for(var u=0,c=i._slots.length;c>u;++u){var s=i._slots[u]._childArmature;s&&s._doAction(h)}else this._doAction(h)}i._actions.length=0}i._lockDispose=!1}i._delayDispose&&i.returnToPool()},i.prototype.invalidUpdate=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=!1),t){var i=this.getBone(t);if(i&&(i.invalidUpdate(),e))for(var r=0,n=this._slots.length;n>r;++r){var o=this._slots[r];o.parent==i&&o.invalidUpdate()}}else{for(var r=0,n=this._bones.length;n>r;++r)this._bones[r].invalidUpdate();
if(e)for(var r=0,n=this._slots.length;n>r;++r)this._slots[r].invalidUpdate()}},i.prototype.getBone=function(t){for(var e=0,i=this._bones.length;i>e;++e){var r=this._bones[e];if(r.name==t)return r}return null},i.prototype.getBoneByDisplay=function(t){var e=this.getSlotByDisplay(t);return e?e.parent:null},i.prototype.getSlot=function(t){for(var e=0,i=this._slots.length;i>e;++e){var r=this._slots[e];if(r.name==t)return r}return null},i.prototype.getSlotByDisplay=function(t){if(t)for(var e=0,i=this._slots.length;i>e;++e){var r=this._slots[e];if(r.display==t)return r}return null},i.prototype.replaceTexture=function(t){this.replacedTexture=t},i.prototype.getBones=function(){return this._bones},i.prototype.getSlots=function(){return this._slots},Object.defineProperty(i.prototype,"name",{get:function(){return this._armatureData?this._armatureData.name:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"armatureData",{get:function(){return this._armatureData},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animation",{get:function(){return this._animation},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"display",{get:function(){return this._display},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"cacheFrameRate",{get:function(){return this._armatureData.cacheFrameRate},set:function(t){if(this._armatureData.cacheFrameRate!=t){this._armatureData.cacheFrames(t);for(var e=0,i=this._slots.length;i>e;++e){var r=this._slots[e],n=r.childArmature;n&&0==n.cacheFrameRate&&(n.cacheFrameRate=t)}}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"replacedTexture",{get:function(){return this._replacedTexture},set:function(t){this._display._onReplaceTexture(t),this._replacedTexture=t;for(var e=0,i=this._slots.length;i>e;++e)this._slots[e].invalidUpdate()},enumerable:!0,configurable:!0}),i.prototype.enableAnimationCache=function(t){this.cacheFrameRate=t},i.prototype.hasEventListener=function(t){return this._display.hasEvent(t)},i.prototype.addEventListener=function(t,e,i){this._display.addEvent(t,e,i)},i.prototype.removeEventListener=function(t,e,i){this._display.removeEvent(t,e,i)},i.prototype.addBone=function(t,e){if(void 0===e&&(e=null),!t)throw new Error;t._setArmature(this),t._setParent(e?this.getBone(e):null)},i.prototype.addSlot=function(t,e){var i=this.getBone(e);if(!i)throw new Error;t._setArmature(this),t._setParent(i)},i.prototype.removeBone=function(t){if(!t||t.armature!=this)throw new Error;t._setParent(null),t._setArmature(null)},i.prototype.removeSlot=function(t){if(!t||t.armature!=this)throw new Error;t._setParent(null),t._setArmature(null)},i.prototype.getDisplay=function(){return this._display},i}(t.BaseObject);t.Armature=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this),this.global=new t.Transform,this.origin=new t.Transform,this.offset=new t.Transform,this._globalTransformMatrix=new t.Matrix}return __extends(i,e),i.prototype._onClear=function(){this.userData=null,this.name=null,this.globalTransformMatrix=this._globalTransformMatrix,this.global.identity(),this.origin.identity(),this.offset.identity(),this._armature=null,this._parent=null,this._globalTransformMatrix.identity()},i.prototype._setArmature=function(t){this._armature=t},i.prototype._setParent=function(t){this._parent=t},Object.defineProperty(i.prototype,"armature",{get:function(){return this._armature},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),i}(t.BaseObject);t.TransformObject=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this),this._animationPose=new t.Transform,this._bones=[],this._slots=[]}return __extends(i,e),i.toString=function(){return"[class dragonBones.Bone]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.inheritTranslation=!1,this.inheritRotation=!1,this.inheritScale=!1,this.ikBendPositive=!1,this.ikWeight=0,this.length=0,this._transformDirty=2,this._blendIndex=0,this._cacheFrames=null,this._animationPose.identity(),this._visible=!0,this._ikChain=0,this._ikChainIndex=0,this._ik=null,this._bones.length=0,this._slots.length=0},i.prototype._updateGlobalTransformMatrix=function(){if(this._parent){var t=this._parent.global.skewY,e=this._parent.globalTransformMatrix;if(this.inheritScale)this.inheritRotation||(this.global.skewX-=t,this.global.skewY-=t),this.global.toMatrix(this.globalTransformMatrix),this.globalTransformMatrix.concat(e),this.inheritTranslation||(this.globalTransformMatrix.tx=this.global.x,this.globalTransformMatrix.ty=this.global.y),this.global.fromMatrix(this.globalTransformMatrix);else{if(this.inheritTranslation){var i=this.global.x,r=this.global.y;this.global.x=e.a*i+e.c*r+e.tx,this.global.y=e.d*r+e.b*i+e.ty}this.inheritRotation&&(this.global.skewX+=t,this.global.skewY+=t),this.global.toMatrix(this.globalTransformMatrix)}}else this.global.toMatrix(this.globalTransformMatrix)},i.prototype._computeIKA=function(){var t=this._ik.global,e=this.globalTransformMatrix.a*this.length,i=this.globalTransformMatrix.b*this.length,r=(Math.atan2(t.y-this.global.y,t.x-this.global.x)+this.offset.skewY-2*this.global.skewY+Math.atan2(i,e))*this.ikWeight;this.global.skewX+=r,this.global.skewY+=r,this.global.toMatrix(this.globalTransformMatrix)},i.prototype._computeIKB=function(){var t=this._parent.global,e=this._ik.global,i=this.globalTransformMatrix.a*this.length,r=this.globalTransformMatrix.b*this.length,n=i*i+r*r,o=Math.sqrt(n),a=this.global.x-t.x,s=this.global.y-t.y,l=a*a+s*s,h=Math.sqrt(l);a=e.x-t.x,s=e.y-t.y;var u=a*a+s*s,c=Math.sqrt(u),p=0;if(c>=o+h||h>=c+o||o>=c+h)p=Math.atan2(e.y-t.y,e.x-t.x)+this._parent.offset.skewY,c>=o+h||o>h&&(p+=Math.PI);else{var d=(l-n+u)/(2*u),f=Math.sqrt(l-d*d*u)/c,g=t.x+a*d,y=t.y+s*d,v=-s*f,m=a*f;this.ikBendPositive?(this.global.x=g-v,this.global.y=y-m):(this.global.x=g+v,this.global.y=y+m),p=Math.atan2(this.global.y-t.y,this.global.x-t.x)+this._parent.offset.skewY}p=(p-t.skewY)*this.ikWeight,t.skewX+=p,t.skewY+=p,t.toMatrix(this._parent.globalTransformMatrix),this._parent._transformDirty=1,this.global.x=t.x+Math.cos(t.skewY)*h,this.global.y=t.y+Math.sin(t.skewY)*h;var _=(Math.atan2(e.y-this.global.y,e.x-this.global.x)+this.offset.skewY-2*this.global.skewY+Math.atan2(r,i))*this.ikWeight;this.global.skewX+=_,this.global.skewY+=_,this.global.toMatrix(this.globalTransformMatrix)},i.prototype._setArmature=function(t){if(this._armature!=t){this._ik=null;var e=null,i=null;if(this._armature&&(e=this.getSlots(),i=this.getBones(),this._armature._removeBoneFromBoneList(this)),this._armature=t,this._armature&&this._armature._addBoneToBoneList(this),e)for(var r=0,n=e.length;n>r;++r){var o=e[r];o.parent==this&&o._setArmature(this._armature)}if(i)for(var r=0,n=i.length;n>r;++r){var a=i[r];a.parent==this&&a._setArmature(this._armature)}}},i.prototype._setIK=function(t,e,i){if(t){if(e==i){var r=this._parent;if(e&&r?e=1:(e=0,i=0,r=this),r==t||r.contains(t))t=null,e=0,i=0;else for(var n=t;n.ik&&n.ikChain;){if(r.contains(n.ik)){t=null,e=0,i=0;break}n=n.parent}}}else e=0,i=0;this._ik=t,this._ikChain=e,this._ikChainIndex=i,this._armature&&(this._armature._bonesDirty=!0)},i.prototype._update=function(e){var i=this;if(i._blendIndex=0,e>=0){var r=i._cacheFrames[e];i.globalTransformMatrix==r?i._transformDirty=0:r?(i._transformDirty=2,i.globalTransformMatrix=r):2==i._transformDirty||i._parent&&0!=i._parent._transformDirty||i._ik&&i.ikWeight>0&&0!=i._ik._transformDirty?(i._transformDirty=2,i.globalTransformMatrix=i._globalTransformMatrix):i.globalTransformMatrix!=i._globalTransformMatrix?(i._transformDirty=0,i._cacheFrames[e]=i.globalTransformMatrix):(i._transformDirty=2,i.globalTransformMatrix=i._globalTransformMatrix)}else(2==i._transformDirty||i._parent&&0!=i._parent._transformDirty||i._ik&&i.ikWeight>0&&0!=i._ik._transformDirty)&&(i._transformDirty=2,i.globalTransformMatrix=i._globalTransformMatrix);0!=i._transformDirty&&(2==i._transformDirty?(i._transformDirty=1,i.globalTransformMatrix==i._globalTransformMatrix&&(i.global.x=i.origin.x+i.offset.x+i._animationPose.x,i.global.y=i.origin.y+i.offset.y+i._animationPose.y,i.global.skewX=i.origin.skewX+i.offset.skewX+i._animationPose.skewX,i.global.skewY=i.origin.skewY+i.offset.skewY+i._animationPose.skewY,i.global.scaleX=i.origin.scaleX*i.offset.scaleX*i._animationPose.scaleX,i.global.scaleY=i.origin.scaleY*i.offset.scaleY*i._animationPose.scaleY,i._updateGlobalTransformMatrix(),i._ik&&i._ikChainIndex==i._ikChain&&i.ikWeight>0&&(i.inheritTranslation&&i._ikChain>0&&i._parent?i._computeIKB():i._computeIKA()),e>=0&&!i._cacheFrames[e]&&(i.globalTransformMatrix=t.BoneTimelineData.cacheFrame(i._cacheFrames,e,i._globalTransformMatrix)))):i._transformDirty=0)},i.prototype.invalidUpdate=function(){this._transformDirty=2},i.prototype.contains=function(t){if(t){if(t==this)return!1;for(var e=t;e!=this&&e;)e=e.parent;return e==this}return!1},i.prototype.getBones=function(){this._bones.length=0;for(var t=this._armature.getBones(),e=0,i=t.length;i>e;++e){var r=t[e];r.parent==this&&this._bones.push(r)}return this._bones},i.prototype.getSlots=function(){this._slots.length=0;for(var t=this._armature.getSlots(),e=0,i=t.length;i>e;++e){var r=t[e];r.parent==this&&this._slots.push(r)}return this._slots},Object.defineProperty(i.prototype,"ikChain",{get:function(){return this._ikChain},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ikChainIndex",{get:function(){return this._ikChainIndex},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ik",{get:function(){return this._ik},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"visible",{get:function(){return this._visible},set:function(t){if(this._visible!=t){this._visible=t;for(var e=this._armature.getSlots(),i=0,r=e.length;r>i;++i){var n=e[i];n._parent==this&&n._updateVisible()}}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"slot",{get:function(){for(var t=this._armature.getSlots(),e=0,i=t.length;i>e;++e){var r=t[e];if(r.parent==this)return r}return null},enumerable:!0,configurable:!0}),i}(t.TransformObject);t.Bone=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this),this._colorTransform=new t.ColorTransform,this._ffdVertices=[],this._replacedDisplayDataSet=[],this._localMatrix=new t.Matrix,this._displayList=[],this._meshBones=[]}return __extends(i,e),i.prototype._onClear=function(){e.prototype._onClear.call(this);for(var i=[],r=0,n=this._displayList.length;n>r;++r){var o=this._displayList[r];o!=this._rawDisplay&&o!=this._meshDisplay&&i.indexOf(o)<0&&i.push(o)}for(var r=0,n=i.length;n>r;++r){var o=i[r];o instanceof t.Armature?o.dispose():this._disposeDisplay(o)}this._meshDisplay&&this._meshDisplay!=this._rawDisplay&&this._disposeDisplay(this._meshDisplay),this._rawDisplay&&this._disposeDisplay(this._rawDisplay),this.inheritAnimation=!0,this.displayController=null,this._blendIndex=0,this._displayDataSet=null,this._meshData=null,this._childArmature=null,this._rawDisplay=null,this._meshDisplay=null,this._cacheFrames=null,this._colorTransform.identity(),this._ffdVertices.length=0,this._replacedDisplayDataSet.length=0,this._zOrderDirty=!1,this._displayDirty=!1,this._colorDirty=!1,this._blendModeDirty=!1,this._originDirty=!1,this._transformDirty=!1,this._ffdDirty=!1,this._zOrder=0,this._displayIndex=-2,this._pivotX=0,this._pivotY=0,this._blendMode=0,this._display=null,this._localMatrix.identity(),this._displayList.length=0,this._meshBones.length=0},i.prototype._isMeshBonesUpdate=function(){for(var t=0,e=this._meshBones.length;e>t;++t)if(0!=this._meshBones[t]._transformDirty)return!0;return!1},i.prototype._updatePivot=function(t,e,r){var n=t&&t!=e&&(!this._meshData||this._meshData!=t.mesh);if(this._meshData&&this._display==this._meshDisplay)this._pivotX=0,this._pivotY=0;else{var o=this._armature.armatureData.scale;if(this._pivotX=e.pivot.x,this._pivotY=e.pivot.y,e.isRelativePivot){var a=r.frame||r.region,s=a.width*o,l=a.height*o;r.rotated&&(s=a.height,l=a.width),this._pivotX*=s,this._pivotY*=l}r.frame&&(this._pivotX+=r.frame.x*o,this._pivotY+=r.frame.y*o)}n&&(t.transform.toMatrix(i._helpMatrix),i._helpMatrix.invert(),i._helpMatrix.transformPoint(0,0,i._helpPoint),this._pivotX-=i._helpPoint.x,this._pivotY-=i._helpPoint.y,e.transform.toMatrix(i._helpMatrix),i._helpMatrix.invert(),i._helpMatrix.transformPoint(0,0,i._helpPoint),this._pivotX+=i._helpPoint.x,this._pivotY+=i._helpPoint.y)},i.prototype._updateDisplay=function(){var e=this._display||this._rawDisplay,i=this._childArmature;this._displayIndex>=0&&this._displayIndex<this._displayList.length?(this._display=this._displayList[this._displayIndex],this._display instanceof t.Armature?(this._childArmature=this._display,this._display=this._childArmature._display):this._childArmature=null):(this._display=null,this._childArmature=null);var r=this._display||this._rawDisplay;if(r!=e&&(this._onUpdateDisplay(),e?this._replaceDisplay(e):this._addDisplay(),this._blendModeDirty=!0,this._colorDirty=!0),this._displayDataSet&&this._displayIndex>=0&&this._displayIndex<this._displayDataSet.displays.length&&(this.origin.copyFrom(this._displayDataSet.displays[this._displayIndex].transform),this._originDirty=!0),this._updateMeshData(!1),r!=this._rawDisplay&&r!=this._meshDisplay||this._updateFrame(),this._childArmature!=i&&(i&&(i._parent=null,this.inheritAnimation&&i.animation.reset()),this._childArmature&&(this._childArmature._parent=this,this.inheritAnimation))){if(0==this._childArmature.cacheFrameRate){var n=this._armature.cacheFrameRate;0!=n&&(this._childArmature.cacheFrameRate=n)}var o=this._armature.armatureData.getSlot(this.name),a=o.actions.length>0?o.actions:this._childArmature.armatureData.actions;if(a.length>0)for(var s=0,l=a.length;l>s;++s)this._childArmature._bufferAction(a[s]);else this._childArmature.animation.play()}},i.prototype._updateLocalTransformMatrix=function(){this.global.copyFrom(this.origin).add(this.offset).toMatrix(this._localMatrix)},i.prototype._updateGlobalTransformMatrix=function(){this.globalTransformMatrix.copyFrom(this._localMatrix),this.globalTransformMatrix.concat(this._parent.globalTransformMatrix),this.global.fromMatrix(this.globalTransformMatrix)},i.prototype._setArmature=function(t){this._armature!=t&&(this._armature&&this._armature._removeSlotFromSlotList(this),this._armature=t,this._onUpdateDisplay(),this._armature?(this._armature._addSlotToSlotList(this),this._addDisplay()):this._removeDisplay())},i.prototype._updateMeshData=function(t){var e=this._meshData,i=null;if(this._display&&this._display==this._meshDisplay&&this._displayIndex>=0){i=this._displayDataSet&&this._displayIndex<this._displayDataSet.displays.length?this._displayDataSet.displays[this._displayIndex].mesh:null;var r=this._displayIndex<this._replacedDisplayDataSet.length?this._replacedDisplayDataSet[this._displayIndex]:null,n=r?r.mesh:null;this._meshData=n||i}else this._meshData=null;if(this._meshData!=e){if(this._meshData&&this._meshData==i){if(this._meshData.skinned){this._meshBones.length=this._meshData.bones.length;for(var o=0,a=this._meshBones.length;a>o;++o)this._meshBones[o]=this._armature.getBone(this._meshData.bones[o].name);for(var s=0,o=0,a=this._meshData.boneIndices.length;a>o;++o)s+=this._meshData.boneIndices[o].length;this._ffdVertices.length=2*s}else this._meshBones.length=0,this._ffdVertices.length=this._meshData.vertices.length;for(var o=0,a=this._ffdVertices.length;a>o;++o)this._ffdVertices[o]=0;this._ffdDirty=!0}else this._meshBones.length=0,this._ffdVertices.length=0;t&&this._armature.animation._updateFFDTimelineStates()}},i.prototype._update=function(e){var i=this;if(i._blendIndex=0,i._zOrderDirty&&(i._zOrderDirty=!1,i._updateZOrder()),i._displayDirty&&(i._displayDirty=!1,i._updateDisplay()),i._display&&(i._blendModeDirty&&(i._blendModeDirty=!1,i._updateBlendMode()),i._colorDirty&&(i._colorDirty=!1,i._updateColor()),!i._meshData||((i._ffdDirty||i._meshData.skinned&&i._isMeshBonesUpdate())&&(i._ffdDirty=!1,i._updateMesh()),!i._meshData.skinned))){if(i._originDirty&&(i._originDirty=!1,i._transformDirty=!0,i._updateLocalTransformMatrix()),e>=0&&i._cacheFrames){var r=i._cacheFrames[e];i.globalTransformMatrix==r?i._transformDirty=!1:r?(i._transformDirty=!0,i.globalTransformMatrix=r):i._transformDirty||0!=i._parent._transformDirty?(i._transformDirty=!0,i.globalTransformMatrix=i._globalTransformMatrix):i.globalTransformMatrix!=i._globalTransformMatrix?(i._transformDirty=!1,i._cacheFrames[e]=i.globalTransformMatrix):(i._transformDirty=!0,i.globalTransformMatrix=i._globalTransformMatrix)}else(i._transformDirty||0!=i._parent._transformDirty)&&(i._transformDirty=!0,i.globalTransformMatrix=i._globalTransformMatrix);i._transformDirty&&(i._transformDirty=!1,i.globalTransformMatrix==i._globalTransformMatrix&&(i._updateGlobalTransformMatrix(),e>=0&&i._cacheFrames&&!i._cacheFrames[e]&&(i.globalTransformMatrix=t.SlotTimelineData.cacheFrame(i._cacheFrames,e,i._globalTransformMatrix))),i._updateTransform())}},i.prototype._setDisplayList=function(e){if(e&&e.length>0){this._displayList.length!=e.length&&(this._displayList.length=e.length);for(var i=0,r=e.length;r>i;++i){var n=e[i];n&&n!=this._rawDisplay&&n!=this._meshDisplay&&!(n instanceof t.Armature)&&this._displayList.indexOf(n)<0&&this._initDisplay(n),this._displayList[i]=n}}else this._displayList.length>0&&(this._displayList.length=0);return this._displayDirty=this._displayIndex>=0&&this._displayIndex<this._displayList.length?this._display!=this._displayList[this._displayIndex]:null!=this._display,this._displayDirty},i.prototype._setZorder=function(t){return this._zOrder==t,this._zOrder=t,this._zOrderDirty=!0,this._zOrderDirty},i.prototype._setDisplayIndex=function(t){return this._displayIndex!=t&&(this._displayIndex=t,this._displayDirty=!0,this._displayDirty)},i.prototype._setBlendMode=function(t){return this._blendMode!=t&&(this._blendMode=t,this._blendModeDirty=!0,!0)},i.prototype._setColor=function(t){return this._colorTransform.copyFrom(t),this._colorDirty=!0,!0},i.prototype.invalidUpdate=function(){this._displayDirty=!0},Object.defineProperty(i.prototype,"rawDisplay",{get:function(){return this._rawDisplay},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"meshDisplay",{get:function(){return this._meshDisplay},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"displayIndex",{get:function(){return this._displayIndex},set:function(t){this._setDisplayIndex(t)&&this._update(-1)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"displayList",{get:function(){return this._displayList.concat()},set:function(e){var i=this._displayList.concat(),r=[];this._setDisplayList(e)&&this._update(-1);for(var n=0,o=i.length;o>n;++n){var a=i[n];a&&a!=this._rawDisplay&&a!=this._meshDisplay&&this._displayList.indexOf(a)<0&&r.indexOf(a)<0&&r.push(a)}for(var n=0,o=r.length;o>n;++n){var a=r[n];a instanceof t.Armature?a.dispose():this._disposeDisplay(a)}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"display",{get:function(){return this._display},set:function(t){if(this._display!=t){var e=this._displayList.length;if(this._displayIndex<0&&0==e&&(this._displayIndex=0),!(this._displayIndex<0)){var i=this.displayList;e<=this._displayIndex&&(i.length=this._displayIndex+1),i[this._displayIndex]=t,this.displayList=i}}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"childArmature",{get:function(){return this._childArmature},set:function(t){this._childArmature!=t&&(t&&t.display.advanceTimeBySelf(!1),this.display=t)},enumerable:!0,configurable:!0}),i.prototype.getDisplay=function(){return this._display},i.prototype.setDisplay=function(t){this.display=t},i._helpPoint=new t.Point,i._helpMatrix=new t.Matrix,i}(t.TransformObject);t.Slot=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(i){void 0===i&&(i=null),this.autoSearch=!1,this._dataParser=null,this._dragonBonesDataMap={},this._textureAtlasDataMap={},this._dataParser=i,this._dataParser||(e._defaultParser||(e._defaultParser=new t.ObjectDataParser),this._dataParser=e._defaultParser)}return e.prototype._getTextureData=function(t,e){var i=this._textureAtlasDataMap[t];if(i)for(var r=0,n=i.length;n>r;++r){var o=i[r].getTexture(e);if(o)return o}if(this.autoSearch)for(var r in this._textureAtlasDataMap){i=this._textureAtlasDataMap[r];for(var a=0,s=i.length;s>a;++a){var l=i[a];if(l.autoSearch){var o=l.getTexture(e);if(o)return o}}}return null},e.prototype._fillBuildArmaturePackage=function(t,e,i,r,n){var o=null,a=null;if(e&&(o=this._dragonBonesDataMap[e],o&&(a=o.getArmature(i))),!a&&(!e||this.autoSearch))for(var s in this._dragonBonesDataMap)if(o=this._dragonBonesDataMap[s],(!e||o.autoSearch)&&(a=o.getArmature(i))){e=s;break}return!!a&&(t.dataName=e,t.textureAtlasName=n,t.data=o,t.armature=a,t.skin=a.getSkin(r),t.skin||(t.skin=a.defaultSkin),!0)},e.prototype._buildBones=function(e,i){for(var r=e.armature.sortedBones,n=0,o=r.length;o>n;++n){var a=r[n],s=t.BaseObject.borrowObject(t.Bone);s.name=a.name,s.inheritTranslation=a.inheritTranslation,s.inheritRotation=a.inheritRotation,s.inheritScale=a.inheritScale,s.length=a.length,s.origin.copyFrom(a.transform),a.parent?i.addBone(s,a.parent.name):i.addBone(s),a.ik&&(s.ikBendPositive=a.bendPositive,s.ikWeight=a.weight,s._setIK(i.getBone(a.ik.name),a.chain,a.chainIndex))}},e.prototype._buildSlots=function(t,e){var i=t.skin,r=t.armature.defaultSkin,n={};for(var o in r.slots){var a=r.slots[o];n[a.slot.name]=a}if(i!=r)for(var o in i.slots){var a=i.slots[o];n[a.slot.name]=a}for(var s=t.armature.sortedSlots,o=0,l=s.length;l>o;++o){var h=s[o],a=n[h.name];if(a){var u=this._generateSlot(t,a,e);u&&(u._displayDataSet=a,u._setDisplayIndex(h.displayIndex),u._setBlendMode(h.blendMode),u._setColor(h.color),e.addSlot(u,h.parent.name))}}},e.prototype._replaceSlotDisplay=function(t,e,i,r){if(0>r&&(r=i.displayIndex),r>=0){var n=i.displayList;if(n.length<=r&&(n.length=r+1),i._replacedDisplayDataSet.length<=r&&(i._replacedDisplayDataSet.length=r+1),i._replacedDisplayDataSet[r]=e,1==e.type){var o=this.buildArmature(e.name,t.dataName,null,t.textureAtlasName);n[r]=o}else e.texture&&!t.textureAtlasName||(e.texture=this._getTextureData(t.textureAtlasName||t.dataName,e.name)),n[r]=e.mesh||r<i._displayDataSet.displays.length&&i._displayDataSet.displays[r].mesh?i.meshDisplay:i.rawDisplay;i.displayList=n,i.invalidUpdate()}},e.prototype.parseDragonBonesData=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=1);var r=this._dataParser.parseDragonBonesData(t,i);return this.addDragonBonesData(r,e),r},e.prototype.parseTextureAtlasData=function(t,e,i,r){void 0===i&&(i=null),void 0===r&&(r=0);var n=this._generateTextureAtlasData(null,null);return this._dataParser.parseTextureAtlasData(t,n,r),this._generateTextureAtlasData(n,e),this.addTextureAtlasData(n,i),n},e.prototype.getDragonBonesData=function(t){return this._dragonBonesDataMap[t]},e.prototype.addDragonBonesData=function(t,e){if(void 0===e&&(e=null),!t)throw new Error;e=e||t.name,e?this._dragonBonesDataMap[e]?console.warn("Same name data.",e):this._dragonBonesDataMap[e]=t:console.warn("Unnamed data.")},e.prototype.removeDragonBonesData=function(e,i){void 0===i&&(i=!0);var r=this._dragonBonesDataMap[e];if(r){if(i){if(t.DragonBones.debug)for(var n=0,o=t.DragonBones._armatures.length;o>n;++n){var a=t.DragonBones._armatures[n];if(a.armatureData.parent==r)throw new Error("ArmatureData: "+a.armatureData.name+" DragonBonesData: "+e)}r.returnToPool()}delete this._dragonBonesDataMap[e]}},e.prototype.getTextureAtlasData=function(t){return this._textureAtlasDataMap[t]},e.prototype.addTextureAtlasData=function(t,e){if(void 0===e&&(e=null),!t)throw new Error;if(e=e||t.name){var i=this._textureAtlasDataMap[e]=this._textureAtlasDataMap[e]||[];i.indexOf(t)<0&&i.push(t)}else console.warn("Unnamed data.")},e.prototype.removeTextureAtlasData=function(t,e){void 0===e&&(e=!0);var i=this._textureAtlasDataMap[t];if(i){if(e)for(var r=0,n=i.length;n>r;++r)i[r].returnToPool();delete this._textureAtlasDataMap[t]}},e.prototype.clear=function(t){void 0===t&&(t=!0);for(var e in this._dragonBonesDataMap)t&&this._dragonBonesDataMap[e].returnToPool(),delete this._dragonBonesDataMap[e];for(var e in this._textureAtlasDataMap){if(t)for(var i=this._textureAtlasDataMap[e],r=0,n=i.length;n>r;++r)i[r].returnToPool();delete this._textureAtlasDataMap[e]}},e.prototype.buildArmature=function(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=null),void 0===r&&(r=null);var n={};if(this._fillBuildArmaturePackage(n,e,t,i,r)){var o=this._generateArmature(n);return this._buildBones(n,o),this._buildSlots(n,o),o.advanceTime(0),o}return console.warn("No armature data.",t,e||""),null},e.prototype.copyAnimationsToArmature=function(e,i,r,n,o){void 0===r&&(r=null),void 0===n&&(n=null),void 0===o&&(o=!0);var a={};if(this._fillBuildArmaturePackage(a,n,i,r,null)){var s=a.armature;if(o)e.animation.animations=s.animations;else{var l={};for(var h in e.animation.animations)l[h]=e.animation.animations[h];for(var h in s.animations)l[h]=s.animations[h];e.animation.animations=l}if(a.skin){for(var u=e.getSlots(),c=0,p=u.length;p>c;++c)for(var d=u[c],f=d.displayList,g=0,y=f.length;y>g;++g){var v=f[g];if(v instanceof t.Armature){var m=a.skin.getSlot(d.name).displays;if(g<m.length){var _=m[g];1==_.type&&this.copyAnimationsToArmature(v,_.name,r,n,o)}}}return!0}}return!1},e.prototype.replaceSlotDisplay=function(t,e,i,r,n,o){void 0===o&&(o=-1);var a={};if(this._fillBuildArmaturePackage(a,t,e,null,null)){var s=a.skin.getSlot(i);if(s)for(var l=0,h=s.displays.length;h>l;++l){var u=s.displays[l];if(u.name==r){this._replaceSlotDisplay(a,u,n,o);break}}}},e.prototype.replaceSlotDisplayList=function(t,e,i,r){var n={};if(this._fillBuildArmaturePackage(n,t,e,null,null)){var o=n.skin.getSlot(i);if(o)for(var a=0,s=0,l=o.displays.length;l>s;++s){var h=o.displays[s];this._replaceSlotDisplay(n,h,r,a++)}}},e.prototype.getAllDragonBonesData=function(){return this._dragonBonesDataMap},e.prototype.getAllTextureAtlasData=function(){return this._textureAtlasDataMap},e._defaultParser=null,e}();t.BaseFactory=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this._data=null,this._armature=null,this._skin=null,this._slotDisplayDataSet=null,this._mesh=null,this._animation=null,this._timeline=null,this._isOldData=!1,this._isGlobalTransform=!1,this._isAutoTween=!1,this._animationTweenEasing=0,this._timelinePivot=new t.Point,this._helpPoint=new t.Point,this._helpTransformA=new t.Transform,this._helpTransformB=new t.Transform,this._helpMatrix=new t.Matrix,this._rawBones=[]}return e._getArmatureType=function(t){switch(t.toLowerCase()){case"stage":return 2;case"armature":return 0;case"movieclip":return 1;default:return 0}},e._getDisplayType=function(t){switch(t.toLowerCase()){case"image":return 0;case"armature":return 1;case"mesh":return 2;default:return 0}},e._getBlendMode=function(t){switch(t.toLowerCase()){case"normal":return 0;case"add":return 1;case"alpha":return 2;case"darken":return 3;case"difference":return 4;case"erase":return 5;case"hardlight":return 6;case"invert":return 7;case"layer":return 8;case"lighten":return 9;case"multiply":return 10;case"overlay":return 11;case"screen":return 12;case"subtract":return 13;default:return 0}},e._getActionType=function(t){switch(t.toLowerCase()){case"play":return 0;case"stop":return 1;case"gotoandplay":return 2;case"gotoandstop":return 3;case"fadein":return 4;case"fadeout":return 5;default:return 4}},e.prototype._getTimelineFrameMatrix=function(e,i,r,n){var o=Math.floor(r*e.frameCount/e.duration);if(1==i.frames.length||o>=i.frames.length)n.copyFrom(i.frames[0].transform);else{var a=i.frames[o],s=0;a.tweenEasing!=t.DragonBones.NO_TWEEN?(s=(r-a.position)/a.duration,0!=a.tweenEasing&&(s=t.TweenTimelineState._getEasingValue(s,a.tweenEasing))):a.curve&&(s=(r-a.position)/a.duration,s=t.TweenTimelineState._getEasingCurveValue(s,a.curve));var l=a.next;n.x=l.transform.x-a.transform.x,n.y=l.transform.y-a.transform.y,n.skewX=t.Transform.normalizeRadian(l.transform.skewX-a.transform.skewX),n.skewY=t.Transform.normalizeRadian(l.transform.skewY-a.transform.skewY),n.scaleX=l.transform.scaleX-a.transform.scaleX,n.scaleY=l.transform.scaleY-a.transform.scaleY,n.x=a.transform.x+n.x*s,n.y=a.transform.y+n.y*s,n.skewX=a.transform.skewX+n.skewX*s,n.skewY=a.transform.skewY+n.skewY*s,n.scaleX=a.transform.scaleX+n.scaleX*s,n.scaleY=a.transform.scaleY+n.scaleY*s}n.add(i.originalTransform)},e.prototype._globalToLocal=function(t){for(var e=new Array,i=t.sortedBones.concat().reverse(),r=0,n=i.length;n>r;++r){var o=i[r];o.parent&&(o.parent.transform.toMatrix(this._helpMatrix),this._helpMatrix.invert(),this._helpMatrix.transformPoint(o.transform.x,o.transform.y,this._helpPoint),o.transform.x=this._helpPoint.x,o.transform.y=this._helpPoint.y,o.transform.rotation-=o.parent.transform.rotation);for(var a in t.animations){var s=t.animations[a],l=s.getBoneTimeline(o.name);if(l){var h=o.parent?s.getBoneTimeline(o.parent.name):null;this._helpTransformB.copyFrom(l.originalTransform),e.length=0;for(var u=0,c=l.frames.length;c>u;++u){var p=l.frames[u];e.indexOf(p)>=0||(e.push(p),h?(this._getTimelineFrameMatrix(s,h,p.position,this._helpTransformA),p.transform.add(this._helpTransformB),this._helpTransformA.toMatrix(this._helpMatrix),this._helpMatrix.invert(),this._helpMatrix.transformPoint(p.transform.x,p.transform.y,this._helpPoint),p.transform.x=this._helpPoint.x,p.transform.y=this._helpPoint.y,p.transform.rotation-=this._helpTransformA.rotation):p.transform.add(this._helpTransformB),p.transform.minus(o.transform),0==u?(l.originalTransform.copyFrom(p.transform),p.transform.identity()):p.transform.minus(l.originalTransform))}}}}},e.prototype._mergeFrameToAnimationTimeline=function(e,i,r){var n=Math.floor(e*this._armature.frameRate),o=this._animation.frames;if(0==o.length){var a=t.BaseObject.borrowObject(t.AnimationFrameData);if(a.position=0,this._animation.frameCount>1){o.length=this._animation.frameCount+1;var s=t.BaseObject.borrowObject(t.AnimationFrameData);s.position=this._animation.frameCount/this._armature.frameRate,o[0]=a,o[this._animation.frameCount]=s}}var l=null,h=o[n];if(!h||0!=n&&o[n-1]!=h.prev){l=t.BaseObject.borrowObject(t.AnimationFrameData),l.position=n/this._armature.frameRate,o[n]=l;for(var u=n+1,c=o.length;c>u;++u)h&&o[u]==h&&(o[u]=null)}else l=h;if(i)for(var u=0,c=i.length;c>u;++u)l.actions.push(i[u]);if(r)for(var u=0,c=r.length;c>u;++u)l.events.push(r[u]);for(var p=null,d=null,u=0,c=o.length;c>u;++u){var f=o[u];f&&d!=f?(d=f,p&&(d.prev=p,p.next=d,p.duration=d.position-p.position),p=d):o[u]=p}d.duration=this._animation.duration-d.position,d=o[0],p.next=d,d.prev=p},e.parseDragonBonesData=function(e){return t.ObjectDataParser.getInstance().parseDragonBonesData(e)},e.parseTextureAtlasData=function(i,r){void 0===r&&(r=1);for(var n={},o=i[e.SUB_TEXTURE],a=0,s=o.length;s>a;a++){var l=o[a],h=l[e.NAME],u=new t.Rectangle,c=null;u.x=l[e.X]/r,u.y=l[e.Y]/r,u.width=l[e.WIDTH]/r,u.height=l[e.HEIGHT]/r,e.FRAME_WIDTH in l&&(c=new t.Rectangle,c.x=l[e.FRAME_X]/r,c.y=l[e.FRAME_Y]/r,c.width=l[e.FRAME_WIDTH]/r,c.height=l[e.FRAME_HEIGHT]/r),n[h]={region:u,frame:c,rotated:!1}}return n},e.DATA_VERSION_2_3="2.3",e.DATA_VERSION_3_0="3.0",e.DATA_VERSION_4_0="4.0",e.DATA_VERSION="4.5",e.TEXTURE_ATLAS="TextureAtlas",e.SUB_TEXTURE="SubTexture",e.FORMAT="format",e.IMAGE_PATH="imagePath",e.WIDTH="width",e.HEIGHT="height",e.ROTATED="rotated",e.FRAME_X="frameX",e.FRAME_Y="frameY",e.FRAME_WIDTH="frameWidth",e.FRAME_HEIGHT="frameHeight",e.DRADON_BONES="dragonBones",e.ARMATURE="armature",e.BONE="bone",e.IK="ik",e.SLOT="slot",e.SKIN="skin",e.DISPLAY="display",e.ANIMATION="animation",e.Z_ORDER="zOrder",e.FFD="ffd",e.FRAME="frame",e.PIVOT="pivot",e.TRANSFORM="transform",e.AABB="aabb",e.COLOR="color",e.FILTER="filter",e.VERSION="version",e.IS_GLOBAL="isGlobal",e.FRAME_RATE="frameRate",e.TYPE="type",e.NAME="name",e.PARENT="parent",e.LENGTH="length",e.DATA="data",e.DISPLAY_INDEX="displayIndex",e.BLEND_MODE="blendMode",e.INHERIT_TRANSLATION="inheritTranslation",e.INHERIT_ROTATION="inheritRotation",e.INHERIT_SCALE="inheritScale",e.TARGET="target",e.BEND_POSITIVE="bendPositive",e.CHAIN="chain",e.WEIGHT="weight",e.FADE_IN_TIME="fadeInTime",e.PLAY_TIMES="playTimes",e.SCALE="scale",e.OFFSET="offset",e.POSITION="position",e.DURATION="duration",e.TWEEN_EASING="tweenEasing",e.TWEEN_ROTATE="tweenRotate",e.TWEEN_SCALE="tweenScale",e.CURVE="curve",e.GUIDE_CURVE="guideCurve",e.EVENT="event",e.SOUND="sound",e.ACTION="action",e.ACTIONS="actions",e.DEFAULT_ACTIONS="defaultActions",e.X="x",e.Y="y",e.SKEW_X="skX",e.SKEW_Y="skY",e.SCALE_X="scX",e.SCALE_Y="scY",e.ALPHA_OFFSET="aO",e.RED_OFFSET="rO",e.GREEN_OFFSET="gO",e.BLUE_OFFSET="bO",e.ALPHA_MULTIPLIER="aM",e.RED_MULTIPLIER="rM",e.GREEN_MULTIPLIER="gM",e.BLUE_MULTIPLIER="bM",e.UVS="uvs",e.VERTICES="vertices",e.TRIANGLES="triangles",e.WEIGHTS="weights",e.SLOT_POSE="slotPose",e.BONE_POSE="bonePose",e.TWEEN="tween",e.KEY="key",e.COLOR_TRANSFORM="colorTransform",e.TIMELINE="timeline",e.PIVOT_X="pX",e.PIVOT_Y="pY",e.Z="z",e.LOOP="loop",e.AUTO_TWEEN="autoTween",e.HIDE="hide",e
}();t.DataParser=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this)}return __extends(i,e),i._getBoolean=function(t,e,i){if(e in t){var r=t[e],n=typeof r;if("boolean"==n)return r;if("string"!=n)return!!r;switch(r){case"0":case"NaN":case"":case"false":case"null":case"undefined":return!1;default:return!0}}return i},i._getNumber=function(t,e,i){if(e in t){var r=t[e];return null==r||"NaN"==r?i:+r||0}return i},i._getString=function(t,e,i){return e in t?String(t[e]):i},i._getParameter=function(t,e,i){return t.length>e?t[e]:i},i.prototype._parseArmature=function(e,r){var n=t.BaseObject.borrowObject(t.ArmatureData);if(n.name=i._getString(e,i.NAME,null),n.frameRate=i._getNumber(e,i.FRAME_RATE,this._data.frameRate)||this._data.frameRate,n.scale=r,n.type=i.TYPE in e&&"string"==typeof e[i.TYPE]?i._getArmatureType(e[i.TYPE]):i._getNumber(e,i.TYPE,0),this._armature=n,this._rawBones.length=0,i.AABB in e){var o=e[i.AABB];n.aabb.x=i._getNumber(o,i.X,0),n.aabb.y=i._getNumber(o,i.Y,0),n.aabb.width=i._getNumber(o,i.WIDTH,0),n.aabb.height=i._getNumber(o,i.HEIGHT,0)}if(i.BONE in e)for(var a=e[i.BONE],s=0,l=a.length;l>s;++s){var h=a[s],u=this._parseBone(h);n.addBone(u,i._getString(h,i.PARENT,null)),this._rawBones.push(u)}if(i.IK in e)for(var c=e[i.IK],s=0,l=c.length;l>s;++s)this._parseIK(c[s]);if(i.SLOT in e)for(var p=e[i.SLOT],d=0,s=0,l=p.length;l>s;++s)n.addSlot(this._parseSlot(p[s],d++));if(i.SKIN in e)for(var f=e[i.SKIN],s=0,l=f.length;l>s;++s)n.addSkin(this._parseSkin(f[s]));if(i.ANIMATION in e)for(var g=e[i.ANIMATION],s=0,l=g.length;l>s;++s)n.addAnimation(this._parseAnimation(g[s]));return(i.ACTIONS in e||i.DEFAULT_ACTIONS in e)&&this._parseActionData(e,n.actions,null,null),this._isOldData&&this._isGlobalTransform&&this._globalToLocal(n),this._armature=null,this._rawBones.length=0,n},i.prototype._parseBone=function(e){var r=t.BaseObject.borrowObject(t.BoneData);return r.name=i._getString(e,i.NAME,null),r.inheritTranslation=i._getBoolean(e,i.INHERIT_TRANSLATION,!0),r.inheritRotation=i._getBoolean(e,i.INHERIT_ROTATION,!0),r.inheritScale=i._getBoolean(e,i.INHERIT_SCALE,!0),r.length=i._getNumber(e,i.LENGTH,0)*this._armature.scale,i.TRANSFORM in e&&this._parseTransform(e[i.TRANSFORM],r.transform),this._isOldData&&(r.inheritScale=!1),r},i.prototype._parseIK=function(t){var e=this._armature.getBone(i._getString(t,i.BONE in t?i.BONE:i.NAME,null));e&&(e.ik=this._armature.getBone(i._getString(t,i.TARGET,null)),e.bendPositive=i._getBoolean(t,i.BEND_POSITIVE,!0),e.chain=i._getNumber(t,i.CHAIN,0),e.weight=i._getNumber(t,i.WEIGHT,1),e.chain>0&&e.parent&&!e.parent.ik?(e.parent.ik=e.ik,e.parent.chainIndex=0,e.parent.chain=0,e.chainIndex=1):(e.chain=0,e.chainIndex=0))},i.prototype._parseSlot=function(e,r){var n=t.BaseObject.borrowObject(t.SlotData);return n.name=i._getString(e,i.NAME,null),n.parent=this._armature.getBone(i._getString(e,i.PARENT,null)),n.displayIndex=i._getNumber(e,i.DISPLAY_INDEX,0),n.zOrder=i._getNumber(e,i.Z,r),i.COLOR in e||i.COLOR_TRANSFORM in e?(n.color=t.SlotData.generateColor(),this._parseColorTransform(e[i.COLOR]||e[i.COLOR_TRANSFORM],n.color)):n.color=t.SlotData.DEFAULT_COLOR,n.blendMode=i.BLEND_MODE in e&&"string"==typeof e[i.BLEND_MODE]?i._getBlendMode(e[i.BLEND_MODE]):i._getNumber(e,i.BLEND_MODE,0),(i.ACTIONS in e||i.DEFAULT_ACTIONS in e)&&this._parseActionData(e,n.actions,null,null),this._isOldData&&(i.COLOR_TRANSFORM in e?(n.color=t.SlotData.generateColor(),this._parseColorTransform(e[i.COLOR_TRANSFORM],n.color)):n.color=t.SlotData.DEFAULT_COLOR),n},i.prototype._parseSkin=function(e){var r=t.BaseObject.borrowObject(t.SkinData);if(r.name=i._getString(e,i.NAME,"__default")||"__default",i.SLOT in e){this._skin=r;for(var n=e[i.SLOT],o=0,a=0,s=n.length;s>a;++a)this._isOldData&&this._armature.addSlot(this._parseSlot(n[a],o++)),r.addSlot(this._parseSlotDisplaySet(n[a]));this._skin=null}return r},i.prototype._parseSlotDisplaySet=function(e){var r=t.BaseObject.borrowObject(t.SlotDisplayDataSet);if(r.slot=this._armature.getSlot(i._getString(e,i.NAME,null)),i.DISPLAY in e){var n=e[i.DISPLAY],o=r.displays;this._slotDisplayDataSet=r;for(var a=0,s=n.length;s>a;++a)o.push(this._parseDisplay(n[a]));this._slotDisplayDataSet=null}return r},i.prototype._parseDisplay=function(e){var r=t.BaseObject.borrowObject(t.DisplayData);if(r.name=i._getString(e,i.NAME,null),r.type=i.TYPE in e&&"string"==typeof e[i.TYPE]?i._getDisplayType(e[i.TYPE]):i._getNumber(e,i.TYPE,0),r.isRelativePivot=!0,i.PIVOT in e){var n=e[i.PIVOT];r.pivot.x=i._getNumber(n,i.X,0),r.pivot.y=i._getNumber(n,i.Y,0)}else if(this._isOldData){var o=e[i.TRANSFORM];r.isRelativePivot=!1,r.pivot.x=i._getNumber(o,i.PIVOT_X,0)*this._armature.scale,r.pivot.y=i._getNumber(o,i.PIVOT_Y,0)*this._armature.scale}else r.pivot.x=.5,r.pivot.y=.5;switch(i.TRANSFORM in e&&this._parseTransform(e[i.TRANSFORM],r.transform),r.type){case 0:break;case 1:break;case 2:r.mesh=this._parseMesh(e)}return r},i.prototype._parseMesh=function(e){var r=t.BaseObject.borrowObject(t.MeshData),n=e[i.VERTICES],o=e[i.UVS],a=e[i.TRIANGLES],s=Math.floor(n.length/2),l=Math.floor(a.length/3),h=new Array(this._armature.sortedBones.length);if(r.skinned=i.WEIGHTS in e&&e[i.WEIGHTS].length>0,r.uvs.length=2*s,r.vertices.length=2*s,r.vertexIndices.length=3*l,r.skinned){if(r.boneIndices.length=s,r.weights.length=s,r.boneVertices.length=s,i.SLOT_POSE in e){var u=e[i.SLOT_POSE];r.slotPose.a=u[0],r.slotPose.b=u[1],r.slotPose.c=u[2],r.slotPose.d=u[3],r.slotPose.tx=u[4]*this._armature.scale,r.slotPose.ty=u[5]*this._armature.scale}if(i.BONE_POSE in e)for(var c=e[i.BONE_POSE],p=0,d=c.length;d>p;p+=7){var f=c[p],g=h[f]=new t.Matrix;g.a=c[p+1],g.b=c[p+2],g.c=c[p+3],g.d=c[p+4],g.tx=c[p+5]*this._armature.scale,g.ty=c[p+6]*this._armature.scale,g.invert()}}for(var p=0,y=0,d=n.length;d>p;p+=2){var v=p+1,m=p/2,_=r.vertices[p]=n[p]*this._armature.scale,b=r.vertices[v]=n[v]*this._armature.scale;if(r.uvs[p]=o[p],r.uvs[v]=o[v],r.skinned){var T=e[i.WEIGHTS],x=T[y],E=r.boneIndices[m]=new Array(x),$=r.weights[m]=new Array(x),S=r.boneVertices[m]=new Array(2*x);r.slotPose.transformPoint(_,b,this._helpPoint),_=r.vertices[p]=this._helpPoint.x,b=r.vertices[v]=this._helpPoint.y;for(var C=0;x>C;++C){var w=y+1+2*C,f=T[w],O=this._rawBones[f],P=r.bones.indexOf(O);0>P&&(P=r.bones.length,r.bones[P]=O,r.inverseBindPose[P]=h[f]),r.inverseBindPose[P].transformPoint(_,b,this._helpPoint),E[C]=P,$[C]=T[w+1],S[2*C]=this._helpPoint.x,S[2*C+1]=this._helpPoint.y}y+=2*x+1}}for(var p=0,d=a.length;d>p;++p)r.vertexIndices[p]=a[p];return r},i.prototype._parseAnimation=function(e){var r=t.BaseObject.borrowObject(t.AnimationData);r.name=i._getString(e,i.NAME,"__default")||"__default",r.frameCount=Math.max(i._getNumber(e,i.DURATION,1),1),r.position=i._getNumber(e,i.POSITION,0)/this._armature.frameRate,r.duration=r.frameCount/this._armature.frameRate,r.playTimes=i._getNumber(e,i.PLAY_TIMES,1),r.fadeInTime=i._getNumber(e,i.FADE_IN_TIME,0),this._animation=r;var n=i._getString(e,i.ANIMATION,null);if(n)return r.animation=this._armature.getAnimation(n),!r.animation,r;if(this._parseTimeline(e,r,this._parseAnimationFrame),i.Z_ORDER in e&&(r.zOrderTimeline=t.BaseObject.borrowObject(t.ZOrderTimelineData),this._parseTimeline(e[i.Z_ORDER],r.zOrderTimeline,this._parseZOrderFrame)),i.BONE in e)for(var o=e[i.BONE],a=0,s=o.length;s>a;++a)r.addBoneTimeline(this._parseBoneTimeline(o[a]));if(i.SLOT in e)for(var l=e[i.SLOT],a=0,s=l.length;s>a;++a)r.addSlotTimeline(this._parseSlotTimeline(l[a]));if(i.FFD in e)for(var h=e[i.FFD],a=0,s=h.length;s>a;++a)r.addFFDTimeline(this._parseFFDTimeline(h[a]));if(this._isOldData){if(this._isAutoTween=i._getBoolean(e,i.AUTO_TWEEN,!0),this._animationTweenEasing=i._getNumber(e,i.TWEEN_EASING,0)||0,r.playTimes=i._getNumber(e,i.LOOP,1),i.TIMELINE in e)for(var u=e[i.TIMELINE],a=0,s=u.length;s>a;++a){var c=u[a];r.addBoneTimeline(this._parseBoneTimeline(c)),r.addSlotTimeline(this._parseSlotTimeline(c))}}else this._isAutoTween=!1,this._animationTweenEasing=0;for(var a in this._armature.bones){var p=this._armature.bones[a];if(!r.getBoneTimeline(p.name)){var d=t.BaseObject.borrowObject(t.BoneTimelineData),f=t.BaseObject.borrowObject(t.BoneFrameData);d.bone=p,d.frames[0]=f,r.addBoneTimeline(d)}}for(var a in this._armature.slots){var g=this._armature.slots[a];if(!r.getSlotTimeline(g.name)){var y=t.BaseObject.borrowObject(t.SlotTimelineData),v=t.BaseObject.borrowObject(t.SlotFrameData);y.slot=g,v.displayIndex=g.displayIndex,g.color==t.SlotData.DEFAULT_COLOR?v.color=t.SlotFrameData.DEFAULT_COLOR:(v.color=t.SlotFrameData.generateColor(),v.color.copyFrom(g.color)),y.frames[0]=v,r.addSlotTimeline(y),this._isOldData&&(v.displayIndex=-1)}}return this._animation=null,r},i.prototype._parseBoneTimeline=function(e){var r=t.BaseObject.borrowObject(t.BoneTimelineData);r.bone=this._armature.getBone(i._getString(e,i.NAME,null)),this._parseTimeline(e,r,this._parseBoneFrame);for(var n=r.originalTransform,o=null,a=0,s=r.frames.length;s>a;++a){var l=r.frames[a];o?o!=l&&l.transform.minus(n):(n.copyFrom(l.transform),l.transform.identity(),0==n.scaleX&&(n.scaleX=.001),0==n.scaleY&&(n.scaleY=.001)),o=l}return 1==r.scale&&0==r.offset||(this._animation.hasAsynchronyTimeline=!0),this._isOldData&&(i.PIVOT_X in e||i.PIVOT_Y in e)?(this._timelinePivot.x=i._getNumber(e,i.PIVOT_X,0),this._timelinePivot.y=i._getNumber(e,i.PIVOT_Y,0)):this._timelinePivot.clear(),r},i.prototype._parseSlotTimeline=function(e){var r=t.BaseObject.borrowObject(t.SlotTimelineData);return r.slot=this._armature.getSlot(i._getString(e,i.NAME,null)),this._parseTimeline(e,r,this._parseSlotFrame),1==r.scale&&0==r.offset||(this._animation.hasAsynchronyTimeline=!0),r},i.prototype._parseFFDTimeline=function(e){var r=t.BaseObject.borrowObject(t.FFDTimelineData);r.skin=this._armature.getSkin(i._getString(e,i.SKIN,null)),r.slot=r.skin.getSlot(i._getString(e,i.SLOT,null));for(var n=i._getString(e,i.NAME,null),o=0,a=r.slot.displays.length;a>o;++o){var s=r.slot.displays[o];if(s.mesh&&s.name==n){r.displayIndex=o,this._mesh=s.mesh;break}}return this._parseTimeline(e,r,this._parseFFDFrame),this._mesh=null,r},i.prototype._parseAnimationFrame=function(e,r,n){var o=t.BaseObject.borrowObject(t.AnimationFrameData);return this._parseFrame(e,o,r,n),(i.ACTION in e||i.ACTIONS in e)&&this._parseActionData(e,o.actions,null,null),(i.EVENT in e||i.SOUND in e)&&this._parseEventData(e,o.events,null,null),o},i.prototype._parseZOrderFrame=function(e,r,n){var o=t.BaseObject.borrowObject(t.ZOrderFrameData);this._parseFrame(e,o,r,n);var a=e[i.Z_ORDER];if(a&&a.length>0){var s=this._armature.sortedSlots.length,l=new Array(s-a.length/2);o.zOrder.length=s;for(var h=0;s>h;++h)o.zOrder[h]=-1;for(var u=0,c=0,p=0,d=a.length;d>p;p+=2){for(var f=a[p],g=a[p+1];u!=f;)l[c++]=u++;o.zOrder[u+g]=u++}for(;s>u;)l[c++]=u++;for(var y=s;y--;)-1==o.zOrder[y]&&(o.zOrder[y]=l[--c])}return o},i.prototype._parseBoneFrame=function(e,r,n){var o=t.BaseObject.borrowObject(t.BoneFrameData);if(o.tweenRotate=i._getNumber(e,i.TWEEN_ROTATE,0),o.tweenScale=i._getBoolean(e,i.TWEEN_SCALE,!0),this._parseTweenFrame(e,o,r,n),i.TRANSFORM in e){var a=e[i.TRANSFORM];this._parseTransform(a,o.transform),this._isOldData&&(this._helpPoint.x=this._timelinePivot.x+i._getNumber(a,i.PIVOT_X,0),this._helpPoint.y=this._timelinePivot.y+i._getNumber(a,i.PIVOT_Y,0),o.transform.toMatrix(this._helpMatrix),this._helpMatrix.transformPoint(this._helpPoint.x,this._helpPoint.y,this._helpPoint,!0),o.transform.x+=this._helpPoint.x,o.transform.y+=this._helpPoint.y)}var s=this._timeline.bone,l=new Array,h=new Array;if(i.ACTION in e||i.ACTIONS in e){var u=this._armature.getSlot(s.name);this._parseActionData(e,l,s,u)}return(i.EVENT in e||i.SOUND in e)&&this._parseEventData(e,h,s,null),(l.length>0||h.length>0)&&this._mergeFrameToAnimationTimeline(o.position,l,h),o},i.prototype._parseSlotFrame=function(e,r,n){var o=t.BaseObject.borrowObject(t.SlotFrameData);if(o.displayIndex=i._getNumber(e,i.DISPLAY_INDEX,0),this._parseTweenFrame(e,o,r,n),i.COLOR in e||i.COLOR_TRANSFORM in e?(o.color=t.SlotFrameData.generateColor(),this._parseColorTransform(e[i.COLOR]||e[i.COLOR_TRANSFORM],o.color)):o.color=t.SlotFrameData.DEFAULT_COLOR,this._isOldData)i._getBoolean(e,i.HIDE,!1)&&(o.displayIndex=-1);else if(i.ACTION in e||i.ACTIONS in e){var a=this._timeline.slot,s=new Array;this._parseActionData(e,s,a.parent,a),this._mergeFrameToAnimationTimeline(o.position,s,null)}return o},i.prototype._parseFFDFrame=function(e,r,n){var o=t.BaseObject.borrowObject(t.ExtensionFrameData);o.type=i._getNumber(e,i.TYPE,0),this._parseTweenFrame(e,o,r,n);for(var a=e[i.VERTICES],s=i._getNumber(e,i.OFFSET,0),l=0,h=0,u=0,c=this._mesh.vertices.length;c>u;u+=2)if(!a||s>u||u-s>=a.length?(l=0,h=0):(l=a[u-s]*this._armature.scale,h=a[u+1-s]*this._armature.scale),this._mesh.skinned){this._mesh.slotPose.transformPoint(l,h,this._helpPoint,!0),l=this._helpPoint.x,h=this._helpPoint.y;for(var p=this._mesh.boneIndices[u/2],d=0,f=p.length;f>d;++d){var g=p[d];this._mesh.inverseBindPose[g].transformPoint(l,h,this._helpPoint,!0),o.tweens.push(this._helpPoint.x,this._helpPoint.y)}}else o.tweens.push(l,h);return o},i.prototype._parseTweenFrame=function(e,r,n,o){this._parseFrame(e,r,n,o),r.duration>0?(r.tweenEasing=i.TWEEN_EASING in e?i._getNumber(e,i.TWEEN_EASING,t.DragonBones.NO_TWEEN):this._isOldData&&this._isAutoTween?this._animationTweenEasing:t.DragonBones.NO_TWEEN,this._isOldData&&1==this._animation.scale&&1==this._timeline.scale&&r.duration*this._armature.frameRate<2&&(r.tweenEasing=t.DragonBones.NO_TWEEN),o>0&&i.CURVE in e&&(r.curve=new Array(2*o-1),t.TweenFrameData.samplingEasingCurve(e[i.CURVE],r.curve))):(r.tweenEasing=t.DragonBones.NO_TWEEN,r.curve=null)},i.prototype._parseFrame=function(t,e,i,r){e.position=i/this._armature.frameRate,e.duration=r/this._armature.frameRate},i.prototype._parseTimeline=function(e,r,n){if(r.scale=i._getNumber(e,i.SCALE,1),r.offset=i._getNumber(e,i.OFFSET,0),i.FRAME in e){this._timeline=r;var o=e[i.FRAME];if(1==o.length)r.frames.length=1,r.frames[0]=n.call(this,o[0],0,i._getNumber(o[0],i.DURATION,1));else if(o.length>1){r.frames.length=this._animation.frameCount+1;for(var a=0,s=0,l=null,h=null,u=0,c=0,p=r.frames.length;p>u;++u){if(u>=a+s&&c<o.length){var d=o[c++];a=u,s=i._getNumber(d,i.DURATION,1),l=n.call(this,d,a,s),h&&(h.next=l,l.prev=h,this._isOldData&&h instanceof t.TweenFrameData&&-1==i._getNumber(d,i.DISPLAY_INDEX,0)&&(h.tweenEasing=t.DragonBones.NO_TWEEN)),h=l}r.frames[u]=l}l.duration=this._animation.duration-l.position,l=r.frames[0],h.next=l,l.prev=h,this._isOldData&&h instanceof t.TweenFrameData&&-1==i._getNumber(o[0],i.DISPLAY_INDEX,0)&&(h.tweenEasing=t.DragonBones.NO_TWEEN)}this._timeline=null}},i.prototype._parseActionData=function(e,r,n,o){var a=e[i.ACTION]||e[i.ACTIONS]||e[i.DEFAULT_ACTIONS];if("string"==typeof a){var s=t.BaseObject.borrowObject(t.ActionData);s.type=4,s.bone=n,s.slot=o,s.data[0]=a,s.data[1]=-1,s.data[2]=-1,r.push(s)}else if(a instanceof Array)for(var l=0,h=a.length;h>l;++l){var u=a[l],c=u instanceof Array,s=t.BaseObject.borrowObject(t.ActionData),p=c?i._getParameter(u,1,null):i._getString(u,"gotoAndPlay",null);if(c){var d=u[0];s.type="string"==typeof d?i._getActionType(d):i._getParameter(u,0,4)}else s.type=2;switch(s.type){case 0:s.data[0]=p,s.data[1]=c?i._getParameter(u,2,-1):-1;break;case 1:s.data[0]=p;break;case 2:s.data[0]=p,s.data[1]=c?i._getParameter(u,2,0):0,s.data[2]=c?i._getParameter(u,3,-1):-1;break;case 3:s.data[0]=p,s.data[1]=c?i._getParameter(u,2,0):0;break;case 4:s.data[0]=p,s.data[1]=c?i._getParameter(u,2,-1):-1,s.data[2]=c?i._getParameter(u,3,-1):-1;break;case 5:s.data[0]=p,s.data[1]=c?i._getParameter(u,2,0):0}s.bone=n,s.slot=o,r.push(s)}},i.prototype._parseEventData=function(e,r,n,o){if(i.SOUND in e){var a=t.BaseObject.borrowObject(t.EventData);a.type=11,a.name=i._getString(e,i.SOUND,null),a.bone=n,a.slot=o,r.push(a)}if(i.EVENT in e){var s=t.BaseObject.borrowObject(t.EventData);s.type=10,s.name=i._getString(e,i.EVENT,null),s.bone=n,s.slot=o,i.DATA in e&&(s.data=e[i.DATA]),r.push(s)}},i.prototype._parseTransform=function(e,r){r.x=i._getNumber(e,i.X,0)*this._armature.scale,r.y=i._getNumber(e,i.Y,0)*this._armature.scale,r.skewX=i._getNumber(e,i.SKEW_X,0)*t.DragonBones.ANGLE_TO_RADIAN,r.skewY=i._getNumber(e,i.SKEW_Y,0)*t.DragonBones.ANGLE_TO_RADIAN,r.scaleX=i._getNumber(e,i.SCALE_X,1),r.scaleY=i._getNumber(e,i.SCALE_Y,1)},i.prototype._parseColorTransform=function(t,e){e.alphaMultiplier=.01*i._getNumber(t,i.ALPHA_MULTIPLIER,100),e.redMultiplier=.01*i._getNumber(t,i.RED_MULTIPLIER,100),e.greenMultiplier=.01*i._getNumber(t,i.GREEN_MULTIPLIER,100),e.blueMultiplier=.01*i._getNumber(t,i.BLUE_MULTIPLIER,100),e.alphaOffset=i._getNumber(t,i.ALPHA_OFFSET,0),e.redOffset=i._getNumber(t,i.RED_OFFSET,0),e.greenOffset=i._getNumber(t,i.GREEN_OFFSET,0),e.blueOffset=i._getNumber(t,i.BLUE_OFFSET,0)},i.prototype.parseDragonBonesData=function(e,r){if(void 0===r&&(r=1),e){var n=i._getString(e,i.VERSION,null);if(this._isOldData=n==i.DATA_VERSION_2_3||n==i.DATA_VERSION_3_0,this._isGlobalTransform=this._isOldData?i._getBoolean(e,i.IS_GLOBAL,!0):!1,n==i.DATA_VERSION||n==i.DATA_VERSION_4_0||this._isOldData){var o=t.BaseObject.borrowObject(t.DragonBonesData);if(o.name=i._getString(e,i.NAME,null),o.frameRate=i._getNumber(e,i.FRAME_RATE,24)||24,i.ARMATURE in e){this._data=o;for(var a=e[i.ARMATURE],s=0,l=a.length;l>s;++s)o.addArmature(this._parseArmature(a[s],r));this._data=null}return o}throw new Error("Nonsupport data version.")}throw new Error("No data.")},i.prototype.parseTextureAtlasData=function(e,r,n){if(void 0===n&&(n=0),!e)throw new Error("No data.");if(r.name=i._getString(e,i.NAME,null),r.imagePath=i._getString(e,i.IMAGE_PATH,null),n>0?r.scale=n:n=r.scale=i._getNumber(e,i.SCALE,r.scale),n=1/n,i.SUB_TEXTURE in e)for(var o=e[i.SUB_TEXTURE],a=0,s=o.length;s>a;++a){var l=o[a],h=r.generateTextureData();h.name=i._getString(l,i.NAME,null),h.rotated=i._getBoolean(l,i.ROTATED,!1),h.region.x=i._getNumber(l,i.X,0)*n,h.region.y=i._getNumber(l,i.Y,0)*n,h.region.width=i._getNumber(l,i.WIDTH,0)*n,h.region.height=i._getNumber(l,i.HEIGHT,0)*n;var u=i._getNumber(l,i.FRAME_WIDTH,-1),c=i._getNumber(l,i.FRAME_HEIGHT,-1);u>0&&c>0&&(h.frame=t.TextureData.generateRectangle(),h.frame.x=i._getNumber(l,i.FRAME_X,0)*n,h.frame.y=i._getNumber(l,i.FRAME_Y,0)*n,h.frame.width=u*n,h.frame.height=c*n),r.addTexture(h)}},i.getInstance=function(){return i._instance||(i._instance=new i),i._instance},i._instance=null,i}(t.DataParser);t.ObjectDataParser=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this),this.textures={}}return __extends(e,t),e.prototype._onClear=function(){for(var t in this.textures)this.textures[t].returnToPool(),delete this.textures[t];this.autoSearch=!1,this.scale=1,this.name=null,this.imagePath=null},e.prototype.addTexture=function(t){if(!t||!t.name||this.textures[t.name])throw new Error;this.textures[t.name]=t,t.parent=this},e.prototype.getTexture=function(t){return this.textures[t]},e}(t.BaseObject);t.TextureAtlasData=e;var i=function(e){function i(){e.call(this),this.region=new t.Rectangle}return __extends(i,e),i.generateRectangle=function(){return new t.Rectangle},i.prototype._onClear=function(){this.rotated=!1,this.name=null,this.frame=null,this.parent=null,this.region.clear()},i}(t.BaseObject);t.TextureData=i}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function r(){e.call(this)}return __extends(r,e),r.toString=function(){return"[class dragonBones.EgretTextureAtlasData]"},r.prototype._onClear=function(){e.prototype._onClear.call(this),this.texture&&(this.texture=null)},r.prototype.generateTextureData=function(){return t.BaseObject.borrowObject(i)},r.prototype.dispose=function(){this.returnToPool()},r}(t.TextureAtlasData);t.EgretTextureAtlasData=e;var i=function(t){function e(){t.call(this)}return __extends(e,t),e.toString=function(){return"[class dragonBones.EgretTextureData]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.texture&&(this.texture=null)},e}(t.TextureData);t.EgretTextureData=i}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(t,i,r,n){e.call(this,t,i,r,n)}return __extends(i,e),Object.defineProperty(i.prototype,"eventObject",{get:function(){return this.data},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationName",{get:function(){return this.eventObject.animationState.name},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"armature",{get:function(){return this.eventObject.armature},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bone",{get:function(){return this.eventObject.bone},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"slot",{get:function(){return this.eventObject.slot},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationState",{get:function(){return this.eventObject.animationState},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"frameLabel",{get:function(){return this.eventObject.name},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"sound",{get:function(){return this.eventObject.name},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"movementID",{get:function(){return this.animationName},enumerable:!0,configurable:!0}),i.START=t.EventObject.START,i.LOOP_COMPLETE=t.EventObject.LOOP_COMPLETE,i.COMPLETE=t.EventObject.COMPLETE,i.FADE_IN=t.EventObject.FADE_IN,i.FADE_IN_COMPLETE=t.EventObject.FADE_IN_COMPLETE,i.FADE_OUT=t.EventObject.FADE_OUT,i.FADE_OUT_COMPLETE=t.EventObject.FADE_OUT_COMPLETE,i.FRAME_EVENT=t.EventObject.FRAME_EVENT,i.SOUND_EVENT=t.EventObject.SOUND_EVENT,i.ANIMATION_FRAME_EVENT=t.EventObject.FRAME_EVENT,i.BONE_FRAME_EVENT=t.EventObject.FRAME_EVENT,i.MOVEMENT_FRAME_EVENT=t.EventObject.FRAME_EVENT,i.SOUND=t.EventObject.SOUND_EVENT,i}(egret.Event);t.EgretEvent=e;var i=function(i){function r(){i.call(this),this._subTextures={}}return __extends(r,i),r.prototype._onClear=function(){for(var t in this._subTextures)delete this._subTextures[t];this._armature&&this.advanceTimeBySelf(!1),this._armature=null,this._debugDrawer=null},r.prototype._dispatchEvent=function(t){var i=egret.Event.create(e,t.type);i.data=t,this.dispatchEvent(i),egret.Event.release(i)},r.prototype._debugDraw=function(){this._debugDrawer||(this._debugDrawer=new egret.Shape),this.addChild(this._debugDrawer),this._debugDrawer.graphics.clear();for(var t=this._armature.getBones(),e=0,i=t.length;i>e;++e){var r=t[e],n=Math.max(r.length,5),o=r.globalTransformMatrix.tx,a=r.globalTransformMatrix.ty,s=o+r.globalTransformMatrix.a*n,l=a+r.globalTransformMatrix.b*n;this._debugDrawer.graphics.lineStyle(1,r.ik?16711680:65280,.5),this._debugDrawer.graphics.moveTo(o,a),this._debugDrawer.graphics.lineTo(s,l)}},r.prototype._onReplaceTexture=function(){for(var t in this._subTextures)delete this._subTextures[t]},r.prototype.hasEvent=function(t){return this.hasEventListener(t)},r.prototype.addEvent=function(t,e,i){this.addEventListener(t,e,i)},r.prototype.removeEvent=function(t,e,i){this.removeEventListener(t,e,i)},r.prototype.dispose=function(){this._armature&&(this.advanceTimeBySelf(!1),this._armature.dispose(),this._armature=null)},r.prototype.advanceTimeBySelf=function(e){e?t.EgretFactory._clock.add(this._armature):t.EgretFactory._clock.remove(this._armature)},Object.defineProperty(r.prototype,"armature",{get:function(){return this._armature},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"animation",{get:function(){return this._armature.animation},enumerable:!0,configurable:!0}),r}(egret.DisplayObjectContainer);t.EgretArmatureDisplay=i;var r=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e}(e);t.Event=r;var n=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e}(e);t.ArmatureEvent=n;var o=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e}(e);t.AnimationEvent=o;var a=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e}(e);t.FrameEvent=a;var s=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e}(e);t.SoundEvent=s;var l=function(e){function i(i,r,n){void 0===n&&(n=1),e.call(this),this._onClear(),this.texture=i,t.ObjectDataParser.getInstance().parseTextureAtlasData(r,this,n)}return __extends(i,e),i.toString=function(){return"[class dragonBones.EgretTextureAtlas]"},i}(t.EgretTextureAtlasData);t.EgretTextureAtlas=l;var h=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e}(l);t.EgretSheetAtlas=h;var u=function(){function e(){}return e.getInstance=function(){return t.EgretFactory._eventManager},e}();t.SoundEventManager=u;var c=function(){function t(){}return t}();t.AnimationCacheManager=c}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(r){void 0===r&&(r=null),e.call(this,r),i._eventManager||(i._eventManager=new t.EgretArmatureDisplay,i._clock=new t.WorldClock,i._clock.time=.001*egret.getTimer(),egret.startTick(i._clockHandler,i))}return __extends(i,e),i._clockHandler=function(t){t*=.001;var e=t-i._clock.time;return i._clock.advanceTime(e),i._clock.time=t,!1},Object.defineProperty(i,"factory",{get:function(){return i._factory||(i._factory=new i),i._factory},enumerable:!0,configurable:!0}),i.prototype._generateTextureAtlasData=function(e,i){return e?e.texture=i:e=t.BaseObject.borrowObject(t.EgretTextureAtlasData),e},i.prototype._generateArmature=function(e){var r=t.BaseObject.borrowObject(t.Armature),n=new t.EgretArmatureDisplay;return r._armatureData=e.armature,r._skinData=e.skin,r._animation=t.BaseObject.borrowObject(t.Animation),r._display=n,r._eventManager=i._eventManager,n._armature=r,r._animation._armature=r,r.animation.animations=e.armature.animations,r},i.prototype._generateSlot=function(e,i){var r=t.BaseObject.borrowObject(t.EgretSlot),n=i.slot,o=[];r.name=n.name,r._rawDisplay=new egret.Bitmap,r._meshDisplay=new egret.Mesh;for(var a=0,s=i.displays.length;s>a;++a){var l=i.displays[a];switch(l.type){case 0:l.texture&&!e.textureAtlasName||(l.texture=this._getTextureData(e.textureAtlasName||e.dataName,l.name)),o.push(r._rawDisplay);break;case 2:l.texture&&!e.textureAtlasName||(l.texture=this._getTextureData(e.textureAtlasName||e.dataName,l.name)),"webgl"==egret.Capabilities.renderMode||egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE?o.push(r._meshDisplay):(console.warn("Canvas can not support mesh, please change renderMode to webgl."),o.push(r._rawDisplay));break;case 1:var h=this.buildArmature(l.name,e.dataName,null,e.textureAtlasName);if(h){if(!r.inheritAnimation){var u=n.actions.length>0?n.actions:h.armatureData.actions;if(u.length>0)for(var c=0,p=u.length;p>c;++c)h._bufferAction(u[c]);else h.animation.play()}l.armature=h.armatureData}o.push(h);break;default:o.push(null)}}return r._setDisplayList(o),r},i.prototype.buildArmatureDisplay=function(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=null),void 0===r&&(r=null);var n=this.buildArmature(t,e,i,r),o=n?n._display:null;return o&&o.advanceTimeBySelf(!0),o},i.prototype.getTextureDisplay=function(t,e){void 0===e&&(e=null);var i=this._getTextureData(e,t);if(i){if(!i.texture){var r=i.parent.texture;i.texture=new egret.Texture,i.texture._bitmapData=r._bitmapData,i.texture.$initData(i.region.x,i.region.y,i.region.width,i.region.height,0,0,i.region.width,i.region.height,r.textureWidth,r.textureHeight)}return new egret.Bitmap(i.texture)}return null},Object.defineProperty(i.prototype,"soundEventManater",{get:function(){return i._eventManager},enumerable:!0,configurable:!0}),i.prototype.addSkeletonData=function(t,e){void 0===e&&(e=null),this.addDragonBonesData(t,e)},i.prototype.getSkeletonData=function(t){return this.getDragonBonesData(t)},i.prototype.removeSkeletonData=function(t){this.removeDragonBonesData(t)},i.prototype.addTextureAtlas=function(t,e){void 0===e&&(e=null),this.addTextureAtlasData(t,e)},i.prototype.getTextureAtlas=function(t){return this.getTextureAtlasData(t)},i.prototype.removeTextureAtlas=function(t){this.removeTextureAtlasData(t)},i.prototype.buildFastArmature=function(t,e,i){return void 0===e&&(e=null),void 0===i&&(i=null),this.buildArmature(t,e,i)},i.prototype.dispose=function(){this.clear()},i._factory=null,i._eventManager=null,i._clock=null,i}(t.BaseFactory);t.EgretFactory=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this)}return __extends(e,t),e.toString=function(){return"[class dragonBones.EgretSlot]"},e.prototype._createTexture=function(t,e){var i=e.width,r=e.height,n=Math.min(t.region.width,i-t.region.x),o=Math.min(t.region.height,r-t.region.y),a=new egret.Texture;return a._bitmapData=e,a.$initData(t.region.x,t.region.y,n,o,0,0,n,o,i,r),a},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.transformUpdateEnabled=!1,this._renderDisplay=null,this._colorFilter=null},e.prototype._initDisplay=function(){},e.prototype._disposeDisplay=function(){},e.prototype._onUpdateDisplay=function(){this._rawDisplay||(this._rawDisplay=new egret.Bitmap),this._renderDisplay=this._display||this._rawDisplay},e.prototype._addDisplay=function(){var t=this._armature._display;t.addChild(this._renderDisplay)},e.prototype._replaceDisplay=function(t){var e=this._armature._display,i=t;e.addChild(this._renderDisplay),e.swapChildren(this._renderDisplay,i),e.removeChild(i)},e.prototype._removeDisplay=function(){this._renderDisplay.parent.removeChild(this._renderDisplay)},e.prototype._updateZOrder=function(){var t=this._armature._display;t.addChildAt(this._renderDisplay,this._zOrder)},e.prototype._updateVisible=function(){this._renderDisplay.visible=this._parent.visible},e.prototype._updateBlendMode=function(){switch(this._blendMode){case 0:this._renderDisplay.blendMode=egret.BlendMode.NORMAL;break;case 1:this._renderDisplay.blendMode=egret.BlendMode.ADD;break;case 5:this._renderDisplay.blendMode=egret.BlendMode.ERASE}},e.prototype._updateColor=function(){if(1!=this._colorTransform.redMultiplier||1!=this._colorTransform.greenMultiplier||1!=this._colorTransform.blueMultiplier||0!=this._colorTransform.redOffset||0!=this._colorTransform.greenOffset||0!=this._colorTransform.blueOffset||0!=this._colorTransform.alphaOffset){this._colorFilter||(this._colorFilter=new egret.ColorMatrixFilter);var t=this._colorFilter.matrix;t[0]=this._colorTransform.redMultiplier,t[6]=this._colorTransform.greenMultiplier,t[12]=this._colorTransform.blueMultiplier,t[18]=this._colorTransform.alphaMultiplier,t[4]=this._colorTransform.redOffset,t[9]=this._colorTransform.greenOffset,t[14]=this._colorTransform.blueOffset,t[19]=this._colorTransform.alphaOffset,this._colorFilter.matrix=t;var e=this._renderDisplay.filters;e||(e=[]),e.indexOf(this._colorFilter)<0&&e.push(this._colorFilter),this._renderDisplay.filters=e}else this._colorFilter&&(this._colorFilter=null,this._renderDisplay.filters=null),this._renderDisplay.$setAlpha(this._colorTransform.alphaMultiplier)},e.prototype._updateFilters=function(){},e.prototype._updateFrame=function(){if(this._display&&this._displayIndex>=0){var t=this._displayIndex<this._displayDataSet.displays.length?this._displayDataSet.displays[this._displayIndex]:null,e=this._displayIndex<this._replacedDisplayDataSet.length?this._replacedDisplayDataSet[this._displayIndex]:null,i=e||t,r=i.texture;if(r){var n=r.parent,o=this._armature.replacedTexture?this._armature.replacedTexture._bitmapData:null,a=o&&i.texture.parent==t.texture.parent?o:n.texture?n.texture._bitmapData:null;if(a){var s=r.texture;if(a==o){var l=this._armature._display,h=r.name;s=l._subTextures[h],s||(s=this._createTexture(r,a),l._subTextures[h]=s)}else r.texture||(s=this._createTexture(r,a),r.texture=s);if(this._updatePivot(t,i,r),this._meshData&&this._display==this._meshDisplay){var u=this._meshDisplay,c=u.$renderNode;c.uvs.length=0,c.vertices.length=0,c.indices.length=0;for(var p=0,d=this._meshData.vertices.length;d>p;++p)c.uvs[p]=this._meshData.uvs[p],c.vertices[p]=this._meshData.vertices[p];
for(var p=0,d=this._meshData.vertexIndices.length;d>p;++p)c.indices[p]=this._meshData.vertexIndices[p];if(u.$setBitmapData(s),u.$setAnchorOffsetX(this._pivotX),u.$setAnchorOffsetY(this._pivotY),u.$updateVertices(),u.$invalidateTransform(),this._meshData.skinned){var f=u.matrix;f.identity(),u.matrix=f}}else{var g=this._display;g.$setBitmapData(s),g.$setAnchorOffsetX(this._pivotX),g.$setAnchorOffsetY(this._pivotY)}return void this._updateVisible()}}}this._pivotX=0,this._pivotY=0;var y=this._renderDisplay;y.visible=!1,y.$setBitmapData(null),y.$setAnchorOffsetX(this._pivotX),y.$setAnchorOffsetY(this._pivotY),y.x=this.origin.x,y.y=this.origin.y},e.prototype._updateMesh=function(){var t=this._meshDisplay,e=t.$renderNode,i=this._ffdVertices.length>0;if(this._meshData.skinned){for(var r=0,n=0,o=this._meshData.vertices.length;o>r;r+=2){for(var a=r/2,s=this._meshData.boneIndices[a],l=this._meshData.boneVertices[a],h=this._meshData.weights[a],u=0,c=0,p=0,d=s.length;d>p;++p){var f=this._meshBones[s[p]],g=f.globalTransformMatrix,y=h[p],v=0,m=0;i?(v=l[2*p]+this._ffdVertices[n],m=l[2*p+1]+this._ffdVertices[n+1]):(v=l[2*p],m=l[2*p+1]),u+=(g.a*v+g.c*m+g.tx)*y,c+=(g.b*v+g.d*m+g.ty)*y,n+=2}e.vertices[r]=u,e.vertices[r+1]=c}t.$updateVertices(),t.$invalidateTransform()}else if(i){for(var _=this._meshData.vertices,r=0,o=this._meshData.vertices.length;o>r;r+=2){var u=_[r]+this._ffdVertices[r],c=_[r+1]+this._ffdVertices[r+1];e.vertices[r]=u,e.vertices[r+1]=c}t.$updateVertices(),t.$invalidateTransform()}},e.prototype._updateTransform=function(){if(this.transformUpdateEnabled)this._renderDisplay.$setMatrix(this.globalTransformMatrix,this.transformUpdateEnabled),this._renderDisplay.$setAnchorOffsetX(this._pivotX),this._renderDisplay.$setAnchorOffsetX(this._pivotY);else{var t=this._renderDisplay.$DisplayObject,e=t[6];e.a=this.globalTransformMatrix.a,e.b=this.globalTransformMatrix.b,e.c=this.globalTransformMatrix.c,e.d=this.globalTransformMatrix.d,e.tx=this.globalTransformMatrix.tx,e.ty=this.globalTransformMatrix.ty,this._renderDisplay.$removeFlags(8),this._renderDisplay.$invalidatePosition()}},e}(t.Slot);t.EgretSlot=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){function e(t,e){for(var i=0,r=t.length;r>i;++i){var n=t[i];if(n.name==e)return n}return null}function i(t){if(t.groupName){var i=p[t.groupName];if(i){var r=e(i.movie,t.movieName);if(r)return t.groupConfig=i,t.movieConfig=r,!0}}if(!t.groupName)for(var n in p){var i=p[n];if(!t.groupName){var r=e(i.movie,t.movieName);if(r)return t.groupName=n,t.groupConfig=i,t.movieConfig=r,!0}}return!1}function r(t){return null!=p[t]}function n(t,e,i){if(void 0===i&&(i=null),!t)throw new Error;var r=new egret.ByteArray(t);r.endian=egret.Endian.LITTLE_ENDIAN,r.position=8;var n=JSON.parse(r.readUTF());n.offset=r.position,n.arrayBuffer=t,n.textures=[];var o=n.offset%4;o&&(n.offset+=4-o);for(var a=0,s=n.position.length;s>a;a+=3)switch(a/3){case 1:n.displayFrameArray=new Int16Array(n.arrayBuffer,n.offset+n.position[a],n.position[a+1]/n.position[a+2]);break;case 2:n.rectangleArray=new Float32Array(n.arrayBuffer,n.offset+n.position[a],n.position[a+1]/n.position[a+2]);break;case 3:n.transformArray=new Float32Array(n.arrayBuffer,n.offset+n.position[a],n.position[a+1]/n.position[a+2]);break;case 4:n.colorArray=new Int16Array(n.arrayBuffer,n.offset+n.position[a],n.position[a+1]/n.position[a+2])}if(i=i||n.name,p[i],p[i]=n,e instanceof Array)for(var a=0,s=e.length;s>a;++a){var l=e[a];n.textures.push(l)}else n.textures.push(e)}function o(t){var e=p[t];e&&delete p[t]}function a(){for(var t in p)delete p[t]}function s(t,e){void 0===e&&(e=null);var r={movieName:t,groupName:e};if(i(r)){var n=new f(r);return n}return console.warn("No movie named: "+t),null}function l(t){var e=p[t];if(e){for(var i=[],r=0,n=e.movie.length;n>r;++r)i.push(e.movie[r].name);return i}return console.warn("No group named: "+t),null}var h=function(t){function e(e){t.call(this),this.displayIndex=-1,this.colorIndex=-1,this.transformIndex=-1,this.config=null,this.displayConfig=null,this.display=null,this.childMovie=null,this.colorFilter=null,this.rawDisplay=new egret.Bitmap,this.childMovies={},this.display=this.rawDisplay,this.config=e,this.rawDisplay.name=this.config.name,null==this.config.blendMode&&(this.config.blendMode=0)}return __extends(e,t),e.prototype.dispose=function(){this.config=null,this.displayConfig=null,this.display=null,this.childMovie=null,this.colorFilter=null,this.rawDisplay=null,this.childMovies=null},e}(egret.HashObject),u=new egret.Rectangle,c=new egret.Matrix,p={};t.hasMovieGroup=r,t.addMovieGroup=n,t.removeMovieGroup=o,t.removeAllMovieGroup=a,t.buildMovie=s,t.getMovieNames=l;var d=function(t){function e(e){t.call(this,e),this.name=null,this.slotName=null,this.clipName=null,this.movie=null}return __extends(e,t),e.START="start",e.LOOP_COMPLETE="loopComplete",e.COMPLETE="complete",e.FRAME_EVENT="frameEvent",e.SOUND_EVENT="soundEvent",e}(egret.Event);t.MovieEvent=d;var f=function(e){function i(r){e.call(this),this.timeScale=1,this.clipTimeScale=1,this._batchEnabled=!0,this._isLockDispose=!1,this._isDelayDispose=!1,this._isStarted=!1,this._isPlaying=!1,this._isReversing=!1,this._isCompleted=!1,this._playTimes=0,this._time=0,this._currentTime=0,this._timeStamp=0,this._currentPlayTimes=0,this._cacheFrameIndex=0,this._frameSize=0,this._cacheRectangle=null,this._groupConfig=null,this._config=null,this._clipConfig=null,this._currentFrameConfig=null,this._clipArray=null,this._clipNames=[],this._slots=[],this._childMovies=[],this._groupConfig=r.groupConfig,this._config=r.movieConfig,this._batchEnabled=!this._config.isNested,this._batchEnabled&&(this.$renderNode=new egret.sys.GroupNode,this.$renderNode.cleanBeforeRender=i._cleanBeforeRender),this._clipNames.length=0;for(var n=0,o=this._config.clip.length;o>n;++n)this._clipNames.push(this._config.clip[n].name);for(var n=0,o=this._config.slot.length;o>n;++n){var a=new h(this._config.slot[n]);this._updateSlotBlendMode(a),this._slots.push(a),this._batchEnabled?this.$renderNode.addNode(a.rawDisplay.$renderNode):this.addChild(a.rawDisplay)}this._frameSize=2*this._slots.length,t.EgretFactory.factory,this.advanceTimeBySelf(!0),this.name=this._config.name,this.play(),this.advanceTime(1e-6),this.stop()}return __extends(i,e),i._cleanBeforeRender=function(){},i.prototype._configToEvent=function(t,e){e.movie=this,e.clipName=this._clipConfig.name,e.name=t.name,e.slotName=t.slot},i.prototype._onCrossFrame=function(e){for(var i=0,r=e.actionAndEvent.length;r>i;++i){var n=e.actionAndEvent[i];if(n)switch(n.type){case 11:if(t.EgretFactory.factory.soundEventManater.hasEventListener(d.SOUND_EVENT)){var o=egret.Event.create(d,d.SOUND_EVENT);this._configToEvent(n,o),t.EgretFactory.factory.soundEventManater.dispatchEvent(o),egret.Event.release(o)}break;case 10:if(this.hasEventListener(d.FRAME_EVENT)){var a=egret.Event.create(d,d.FRAME_EVENT);this._configToEvent(n,a),this.dispatchEvent(a),egret.Event.release(a)}break;case 0:case 4:if(n.slot){var s=this._getSlot(n.slot);s&&s.childMovie&&s.childMovie.play(n.name)}else this.play(n.name);break;case 1:break;case 2:break;case 3:}}},i.prototype._updateSlotBlendMode=function(t){var e="";switch(t.config.blendMode){case 0:e=egret.BlendMode.NORMAL;break;case 1:e=egret.BlendMode.ADD;break;case 5:e=egret.BlendMode.ERASE}e&&(this._batchEnabled?t.display.$renderNode.blendMode=egret.sys.blendModeToNumber(e):t.display.blendMode=e)},i.prototype._updateSlotColor=function(t,e,i,r,n,o,a,s,l){if(1!=i||1!=r||1!=n||0!=a||0!=s||0!=l||0!=o){t.colorFilter||(t.colorFilter=new egret.ColorMatrixFilter);var h=t.colorFilter.matrix;if(h[0]=i,h[6]=r,h[12]=n,h[18]=e,h[4]=a,h[9]=s,h[14]=l,h[19]=o,t.colorFilter.matrix=h,this._batchEnabled)t.display.$renderNode.filter,t.display.$renderNode.filter=t.colorFilter;else{var u=t.display.filters;u||(u=[]),u.indexOf(t.colorFilter)<0&&u.push(t.colorFilter),t.display.filters=u}}else t.colorFilter&&(t.colorFilter=null),this._batchEnabled?(t.display.$renderNode.filter=null,t.display.$renderNode.alpha=e):(t.display.filters=null,t.display.$setAlpha(e))},i.prototype._updateSlotDisplay=function(t){var e=t.display||t.rawDisplay,i=t.childMovie;if(t.displayIndex>=0)if(t.displayConfig=this._groupConfig.display[t.displayIndex],1==t.displayConfig.type){var r=t.childMovies[t.displayConfig.name];r||(r=s(t.displayConfig.name,this._groupConfig.name),r.advanceTimeBySelf(!1),t.childMovies[t.displayConfig.name]=r),t.display=r,t.childMovie=r}else t.display=t.rawDisplay,t.childMovie=null;else t.displayConfig=null,t.display=t.rawDisplay,t.childMovie=null;if(t.display!=e&&(e&&(this.addChild(t.display),this.swapChildren(t.display,e),this.removeChild(e)),this._updateSlotBlendMode(t)),t.display==t.rawDisplay)if(t.displayConfig&&null!=t.displayConfig.regionIndex){if(!t.displayConfig.texture){var n=this._groupConfig.textures[0],o=4*t.displayConfig.regionIndex,a=this._groupConfig.rectangleArray[o],l=this._groupConfig.rectangleArray[o+1],h=this._groupConfig.rectangleArray[o+2],u=this._groupConfig.rectangleArray[o+3];t.displayConfig.texture=new egret.Texture,t.displayConfig.texture._bitmapData=n._bitmapData,t.displayConfig.texture.$initData(a,l,Math.min(h,n.textureWidth-a),Math.min(u,n.textureHeight-l),0,0,Math.min(h,n.textureWidth-a),Math.min(u,n.textureHeight-l),n.textureWidth,n.textureHeight)}if(this._batchEnabled){var c=t.displayConfig.texture,p=t.rawDisplay.$renderNode;egret.sys.RenderNode.prototype.cleanBeforeRender.call(t.rawDisplay.$renderNode),p.image=c._bitmapData,p.drawImage(c._bitmapX,c._bitmapY,c._bitmapWidth,c._bitmapHeight,c._offsetX,c._offsetY,c.textureWidth,c.textureHeight),p.imageWidth=c._sourceWidth,p.imageHeight=c._sourceHeight}else t.rawDisplay.visible=!0,t.rawDisplay.$setBitmapData(t.displayConfig.texture)}else this._batchEnabled?t.rawDisplay.$renderNode.image=null:(t.rawDisplay.visible=!1,t.rawDisplay.$setBitmapData(null));t.childMovie!=i&&(i&&(i.stop(),this._childMovies.slice(this._childMovies.indexOf(i),1)),t.childMovie&&(this._childMovies.indexOf(t.childMovie)<0&&this._childMovies.push(t.childMovie),t.childMovie.play(t.config.action?t.config.action:t.childMovie._config.action)))},i.prototype._getSlot=function(t){for(var e=0,i=this._slots.length;i>e;++e){var r=this._slots[e];if(r.config.name==t)return r}return null},i.prototype.$render=function(){this._batchEnabled||e.prototype.$render.call(this)},i.prototype.$measureContentBounds=function(t){this._batchEnabled&&this._cacheRectangle?t.setTo(this._cacheRectangle.x,this._cacheRectangle.y,this._cacheRectangle.width-this._cacheRectangle.x,this._cacheRectangle.height-this._cacheRectangle.y):e.prototype.$measureContentBounds.call(this,t)},i.prototype.$doAddChild=function(t,i,r){return this._batchEnabled?(console.warn("Can not add child."),null):e.prototype.$doAddChild.call(this,t,i,r)},i.prototype.$doRemoveChild=function(t,i){return this._batchEnabled?(console.warn("Can not remove child."),null):e.prototype.$doRemoveChild.call(this,t,i)},i.prototype.dispose=function(){if(this._isLockDispose)this._isDelayDispose=!0;else{this.advanceTimeBySelf(!1);for(var t=0,e=this._slots.length;e>t;++t)this._slots[t].dispose();this._isPlaying=!1,this._cacheRectangle=null,this._groupConfig=null,this._clipConfig=null,this._currentFrameConfig=null,this._clipNames=null,this._slots=null,this._childMovies=null}},i.prototype.advanceTime=function(t){if(this._isPlaying){this._isLockDispose=!0,0>t&&(t=-t),t*=this.timeScale,this._time+=t*this.clipTimeScale;var e=this._clipConfig.duration,i=e*this._playTimes,r=this._time,n=this._currentPlayTimes;if(this._playTimes>0&&(r>=i||-i>=r)?(this._isCompleted=!0,n=this._playTimes,r=0>r?0:e):(this._isCompleted=!1,0>r?(n=Math.floor(-r/e),r=e- -r%e):(n=Math.floor(r/e),r%=e),this._playTimes>0&&n>this._playTimes&&(n=this._playTimes)),this._currentTime!=r){var o=Math.floor(r*this._clipConfig.cacheTimeToFrameScale);if(this._cacheFrameIndex!=o){this._cacheFrameIndex=o;var a=this._groupConfig.displayFrameArray,s=this._groupConfig.transformArray,l=this._groupConfig.colorArray,h=!0,p=!1,f=!1,g=this._cacheRectangle;this._cacheRectangle=this._clipConfig.cacheRectangles[this._cacheFrameIndex],this._batchEnabled&&!this._cacheRectangle&&(f=!0,this._cacheRectangle=new egret.Rectangle,this._clipConfig.cacheRectangles[this._cacheFrameIndex]=this._cacheRectangle);for(var y=0,v=this._slots.length;v>y;++y){var m=this._slots[y],_=this._frameSize*this._cacheFrameIndex+2*y,b=2*this._clipArray[_];if(b>=0){var T=a[b],x=8*a[b+1],E=6*this._clipArray[_+1],$=!1;if(m.displayIndex!=T&&(m.displayIndex=T,$=!0,this._updateSlotDisplay(m)),(m.colorIndex!=x||$)&&(m.colorIndex=x,m.colorIndex>=0?this._updateSlotColor(m,.01*l[x],.01*l[x+1],.01*l[x+2],.01*l[x+3],l[x+4],l[x+5],l[x+6],l[x+7]):this._updateSlotColor(m,1,1,1,1,0,0,0,0)),p=!0,m.transformIndex!=E)if(m.transformIndex=E,this._batchEnabled){var S=m.display.$renderNode.matrix;S||(S=m.display.$renderNode.matrix=new egret.Matrix),S.a=s[E],S.b=s[E+1],S.c=s[E+2],S.d=s[E+3],S.tx=s[E+4],S.ty=s[E+5]}else c.a=s[E],c.b=s[E+1],c.c=s[E+2],c.d=s[E+3],c.tx=s[E+4],c.ty=s[E+5],m.display.$setMatrix(c);if(this._batchEnabled&&f){var S=m.display.$renderNode.matrix;u.x=0,u.y=0,u.width=m.displayConfig.texture.textureWidth,u.height=m.displayConfig.texture.textureHeight,S.$transformBounds(u),h?(h=!1,this._cacheRectangle.x=u.x,this._cacheRectangle.width=u.x+u.width,this._cacheRectangle.y=u.y,this._cacheRectangle.height=u.y+u.height):(this._cacheRectangle.x=Math.min(this._cacheRectangle.x,u.x),this._cacheRectangle.width=Math.max(this._cacheRectangle.width,u.x+u.width),this._cacheRectangle.y=Math.min(this._cacheRectangle.y,u.y),this._cacheRectangle.height=Math.max(this._cacheRectangle.height,u.y+u.height))}}else-1!=m.displayIndex&&(m.displayIndex=-1,this._updateSlotDisplay(m))}this._cacheRectangle&&(p&&f&&h&&g&&(this._cacheRectangle.x=g.x,this._cacheRectangle.y=g.y,this._cacheRectangle.width=g.width,this._cacheRectangle.height=g.height),this.$invalidateContentBounds())}if(this._isCompleted&&(this._isPlaying=!1),!this._isStarted&&(this._isStarted=!0,this.hasEventListener(d.START))){var C=egret.Event.create(d,d.START);C.movie=this,C.clipName=this._clipConfig.name,C.name=null,C.slotName=null,this.dispatchEvent(C)}this._isReversing=this._currentTime>r&&this._currentPlayTimes==n;var w=this._clipConfig.frame?this._clipConfig.frame.length:0;if(w>0){var O=Math.floor(this._currentTime*this._config.frameRate),P=this._groupConfig.frame[this._clipConfig.frame[O]];if(this._currentFrameConfig!=P)if(w>1){var D=this._currentFrameConfig;if(this._currentFrameConfig=P,!D){var L=Math.floor(this._currentTime*this._config.frameRate);D=this._groupConfig.frame[this._clipConfig.frame[L]],this._isReversing||(this._currentTime<=D.position||this._currentPlayTimes!=n)&&(D=this._groupConfig.frame[D.prev])}if(this._isReversing)for(;D!=P;)this._onCrossFrame(D),D=this._groupConfig.frame[D.prev];else for(;D!=P;)D=this._groupConfig.frame[D.next],this._onCrossFrame(D)}else this._currentFrameConfig=P,this._currentFrameConfig&&this._onCrossFrame(this._currentFrameConfig)}this._currentTime=r;for(var y=0,v=this._childMovies.length;v>y;++y)this._childMovies[y].advanceTime(t);if(this._currentPlayTimes!=n){if(this._currentPlayTimes=n,this.hasEventListener(d.LOOP_COMPLETE)){var R=egret.Event.create(d,d.LOOP_COMPLETE);R.movie=this,R.clipName=this._clipConfig.name,R.name=null,R.slotName=null,this.dispatchEvent(R),egret.Event.release(R)}if(this._isCompleted&&this.hasEventListener(d.COMPLETE)){var I=egret.Event.create(d,d.COMPLETE);I.movie=this,I.clipName=this._clipConfig.name,I.name=null,I.slotName=null,this.dispatchEvent(I),egret.Event.release(I)}}this._isLockDispose=!1,this._isDelayDispose&&this.dispose()}}},i.prototype.play=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=-1),t){for(var i=null,r=0,n=this._config.clip.length;n>r;++r){var o=this._config.clip[r];o.name==t&&(i=o)}i?(this._clipConfig=i,this._clipArray=new Int16Array(this._groupConfig.arrayBuffer,this._groupConfig.offset+this._groupConfig.position[0]+this._clipConfig.p,this._clipConfig.s/this._groupConfig.position[2]),this._clipConfig.cacheRectangles||(this._clipConfig.cacheRectangles=[]),this._isPlaying=!0,this._isStarted=!1,this._isCompleted=!1,this._playTimes=0>e||e!=e?this._clipConfig.playTimes:e,this._time=0,this._currentTime=0,this._currentPlayTimes=0,this._cacheFrameIndex=-1,this._currentFrameConfig=null,this._cacheRectangle=null,this.clipTimeScale=1/this._clipConfig.scale):console.warn("No clip in movie.",this._config.name,t)}else this._clipConfig?this._isPlaying||this._isCompleted?this.play(this._clipConfig.name,this._playTimes):this._isPlaying=!0:this._config.action&&this.play(this._config.action,e)},i.prototype.stop=function(){this._isPlaying=!1},i.prototype.advanceTimeBySelf=function(e){e?t.EgretFactory._clock.add(this):t.EgretFactory._clock.remove(this)},i.prototype.hasClip=function(t){return null!=this._config.clip[t]},Object.defineProperty(i.prototype,"isPlaying",{get:function(){return this._isPlaying&&!this._isCompleted},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isComplete",{get:function(){return this._isCompleted},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentTime",{get:function(){return this._currentTime},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"totalTime",{get:function(){return this._clipConfig?this._clipConfig.duration:0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentPlayTimes",{get:function(){return this._currentPlayTimes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"playTimes",{get:function(){return this._playTimes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"groupName",{get:function(){return this._groupConfig.name},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"clipName",{get:function(){return this._clipConfig?this._clipConfig.name:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"clipNames",{get:function(){return this._clipNames},enumerable:!0,configurable:!0}),i}(egret.DisplayObjectContainer);t.Movie=f}(dragonBones||(dragonBones={}));